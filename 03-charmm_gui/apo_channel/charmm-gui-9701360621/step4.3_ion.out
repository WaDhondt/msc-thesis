1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 47a2   February 15, 2021            
                                Revision unknown                                
       Copyright(c) 1984-2020  President and Fellows of Harvard College
                              All Rights Reserved
      Current operating system: Linux-3.10.0-1160.80.1.el7.x86_64(x86_64)       
                 Created on 10/11/23 at  5:21:57 by user: apache      

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 11. 2023. JOBID=9701360621
 RDTITL> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 3000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     3000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        50000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream toppar.str
 VOPEN> Attempting to open::toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 11. 2023. JOBID=9701360621
 RDTITL> * STREAM FILE FOR TOPOLOGY AND PARAMETER READING
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! protein topology and parameter
 CHARMM>    open read card unit 10 name toppar/top_all36_prot.rtf
 VOPEN> Attempting to open::toppar/top_all36_prot.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_prot.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *>>>>>>>>CHARMM36 ALL-HYDROGEN TOPOLOGY FILE FOR PROTEINS <<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> MAY 2011 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36m_prot.prm
 VOPEN> Attempting to open::toppar/par_all36m_prot.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36m_prot.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *>>>> CHARMM36 ALL-HYDROGEN PARAMETER FILE FOR PROTEINS <<<<<<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! nucleic acids
 CHARMM>    open read card unit 10 name toppar/top_all36_na.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_na.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_na.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID TOPOLOGY FILE ////
 TITLE> *   ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                      APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *           PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_na.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_na.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_na.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID PARAMETER FILE ////
 TITLE> *         ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                        APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG PARAMETER
 TITLE> *                     SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! carbohydrates
 CHARMM>    open read card unit 10 name toppar/top_all36_carb.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_carb.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_carb.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * $ID: TOP_ALLXX_SUGAR.INP,V 1.106 2014/08/19 19:07:43 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN TOPOLOGIES USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_carb.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_carb.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_carb.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * $ID: PAR_ALLXX_SUGAR.INP,V 1.132 2014/08/19 19:03:21 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN PARAMETERS USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! lipids
 CHARMM>    open read card unit 10 name toppar/top_all36_lipid.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_lipid.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_lipid.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID TOPOLOGY FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_lipid.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_lipid.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_lipid.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID PARAMETER FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! CGENFF
 CHARMM>    open read card unit 10 name toppar/top_all36_cgenff.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_cgenff.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_cgenff.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *          CGENFF: TOPOLOGY FOR THE CHARMM GENERAL FORCE FIELD V. 4.6          *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_cgenff.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_cgenff.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_cgenff.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *         CGENFF: PARAMETERS FOR THE CHARMM GENERAL FORCE FIELD V. 4.6         *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *  2017/8: IF PROTEIN, NUCLEIC ACID AND CARBOHYDRATE TOPOLOGY AND PARAMETER FILES
 TITLE> *  ARE NOT READ PRIOR TO THE CGENFF FILES "WARNING: ATOMS IN NBFIX ' errors will
 TITLE> *  BE ENCOUNTERED.  THESE CAN BE PASSED BY SETTING BOMLEV ( -2) PRIOR TO READING
 TITLE> *  THIS FILE. IN ADDITION, WHEN GENERATING AROMATIC HALOGENS (CL, BR, I) WITH
 TITLE> *  PRE C41B/C42A VERSIONS OF CHARMM "MISSING PARAMETER" ERRORS WILL BE
 TITLE> *  ENCOUNTERED THAT ALSO REQUIRE SETTING BOMLEV ( -2).
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! Phosphates and Sulfates
 CHARMM>    stream toppar/toppar_all36_moreions.str
 VOPEN> Attempting to open::toppar/toppar_all36_moreions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_moreions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIONAL IONS GENERATED USING CGENFF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "345"
 Parameter: NAT <- "345"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "345"
 Parameter: NAT -> "345"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""345"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "345" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES GENERATED BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Interface FF
 CHARMM>    open read card unit 10 name toppar/top_interface.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_interface.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_interface.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY FOR NANOMATERIALS
 TITLE> *
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO17      -1.050
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO21      -1.050
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/par_interface.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_interface.prm::
 OPNLGU> Unit 10 opened for READONLY access to toppar/par_interface.prm
  
 CHARMM>    read para card unit 10 append flex

          PARAMETER FILE BEING READ FROM UNIT 10
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY AND PARAMETER FOR CALY MINERALS, CEMENT MINERALS
 TITLE> *
 PARRDR> Error: Repeated DIHE parameter ( 10947): HGR6  ICG1  ICG1  ICGE is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    stream toppar/toppar_all36_nano_lig.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR NANO-LIGAND
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_nano_lig_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for synthetic polymer
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_polymer_solvent.str
 VOPEN> Attempting to open::toppar/toppar_all36_polymer_solvent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_polymer_solvent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for water and ions
 CHARMM>    stream toppar/toppar_water_ions.str
 VOPEN> Attempting to open::toppar/toppar_water_ions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_water_ions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR WATER AND IONS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_water_ions.inp
 CHARMM>     
  
 CHARMM>    ! IMPORTANT NOTE: this file contains NBFixes between carboxylates and sodium,
 CHARMM>    ! which will only apply if the main files containing carboxylate atom types
 CHARMM>    ! have been read in first!
 CHARMM>     
  
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !TIP3P water model
 CHARMM>    !
 CHARMM>    !W.L. Jorgensen; J.Chandrasekhar; J.D. Madura; R.W. Impey;
 CHARMM>    !M.L. Klein; "Comparison of simple potential functions for
 CHARMM>    !simulating liquid water", J. Chem. Phys. 79 926-935 (1983).
 CHARMM>    !
 CHARMM>    !IONS
 CHARMM>    !
 CHARMM>    !Ions from Roux and coworkers
 CHARMM>    !
 CHARMM>    !Beglov, D. and Roux, B., Finite Representation of an Infinite
 CHARMM>    !Bulk System: Solvent Boundary Potential for Computer Simulations,
 CHARMM>    !Journal of Chemical Physics, 1994, 100: 9050-9063
 CHARMM>    !
 CHARMM>    !ZINC
 CHARMM>    !
 CHARMM>    !Stote, R.H. and Karplus, M. Zinc Binding in Proteins and
 CHARMM>    !Solution: A Simple but Accurate Nonbonded Representation, PROTEINS:
 CHARMM>    !Structure, Function, and Genetics 23:12-31 (1995)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "468"
 Parameter: NAT <- "468"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "468"
 Parameter: NAT -> "468"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""468"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "468" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR WATER AND IONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for sodium interacting with
 CHARMM>    ! carboxylate oxygens of various CHARMM force fields. It will generate
 CHARMM>    ! level -1 warnings whenever any of these force fields have not been
 CHARMM>    ! read prior to the current stream file. Since we don't want to force
 CHARMM>    ! the user to always read all the force fields, we're suppressing the
 CHARMM>    ! warnings. The only side effect is that you will have "most severe
 CHARMM>    ! warning was at level 0" at the end of your output. Also note that
 CHARMM>    ! the user is responsible for reading the current file last if they
 CHARMM>    ! want the NBFixes to apply. A more elegant solution would require new
 CHARMM>    ! features to be added to CHARMM.
 CHARMM>    ! parallel fix, to avoid duplicated messages in the log
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CARBOXYLATE AND SODIUM
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_dum_noble_gases.str
 VOPEN> Attempting to open::toppar/toppar_dum_noble_gases.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_dum_noble_gases.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_dum_nobel_gases.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous	toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "485"
 Parameter: NAT <- "485"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "485"
 Parameter: NAT -> "485"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""485"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "485" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_ions_won.str
 VOPEN> Attempting to open::toppar/toppar_ions_won.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_ions_won.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOP_IONS_WON.STR: GENERAL MODEL FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !This is a comprehensive set of ions developed using stochastic boundary
 CHARMM>    !conditions. It is strongly recommended that ion parameters in
 CHARMM>    !toppar_water_ions.str be used if available, as they are more highly
 CHARMM>    !optimized.  Accordingly, those ions have been commented in this
 CHARMM>    !file.
 CHARMM>    !
 CHARMM>    !reference
 CHARMM>    !Won, Y., "Force Field for Monovalent, Divalent, and Trivalent Cations
 CHARMM>    !Developed under the Solvent Boundary Potential," Journal of Physical
 CHARMM>    !Chemistry A., 116: 11763-11767, 2012.
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "488"
 Parameter: NAT <- "488"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "488"
 Parameter: NAT -> "488"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""488"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "488" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PAR_CATION.PRM FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/cam.str
 VOPEN> Attempting to open::toppar/cam.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/cam.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY GENERATED BY PARMED
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY PARMED
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for CAM interacting with
 CHARMM>    ! water.
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CAM AND WATER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for protein
 CHARMM>    stream toppar/toppar_all36_prot_arg0.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_arg0.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_arg0.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>> ALL-HYDROGEN TOPOLOGY FOR NEUTRAL ARG <<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> 2007 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Atom names include "R" (for Arg) as the second letter. The
 CHARMM>    ! only other atom types in the additive FF with this second
 CHARMM>    ! letter are histidine [HN]R[123] in the protein FF and CRL[12]
 CHARMM>    ! in toppar_all36_lipid_cholesterol.str , so no more conflicts.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.rtf
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_arg0.inp
 CHARMM>     
  
 CHARMM>    !Li, L., Vorobyov, I.V., MacKerell, Jr., A.D., Allen, T.W., "Is
 CHARMM>    !arginine charged in a membrane?" Biophysical Journal, 94: L11-L13,
 CHARMM>    !2008, PMCID: PMC2157258
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MGU1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU1          0.00
*** WARNING **** residue MGU2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU2          0.00
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_c36m_d_aminoacids.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_c36m_d_aminoacids.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_c36m_d_aminoacids.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>>CHARMM36 ALL-HYDROGEN TOPPAR FILE FOR D-PROTEINS <<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 RDTITL> *             PARAMETER SET DISCUSSION FORUM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !update 2016/2. use directly inverted CMAPs
 CHARMM>     
  
 CHARMM>    !toppar stream file for D-amino acids. Includes new residue
 CHARMM>    !names, inverted CMAP and additional parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36m_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_d_amino_acid.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "554"
 Parameter: NAT <- "554"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "554"
 Parameter: NAT -> "554"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""554"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "554" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR D- AMINOACIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR D- AMINOACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_fluoro_alkanes.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_fluoro_alkanes.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_fluoro_alkanes.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR FLUORINATED ALKANES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !These parameters are maintained for historic reasons.  The CGenFF
 CHARMM>    !halogen parameters are a significant improvement over these
 CHARMM>    !parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_fluoro_alkanes.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Chen, I.-J., Yin, D. and MacKerell, Jr., A.D., "Combined Ab
 CHARMM>    !initio/Empirical Approach for Optimization of Lennard-Jones Parameters
 CHARMM>    !for Polar-Neutral Compounds," Journal of Computational Chemistry,
 CHARMM>    !2002, 23:199-213.
 CHARMM>    !
 CHARMM>    !Note that these parameters are higly optimized to reproduce the
 CHARMM>    !corresponding condensed phase properties and have not been incorporated
 CHARMM>    !into the CHARMM22 or CHARMM27 biomolecular force fields
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR FLUOROALKANES
 RDTITL> *
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA  0.0
*** WARNING **** residue FETH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FETH  0.0
*** WARNING **** residue DFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DFET 0.0
*** WARNING **** residue TFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFET  0.0
*** WARNING **** residue TFE  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFE   0.0
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * FLUOROALKANE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_heme.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_heme.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_heme.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR HEME AND RELATED
 RDTITL> * LIGANDS AND PATCHES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !updated 2016/2, allow for use of AUTOGENERATE ANGLE DIHEDRAl PATCH
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_heme.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HEME AND RELATED COMPOUNDS AND PATCHES
 RDTITL> *
*** WARNING **** residue CO2  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO2             0.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR HEME
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_na_combined.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_na_combined.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_na_combined.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR PATCHES TO CREATE
 RDTITL> * MODEL COMPOUNDS AND PATCHES THAT REQUIRE BOTH PROTEIN AND
 RDTITL> * NUCLEIC ACID TOPOLOGY AND PARAMETER INFORMATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>    !stream/toppar_all36_prot_fluoro_alkanes.str ! atom types an parameters for fluorinated compounds
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_na_combined.inp
 CHARMM>     
  
 CHARMM>    !all patches must be followed by AUTOGENERATE ANGLES DIHEDRALS
 CHARMM>     
  
 CHARMM>    !PHOSPHOTYROSINE
 CHARMM>    !
 CHARMM>    !Feng, M.-H., Philippopoulos, M., MacKerell, Jr., A.D. and Lim, C.
 CHARMM>    !Structural Characterization of the Phosphotyrosine Binding Region of a
 CHARMM>    !High-Affinity aSH2 Domain-Phosphopeptide Complex by Molecular Dynamics
 CHARMM>    !Simulation and Chemical Shift Calculations. Journal of the American
 CHARMM>    !Chemical Society, 1996, 118: 11265-11277.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
*** WARNING **** residue THFI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFI       0.00
*** WARNING **** residue THMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THMI       0.00
*** WARNING **** residue THFA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFA        0.00
*** WARNING **** residue THAO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THAO         0.00
*** WARNING **** residue RNUS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RNUS         0.00
*** WARNING **** residue NUCL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NUCL        -1.00
*** WARNING **** residue PPH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPH1      -1.00
*** WARNING **** residue BMPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPH      -1.00
*** WARNING **** residue BMPD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPD      -2.00
*** WARNING **** residue BDFP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFP      -1.00
*** WARNING **** residue BDFD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFD -2.00
*** WARNING **** residue EP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EP_2        -2.00
*** WARNING **** residue IP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IP_2        -2.00
 There were  13 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_retinol.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_retinol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_retinol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR RETINOL AND RETINAL PARAMETERS
 RDTITL> * A. LOCCISANO, A.M.W., J. EVANSECK AND A.D. MACKERELL, JR.
 RDTITL> * APRIL, 2005
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !use with c36 protein force fields
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * RETINAL/RETINOL AND RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue 13DB already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DB       0.00
*** WARNING **** residue 13DP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DP       0.00
*** WARNING **** residue DMB1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMB1       0.00
*** WARNING **** residue DMP1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP1       0.00
*** WARNING **** residue DMP2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP2       0.00
*** WARNING **** residue CROT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CROT       0.00
*** WARNING **** residue PACP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PACP       0.00
*** WARNING **** residue MECH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MECH       0.00
*** WARNING **** residue TMCH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TMCH       0.00
*** WARNING **** residue FRET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FRET       0.00
*** WARNING **** residue RTOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTOL       0.00
*** WARNING **** residue RTAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAL       0.00
*** WARNING **** residue RTAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAC      -1.00
*** WARNING **** residue PRAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAC      -1.00
*** WARNING **** residue PROL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROL       0.00
*** WARNING **** residue PRAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAL       0.00
*** WARNING **** residue SCH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH1       0.00
*** WARNING **** residue SCH2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH2       1.00
*** WARNING **** residue SCH3 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH3       1.00
 There were  20 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * RETINAL/RETINOL AND RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>> ALL-HYDROGEN TOPOLOGY FOR SMALL MODEL COMPOUNDS USED IN THE <<
 RDTITL> *>> DEVELOPMENT OF THE CHARMM22 PROTEIN ALL-HYDROGEN PARAMETERS <<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> JULY 1997 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *CONVERTED TO STREAM FORMAT, DECEMBER 2003
 RDTITL> *CONVERTED TO CHARMM36 PROTEIN ATOM TYPES, MAY 2011
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_model.inp
 CHARMM>     
  
 CHARMM>    !changes after 9/98
 CHARMM>    !
 CHARMM>    !change alkene HA1 and HA2 to HE1 and HE2
 CHARMM>    !
 CHARMM>    !improper atom ordering corrected
 CHARMM>    !
 CHARMM>    !version b5i to be consistent with protein toppar files
 CHARMM>    !
 CHARMM>    !Heme vinyl groups upgraded based on new butene parameters
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    ! references
 CHARMM>    !
 CHARMM>    !PROTEINS
 CHARMM>    !
 CHARMM>    !MacKerell, Jr., A. D.; Bashford, D.; Bellott, M.; Dunbrack Jr., R.L.;
 CHARMM>    !Evanseck, J.D.; Field, M.J.; Fischer, S.; Gao, J.; Guo, H.; Ha, S.;
 CHARMM>    !Joseph-McCarthy, D.; Kuchnir, L.; Kuczera, K.; Lau, F.T.K.; Mattos,
 CHARMM>    !C.; Michnick, S.; Ngo, T.; Nguyen, D.T.; Prodhom, B.; Reiher, III,
 CHARMM>    !W.E.; Roux, B.; Schlenkrich, M.; Smith, J.C.; Stote, R.; Straub, J.;
 CHARMM>    !Watanabe, M.; Wiorkiewicz-Kuczera, J.; Yin, D.; Karplus, M.  All-atom
 CHARMM>    !empirical potential for molecular modeling and dynamics Studies of
 CHARMM>    !proteins.  Journal of Physical Chemistry B, 1998, 102, 3586-3616.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue ACET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACET       -1.00
*** WARNING **** residue PROA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROA       -1.00
*** WARNING **** residue GUAN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GUAN        1.00
*** WARNING **** residue MGUA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGUA        1.00
*** WARNING **** residue GLYN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYN         0.00
*** WARNING **** residue MAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAMM        1.00
*** WARNING **** residue EAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EAMM        1.00
*** WARNING **** residue ACEH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEH        0.00
*** WARNING **** residue MEOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MEOH        0.00
*** WARNING **** residue METO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI METO       -1.00
*** WARNING **** residue ETOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETOH        0.00
*** WARNING **** residue ETO  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETO        -1.00
*** WARNING **** residue PRO2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRO2        0.00
*** WARNING **** residue FORM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FORM        0.00
*** WARNING **** residue ACEM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEM        0.00
*** WARNING **** residue NMA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NMA         0.00
*** WARNING **** residue MESH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MESH        0.00
*** WARNING **** residue MES1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MES1       -1.00
*** WARNING **** residue ETSH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETSH        0.00
*** WARNING **** residue ES1  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ES1        -1.00
*** WARNING **** residue DMDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMDS        0.00
*** WARNING **** residue DEDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DEDS        0.00
*** WARNING **** residue EMS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EMS         0.00
*** WARNING **** residue IMIA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIA        0.00
*** WARNING **** residue MIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MIMI        0.00
*** WARNING **** residue EIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMI        0.00
*** WARNING **** residue IMIM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIM        1.00
*** WARNING **** residue EIMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMM        1.00
*** WARNING **** residue BENZ already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BENZ        0.00
*** WARNING **** residue EBEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EBEN         0.00
*** WARNING **** residue PHEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEN        0.00
*** WARNING **** residue EPHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EPHE        0.00
*** WARNING **** residue PHEO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEO       -1.00
*** WARNING **** residue INDO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI INDO        0.00
*** WARNING **** residue EIND already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIND        0.00
*** WARNING **** residue PDIP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PDIP        0.00
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA        0.00
*** WARNING **** residue PRPA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPA        0.00
*** WARNING **** residue IBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IBUT        0.00
*** WARNING **** residue OCOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI OCOH    0.0
*** WARNING **** residue CO3  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO3  -2.0
*** WARNING **** residue C3   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI C3    0.00
 There were  42 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_modify_res.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_modify_res.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_modify_res.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR FILE FOR VARIOUS MODIFIED RESIDUES AND PATCHES, INCLUDING
 RDTITL> * PATCHES TO COVALENTLY LINK RESIDUES TO IONS TO WORK WITH THE
 RDTITL> * ADDITIVE C36 PROTEIN FORCE FIELD
 RDTITL> * REQUIRES CGENFF PARAMETER FILE
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Acetyllysine (ALY)
 CHARMM>    !Norleucine (NLE) and
 CHARMM>    ! residues and patches for Zn-protein interactions modeled using
 CHARMM>    ! bond and angles between the protein and Zn.
 CHARMM>     
  
 CHARMM>    !non-standard amino acids: 2021
 CHARMM>    !Croitoru, A., Park, S.-J., Kumar, A., Lee, J., Im, Wonpil; MacKerell,
 CHARMM>    !A.D., Jr., and Aleksandrov, A. Additive CHARMM36 Force Field for
 CHARMM>    !Nonstandard Amino Acids, Journal of Chemical Theory and Computation,
 CHARMM>    !17:3554-3570, doi: 10.1021/acs.jctc.1c00254.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPPAR FILE PROTEIN MODIFICATIONS
 RDTITL> *
*** WARNING **** residue CGU  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGU              -2.000
*** WARNING **** residue CME  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CME               0.000
*** WARNING **** residue HIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HIC               0.000
*** WARNING **** residue HICP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HICP              1.000
*** WARNING **** residue CGUP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGUP             -1.000
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for nucleic acids
 CHARMM>    stream toppar/toppar_all36_na_nad_ppi.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_nad_ppi.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_nad_ppi.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN NUCLEIC ACID FORCE TOPPAR STREAM FILE
 RDTITL> * NAD+, NADH, ADP, ATP, PPI AND RELATED ANALOGS
 RDTITL> * A.D. MACKERELL, JR., JULY 2001
 RDTITL> * STREAM FOLLOWING RTF AND PARAM READ OF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Update, 2015/1, nomenclature for NAD+ etc. consistent with PDB
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_na_nad_ppi.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Pavelites, J.J., Bash, P.A., Gao, J., and MacKerell, Jr.,
 CHARMM>    !A.D. A Molecular Mechanics Force Field for NAD+, NADH and the
 CHARMM>    !Pyrophosphate Groups of Nucleotides, Journal of Computational
 CHARMM>    !Chemistry, 1997, 18: 221-239.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * NAD, PPI TOPOLOGY
 RDTITL> *
*** WARNING **** residue NIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NIC         1.00
*** WARNING **** residue NICH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NICH         0.00
*** WARNING **** residue PPI1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI1        -3.00
*** WARNING **** residue PPI2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI2        -2.00
*** WARNING **** residue AMP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI AMP         -2.00
*** WARNING **** residue ADP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ADP         -3.00
*** WARNING **** residue ATP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ATP         -4.00
*** WARNING **** residue 5DP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES 5DP         -3.00
*** WARNING **** residue NAD  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NAD         -1.00
*** WARNING **** residue NADH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADH        -2.00
*** WARNING **** residue NADP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADP        -2.00
*** WARNING **** residue NDPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NDPH        -3.00
 There were  12 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NAD, PPI PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_na_rna_modified.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_rna_modified.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_rna_modified.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIVE CHARMM FORCE FIELD FOR MODIFIED RIBONUCLEIC ACIDS, INCLUDING
 RDTITL> * THOSE FOUNDS IN TRNA. YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> * |
 RDTITL> * WARNING: PARAMETERS AND ATOM TYPE ASSIGNMENTS IN THIS FILE ARE SPECIFIC
 RDTITL> * FOR THESE COMPOUNDS AND SHOULD UNDER NO CIRCUMSTANCES BE APPLIED TO
 RDTITL> * OTHER ORGANIC MOLECULES
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Xu, Y., Vanommeslaeghe, K., Aleksandrov, A., MacKerell, A.D.,
 CHARMM>    ! Jr. Nilsson, L., “Additive CHARMM force field for naturally
 CHARMM>    ! occurring modified ribonucleotides,” Journal of Computational
 CHARMM>    !  Chemistry, DOI: 10.1002/jcc.24307, 2016
 CHARMM>     
  
 CHARMM>    ! Should be used with parent files CGenFF: top_all36_cgenff.inp and par_all36_cgenff.inp
 CHARMM>    !                                    NA36: top_all36_na.inp and par_all36_na.inp
 CHARMM>    !                              and Carb36: top_all36_carb.inp and par_all36_carb.inp
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES OF MODIFIED NUCLEOTIDES
 RDTITL> *
*** WARNING **** residue BUG  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUG           -1.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIVE CHARMM PARAMETERS FOR MODIFIED NUCLEIC ACIDS, BETA VERSION
 RDTITL> * YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for lipids
 CHARMM>    stream toppar/toppar_all36_lipid_sphingo.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_sphingo.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_sphingo.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FOR CERAMIDES AND SPINGOMYELINS; REQUIRES FLEX FORMAT FILES
 RDTITL> * TOP_ALL36_LIPID.RTF AND PAR_ALL36_LIPID.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! PSM and SSM Lipids
 CHARMM>    !
 CHARMM>    ! Venable, R. M.; Sodt, A. J.; Rogaski, B.; Rui, H.; Hatcher, E.; MacKerell, A. D.;
 CHARMM>    ! Pastor, R. W.; Klauda, J. B., CHARMM All-Atom Additive Force Field for Sphingomyelin:
 CHARMM>    ! Elucidation of Hydrogen Bonding and of Positive Curvature. Biophys. J. 2014, 107 (1), 134-145
 CHARMM>    !
 CHARMM>    ! Ceramide
 CHARMM>    !
 CHARMM>    ! Submited by Sam Tonddast-Navaei of U. Cincinnati. Advised by Russell Devane
 CHARMM>    ! Tested by Eric Wang of U. Maryland. Advised by Jeffery Klauda
 CHARMM>    !
 CHARMM>    !
 CHARMM>    ! CerAP/Cer6, CerNP/Cer3, and CerEOS/Cer1
 CHARMM>    !
 CHARMM>    ! Wang, E.; Klauda, J. B., Structure and Permeability of Ceramide Bilayers and Multilayers.
 CHARMM>    ! J. Phys. Chem. B., 2019, 123, 11, 2525-2535
 CHARMM>    ! Wang, E.; Klauda, J. B., Molecular Structure of the Long Periodicity Phase in the Stratum Corneum.
 CHARMM>    ! J. Amer. Chem. Soc., 2019. 141, 42, 16930-16943
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "585"
 Parameter: NAT <- "585"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "585"
 Parameter: NAT -> "585"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""585"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "585" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CER/SM RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 14748): NHL   C     CTO1  HAL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 14769): O     C     CTO1  HAL1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_archaeal.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_archaeal.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_archaeal.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR ARCHAEAL LIPIDS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! This is an on-going file of archaeal lipids
 CHARMM>    ! I am adding meanquinone-7 now
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * ARCHAEAL LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY CGENFF
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_bacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_bacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_bacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! Branched Lipids
 CHARMM>    !
 CHARMM>    ! Lim, J.B. & Klauda, J.B. Branching at the Iso- and Anteiso- Positions in Complex Chlamydia
 CHARMM>    ! Membranes: A Molecular Dynamics Study. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1808:323-331 (2011).
 CHARMM>    !
 CHARMM>    ! Cyclic-replacement of double bond
 CHARMM>    !
 CHARMM>    ! Pandit, K.R. & Klauda, J.B. Membrane models of E. coli containing cyclic moieties in
 CHARMM>    ! the aliphatic lipid chain. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1818:1205-1210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cardiolipin.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cardiolipin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cardiolipin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL>  
 RDTITL> No title read.
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cholesterol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cholesterol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cholesterol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR CHOLESTEROL.  STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> * TOP_ALL36_CGENFF.RTF
 RDTITL> * AND PAR_ALL36_CGENFF.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !topology and parameters are included for two cholesterol models. the
 CHARMM>    !model may be selected by setting variable chol_model to 1 or 2, as
 CHARMM>    !specified below
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set chol_model 1 !2 for original Suits et al. model
 Parameter: CHOL_MODEL <- "1"
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    !1) Revised model of Lim et al.  This contains a number of NBFIXes that
 CHARMM>    !makes it unsuitable for ANTON (set chol_model 1)
 CHARMM>    !
 CHARMM>    !2) Original model of Suits et al., which is used on ANTON as well as
 CHARMM>    !being suitable for other systems (set chol_model 2 (or anything but 1....))
 CHARMM>    !
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    !Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>    !Suits, F., Pitman, M., MacKerell, A.D., Jr., Feller, S.E. "Molecular Level
 CHARMM>    !Organization of Saturated and Polyunsaturated Fatty Acids in a
 CHARMM>    !Phosphatidylcholine Bilayer Containing Cholesterol" Biochemistry,
 CHARMM>    !43(49):15318-28, 2004
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    !test "append"
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    if chol_model eq 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>    ! reference
 CHARMM>    ! Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    ! Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR CHOLESTEROL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CHOLESTEROL PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 15108): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15109): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15110): OG31  CG30  CG3C  HGA1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15108): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15109): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15110): OG31  CG30  CG3C  HGA1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_dag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_dag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_dag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM DAG
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_inositol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_inositol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_inositol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lnp.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lnp.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lnp.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LNP
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
 **** WARNING from RTFRDR **** The total charge of the residue, DAGP,  -0.0100000,
 does not equal the expected charge,   0.0000000.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
          PRES DPEPEG
 **** WARNING from RTFRDR **** The total charge of the residue, DPEP,  -0.0100000,
 does not equal the expected charge,   0.0000000.
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * LNP
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lps.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lps.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lps.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM LPS
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read param card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_mycobacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_mycobacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_mycobacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF, PAR_ALL36_LIPID.PRM
 RDTITL> * AND
 RDTITL> * TOPPAR_ALL36_LIPID_BACTERIAL.STR
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated ANGLE parameter (  5023): CEL1  CEL1  CTL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15355): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15356): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15355): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15356): CTL2  CG2O  CTL1  CTL3 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_miscellaneous.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_miscellaneous.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_miscellaneous.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR MISCELLANEOUS LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETER FOR ACYL PYROPHOSPHATE: ADDED 2019_7
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN LIPID FORCE FIELD TOPPAR STREAM FILE
 RDTITL> * COLLECTION OF RESIDUES AND PATCHES FOR MODEL COMPOUNDS USED
 RDTITL> * IN THE OPTIMIZATION THE LIPID FORCE FIELD.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_lipid_model.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 LIPID MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MAS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAS          0.00
*** WARNING **** residue ETAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAC         0.00
*** WARNING **** residue MPRO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MPRO         0.00
*** WARNING **** residue MP_1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_1        -1.00
*** WARNING **** residue MP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_2        -2.00
*** WARNING **** residue MSO4 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MSO4        -1.00
*** WARNING **** residue BUTA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUTA         0.00
*** WARNING **** residue PENT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PENT         0.00
*** WARNING **** residue HEXA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HEXA         0.00
*** WARNING **** residue ETHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHE       0.00
*** WARNING **** residue PRPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPE       0.00
*** WARNING **** residue BTE1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE1       0.00
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue DIPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIPE       0.00
*** WARNING **** residue DIHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIHE       0.00
*** WARNING **** residue NC4  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC4          1.00
*** WARNING **** residue NC5  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC5          1.00
*** WARNING **** residue CHOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CHOL         1.00
*** WARNING **** residue ACHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACHO         1.00
*** WARNING **** residue PC   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PC           0.00
*** WARNING **** residue GPC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GPC          0.00
*** WARNING **** residue TEA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TEA          1.00
*** WARNING **** residue ETAM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAM       1.00
*** WARNING **** residue GLYC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYC         0.00
*** WARNING **** residue MBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MBUT         0.00
 There were  25 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_prot.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_prot.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_prot.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR LIPID TAIL LINKERS TO CYSTEINE AND GLYCINE,
 RDTITL> * FOR EXAMPLE, PALMITOYLATION, MARISTOYLATION, FERNASYLATION, GERANYLATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LIPID-MODIFIED PROTEIN RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CYSTEIN-PALMITATE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_tag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_tag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_tag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TRIACYLGLYCEROLS [STEPHEN GEE FROM LEHIGH UNIVERSITY]
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_yeast.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_yeast.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_yeast.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_hmmm.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_hmmm.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_hmmm.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TERMINAL PATCHES FOR HMMM TRUNCATED LIPIDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_detergent.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_detergent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_detergent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR DETERGENTS AND FATTY ACIDS.
 RDTITL> * STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Additional residues added by Im lab, Aug. 2017
 CHARMM>     
  
 CHARMM>    !Fatty acids added Jan. 2016
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * DETERGENT AND FATTY ACID RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SB3-12 AND SB3-14 PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_ether.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_ether.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_ether.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN ETHER LIPID FORCE FIELD INCLUDING PLASMALOGENS ALISON
 RDTITL> * N. LEONARD (A. L.), 7/18 WITH RICHARD PASTOR AND JEFFERY KLAUDA, JPCB 122(26)
 RDTITL> * PP. 6744 - 6754.  ANA WEST, 1/20 WITH VALERIA ZONI, WALTER TEAGUE JR., ALISON
 RDTITL> * LEONARD, STEFANO VANNI, KLAUS GAWRISCH, STEPHANIE TRISTAM-NAGLE, JONATHAN
 RDTITL> * SACHS, AND JEFFERY KLAUDA, JPCB 124(5) PP. 828 - 839.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>    !top_all36_cgenff.rtf
 CHARMM>    !par_all36_cgenff.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 ETHER MODEL COMPOUNDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for carbohydrates
 CHARMM>    stream toppar/toppar_all36_carb_glycolipid.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycolipid.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycolipid.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOLIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PIP RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_glycopeptide.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycopeptide.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycopeptide.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOPEPTIDE LINKAGES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_imlab.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_imlab.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_imlab.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for spin/fluorophore labels
 CHARMM>    stream toppar/toppar_all36_label_spin.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_spin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_spin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>> TOPOLOGY FOR NITROXYDE SPIN LABELS <<<<<<<
 RDTITL> * SHAHIDUL M. ISLAM, UNIVERSITY OF CHICAGO
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! please reference the following:
 CHARMM>    !Sezer, D., Freed J. H., and Roux, B. “Parametrization, Molecular Dynamics Simulation, and Calculation of Electron Spin
 CHARMM>    !Resonance Spectra of a Nitroxide Spin Label on a Polyalanine alpha-Helix” J. Phys. Chem. B 2008, 112, 5755-5767
 CHARMM>     
  
 CHARMM>    !Islam, S. M., and Roux, B. “Parameterization and molecular dynamics simulations of a
 CHARMM>    !conformationally constrained double linked spin label constrained by EPR/DEER data”
 CHARMM>    !(planed submission to J journal)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SPIN LABEL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR SPIN LABEL
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_label_fluorophore.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_fluorophore.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_fluorophore.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FILES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MINI FORCE FIELD PARAMETER FILE.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    ! Read PSF and Coordinates
 CHARMM>    open read unit 10 card name step1_pdbreader.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step1_pdbreader.psf::
 OPNLGU> Unit 10 opened for READONLY access to step1_pdbreader.psf
  
 CHARMM>    read psf  unit 10 card
 MAINIO> Protein structure file being read from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 11. 2023. JOB
 TITLE>  * READ PDB, MANIPULATE STRUCTURE IF NEEDED, AND GENERATE TOPOLOGY FILE
 TITLE>  *  DATE:    10/11/23      4:44:42      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =     1336
         Number of atoms         =    21669   Number of groups     =     6683
         Number of bonds         =    21929   Number of angles     =    39628
         Number of dihedrals     =    57979   Number of impropers  =     3511
         Number of cross-terms   =     1332   Number of autogens   =        0
         Number of HB acceptors  =     1875   Number of HB donors  =     2261
         Number of NB exclusions =        0   Total charge =   16.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step2_orient.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step2_orient.crd::
 OPNLGU> Unit 10 opened for READONLY access to step2_orient.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * CALC TOPAREA = 4641.77519
 TITLE> * CALC BOTAREA = 4845.80847
 TITLE> * CALC XMAX = 61.0885415
 TITLE> * CALC XMIN = -60.9276414
 TITLE> * CALC YMAX = 50.6003109
 TITLE> * CALC YMIN = -60.9886095
 TITLE> * CALC ZMAX = 49.2704086
 TITLE> * CALC ZMIN = -58.3021167
 TITLE> *  DATE:    10/11/23      4:53:57      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    define PROT sele all end
 SELRPN>  21669 atoms have been selected out of  21669
  
 CHARMM>     
  
 CHARMM>    !Read the system information
 CHARMM>    stream step3_size.str
 VOPEN> Attempting to open::step3_size.str::
 OPNLGU> Unit 99 opened for READONLY access to step3_size.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE  = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE  = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE  = TETRAGONAL
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>     SET A        = 125.050557
 Parameter: A <- "125.050557"
  
 CHARMM>     SET B        = 125.050557
 Parameter: B <- "125.050557"
  
 CHARMM>     SET C        = 152.572525
 Parameter: C <- "152.572525"
  
 CHARMM>     SET ALPHA    = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA     = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA    = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET ZCEN     = -4.51585405
 Parameter: ZCEN <- "-4.51585405"
  
 CHARMM>     SET NLIPTOP  = 161
 Parameter: NLIPTOP <- "161"
  
 CHARMM>     SET NLIPBOT  = 158
 Parameter: NLIPBOT <- "158"
  
 CHARMM>     SET WBOXZ    = 22.5
 Parameter: WBOXZ <- "22.5"
  
 CHARMM>     SET WATBOXZ  = 60.8021167
 Parameter: WATBOXZ <- "60.8021167"
  
 CHARMM>     SET NCHARGE  = 16
 Parameter: NCHARGE <- "16"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream step4_components.str
 VOPEN> Attempting to open::step4_components.str::
 OPNLGU> Unit 99 opened for READONLY access to step4_components.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET NWATER = 0
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET NWATER = 0
 Parameter: NWATER <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    if islconj .eq. YES stream step3_lipid_conjugate.str
 Comparing "ISLCONJ" and "YES".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    ! Read Lipids
 CHARMM>    open read unit 10 card name step4_lipid_lipid.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.psf::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.psf
  
 CHARMM>    read psf  unit 10 card append
 MAINIO> Protein structure file being appended from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 11. 2023. JOB
 TITLE>  * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE>  *  DATE:    10/11/23      5:13:16      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =     1655
         Number of atoms         =    64415   Number of groups     =    17529
         Number of bonds         =    64356   Number of angles     =   121292
         Number of dihedrals     =   171543   Number of impropers  =     4149
         Number of cross-terms   =     1332   Number of autogens   =        0
         Number of HB acceptors  =     1875   Number of HB donors  =     2261
         Number of NB exclusions =        0   Total charge =   16.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4_lipid_lipid.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.crd
  
 CHARMM>    read coor unit 10 card append
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 A RESIDUE OFFSET OF1336 WILL BE USED.
 INFO: A subset of total atoms will be read.

 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 11. 2023. JOB
 TITLE> * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE> *  DATE:    10/11/23      5:13:17      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    ! Write coordinates
 CHARMM>    open write unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for WRITE access to step4.3_ion_protmemb.crd
  
 CHARMM>    write coor unit 10 card
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    define LPSION sele none end
 SELRPN>      0 atoms have been selected out of  64415
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions
 CHARMM>    ! nneg    : number of negative ions
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set zmemb =  20.0           ! ion exclusion membrane region
 Parameter: ZMEMB <- "20.0"
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR     64415 SELECTED ATOMS:
    XMIN =  -67.423397 XMAX =   68.567774 XAVE =    0.555024
    YMIN =  -66.132661 YMAX =   68.287335 YAVE =    0.440722
    ZMIN =  -58.302117 ZMAX =   49.509077 ZAVE =   -0.411490
    WMIN =    0.000000 WMAX =    0.098307 WAVE =    0.000021
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "68.5677742"
 RDCMND substituted energy or value "?XMIN" to "-67.4233968"
Evaluating: INT((68.5677742--67.4233968+5.0)/0.5)+1
 Parameter: XDIM <- "282"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "68.2873347"
 RDCMND substituted energy or value "?YMIN" to "-66.1326612"
Evaluating: INT((68.2873347--66.1326612+5.0)/0.5)+1
 Parameter: YDIM <- "279"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "49.5090773"
 RDCMND substituted energy or value "?ZMIN" to "-58.3021167"
Evaluating: INT((49.5090773--58.3021167+5.0)/0.5)+1
 Parameter: ZDIM <- "226"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "282"
 Parameter: YDIM -> "279"
 Parameter: ZDIM -> "226"
Evaluating: 282*279*226
 Parameter: SPACE <- "17781228"
  
 CHARMM>     
  
 CHARMM>    ! prevent overflow on integer conversion
 CHARMM>    calc maxint = 2**32 / 2 - 1
Evaluating: 2**32/2-1
 Parameter: MAXINT <- "2.147483647E+09"
  
 CHARMM>    if space .gt. @maxint calc space = @maxint
 Parameter: MAXINT -> "2.147483647E+09"
 Parameter: MAXINT -> "2.147483647E+09"
 Comparing "17781228" and "2.147483647E+09".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname TIP3 end
 Parameter: SPACE -> "17781228"
 SELRPN>  64415 atoms have been selected out of  64415
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=    -70.1634 XMAX=     71.3078 NX= 281
   YMIN=    -68.8727 YMAX=     71.0273 NY= 278
   ZMIN=    -61.4021 ZMAX=     52.4404 NZ= 226


 A TOTAL OF    22817   VACUUM POINTS WERE FOUND
 A TOTAL OF  6266096 OCCUPIED POINTS WERE FOUND
 A TOTAL OF 11365755 EXTERNAL POINTS WERE FOUND
 A TOTAL OF 17631851 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =  799701.038688
 TOTAL SELECTED  VOLUME = 2250238.355540
 TOTAL FREE      VOLUME =    2911.985166
 FRACTIONAL FREE VOLUME =       0.362813
  
 CHARMM>     
  
 CHARMM>    set sysvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "799701.039"
 Parameter: SYSVOL <- "799701.039"
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .ne. HEXA then
 Comparing "RECT" and "HEXA".
 IF test evaluated as true.  Performing command
  
 CHARMM>       calc volumn = ( @A * @B * @C ) - @sysvol
 Parameter: A -> "125.050557"
 Parameter: B -> "125.050557"
 Parameter: C -> "152.572525"
 Parameter: SYSVOL -> "799701.039"
Evaluating: (125.050557*125.050557*152.572525)-799701.039
 Parameter: VOLUMN <- "1586173.46"
  
 CHARMM>    ENDIF
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .eq. HEXA THEN
 Comparing "RECT" and "HEXA".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    if @?nlipaion  .eq. 0 set nlipaion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NLIPAION <- "0"
  
 CHARMM>    if @?ncoreion  .eq. 0 set ncoreion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NCOREION <- "0"
  
 CHARMM>    if @?noantiion .eq. 0 set noantiion = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NOANTIION <- "0"
  
 CHARMM>     
  
 CHARMM>    calc npostot = @nlipaion + @ncoreion + @noantiion
 Parameter: NLIPAION -> "0"
 Parameter: NCOREION -> "0"
 Parameter: NOANTIION -> "0"
Evaluating: 0+0+0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = @npostot
 Parameter: NPOSTOT -> "0"
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of  64415
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of  64415
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of  64415
  
 CHARMM>     
  
 CHARMM>        stream step2.2_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step2.2_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to step2.2_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = SOD
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "SOD"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CLA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CLA"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0.15
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0.15"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "16"
Evaluating: INT(16)
 Parameter: NCHARGE <- "16"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "16"
Evaluating: 16
 Parameter: CGTOT <- "16"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "16"
 Parameter: POSCHARGE -> "1"
 Comparing "16" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "16"
 Parameter: NEGCHARGE -> "1"
 Comparing "16" and "0".
 IF test evaluated as true.  Performing command
Evaluating: INT(ABS(16)/1)
 Parameter: NNEG <- "16"
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "16"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "16"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(16+0*1-16*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "16"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "16"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "16"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(16+0*1-16*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "1586173.46"
 Parameter: NEGVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*1586173.46)*1
 Parameter: NPOS <- "143"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "16"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "1586173.46"
 Parameter: POSVAL -> "1"
Evaluating: 16+INT(0.15*6.021*0.0001*1586173.46)*1
 Parameter: NNEG <- "159"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "143" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "159" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "143" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "SOD"
 Parameter: NPOS -> "143"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   4 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        4   Number of residues   =     1798
         Number of atoms         =    64558   Number of groups     =    17672
         Number of bonds         =    64356   Number of angles     =   121292
         Number of dihedrals     =   171543   Number of impropers  =     4149
         Number of cross-terms   =     1332   Number of autogens   =        0
         Number of HB acceptors  =     1875   Number of HB donors  =     2261
         Number of NB exclusions =        0   Total charge =  159.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>    143 atoms have been selected out of  64558
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele POS end
 SELRPN>    143 atoms have been selected out of  64558
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "159" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isuseranion .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @neg @nneg
 Parameter: NEG -> "CLA"
 Parameter: NNEG -> "159"
  
 CHARMM>                generate NEG warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   5 has been generated. Its identifier is NEG.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        5   Number of residues   =     1957
         Number of atoms         =    64717   Number of groups     =    17831
         Number of bonds         =    64356   Number of angles     =   121292
         Number of dihedrals     =   171543   Number of impropers  =     4149
         Number of cross-terms   =     1332   Number of autogens   =        0
         Number of HB acceptors  =     1875   Number of HB donors  =     2261
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>    159 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            if natomneg .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele NEG end
 SELRPN>    159 atoms have been selected out of  64717
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>    302 atoms have been selected out of  64717
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>    302 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "143"
 Parameter: NNEG -> "159"
Evaluating: 143+159
 Parameter: NION <- "302"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "143"
 Parameter: NPOSTOT <- "143"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "159"
 Parameter: NNEGTOT <- "159"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "302"
 Parameter: NIONTOT <- "302"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "302" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        !
  
 CHARMM>        !Images Setup [to place all atoms inside the box]
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        open read unit 10 card name crystal_image.str
 VOPEN> Attempting to open::crystal_image.str::
 OPNLGU> Unit 10 opened for READONLY access to crystal_image.str
  
 CHARMM>        CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "125.050557"
 Parameter: B -> "125.050557"
 Parameter: C -> "152.572525"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
 Crystal Parameters : Crystal Type = TETR
           A     =  125.05056 B    =  125.05056 C     =  152.57253
           Alpha =   90.00000 Beta =   90.00000 Gamma =   90.00000
  
 CHARMM>        CRYSTAL READ UNIT 10 CARD
 CRYSTAL FILE BEING READ FROM UNIT    10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 11. 2023. JOBID=9701360621
 TITLE> * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE> *
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 11. 2023. JOB
 TITLE>  * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE>  *
                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
    26 Transformations have been processed.

  
 CHARMM>     
  
 CHARMM>        !Image centering by residue
  
 CHARMM>        IMAGE BYRES XCEN 0.0 YCEN 0.0 ZCEN @zcen
 Parameter: ZCEN -> "-4.51585405"
 IMAGE CENTERING ON FOR SOME ATOMS
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000 -4.515854
 RESIDUE 1490 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE 1497 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE 1595 OPERATED ON BY TRANSFORMATION N1Z0Z0R1

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  N1N1N1R1 has       0       0       0       65.12
    2  N1Z0N1R1 has       0       0       0       47.80
    3  N1P1N1R1 has       0       0       0       71.47
    4  Z0N1N1R1 has       0       0       0       61.57
    5  Z0Z0N1R1 has       0       0       0       44.76
    6  Z0P1N1R1 has       0       0       0       58.26
    7  N1N1Z0R1 has     348      82       5        0.00
    8  N1Z0Z0R1 has    8525    2180     101        0.00
    9  N1P1Z0R1 has     881     222      12        0.00
   10  Z0N1Z0R1 has    7763    1926      75        0.00
   12  N1N1P1R1 has       0       0       0       73.14
   13  N1Z0P1R1 has       0       0       0       53.89
   14  N1P1P1R1 has       0       0       0       70.46
 Total of82234 atoms and22241 groups and 2150 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>     
  
 CHARMM>        CONS FIX SELE .NOT. ( POS .OR. NEG ) END
 SELRPN>  64415 atoms have been selected out of  64717
  
 CHARMM>        SKIP ALL EXCL VDW ELEC
 SKIPE> The following energy terms will be computed :
  VDW  ELEC
  
 CHARMM>        scalar wmain = charge
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>     
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "1" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.902050599"
Evaluating: 125.050557*(0.902050599-0.5)
 Parameter: XPOS <- "50.2766513"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "7.357188329E-02"
Evaluating: 125.050557*(7.357188329E-02-0.5)
 Parameter: YPOS <- "-53.3250735"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "9.891914297E-02"
Evaluating: 152.572525*(9.891914297E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-65.7097731"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-65.7097731" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.2766513"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 50.2766513-0
 Parameter: XTRAN <- "50.2766513"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-53.3250735"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -53.3250735-0
 Parameter: YTRAN <- "-53.3250735"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-65.7097731"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -65.7097731-0
 Parameter: ZTRAN <- "-65.7097731"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.2766513"
 Parameter: YTRAN -> "-53.3250735"
 Parameter: ZTRAN -> "-65.7097731"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    50.276651  -53.325074  -65.709773
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.369179246"
Evaluating: 0.369179246*360.0
 Parameter: XPHI <- "132.904529"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.322996458"
Evaluating: 0.322996458*360.0
 Parameter: YPHI <- "116.278725"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.269104382"
Evaluating: 0.269104382*360.0
 Parameter: ZPHI <- "96.8775775"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.2766513"
 Parameter: YPOS -> "-53.3250735"
 Parameter: ZPOS -> "-65.7097731"
 Parameter: XPHI -> "132.904529"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.680779    0.732489
    0.000000   -0.732489   -0.680779

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.2766513"
 Parameter: YPOS -> "-53.3250735"
 Parameter: ZPOS -> "-65.7097731"
 Parameter: YPHI -> "116.278725"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.442738    0.000000   -0.896651
    0.000000    1.000000    0.000000
    0.896651    0.000000   -0.442738

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  116.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.2766513"
 Parameter: YPOS -> "-53.3250735"
 Parameter: ZPOS -> "-65.7097731"
 Parameter: ZPHI -> "96.8775775"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.119748    0.992804    0.000000
   -0.992804   -0.119748    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   96.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.276651 XMAX =   50.276651 XAVE =   50.276651
    YMIN =  -53.325074 YMAX =  -53.325074 YAVE =  -53.325074
    ZMIN =  -65.709773 ZMAX =  -65.709773 ZAVE =  -65.709773
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.2766513"
Evaluating: 50.2766513+3.5
 Parameter: XMAX <- "53.7766513"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-53.3250735"
Evaluating: -53.3250735+3.5
 Parameter: YMAX <- "-49.8250735"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-65.7097731"
Evaluating: -65.7097731+3.5
 Parameter: ZMAX <- "-62.2097731"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.2766513"
Evaluating: 50.2766513-3.5
 Parameter: XMIN <- "46.7766513"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-53.3250735"
Evaluating: -53.3250735-3.5
 Parameter: YMIN <- "-56.8250735"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-65.7097731"
Evaluating: -65.7097731-3.5
 Parameter: ZMIN <- "-69.2097731"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.7766513"
 Parameter: XMIN -> "46.7766513"
 Parameter: YMAX -> "-49.8250735"
 Parameter: YMIN -> "-56.8250735"
 Parameter: ZMAX -> "-62.2097731"
 Parameter: ZMIN -> "-69.2097731"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "2" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "2" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "8.93767993E-02"
Evaluating: 125.050557*(8.93767993E-02-0.5)
 Parameter: XPOS <- "-51.34866"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.40820051"
Evaluating: 125.050557*(0.40820051-0.5)
 Parameter: YPOS <- "-11.4795774"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.156762392"
Evaluating: 152.572525*(0.156762392-0.5)+-4.51585405
 Parameter: ZPOS <- "-56.8844826"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.8844826" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-51.34866"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -51.34866-0
 Parameter: XTRAN <- "-51.34866"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.4795774"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.4795774-0
 Parameter: YTRAN <- "-11.4795774"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.8844826"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -56.8844826-0
 Parameter: ZTRAN <- "-56.8844826"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-51.34866"
 Parameter: YTRAN -> "-11.4795774"
 Parameter: ZTRAN -> "-56.8844826"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -51.348660  -11.479577  -56.884483
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.510328711"
Evaluating: 0.510328711*360.0
 Parameter: XPHI <- "183.718336"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.977903864"
Evaluating: 0.977903864*360.0
 Parameter: YPHI <- "352.045391"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.721562671"
Evaluating: 0.721562671*360.0
 Parameter: ZPHI <- "259.762562"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-51.34866"
 Parameter: YPOS -> "-11.4795774"
 Parameter: ZPOS -> "-56.8844826"
 Parameter: XPHI -> "183.718336"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.997895   -0.064852
    0.000000    0.064852   -0.997895

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  176.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-51.34866"
 Parameter: YPOS -> "-11.4795774"
 Parameter: ZPOS -> "-56.8844826"
 Parameter: YPHI -> "352.045391"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.990378    0.000000    0.138389
    0.000000    1.000000    0.000000
   -0.138389    0.000000    0.990378

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    7.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-51.34866"
 Parameter: YPOS -> "-11.4795774"
 Parameter: ZPOS -> "-56.8844826"
 Parameter: ZPHI -> "259.762562"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.177728   -0.984080    0.000000
    0.984080   -0.177728    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  100.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.348660 XMAX =  -51.348660 XAVE =  -51.348660
    YMIN =  -11.479577 YMAX =  -11.479577 YAVE =  -11.479577
    ZMIN =  -56.884483 ZMAX =  -56.884483 ZAVE =  -56.884483
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-51.34866"
Evaluating: -51.34866+3.5
 Parameter: XMAX <- "-47.84866"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.4795774"
Evaluating: -11.4795774+3.5
 Parameter: YMAX <- "-7.9795774"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.8844826"
Evaluating: -56.8844826+3.5
 Parameter: ZMAX <- "-53.3844826"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-51.34866"
Evaluating: -51.34866-3.5
 Parameter: XMIN <- "-54.84866"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.4795774"
Evaluating: -11.4795774-3.5
 Parameter: YMIN <- "-14.9795774"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.8844826"
Evaluating: -56.8844826-3.5
 Parameter: ZMIN <- "-60.3844826"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-47.84866"
 Parameter: XMIN -> "-54.84866"
 Parameter: YMAX -> "-7.9795774"
 Parameter: YMIN -> "-14.9795774"
 Parameter: ZMAX -> "-53.3844826"
 Parameter: ZMIN -> "-60.3844826"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "3" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "3" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.51856568"
Evaluating: 125.050557*(0.51856568-0.5)
 Parameter: XPOS <- "2.32164863"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.618804359"
Evaluating: 125.050557*(0.618804359-0.5)
 Parameter: YPOS <- "14.8565513"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "9.666980448E-02"
Evaluating: 152.572525*(9.666980448E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-66.0529604"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-66.0529604" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.32164863"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 2.32164863-0
 Parameter: XTRAN <- "2.32164863"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.8565513"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.8565513-0
 Parameter: YTRAN <- "14.8565513"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-66.0529604"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -66.0529604-0
 Parameter: ZTRAN <- "-66.0529604"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.32164863"
 Parameter: YTRAN -> "14.8565513"
 Parameter: ZTRAN -> "-66.0529604"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     2.321649   14.856551  -66.052960
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.562770596"
Evaluating: 0.562770596*360.0
 Parameter: XPHI <- "202.597415"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.527247971"
Evaluating: 0.527247971*360.0
 Parameter: YPHI <- "189.80927"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.512041042"
Evaluating: 0.512041042*360.0
 Parameter: ZPHI <- "184.334775"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.32164863"
 Parameter: YPOS -> "14.8565513"
 Parameter: ZPOS -> "-66.0529604"
 Parameter: XPHI -> "202.597415"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.923228   -0.384254
    0.000000    0.384254   -0.923228

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  157.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.32164863"
 Parameter: YPOS -> "14.8565513"
 Parameter: ZPOS -> "-66.0529604"
 Parameter: YPHI -> "189.80927"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.985380    0.000000    0.170369
    0.000000    1.000000    0.000000
   -0.170369    0.000000   -0.985380

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  170.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.32164863"
 Parameter: YPOS -> "14.8565513"
 Parameter: ZPOS -> "-66.0529604"
 Parameter: ZPHI -> "184.334775"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.997139   -0.075584    0.000000
    0.075584   -0.997139    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  175.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.321649 XMAX =    2.321649 XAVE =    2.321649
    YMIN =   14.856551 YMAX =   14.856551 YAVE =   14.856551
    ZMIN =  -66.052960 ZMAX =  -66.052960 ZAVE =  -66.052960
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.32164863"
Evaluating: 2.32164863+3.5
 Parameter: XMAX <- "5.82164863"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.8565513"
Evaluating: 14.8565513+3.5
 Parameter: YMAX <- "18.3565513"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-66.0529604"
Evaluating: -66.0529604+3.5
 Parameter: ZMAX <- "-62.5529604"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.32164863"
Evaluating: 2.32164863-3.5
 Parameter: XMIN <- "-1.17835137"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.8565513"
Evaluating: 14.8565513-3.5
 Parameter: YMIN <- "11.3565513"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-66.0529604"
Evaluating: -66.0529604-3.5
 Parameter: ZMIN <- "-69.5529604"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.82164863"
 Parameter: XMIN -> "-1.17835137"
 Parameter: YMAX -> "18.3565513"
 Parameter: YMIN -> "11.3565513"
 Parameter: ZMAX -> "-62.5529604"
 Parameter: ZMIN -> "-69.5529604"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "4" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "4" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.128645237"
Evaluating: 125.050557*(0.128645237-0.5)
 Parameter: XPOS <- "-46.43812"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.868275159"
Evaluating: 125.050557*(0.868275159-0.5)
 Parameter: YPOS <- "46.0530138"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.545558032"
Evaluating: 152.572525*(0.545558032-0.5)+-4.51585405
 Parameter: ZPOS <- "2.43504993"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.43504993" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.43504993" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "4" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.876951335"
Evaluating: 125.050557*(0.876951335-0.5)
 Parameter: XPOS <- "47.1379744"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.65401547"
Evaluating: 125.050557*(0.65401547-0.5)
 Parameter: YPOS <- "19.2597203"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.818880106"
Evaluating: 152.572525*(0.818880106-0.5)+-4.51585405
 Parameter: ZPOS <- "44.1364889"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.1364889" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.1364889" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "47.1379744"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 47.1379744-0
 Parameter: XTRAN <- "47.1379744"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.2597203"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.2597203-0
 Parameter: YTRAN <- "19.2597203"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.1364889"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.1364889-0
 Parameter: ZTRAN <- "44.1364889"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "47.1379744"
 Parameter: YTRAN -> "19.2597203"
 Parameter: ZTRAN -> "44.1364889"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    47.137974   19.259720   44.136489
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.454206833"
Evaluating: 0.454206833*360.0
 Parameter: XPHI <- "163.51446"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.689826111"
Evaluating: 0.689826111*360.0
 Parameter: YPHI <- "248.3374"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.980130917E-02"
Evaluating: 8.980130917E-02*360.0
 Parameter: ZPHI <- "32.3284713"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "47.1379744"
 Parameter: YPOS -> "19.2597203"
 Parameter: ZPOS -> "44.1364889"
 Parameter: XPHI -> "163.51446"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.958891    0.283773
    0.000000   -0.283773   -0.958891

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  163.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "47.1379744"
 Parameter: YPOS -> "19.2597203"
 Parameter: ZPOS -> "44.1364889"
 Parameter: YPHI -> "248.3374"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.369140    0.000000    0.929374
    0.000000    1.000000    0.000000
   -0.929374    0.000000   -0.369140

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  111.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "47.1379744"
 Parameter: YPOS -> "19.2597203"
 Parameter: ZPOS -> "44.1364889"
 Parameter: ZPHI -> "32.3284713"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.844996    0.534772    0.000000
   -0.534772    0.844996    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   32.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.137974 XMAX =   47.137974 XAVE =   47.137974
    YMIN =   19.259720 YMAX =   19.259720 YAVE =   19.259720
    ZMIN =   44.136489 ZMAX =   44.136489 ZAVE =   44.136489
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "47.1379744"
Evaluating: 47.1379744+3.5
 Parameter: XMAX <- "50.6379744"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.2597203"
Evaluating: 19.2597203+3.5
 Parameter: YMAX <- "22.7597203"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.1364889"
Evaluating: 44.1364889+3.5
 Parameter: ZMAX <- "47.6364889"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "47.1379744"
Evaluating: 47.1379744-3.5
 Parameter: XMIN <- "43.6379744"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.2597203"
Evaluating: 19.2597203-3.5
 Parameter: YMIN <- "15.7597203"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.1364889"
Evaluating: 44.1364889-3.5
 Parameter: ZMIN <- "40.6364889"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.6379744"
 Parameter: XMIN -> "43.6379744"
 Parameter: YMAX -> "22.7597203"
 Parameter: YMIN -> "15.7597203"
 Parameter: ZMAX -> "47.6364889"
 Parameter: ZMIN -> "40.6364889"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "5" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "5" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.147501113"
Evaluating: 125.050557*(0.147501113-0.5)
 Parameter: XPOS <- "-44.0801822"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.959418957"
Evaluating: 125.050557*(0.959418957-0.5)
 Parameter: YPOS <- "57.4505965"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.571085252"
Evaluating: 152.572525*(0.571085252-0.5)+-4.51585405
 Parameter: ZPOS <- "6.32980234"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.32980234" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.32980234" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "5" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.551960016"
Evaluating: 125.050557*(0.551960016-0.5)
 Parameter: XPOS <- "6.49762894"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.719080953"
Evaluating: 125.050557*(0.719080953-0.5)
 Parameter: YPOS <- "27.3961952"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.788868203"
Evaluating: 152.572525*(0.788868203-0.5)+-4.51585405
 Parameter: ZPOS <- "39.5574971"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.5574971" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.5574971" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.49762894"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.49762894-0
 Parameter: XTRAN <- "6.49762894"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.3961952"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.3961952-0
 Parameter: YTRAN <- "27.3961952"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.5574971"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.5574971-0
 Parameter: ZTRAN <- "39.5574971"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.49762894"
 Parameter: YTRAN -> "27.3961952"
 Parameter: ZTRAN -> "39.5574971"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     6.497629   27.396195   39.557497
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.640855162"
Evaluating: 0.640855162*360.0
 Parameter: XPHI <- "230.707858"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.778415399E-02"
Evaluating: 6.778415399E-02*360.0
 Parameter: YPHI <- "24.4022954"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.254254637"
Evaluating: 0.254254637*360.0
 Parameter: ZPHI <- "91.5316693"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.49762894"
 Parameter: YPOS -> "27.3961952"
 Parameter: ZPOS -> "39.5574971"
 Parameter: XPHI -> "230.707858"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.633275   -0.773927
    0.000000    0.773927   -0.633275

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.49762894"
 Parameter: YPOS -> "27.3961952"
 Parameter: ZPOS -> "39.5574971"
 Parameter: YPHI -> "24.4022954"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.910667    0.000000   -0.413141
    0.000000    1.000000    0.000000
    0.413141    0.000000    0.910667

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   24.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.49762894"
 Parameter: YPOS -> "27.3961952"
 Parameter: ZPOS -> "39.5574971"
 Parameter: ZPHI -> "91.5316693"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.026729    0.999643    0.000000
   -0.999643   -0.026729    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   91.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.497629 XMAX =    6.497629 XAVE =    6.497629
    YMIN =   27.396195 YMAX =   27.396195 YAVE =   27.396195
    ZMIN =   39.557497 ZMAX =   39.557497 ZAVE =   39.557497
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.49762894"
Evaluating: 6.49762894+3.5
 Parameter: XMAX <- "9.99762894"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.3961952"
Evaluating: 27.3961952+3.5
 Parameter: YMAX <- "30.8961952"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.5574971"
Evaluating: 39.5574971+3.5
 Parameter: ZMAX <- "43.0574971"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.49762894"
Evaluating: 6.49762894-3.5
 Parameter: XMIN <- "2.99762894"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.3961952"
Evaluating: 27.3961952-3.5
 Parameter: YMIN <- "23.8961952"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.5574971"
Evaluating: 39.5574971-3.5
 Parameter: ZMIN <- "36.0574971"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.99762894"
 Parameter: XMIN -> "2.99762894"
 Parameter: YMAX -> "30.8961952"
 Parameter: YMIN -> "23.8961952"
 Parameter: ZMAX -> "43.0574971"
 Parameter: ZMIN -> "36.0574971"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "6" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "6" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.339552929"
Evaluating: 125.050557*(0.339552929-0.5)
 Parameter: XPOS <- "-20.0639956"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.30582966"
Evaluating: 125.050557*(0.30582966-0.5)
 Parameter: YPOS <- "-24.2811092"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.782822307"
Evaluating: 152.572525*(0.782822307-0.5)+-4.51585405
 Parameter: ZPOS <- "38.6350595"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.6350595" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.6350595" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.0639956"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -20.0639956-0
 Parameter: XTRAN <- "-20.0639956"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.2811092"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.2811092-0
 Parameter: YTRAN <- "-24.2811092"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.6350595"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.6350595-0
 Parameter: ZTRAN <- "38.6350595"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.0639956"
 Parameter: YTRAN -> "-24.2811092"
 Parameter: ZTRAN -> "38.6350595"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -20.063996  -24.281109   38.635059
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.252887963E-02"
Evaluating: 6.252887963E-02*360.0
 Parameter: XPHI <- "22.5103967"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.703062599E-02"
Evaluating: 3.703062599E-02*360.0
 Parameter: YPHI <- "13.3310254"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.956655722"
Evaluating: 0.956655722*360.0
 Parameter: ZPHI <- "344.39606"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.0639956"
 Parameter: YPOS -> "-24.2811092"
 Parameter: ZPOS -> "38.6350595"
 Parameter: XPHI -> "22.5103967"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.923810    0.382851
    0.000000   -0.382851    0.923810

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   22.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.0639956"
 Parameter: YPOS -> "-24.2811092"
 Parameter: ZPOS -> "38.6350595"
 Parameter: YPHI -> "13.3310254"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.973054    0.000000   -0.230577
    0.000000    1.000000    0.000000
    0.230577    0.000000    0.973054

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   13.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.0639956"
 Parameter: YPOS -> "-24.2811092"
 Parameter: ZPOS -> "38.6350595"
 Parameter: ZPHI -> "344.39606"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.963144   -0.268986    0.000000
    0.268986    0.963144    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   15.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.063996 XMAX =  -20.063996 XAVE =  -20.063996
    YMIN =  -24.281109 YMAX =  -24.281109 YAVE =  -24.281109
    ZMIN =   38.635059 ZMAX =   38.635059 ZAVE =   38.635059
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.0639956"
Evaluating: -20.0639956+3.5
 Parameter: XMAX <- "-16.5639956"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.2811092"
Evaluating: -24.2811092+3.5
 Parameter: YMAX <- "-20.7811092"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.6350595"
Evaluating: 38.6350595+3.5
 Parameter: ZMAX <- "42.1350595"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.0639956"
Evaluating: -20.0639956-3.5
 Parameter: XMIN <- "-23.5639956"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.2811092"
Evaluating: -24.2811092-3.5
 Parameter: YMIN <- "-27.7811092"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.6350595"
Evaluating: 38.6350595-3.5
 Parameter: ZMIN <- "35.1350595"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-16.5639956"
 Parameter: XMIN -> "-23.5639956"
 Parameter: YMAX -> "-20.7811092"
 Parameter: YMIN -> "-27.7811092"
 Parameter: ZMAX -> "42.1350595"
 Parameter: ZMIN -> "35.1350595"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "7" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "7" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.831325193"
Evaluating: 125.050557*(0.831325193-0.5)
 Parameter: XPOS <- "41.4323999"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.520649839"
Evaluating: 125.050557*(0.520649839-0.5)
 Parameter: YPOS <- "2.58227387"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.636860488"
Evaluating: 152.572525*(0.636860488-0.5)+-4.51585405
 Parameter: ZPOS <- "16.3652962"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.3652962" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.3652962" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.4323999"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.4323999-0
 Parameter: XTRAN <- "41.4323999"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.58227387"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.58227387-0
 Parameter: YTRAN <- "2.58227387"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.3652962"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.3652962-0
 Parameter: ZTRAN <- "16.3652962"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.4323999"
 Parameter: YTRAN -> "2.58227387"
 Parameter: ZTRAN -> "16.3652962"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    41.432400    2.582274   16.365296
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.123509652E-02"
Evaluating: 9.123509652E-02*360.0
 Parameter: XPHI <- "32.8446347"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.946111354"
Evaluating: 0.946111354*360.0
 Parameter: YPHI <- "340.600087"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.607436178"
Evaluating: 0.607436178*360.0
 Parameter: ZPHI <- "218.677024"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.4323999"
 Parameter: YPOS -> "2.58227387"
 Parameter: ZPOS -> "16.3652962"
 Parameter: XPHI -> "32.8446347"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.840144    0.542363
    0.000000   -0.542363    0.840144

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   32.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.4323999"
 Parameter: YPOS -> "2.58227387"
 Parameter: ZPOS -> "16.3652962"
 Parameter: YPHI -> "340.600087"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.943223    0.000000    0.332160
    0.000000    1.000000    0.000000
   -0.332160    0.000000    0.943223

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   19.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.4323999"
 Parameter: YPOS -> "2.58227387"
 Parameter: ZPOS -> "16.3652962"
 Parameter: ZPHI -> "218.677024"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.780681   -0.624930    0.000000
    0.624930   -0.780681    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  141.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.432400 XMAX =   41.432400 XAVE =   41.432400
    YMIN =    2.582274 YMAX =    2.582274 YAVE =    2.582274
    ZMIN =   16.365296 ZMAX =   16.365296 ZAVE =   16.365296
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.4323999"
Evaluating: 41.4323999+3.5
 Parameter: XMAX <- "44.9323999"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.58227387"
Evaluating: 2.58227387+3.5
 Parameter: YMAX <- "6.08227387"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.3652962"
Evaluating: 16.3652962+3.5
 Parameter: ZMAX <- "19.8652962"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.4323999"
Evaluating: 41.4323999-3.5
 Parameter: XMIN <- "37.9323999"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.58227387"
Evaluating: 2.58227387-3.5
 Parameter: YMIN <- "-0.91772613"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.3652962"
Evaluating: 16.3652962-3.5
 Parameter: ZMIN <- "12.8652962"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.9323999"
 Parameter: XMIN -> "37.9323999"
 Parameter: YMAX -> "6.08227387"
 Parameter: YMIN -> "-0.91772613"
 Parameter: ZMAX -> "19.8652962"
 Parameter: ZMIN -> "12.8652962"
 SELRPN>     14 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      8 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64422 POS      SOD      7        SOD     -**** PROA     LEU      1199     C             4.4322
64422 POS      SOD      7        SOD     -**** PROA     LEU      1199     O             3.9429
64422 POS      SOD      7        SOD     -**** PROA     SER      1200     N             4.0740
64422 POS      SOD      7        SOD     -**** PROA     SER      1200     CA            2.9359
64422 POS      SOD      7        SOD     -**** PROA     SER      1200     CB            3.4220
64422 POS      SOD      7        SOD     -**** PROA     SER      1200     C             3.3725
64422 POS      SOD      7        SOD     -**** PROA     SER      1200     O             2.9561
64422 POS      SOD      7        SOD     -**** PROA     ASP      1203     CB            3.8091
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "7" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "7.738901641E-02"
Evaluating: 125.050557*(7.738901641E-02-0.5)
 Parameter: XPOS <- "-52.8477389"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.641619029"
Evaluating: 125.050557*(0.641619029-0.5)
 Parameter: YPOS <- "17.7095385"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "2.245715049E-02"
Evaluating: 152.572525*(2.245715049E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-77.3757724"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-77.3757724" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.432400 XMAX =   41.432400 XAVE =   41.432400
    YMIN =    2.582274 YMAX =    2.582274 YAVE =    2.582274
    ZMIN =   16.365296 ZMAX =   16.365296 ZAVE =   16.365296
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-52.8477389"
 RDCMND substituted energy or value "?XAVE" to "41.4323999"
Evaluating: -52.8477389-41.4323999
 Parameter: XTRAN <- "-94.2801388"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.7095385"
 RDCMND substituted energy or value "?YAVE" to "2.58227387"
Evaluating: 17.7095385-2.58227387
 Parameter: YTRAN <- "15.1272646"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-77.3757724"
 RDCMND substituted energy or value "?ZAVE" to "16.3652962"
Evaluating: -77.3757724-16.3652962
 Parameter: ZTRAN <- "-93.7410686"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-94.2801388"
 Parameter: YTRAN -> "15.1272646"
 Parameter: ZTRAN -> "-93.7410686"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -94.280139   15.127265  -93.741069
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.536981507"
Evaluating: 0.536981507*360.0
 Parameter: XPHI <- "193.313343"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.294374006"
Evaluating: 0.294374006*360.0
 Parameter: YPHI <- "105.974642"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.718773678"
Evaluating: 0.718773678*360.0
 Parameter: ZPHI <- "258.758524"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-52.8477389"
 Parameter: YPOS -> "17.7095385"
 Parameter: ZPOS -> "-77.3757724"
 Parameter: XPHI -> "193.313343"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.973125   -0.230276
    0.000000    0.230276   -0.973125

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  166.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-52.8477389"
 Parameter: YPOS -> "17.7095385"
 Parameter: ZPOS -> "-77.3757724"
 Parameter: YPHI -> "105.974642"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.275212    0.000000   -0.961384
    0.000000    1.000000    0.000000
    0.961384    0.000000   -0.275212

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  105.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-52.8477389"
 Parameter: YPOS -> "17.7095385"
 Parameter: ZPOS -> "-77.3757724"
 Parameter: ZPHI -> "258.758524"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.194944   -0.980814    0.000000
    0.980814   -0.194944    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  101.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -52.847739 XMAX =  -52.847739 XAVE =  -52.847739
    YMIN =   17.709539 YMAX =   17.709539 YAVE =   17.709539
    ZMIN =  -77.375772 ZMAX =  -77.375772 ZAVE =  -77.375772
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-52.8477389"
Evaluating: -52.8477389+3.5
 Parameter: XMAX <- "-49.3477389"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.7095385"
Evaluating: 17.7095385+3.5
 Parameter: YMAX <- "21.2095385"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-77.3757724"
Evaluating: -77.3757724+3.5
 Parameter: ZMAX <- "-73.8757724"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-52.8477389"
Evaluating: -52.8477389-3.5
 Parameter: XMIN <- "-56.3477389"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.7095385"
Evaluating: 17.7095385-3.5
 Parameter: YMIN <- "14.2095385"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-77.3757724"
Evaluating: -77.3757724-3.5
 Parameter: ZMIN <- "-80.8757724"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-49.3477389"
 Parameter: XMIN -> "-56.3477389"
 Parameter: YMAX -> "21.2095385"
 Parameter: YMIN -> "14.2095385"
 Parameter: ZMAX -> "-73.8757724"
 Parameter: ZMIN -> "-80.8757724"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "8" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "8" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.807686098"
Evaluating: 125.050557*(0.807686098-0.5)
 Parameter: XPOS <- "38.4763179"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.577867475"
Evaluating: 125.050557*(0.577867475-0.5)
 Parameter: YPOS <- "9.73737112"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.732966726"
Evaluating: 152.572525*(0.732966726-0.5)+-4.51585405
 Parameter: ZPOS <- "31.0284676"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.0284676" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.0284676" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.4763179"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.4763179-0
 Parameter: XTRAN <- "38.4763179"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.73737112"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.73737112-0
 Parameter: YTRAN <- "9.73737112"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.0284676"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.0284676-0
 Parameter: ZTRAN <- "31.0284676"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.4763179"
 Parameter: YTRAN -> "9.73737112"
 Parameter: ZTRAN -> "31.0284676"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    38.476318    9.737371   31.028468
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.144226037"
Evaluating: 0.144226037*360.0
 Parameter: XPHI <- "51.9213733"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.606005195"
Evaluating: 0.606005195*360.0
 Parameter: YPHI <- "218.16187"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.341672091"
Evaluating: 0.341672091*360.0
 Parameter: ZPHI <- "123.001953"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.4763179"
 Parameter: YPOS -> "9.73737112"
 Parameter: ZPOS -> "31.0284676"
 Parameter: XPHI -> "51.9213733"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.616742    0.787165
    0.000000   -0.787165    0.616742

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   51.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.4763179"
 Parameter: YPOS -> "9.73737112"
 Parameter: ZPOS -> "31.0284676"
 Parameter: YPHI -> "218.16187"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.786268    0.000000    0.617885
    0.000000    1.000000    0.000000
   -0.617885    0.000000   -0.786268

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  141.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.4763179"
 Parameter: YPOS -> "9.73737112"
 Parameter: ZPOS -> "31.0284676"
 Parameter: ZPHI -> "123.001953"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.544668    0.838652    0.000000
   -0.838652   -0.544668    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  123.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.476318 XMAX =   38.476318 XAVE =   38.476318
    YMIN =    9.737371 YMAX =    9.737371 YAVE =    9.737371
    ZMIN =   31.028468 ZMAX =   31.028468 ZAVE =   31.028468
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.4763179"
Evaluating: 38.4763179+3.5
 Parameter: XMAX <- "41.9763179"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.73737112"
Evaluating: 9.73737112+3.5
 Parameter: YMAX <- "13.2373711"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.0284676"
Evaluating: 31.0284676+3.5
 Parameter: ZMAX <- "34.5284676"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.4763179"
Evaluating: 38.4763179-3.5
 Parameter: XMIN <- "34.9763179"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.73737112"
Evaluating: 9.73737112-3.5
 Parameter: YMIN <- "6.23737112"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.0284676"
Evaluating: 31.0284676-3.5
 Parameter: ZMIN <- "27.5284676"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.9763179"
 Parameter: XMIN -> "34.9763179"
 Parameter: YMAX -> "13.2373711"
 Parameter: YMIN -> "6.23737112"
 Parameter: ZMAX -> "34.5284676"
 Parameter: ZMIN -> "27.5284676"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "9" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "9" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.276714888"
Evaluating: 125.050557*(0.276714888-0.5)
 Parameter: XPOS <- "-27.9219276"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.734382923"
Evaluating: 125.050557*(0.734382923-0.5)
 Parameter: YPOS <- "29.3097151"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.949458286"
Evaluating: 152.572525*(0.949458286-0.5)+-4.51585405
 Parameter: ZPOS <- "64.0591315"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "64.0591315" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "64.0591315" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.9219276"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.9219276-0
 Parameter: XTRAN <- "-27.9219276"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.3097151"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.3097151-0
 Parameter: YTRAN <- "29.3097151"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "64.0591315"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 64.0591315-0
 Parameter: ZTRAN <- "64.0591315"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.9219276"
 Parameter: YTRAN -> "29.3097151"
 Parameter: ZTRAN -> "64.0591315"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -27.921928   29.309715   64.059132
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.71766348"
Evaluating: 0.71766348*360.0
 Parameter: XPHI <- "258.358853"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.571136576"
Evaluating: 0.571136576*360.0
 Parameter: YPHI <- "205.609167"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.524940008"
Evaluating: 0.524940008*360.0
 Parameter: ZPHI <- "188.978403"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.9219276"
 Parameter: YPOS -> "29.3097151"
 Parameter: ZPOS -> "64.0591315"
 Parameter: XPHI -> "258.358853"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.201781   -0.979431
    0.000000    0.979431   -0.201781

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  101.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.9219276"
 Parameter: YPOS -> "29.3097151"
 Parameter: ZPOS -> "64.0591315"
 Parameter: YPHI -> "205.609167"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.901763    0.000000    0.432230
    0.000000    1.000000    0.000000
   -0.432230    0.000000   -0.901763

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  154.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.9219276"
 Parameter: YPOS -> "29.3097151"
 Parameter: ZPOS -> "64.0591315"
 Parameter: ZPHI -> "188.978403"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.987747   -0.156062    0.000000
    0.156062   -0.987747    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  171.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.921928 XMAX =  -27.921928 XAVE =  -27.921928
    YMIN =   29.309715 YMAX =   29.309715 YAVE =   29.309715
    ZMIN =   64.059132 ZMAX =   64.059132 ZAVE =   64.059132
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.9219276"
Evaluating: -27.9219276+3.5
 Parameter: XMAX <- "-24.4219276"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.3097151"
Evaluating: 29.3097151+3.5
 Parameter: YMAX <- "32.8097151"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "64.0591315"
Evaluating: 64.0591315+3.5
 Parameter: ZMAX <- "67.5591315"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.9219276"
Evaluating: -27.9219276-3.5
 Parameter: XMIN <- "-31.4219276"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.3097151"
Evaluating: 29.3097151-3.5
 Parameter: YMIN <- "25.8097151"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "64.0591315"
Evaluating: 64.0591315-3.5
 Parameter: ZMIN <- "60.5591315"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.4219276"
 Parameter: XMIN -> "-31.4219276"
 Parameter: YMAX -> "32.8097151"
 Parameter: YMIN -> "25.8097151"
 Parameter: ZMAX -> "67.5591315"
 Parameter: ZMIN -> "60.5591315"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "10" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "10" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.463677732"
Evaluating: 125.050557*(0.463677732-0.5)
 Parameter: XPOS <- "-4.54211984"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.355606055"
Evaluating: 125.050557*(0.355606055-0.5)
 Parameter: YPOS <- "-18.0565432"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.908778646"
Evaluating: 152.572525*(0.908778646-0.5)+-4.51585405
 Parameter: ZPOS <- "57.8525361"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.8525361" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.8525361" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.54211984"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.54211984-0
 Parameter: XTRAN <- "-4.54211984"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.0565432"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.0565432-0
 Parameter: YTRAN <- "-18.0565432"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.8525361"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.8525361-0
 Parameter: ZTRAN <- "57.8525361"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.54211984"
 Parameter: YTRAN -> "-18.0565432"
 Parameter: ZTRAN -> "57.8525361"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -4.542120  -18.056543   57.852536
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.681535743"
Evaluating: 0.681535743*360.0
 Parameter: XPHI <- "245.352867"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.659464444"
Evaluating: 0.659464444*360.0
 Parameter: YPHI <- "237.4072"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.143424333"
Evaluating: 0.143424333*360.0
 Parameter: ZPHI <- "51.6327599"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.54211984"
 Parameter: YPOS -> "-18.0565432"
 Parameter: ZPOS -> "57.8525361"
 Parameter: XPHI -> "245.352867"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.417029   -0.908893
    0.000000    0.908893   -0.417029

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  114.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.54211984"
 Parameter: YPOS -> "-18.0565432"
 Parameter: ZPOS -> "57.8525361"
 Parameter: YPHI -> "237.4072"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.538665    0.000000    0.842520
    0.000000    1.000000    0.000000
   -0.842520    0.000000   -0.538665

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  122.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.54211984"
 Parameter: YPOS -> "-18.0565432"
 Parameter: ZPOS -> "57.8525361"
 Parameter: ZPHI -> "51.6327599"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.620700    0.784048    0.000000
   -0.784048    0.620700    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   51.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.542120 XMAX =   -4.542120 XAVE =   -4.542120
    YMIN =  -18.056543 YMAX =  -18.056543 YAVE =  -18.056543
    ZMIN =   57.852536 ZMAX =   57.852536 ZAVE =   57.852536
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.54211984"
Evaluating: -4.54211984+3.5
 Parameter: XMAX <- "-1.04211984"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.0565432"
Evaluating: -18.0565432+3.5
 Parameter: YMAX <- "-14.5565432"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.8525361"
Evaluating: 57.8525361+3.5
 Parameter: ZMAX <- "61.3525361"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.54211984"
Evaluating: -4.54211984-3.5
 Parameter: XMIN <- "-8.04211984"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.0565432"
Evaluating: -18.0565432-3.5
 Parameter: YMIN <- "-21.5565432"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.8525361"
Evaluating: 57.8525361-3.5
 Parameter: ZMIN <- "54.3525361"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.04211984"
 Parameter: XMIN -> "-8.04211984"
 Parameter: YMAX -> "-14.5565432"
 Parameter: YMIN -> "-21.5565432"
 Parameter: ZMAX -> "61.3525361"
 Parameter: ZMIN -> "54.3525361"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "11" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "11" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.333335193"
Evaluating: 125.050557*(0.333335193-0.5)
 Parameter: XPOS <- "-20.8415269"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.726460454"
Evaluating: 125.050557*(0.726460454-0.5)
 Parameter: YPOS <- "28.3190059"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.754878021"
Evaluating: 152.572525*(0.754878021-0.5)+-4.51585405
 Parameter: ZPOS <- "34.3715292"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.3715292" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.3715292" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.8415269"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -20.8415269-0
 Parameter: XTRAN <- "-20.8415269"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.3190059"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.3190059-0
 Parameter: YTRAN <- "28.3190059"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.3715292"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.3715292-0
 Parameter: ZTRAN <- "34.3715292"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.8415269"
 Parameter: YTRAN -> "28.3190059"
 Parameter: ZTRAN -> "34.3715292"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -20.841527   28.319006   34.371529
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.475064769"
Evaluating: 0.475064769*360.0
 Parameter: XPHI <- "171.023317"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.881708298"
Evaluating: 0.881708298*360.0
 Parameter: YPHI <- "317.414987"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.559001874"
Evaluating: 0.559001874*360.0
 Parameter: ZPHI <- "201.240675"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.8415269"
 Parameter: YPOS -> "28.3190059"
 Parameter: ZPOS -> "34.3715292"
 Parameter: XPHI -> "171.023317"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.987752    0.156033
    0.000000   -0.156033   -0.987752

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  171.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.8415269"
 Parameter: YPOS -> "28.3190059"
 Parameter: ZPOS -> "34.3715292"
 Parameter: YPHI -> "317.414987"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.736274    0.000000    0.676683
    0.000000    1.000000    0.000000
   -0.676683    0.000000    0.736274

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   42.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.8415269"
 Parameter: YPOS -> "28.3190059"
 Parameter: ZPOS -> "34.3715292"
 Parameter: ZPHI -> "201.240675"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.932067   -0.362286    0.000000
    0.362286   -0.932067    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  158.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.841527 XMAX =  -20.841527 XAVE =  -20.841527
    YMIN =   28.319006 YMAX =   28.319006 YAVE =   28.319006
    ZMIN =   34.371529 ZMAX =   34.371529 ZAVE =   34.371529
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.8415269"
Evaluating: -20.8415269+3.5
 Parameter: XMAX <- "-17.3415269"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.3190059"
Evaluating: 28.3190059+3.5
 Parameter: YMAX <- "31.8190059"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.3715292"
Evaluating: 34.3715292+3.5
 Parameter: ZMAX <- "37.8715292"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.8415269"
Evaluating: -20.8415269-3.5
 Parameter: XMIN <- "-24.3415269"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.3190059"
Evaluating: 28.3190059-3.5
 Parameter: YMIN <- "24.8190059"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.3715292"
Evaluating: 34.3715292-3.5
 Parameter: ZMIN <- "30.8715292"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.3415269"
 Parameter: XMIN -> "-24.3415269"
 Parameter: YMAX -> "31.8190059"
 Parameter: YMIN -> "24.8190059"
 Parameter: ZMAX -> "37.8715292"
 Parameter: ZMIN -> "30.8715292"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "12" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "12" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.224396249"
Evaluating: 125.050557*(0.224396249-0.5)
 Parameter: XPOS <- "-34.4644026"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.986983491"
Evaluating: 125.050557*(0.986983491-0.5)
 Parameter: YPOS <- "60.8975568"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.430777442"
Evaluating: 152.572525*(0.430777442-0.5)+-4.51585405
 Parameter: ZPOS <- "-15.0773145"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.0773145" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.4644026"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.4644026-0
 Parameter: XTRAN <- "-34.4644026"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "60.8975568"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 60.8975568-0
 Parameter: YTRAN <- "60.8975568"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.0773145"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.0773145-0
 Parameter: ZTRAN <- "-15.0773145"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.4644026"
 Parameter: YTRAN -> "60.8975568"
 Parameter: ZTRAN -> "-15.0773145"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -34.464403   60.897557  -15.077314
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.463600865"
Evaluating: 0.463600865*360.0
 Parameter: XPHI <- "166.896311"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.572720529"
Evaluating: 0.572720529*360.0
 Parameter: YPHI <- "206.17939"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.369089028"
Evaluating: 0.369089028*360.0
 Parameter: ZPHI <- "132.87205"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.4644026"
 Parameter: YPOS -> "60.8975568"
 Parameter: ZPOS -> "-15.0773145"
 Parameter: XPHI -> "166.896311"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.973961    0.226714
    0.000000   -0.226714   -0.973961

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  166.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.4644026"
 Parameter: YPOS -> "60.8975568"
 Parameter: ZPOS -> "-15.0773145"
 Parameter: YPHI -> "206.17939"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.897417    0.000000    0.441183
    0.000000    1.000000    0.000000
   -0.441183    0.000000   -0.897417

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  153.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.4644026"
 Parameter: YPOS -> "60.8975568"
 Parameter: ZPOS -> "-15.0773145"
 Parameter: ZPHI -> "132.87205"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.680363    0.732875    0.000000
   -0.732875   -0.680363    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  132.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.464403 XMAX =  -34.464403 XAVE =  -34.464403
    YMIN =   60.897557 YMAX =   60.897557 YAVE =   60.897557
    ZMIN =  -15.077314 ZMAX =  -15.077314 ZAVE =  -15.077314
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.4644026"
Evaluating: -34.4644026+3.5
 Parameter: XMAX <- "-30.9644026"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "60.8975568"
Evaluating: 60.8975568+3.5
 Parameter: YMAX <- "64.3975568"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.0773145"
Evaluating: -15.0773145+3.5
 Parameter: ZMAX <- "-11.5773145"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.4644026"
Evaluating: -34.4644026-3.5
 Parameter: XMIN <- "-37.9644026"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "60.8975568"
Evaluating: 60.8975568-3.5
 Parameter: YMIN <- "57.3975568"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.0773145"
Evaluating: -15.0773145-3.5
 Parameter: ZMIN <- "-18.5773145"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.9644026"
 Parameter: XMIN -> "-37.9644026"
 Parameter: YMAX -> "64.3975568"
 Parameter: YMIN -> "57.3975568"
 Parameter: ZMAX -> "-11.5773145"
 Parameter: ZMIN -> "-18.5773145"
 SELRPN>     23 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     12 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64427 POS      SOD      12       SOD     -**** MEMB     POPC     230      C25           3.2556
64427 POS      SOD      12       SOD     -**** MEMB     POPC     265      O14           3.8810
64427 POS      SOD      12       SOD     -**** MEMB     POPC     265      C3            3.0706
64427 POS      SOD      12       SOD     -**** MEMB     POPC     265      O31           2.8277
64427 POS      SOD      12       SOD     -**** MEMB     POPC     265      C31           3.6735
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "12" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.746544246"
Evaluating: 125.050557*(0.746544246-0.5)
 Parameter: XPOS <- "30.8304953"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.50512439"
Evaluating: 125.050557*(0.50512439-0.5)
 Parameter: YPOS <- "0.640807824"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.694450868"
Evaluating: 152.572525*(0.694450868-0.5)+-4.51585405
 Parameter: ZPOS <- "25.1520059"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.1520059" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.1520059" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.464403 XMAX =  -34.464403 XAVE =  -34.464403
    YMIN =   60.897557 YMAX =   60.897557 YAVE =   60.897557
    ZMIN =  -15.077314 ZMAX =  -15.077314 ZAVE =  -15.077314
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.8304953"
 RDCMND substituted energy or value "?XAVE" to "-34.4644026"
Evaluating: 30.8304953--34.4644026
 Parameter: XTRAN <- "65.2948979"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.640807824"
 RDCMND substituted energy or value "?YAVE" to "60.8975568"
Evaluating: 0.640807824-60.8975568
 Parameter: YTRAN <- "-60.256749"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.1520059"
 RDCMND substituted energy or value "?ZAVE" to "-15.0773145"
Evaluating: 25.1520059--15.0773145
 Parameter: ZTRAN <- "40.2293204"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "65.2948979"
 Parameter: YTRAN -> "-60.256749"
 Parameter: ZTRAN -> "40.2293204"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    65.294898  -60.256749   40.229320
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.209423359"
Evaluating: 0.209423359*360.0
 Parameter: XPHI <- "75.3924092"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.93218359"
Evaluating: 0.93218359*360.0
 Parameter: YPHI <- "335.586092"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.732335577E-02"
Evaluating: 8.732335577E-02*360.0
 Parameter: ZPHI <- "31.4364081"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.8304953"
 Parameter: YPOS -> "0.640807824"
 Parameter: ZPOS -> "25.1520059"
 Parameter: XPHI -> "75.3924092"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.252198    0.967676
    0.000000   -0.967676    0.252198

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   75.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.8304953"
 Parameter: YPOS -> "0.640807824"
 Parameter: ZPOS -> "25.1520059"
 Parameter: YPHI -> "335.586092"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.910583    0.000000    0.413325
    0.000000    1.000000    0.000000
   -0.413325    0.000000    0.910583

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   24.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.8304953"
 Parameter: YPOS -> "0.640807824"
 Parameter: ZPOS -> "25.1520059"
 Parameter: ZPHI -> "31.4364081"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.853220    0.521552    0.000000
   -0.521552    0.853220    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   31.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.830495 XMAX =   30.830495 XAVE =   30.830495
    YMIN =    0.640808 YMAX =    0.640808 YAVE =    0.640808
    ZMIN =   25.152006 ZMAX =   25.152006 ZAVE =   25.152006
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.8304953"
Evaluating: 30.8304953+3.5
 Parameter: XMAX <- "34.3304953"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.640807814"
Evaluating: 0.640807814+3.5
 Parameter: YMAX <- "4.14080781"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.1520059"
Evaluating: 25.1520059+3.5
 Parameter: ZMAX <- "28.6520059"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.8304953"
Evaluating: 30.8304953-3.5
 Parameter: XMIN <- "27.3304953"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.640807814"
Evaluating: 0.640807814-3.5
 Parameter: YMIN <- "-2.85919219"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.1520059"
Evaluating: 25.1520059-3.5
 Parameter: ZMIN <- "21.6520059"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.3304953"
 Parameter: XMIN -> "27.3304953"
 Parameter: YMAX -> "4.14080781"
 Parameter: YMIN -> "-2.85919219"
 Parameter: ZMAX -> "28.6520059"
 Parameter: ZMIN -> "21.6520059"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "13" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "13" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.80729233"
Evaluating: 125.050557*(0.80729233-0.5)
 Parameter: XPOS <- "38.427077"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.418655226"
Evaluating: 125.050557*(0.418655226-0.5)
 Parameter: YPOS <- "-10.1722093"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "9.86659578E-02"
Evaluating: 152.572525*(9.86659578E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-65.7484022"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-65.7484022" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.427077"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.427077-0
 Parameter: XTRAN <- "38.427077"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.1722093"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -10.1722093-0
 Parameter: YTRAN <- "-10.1722093"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-65.7484022"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -65.7484022-0
 Parameter: ZTRAN <- "-65.7484022"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.427077"
 Parameter: YTRAN -> "-10.1722093"
 Parameter: ZTRAN -> "-65.7484022"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    38.427077  -10.172209  -65.748402
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.518935366"
Evaluating: 0.518935366*360.0
 Parameter: XPHI <- "186.816732"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.64905749"
Evaluating: 0.64905749*360.0
 Parameter: YPHI <- "233.660696"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.022775807E-02"
Evaluating: 7.022775807E-02*360.0
 Parameter: ZPHI <- "25.2819929"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.427077"
 Parameter: YPOS -> "-10.1722093"
 Parameter: ZPOS -> "-65.7484022"
 Parameter: XPHI -> "186.816732"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.992931   -0.118694
    0.000000    0.118694   -0.992931

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  173.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.427077"
 Parameter: YPOS -> "-10.1722093"
 Parameter: ZPOS -> "-65.7484022"
 Parameter: YPHI -> "233.660696"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.592566    0.000000    0.805522
    0.000000    1.000000    0.000000
   -0.805522    0.000000   -0.592566

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  126.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.427077"
 Parameter: YPOS -> "-10.1722093"
 Parameter: ZPOS -> "-65.7484022"
 Parameter: ZPHI -> "25.2819929"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.904217    0.427074    0.000000
   -0.427074    0.904217    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   25.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.427077 XMAX =   38.427077 XAVE =   38.427077
    YMIN =  -10.172209 YMAX =  -10.172209 YAVE =  -10.172209
    ZMIN =  -65.748402 ZMAX =  -65.748402 ZAVE =  -65.748402
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.427077"
Evaluating: 38.427077+3.5
 Parameter: XMAX <- "41.927077"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.1722093"
Evaluating: -10.1722093+3.5
 Parameter: YMAX <- "-6.6722093"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-65.7484022"
Evaluating: -65.7484022+3.5
 Parameter: ZMAX <- "-62.2484022"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.427077"
Evaluating: 38.427077-3.5
 Parameter: XMIN <- "34.927077"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.1722093"
Evaluating: -10.1722093-3.5
 Parameter: YMIN <- "-13.6722093"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-65.7484022"
Evaluating: -65.7484022-3.5
 Parameter: ZMIN <- "-69.2484022"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.927077"
 Parameter: XMIN -> "34.927077"
 Parameter: YMAX -> "-6.6722093"
 Parameter: YMIN -> "-13.6722093"
 Parameter: ZMAX -> "-62.2484022"
 Parameter: ZMIN -> "-69.2484022"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "14" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "14" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.402517716"
Evaluating: 125.050557*(0.402517716-0.5)
 Parameter: XPOS <- "-12.1902139"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "5.666695211E-02"
Evaluating: 125.050557*(5.666695211E-02-0.5)
 Parameter: YPOS <- "-55.4390446"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.62558058"
Evaluating: 152.572525*(0.62558058-0.5)+-4.51585405
 Parameter: ZPOS <- "14.6442921"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.6442921" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.6442921" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "14" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.264023072"
Evaluating: 125.050557*(0.264023072-0.5)
 Parameter: XPOS <- "-29.5090463"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.285557704"
Evaluating: 125.050557*(0.285557704-0.5)
 Parameter: YPOS <- "-26.8161286"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "8.353669492E-02"
Evaluating: 152.572525*(8.353669492E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-68.0567121"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-68.0567121" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.5090463"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.5090463-0
 Parameter: XTRAN <- "-29.5090463"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.8161286"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.8161286-0
 Parameter: YTRAN <- "-26.8161286"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-68.0567121"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -68.0567121-0
 Parameter: ZTRAN <- "-68.0567121"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.5090463"
 Parameter: YTRAN -> "-26.8161286"
 Parameter: ZTRAN -> "-68.0567121"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -29.509046  -26.816129  -68.056712
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.6686499"
Evaluating: 0.6686499*360.0
 Parameter: XPHI <- "240.713964"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.501525365"
Evaluating: 0.501525365*360.0
 Parameter: YPHI <- "180.549131"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.316667841"
Evaluating: 0.316667841*360.0
 Parameter: ZPHI <- "114.000423"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.5090463"
 Parameter: YPOS -> "-26.8161286"
 Parameter: ZPOS -> "-68.0567121"
 Parameter: XPHI -> "240.713964"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.489170   -0.872189
    0.000000    0.872189   -0.489170

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  119.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.5090463"
 Parameter: YPOS -> "-26.8161286"
 Parameter: ZPOS -> "-68.0567121"
 Parameter: YPHI -> "180.549131"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.999954    0.000000    0.009584
    0.000000    1.000000    0.000000
   -0.009584    0.000000   -0.999954

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  179.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.5090463"
 Parameter: YPOS -> "-26.8161286"
 Parameter: ZPOS -> "-68.0567121"
 Parameter: ZPHI -> "114.000423"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.406743    0.913542    0.000000
   -0.913542   -0.406743    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.509046 XMAX =  -29.509046 XAVE =  -29.509046
    YMIN =  -26.816129 YMAX =  -26.816129 YAVE =  -26.816129
    ZMIN =  -68.056712 ZMAX =  -68.056712 ZAVE =  -68.056712
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.5090463"
Evaluating: -29.5090463+3.5
 Parameter: XMAX <- "-26.0090463"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.8161286"
Evaluating: -26.8161286+3.5
 Parameter: YMAX <- "-23.3161286"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-68.0567121"
Evaluating: -68.0567121+3.5
 Parameter: ZMAX <- "-64.5567121"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.5090463"
Evaluating: -29.5090463-3.5
 Parameter: XMIN <- "-33.0090463"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.8161286"
Evaluating: -26.8161286-3.5
 Parameter: YMIN <- "-30.3161286"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-68.0567121"
Evaluating: -68.0567121-3.5
 Parameter: ZMIN <- "-71.5567121"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.0090463"
 Parameter: XMIN -> "-33.0090463"
 Parameter: YMAX -> "-23.3161286"
 Parameter: YMIN -> "-30.3161286"
 Parameter: ZMAX -> "-64.5567121"
 Parameter: ZMIN -> "-71.5567121"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "15" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "15" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.896896797"
Evaluating: 125.050557*(0.896896797-0.5)
 Parameter: XPOS <- "49.6321655"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.799756489"
Evaluating: 125.050557*(0.799756489-0.5)
 Parameter: YPOS <- "37.4847159"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.329085469"
Evaluating: 152.572525*(0.329085469-0.5)+-4.51585405
 Parameter: ZPOS <- "-30.5927156"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.5927156" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.6321655"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.6321655-0
 Parameter: XTRAN <- "49.6321655"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.4847159"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.4847159-0
 Parameter: YTRAN <- "37.4847159"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.5927156"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.5927156-0
 Parameter: ZTRAN <- "-30.5927156"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.6321655"
 Parameter: YTRAN -> "37.4847159"
 Parameter: ZTRAN -> "-30.5927156"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    49.632165   37.484716  -30.592716
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.374899564"
Evaluating: 0.374899564*360.0
 Parameter: XPHI <- "134.963843"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.707965137"
Evaluating: 0.707965137*360.0
 Parameter: YPHI <- "254.867449"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.559528695"
Evaluating: 0.559528695*360.0
 Parameter: ZPHI <- "201.43033"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.6321655"
 Parameter: YPOS -> "37.4847159"
 Parameter: ZPOS -> "-30.5927156"
 Parameter: XPHI -> "134.963843"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.706660    0.707553
    0.000000   -0.707553   -0.706660

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  134.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.6321655"
 Parameter: YPOS -> "37.4847159"
 Parameter: ZPOS -> "-30.5927156"
 Parameter: YPHI -> "254.867449"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.261053    0.000000    0.965324
    0.000000    1.000000    0.000000
   -0.965324    0.000000   -0.261053

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  105.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.6321655"
 Parameter: YPOS -> "37.4847159"
 Parameter: ZPOS -> "-30.5927156"
 Parameter: ZPHI -> "201.43033"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.930863   -0.365370    0.000000
    0.365370   -0.930863    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  158.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.632165 XMAX =   49.632165 XAVE =   49.632165
    YMIN =   37.484716 YMAX =   37.484716 YAVE =   37.484716
    ZMIN =  -30.592716 ZMAX =  -30.592716 ZAVE =  -30.592716
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.6321655"
Evaluating: 49.6321655+3.5
 Parameter: XMAX <- "53.1321655"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.4847159"
Evaluating: 37.4847159+3.5
 Parameter: YMAX <- "40.9847159"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.5927156"
Evaluating: -30.5927156+3.5
 Parameter: ZMAX <- "-27.0927156"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.6321655"
Evaluating: 49.6321655-3.5
 Parameter: XMIN <- "46.1321655"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.4847159"
Evaluating: 37.4847159-3.5
 Parameter: YMIN <- "33.9847159"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.5927156"
Evaluating: -30.5927156-3.5
 Parameter: ZMIN <- "-34.0927156"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.1321655"
 Parameter: XMIN -> "46.1321655"
 Parameter: YMAX -> "40.9847159"
 Parameter: YMIN -> "33.9847159"
 Parameter: ZMAX -> "-27.0927156"
 Parameter: ZMIN -> "-34.0927156"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "16" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "16" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.223779722"
Evaluating: 125.050557*(0.223779722-0.5)
 Parameter: XPOS <- "-34.5414996"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.673541597"
Evaluating: 125.050557*(0.673541597-0.5)
 Parameter: YPOS <- "21.7014734"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.501492507"
Evaluating: 152.572525*(0.501492507-0.5)+-4.51585405
 Parameter: ZPOS <- "-4.28813849"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.28813849" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.28813849" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "16" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.122919034"
Evaluating: 125.050557*(0.122919034-0.5)
 Parameter: XPOS <- "-47.1541848"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.760971294"
Evaluating: 125.050557*(0.760971294-0.5)
 Parameter: YPOS <- "32.6346057"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.414693577"
Evaluating: 152.572525*(0.414693577-0.5)+-4.51585405
 Parameter: ZPOS <- "-17.5312704"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.5312704" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.1541848"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -47.1541848-0
 Parameter: XTRAN <- "-47.1541848"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.6346057"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.6346057-0
 Parameter: YTRAN <- "32.6346057"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.5312704"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.5312704-0
 Parameter: ZTRAN <- "-17.5312704"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.1541848"
 Parameter: YTRAN -> "32.6346057"
 Parameter: ZTRAN -> "-17.5312704"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -47.154185   32.634606  -17.531270
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.908553061"
Evaluating: 0.908553061*360.0
 Parameter: XPHI <- "327.079102"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.382117186"
Evaluating: 0.382117186*360.0
 Parameter: YPHI <- "137.562187"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.900532571"
Evaluating: 0.900532571*360.0
 Parameter: ZPHI <- "324.191726"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.1541848"
 Parameter: YPOS -> "32.6346057"
 Parameter: ZPOS -> "-17.5312704"
 Parameter: XPHI -> "327.079102"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.839422   -0.543481
    0.000000    0.543481    0.839422

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   32.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.1541848"
 Parameter: YPOS -> "32.6346057"
 Parameter: ZPOS -> "-17.5312704"
 Parameter: YPHI -> "137.562187"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.738010    0.000000   -0.674790
    0.000000    1.000000    0.000000
    0.674790    0.000000   -0.738010

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  137.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.1541848"
 Parameter: YPOS -> "32.6346057"
 Parameter: ZPOS -> "-17.5312704"
 Parameter: ZPHI -> "324.191726"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.810979   -0.585075    0.000000
    0.585075    0.810979    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   35.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.154185 XMAX =  -47.154185 XAVE =  -47.154185
    YMIN =   32.634606 YMAX =   32.634606 YAVE =   32.634606
    ZMIN =  -17.531270 ZMAX =  -17.531270 ZAVE =  -17.531270
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.1541848"
Evaluating: -47.1541848+3.5
 Parameter: XMAX <- "-43.6541848"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.6346057"
Evaluating: 32.6346057+3.5
 Parameter: YMAX <- "36.1346057"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.5312704"
Evaluating: -17.5312704+3.5
 Parameter: ZMAX <- "-14.0312704"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.1541848"
Evaluating: -47.1541848-3.5
 Parameter: XMIN <- "-50.6541848"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.6346057"
Evaluating: 32.6346057-3.5
 Parameter: YMIN <- "29.1346057"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.5312704"
Evaluating: -17.5312704-3.5
 Parameter: ZMIN <- "-21.0312704"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-43.6541848"
 Parameter: XMIN -> "-50.6541848"
 Parameter: YMAX -> "36.1346057"
 Parameter: YMIN -> "29.1346057"
 Parameter: ZMAX -> "-14.0312704"
 Parameter: ZMIN -> "-21.0312704"
 SELRPN>     21 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      9 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64431 POS      SOD      16       SOD     -**** MEMB     POPC     232      N             3.5048
64431 POS      SOD      16       SOD     -**** MEMB     POPC     232      C12           3.1822
64431 POS      SOD      16       SOD     -**** MEMB     POPC     232      C13           2.8232
64431 POS      SOD      16       SOD     -**** MEMB     POPC     232      C11           3.5964
64431 POS      SOD      16       SOD     -**** MEMB     POPC     232      O12           3.1980
64431 POS      SOD      16       SOD     -**** MEMB     POPC     268      C21           3.4159
64431 POS      SOD      16       SOD     -**** MEMB     POPC     268      O22           2.2313
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "16" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.285796054"
Evaluating: 125.050557*(0.285796054-0.5)
 Parameter: XPOS <- "-26.7863228"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.598205152"
Evaluating: 125.050557*(0.598205152-0.5)
 Parameter: YPOS <- "12.280609"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.464069879"
Evaluating: 152.572525*(0.464069879-0.5)+-4.51585405
 Parameter: ZPOS <- "-9.99780333"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.99780333" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.99780333" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "16" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.418642275"
Evaluating: 125.050557*(0.418642275-0.5)
 Parameter: XPOS <- "-10.1738288"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.68121774"
Evaluating: 125.050557*(0.68121774-0.5)
 Parameter: YPOS <- "22.6613793"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.592272112"
Evaluating: 152.572525*(0.592272112-0.5)+-4.51585405
 Parameter: ZPOS <- "9.56233506"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.56233506" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.56233506" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "16" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.955659395"
Evaluating: 125.050557*(0.955659395-0.5)
 Parameter: XPOS <- "56.9804611"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.810438981"
Evaluating: 125.050557*(0.810438981-0.5)
 Parameter: YPOS <- "38.8205675"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.654111143"
Evaluating: 152.572525*(0.654111143-0.5)+-4.51585405
 Parameter: ZPOS <- "18.9972722"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.9972722" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.9972722" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.154185 XMAX =  -47.154185 XAVE =  -47.154185
    YMIN =   32.634606 YMAX =   32.634606 YAVE =   32.634606
    ZMIN =  -17.531270 ZMAX =  -17.531270 ZAVE =  -17.531270
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "56.9804611"
 RDCMND substituted energy or value "?XAVE" to "-47.1541848"
Evaluating: 56.9804611--47.1541848
 Parameter: XTRAN <- "104.134646"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.8205675"
 RDCMND substituted energy or value "?YAVE" to "32.6346057"
Evaluating: 38.8205675-32.6346057
 Parameter: YTRAN <- "6.1859618"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.9972722"
 RDCMND substituted energy or value "?ZAVE" to "-17.5312704"
Evaluating: 18.9972722--17.5312704
 Parameter: ZTRAN <- "36.5285426"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "104.134646"
 Parameter: YTRAN -> "6.1859618"
 Parameter: ZTRAN -> "36.5285426"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   104.134646    6.185962   36.528543
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.509886383"
Evaluating: 0.509886383*360.0
 Parameter: XPHI <- "183.559098"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.765521858"
Evaluating: 0.765521858*360.0
 Parameter: YPHI <- "275.587869"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.182602482"
Evaluating: 0.182602482*360.0
 Parameter: ZPHI <- "65.7368935"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "56.9804611"
 Parameter: YPOS -> "38.8205675"
 Parameter: ZPOS -> "18.9972722"
 Parameter: XPHI -> "183.559098"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.998071   -0.062078
    0.000000    0.062078   -0.998071

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  176.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "56.9804611"
 Parameter: YPOS -> "38.8205675"
 Parameter: ZPOS -> "18.9972722"
 Parameter: YPHI -> "275.587869"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.097372    0.000000    0.995248
    0.000000    1.000000    0.000000
   -0.995248    0.000000    0.097372

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   84.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "56.9804611"
 Parameter: YPOS -> "38.8205675"
 Parameter: ZPOS -> "18.9972722"
 Parameter: ZPHI -> "65.7368935"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.410927    0.911668    0.000000
   -0.911668    0.410927    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   65.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   56.980461 XMAX =   56.980461 XAVE =   56.980461
    YMIN =   38.820567 YMAX =   38.820567 YAVE =   38.820567
    ZMIN =   18.997272 ZMAX =   18.997272 ZAVE =   18.997272
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "56.9804611"
Evaluating: 56.9804611+3.5
 Parameter: XMAX <- "60.4804611"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.8205675"
Evaluating: 38.8205675+3.5
 Parameter: YMAX <- "42.3205675"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.9972721"
Evaluating: 18.9972721+3.5
 Parameter: ZMAX <- "22.4972721"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "56.9804611"
Evaluating: 56.9804611-3.5
 Parameter: XMIN <- "53.4804611"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.8205675"
Evaluating: 38.8205675-3.5
 Parameter: YMIN <- "35.3205675"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.9972721"
Evaluating: 18.9972721-3.5
 Parameter: ZMIN <- "15.4972721"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "60.4804611"
 Parameter: XMIN -> "53.4804611"
 Parameter: YMAX -> "42.3205675"
 Parameter: YMIN -> "35.3205675"
 Parameter: ZMAX -> "22.4972721"
 Parameter: ZMIN -> "15.4972721"
 SELRPN>     22 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      8 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64431 POS      SOD      16       SOD     -**** MEMB     POPC     116      N             3.5208
64431 POS      SOD      16       SOD     -**** MEMB     POPC     116      C12           3.8145
64431 POS      SOD      16       SOD     -**** MEMB     POPC     116      C14           2.6387
64431 POS      SOD      16       SOD     -**** MEMB     POPC     116      C15           3.5526
64431 POS      SOD      16       SOD     -**** MEMB     POPC     116      C1            3.7874
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "16" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.650684766"
Evaluating: 125.050557*(0.650684766-0.5)
 Parameter: XPOS <- "18.8432139"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.319796226"
Evaluating: 125.050557*(0.319796226-0.5)
 Parameter: YPOS <- "-22.5345823"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.107623061"
Evaluating: 152.572525*(0.107623061-0.5)+-4.51585405
 Parameter: ZPOS <- "-64.3817944"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-64.3817944" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   56.980461 XMAX =   56.980461 XAVE =   56.980461
    YMIN =   38.820567 YMAX =   38.820567 YAVE =   38.820567
    ZMIN =   18.997272 ZMAX =   18.997272 ZAVE =   18.997272
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.8432139"
 RDCMND substituted energy or value "?XAVE" to "56.9804611"
Evaluating: 18.8432139-56.9804611
 Parameter: XTRAN <- "-38.1372472"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.5345823"
 RDCMND substituted energy or value "?YAVE" to "38.8205675"
Evaluating: -22.5345823-38.8205675
 Parameter: YTRAN <- "-61.3551498"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-64.3817944"
 RDCMND substituted energy or value "?ZAVE" to "18.9972721"
Evaluating: -64.3817944-18.9972721
 Parameter: ZTRAN <- "-83.3790665"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.1372472"
 Parameter: YTRAN -> "-61.3551498"
 Parameter: ZTRAN -> "-83.3790665"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -38.137247  -61.355150  -83.379066
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.813566943E-02"
Evaluating: 9.813566943E-02*360.0
 Parameter: XPHI <- "35.328841"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.406801278"
Evaluating: 0.406801278*360.0
 Parameter: YPHI <- "146.44846"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.952094114"
Evaluating: 0.952094114*360.0
 Parameter: ZPHI <- "342.753881"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.8432139"
 Parameter: YPOS -> "-22.5345823"
 Parameter: ZPOS -> "-64.3817944"
 Parameter: XPHI -> "35.328841"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.815847    0.578268
    0.000000   -0.578268    0.815847

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   35.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.8432139"
 Parameter: YPOS -> "-22.5345823"
 Parameter: ZPOS -> "-64.3817944"
 Parameter: YPHI -> "146.44846"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.833389    0.000000   -0.552687
    0.000000    1.000000    0.000000
    0.552687    0.000000   -0.833389

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  146.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.8432139"
 Parameter: YPOS -> "-22.5345823"
 Parameter: ZPOS -> "-64.3817944"
 Parameter: ZPHI -> "342.753881"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.955040   -0.296477    0.000000
    0.296477    0.955040    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   17.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.843214 XMAX =   18.843214 XAVE =   18.843214
    YMIN =  -22.534582 YMAX =  -22.534582 YAVE =  -22.534582
    ZMIN =  -64.381794 ZMAX =  -64.381794 ZAVE =  -64.381794
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.8432139"
Evaluating: 18.8432139+3.5
 Parameter: XMAX <- "22.3432139"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.5345823"
Evaluating: -22.5345823+3.5
 Parameter: YMAX <- "-19.0345823"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-64.3817944"
Evaluating: -64.3817944+3.5
 Parameter: ZMAX <- "-60.8817944"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.8432139"
Evaluating: 18.8432139-3.5
 Parameter: XMIN <- "15.3432139"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.5345823"
Evaluating: -22.5345823-3.5
 Parameter: YMIN <- "-26.0345823"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-64.3817944"
Evaluating: -64.3817944-3.5
 Parameter: ZMIN <- "-67.8817944"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.3432139"
 Parameter: XMIN -> "15.3432139"
 Parameter: YMAX -> "-19.0345823"
 Parameter: YMIN -> "-26.0345823"
 Parameter: ZMAX -> "-60.8817944"
 Parameter: ZMIN -> "-67.8817944"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "17" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "17" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.528483021"
Evaluating: 125.050557*(0.528483021-0.5)
 Parameter: XPOS <- "3.56181764"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.608977593"
Evaluating: 125.050557*(0.608977593-0.5)
 Parameter: YPOS <- "13.6277087"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.414744728"
Evaluating: 152.572525*(0.414744728-0.5)+-4.51585405
 Parameter: ZPOS <- "-17.5234662"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.5234662" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.56181764"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.56181764-0
 Parameter: XTRAN <- "3.56181764"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.6277087"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.6277087-0
 Parameter: YTRAN <- "13.6277087"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.5234662"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.5234662-0
 Parameter: ZTRAN <- "-17.5234662"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.56181764"
 Parameter: YTRAN -> "13.6277087"
 Parameter: ZTRAN -> "-17.5234662"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     3.561818   13.627709  -17.523466
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.22449589"
Evaluating: 0.22449589*360.0
 Parameter: XPHI <- "80.8185204"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.729640273"
Evaluating: 0.729640273*360.0
 Parameter: YPHI <- "262.670498"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.411413441"
Evaluating: 0.411413441*360.0
 Parameter: ZPHI <- "148.108839"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.56181764"
 Parameter: YPOS -> "13.6277087"
 Parameter: ZPOS -> "-17.5234662"
 Parameter: XPHI -> "80.8185204"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.159562    0.987188
    0.000000   -0.987188    0.159562

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   80.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.56181764"
 Parameter: YPOS -> "13.6277087"
 Parameter: ZPOS -> "-17.5234662"
 Parameter: YPHI -> "262.670498"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.127575    0.000000    0.991829
    0.000000    1.000000    0.000000
   -0.991829    0.000000   -0.127575

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   97.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.56181764"
 Parameter: YPOS -> "13.6277087"
 Parameter: ZPOS -> "-17.5234662"
 Parameter: ZPHI -> "148.108839"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.849053    0.528307    0.000000
   -0.528307   -0.849053    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  148.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.561818 XMAX =    3.561818 XAVE =    3.561818
    YMIN =   13.627709 YMAX =   13.627709 YAVE =   13.627709
    ZMIN =  -17.523466 ZMAX =  -17.523466 ZAVE =  -17.523466
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.56181764"
Evaluating: 3.56181764+3.5
 Parameter: XMAX <- "7.06181764"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.6277087"
Evaluating: 13.6277087+3.5
 Parameter: YMAX <- "17.1277087"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.5234662"
Evaluating: -17.5234662+3.5
 Parameter: ZMAX <- "-14.0234662"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.56181764"
Evaluating: 3.56181764-3.5
 Parameter: XMIN <- "6.181764E-02"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.6277087"
Evaluating: 13.6277087-3.5
 Parameter: YMIN <- "10.1277087"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.5234662"
Evaluating: -17.5234662-3.5
 Parameter: ZMIN <- "-21.0234662"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.06181764"
 Parameter: XMIN -> "6.181764E-02"
 Parameter: YMAX -> "17.1277087"
 Parameter: YMIN -> "10.1277087"
 Parameter: ZMAX -> "-14.0234662"
 Parameter: ZMIN -> "-21.0234662"
 SELRPN>      3 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64432 POS      SOD      17       SOD     -**** PROA     ASP      1382     OD1           4.4756
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "17" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.941590085"
Evaluating: 125.050557*(0.941590085-0.5)
 Parameter: XPOS <- "55.2210861"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.878794357"
Evaluating: 125.050557*(0.878794357-0.5)
 Parameter: YPOS <- "47.3684453"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.439984002"
Evaluating: 152.572525*(0.439984002-0.5)+-4.51585405
 Parameter: ZPOS <- "-13.6726464"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.6726464" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.6726464" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "17" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.694733077"
Evaluating: 125.050557*(0.694733077-0.5)
 Parameter: XPOS <- "24.3514797"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.85781671"
Evaluating: 125.050557*(0.85781671-0.5)
 Parameter: YPOS <- "44.7451789"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.216290331"
Evaluating: 152.572525*(0.216290331-0.5)+-4.51585405
 Parameter: ZPOS <- "-47.8021546"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-47.8021546" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.561818 XMAX =    3.561818 XAVE =    3.561818
    YMIN =   13.627709 YMAX =   13.627709 YAVE =   13.627709
    ZMIN =  -17.523466 ZMAX =  -17.523466 ZAVE =  -17.523466
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.3514797"
 RDCMND substituted energy or value "?XAVE" to "3.56181764"
Evaluating: 24.3514797-3.56181764
 Parameter: XTRAN <- "20.7896621"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.7451789"
 RDCMND substituted energy or value "?YAVE" to "13.6277087"
Evaluating: 44.7451789-13.6277087
 Parameter: YTRAN <- "31.1174702"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-47.8021546"
 RDCMND substituted energy or value "?ZAVE" to "-17.5234662"
Evaluating: -47.8021546--17.5234662
 Parameter: ZTRAN <- "-30.2786884"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.7896621"
 Parameter: YTRAN -> "31.1174702"
 Parameter: ZTRAN -> "-30.2786884"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    20.789662   31.117470  -30.278688
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.184727635"
Evaluating: 0.184727635*360.0
 Parameter: XPHI <- "66.5019486"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.656850317"
Evaluating: 0.656850317*360.0
 Parameter: YPHI <- "236.466114"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.350511803"
Evaluating: 0.350511803*360.0
 Parameter: ZPHI <- "126.184249"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.3514797"
 Parameter: YPOS -> "44.7451789"
 Parameter: ZPOS -> "-47.8021546"
 Parameter: XPHI -> "66.5019486"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.398718    0.917074
    0.000000   -0.917074    0.398718

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   66.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.3514797"
 Parameter: YPOS -> "44.7451789"
 Parameter: ZPOS -> "-47.8021546"
 Parameter: YPHI -> "236.466114"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.552430    0.000000    0.833559
    0.000000    1.000000    0.000000
   -0.833559    0.000000   -0.552430

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  123.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.3514797"
 Parameter: YPOS -> "44.7451789"
 Parameter: ZPOS -> "-47.8021546"
 Parameter: ZPHI -> "126.184249"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.590384    0.807123    0.000000
   -0.807123   -0.590384    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  126.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.351480 XMAX =   24.351480 XAVE =   24.351480
    YMIN =   44.745179 YMAX =   44.745179 YAVE =   44.745179
    ZMIN =  -47.802155 ZMAX =  -47.802155 ZAVE =  -47.802155
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.3514797"
Evaluating: 24.3514797+3.5
 Parameter: XMAX <- "27.8514797"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.7451789"
Evaluating: 44.7451789+3.5
 Parameter: YMAX <- "48.2451789"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-47.8021546"
Evaluating: -47.8021546+3.5
 Parameter: ZMAX <- "-44.3021546"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.3514797"
Evaluating: 24.3514797-3.5
 Parameter: XMIN <- "20.8514797"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.7451789"
Evaluating: 44.7451789-3.5
 Parameter: YMIN <- "41.2451789"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-47.8021546"
Evaluating: -47.8021546-3.5
 Parameter: ZMIN <- "-51.3021546"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.8514797"
 Parameter: XMIN -> "20.8514797"
 Parameter: YMAX -> "48.2451789"
 Parameter: YMIN -> "41.2451789"
 Parameter: ZMAX -> "-44.3021546"
 Parameter: ZMIN -> "-51.3021546"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "18" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "18" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.452942305"
Evaluating: 125.050557*(0.452942305-0.5)
 Parameter: XPOS <- "-5.88459097"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.897636384"
Evaluating: 125.050557*(0.897636384-0.5)
 Parameter: YPOS <- "49.7246513"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "3.612399426E-02"
Evaluating: 152.572525*(3.612399426E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-75.2905875"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-75.2905875" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.88459097"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.88459097-0
 Parameter: XTRAN <- "-5.88459097"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "49.7246513"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 49.7246513-0
 Parameter: YTRAN <- "49.7246513"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-75.2905875"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -75.2905875-0
 Parameter: ZTRAN <- "-75.2905875"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.88459097"
 Parameter: YTRAN -> "49.7246513"
 Parameter: ZTRAN -> "-75.2905875"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -5.884591   49.724651  -75.290588
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.214786072"
Evaluating: 0.214786072*360.0
 Parameter: XPHI <- "77.3229859"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.313044236E-03"
Evaluating: 7.313044236E-03*360.0
 Parameter: YPHI <- "2.63269592"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.162082352"
Evaluating: 0.162082352*360.0
 Parameter: ZPHI <- "58.3496467"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.88459097"
 Parameter: YPOS -> "49.7246513"
 Parameter: ZPOS -> "-75.2905875"
 Parameter: XPHI -> "77.3229859"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.219455    0.975623
    0.000000   -0.975623    0.219455

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   77.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.88459097"
 Parameter: YPOS -> "49.7246513"
 Parameter: ZPOS -> "-75.2905875"
 Parameter: YPHI -> "2.63269592"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.998945    0.000000   -0.045933
    0.000000    1.000000    0.000000
    0.045933    0.000000    0.998945

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.88459097"
 Parameter: YPOS -> "49.7246513"
 Parameter: ZPOS -> "-75.2905875"
 Parameter: ZPHI -> "58.3496467"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.524734    0.851266    0.000000
   -0.851266    0.524734    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   58.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.884591 XMAX =   -5.884591 XAVE =   -5.884591
    YMIN =   49.724651 YMAX =   49.724651 YAVE =   49.724651
    ZMIN =  -75.290588 ZMAX =  -75.290588 ZAVE =  -75.290588
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.88459097"
Evaluating: -5.88459097+3.5
 Parameter: XMAX <- "-2.38459097"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "49.7246513"
Evaluating: 49.7246513+3.5
 Parameter: YMAX <- "53.2246513"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-75.2905875"
Evaluating: -75.2905875+3.5
 Parameter: ZMAX <- "-71.7905875"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.88459097"
Evaluating: -5.88459097-3.5
 Parameter: XMIN <- "-9.38459097"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "49.7246513"
Evaluating: 49.7246513-3.5
 Parameter: YMIN <- "46.2246513"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-75.2905875"
Evaluating: -75.2905875-3.5
 Parameter: ZMIN <- "-78.7905875"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.38459097"
 Parameter: XMIN -> "-9.38459097"
 Parameter: YMAX -> "53.2246513"
 Parameter: YMIN -> "46.2246513"
 Parameter: ZMAX -> "-71.7905875"
 Parameter: ZMIN -> "-78.7905875"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "19" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "19" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.670292856"
Evaluating: 125.050557*(0.670292856-0.5)
 Parameter: XPOS <- "21.2952165"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.413966142"
Evaluating: 125.050557*(0.413966142-0.5)
 Parameter: YPOS <- "-10.7585819"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "3.359177986E-02"
Evaluating: 152.572525*(3.359177986E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-75.6769339"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-75.6769339" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.2952165"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.2952165-0
 Parameter: XTRAN <- "21.2952165"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.7585819"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -10.7585819-0
 Parameter: YTRAN <- "-10.7585819"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-75.6769339"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -75.6769339-0
 Parameter: ZTRAN <- "-75.6769339"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.2952165"
 Parameter: YTRAN -> "-10.7585819"
 Parameter: ZTRAN -> "-75.6769339"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    21.295216  -10.758582  -75.676934
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.13936993"
Evaluating: 0.13936993*360.0
 Parameter: XPHI <- "50.1731748"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.291021496"
Evaluating: 0.291021496*360.0
 Parameter: YPHI <- "104.767739"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.276712317"
Evaluating: 0.276712317*360.0
 Parameter: ZPHI <- "99.6164341"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.2952165"
 Parameter: YPOS -> "-10.7585819"
 Parameter: ZPOS -> "-75.6769339"
 Parameter: XPHI -> "50.1731748"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.640469    0.767984
    0.000000   -0.767984    0.640469

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   50.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.2952165"
 Parameter: YPOS -> "-10.7585819"
 Parameter: ZPOS -> "-75.6769339"
 Parameter: YPHI -> "104.767739"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.254901    0.000000   -0.966967
    0.000000    1.000000    0.000000
    0.966967    0.000000   -0.254901

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  104.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.2952165"
 Parameter: YPOS -> "-10.7585819"
 Parameter: ZPOS -> "-75.6769339"
 Parameter: ZPHI -> "99.6164341"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.167052    0.985948    0.000000
   -0.985948   -0.167052    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   99.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.295216 XMAX =   21.295216 XAVE =   21.295216
    YMIN =  -10.758582 YMAX =  -10.758582 YAVE =  -10.758582
    ZMIN =  -75.676934 ZMAX =  -75.676934 ZAVE =  -75.676934
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.2952165"
Evaluating: 21.2952165+3.5
 Parameter: XMAX <- "24.7952165"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.7585819"
Evaluating: -10.7585819+3.5
 Parameter: YMAX <- "-7.2585819"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-75.6769339"
Evaluating: -75.6769339+3.5
 Parameter: ZMAX <- "-72.1769339"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.2952165"
Evaluating: 21.2952165-3.5
 Parameter: XMIN <- "17.7952165"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.7585819"
Evaluating: -10.7585819-3.5
 Parameter: YMIN <- "-14.2585819"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-75.6769339"
Evaluating: -75.6769339-3.5
 Parameter: ZMIN <- "-79.1769339"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.7952165"
 Parameter: XMIN -> "17.7952165"
 Parameter: YMAX -> "-7.2585819"
 Parameter: YMIN -> "-14.2585819"
 Parameter: ZMAX -> "-72.1769339"
 Parameter: ZMIN -> "-79.1769339"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "20" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "20" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.818428126"
Evaluating: 125.050557*(0.818428126-0.5)
 Parameter: XPOS <- "39.8196145"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.721020402"
Evaluating: 125.050557*(0.721020402-0.5)
 Parameter: YPOS <- "27.6387244"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.12651999"
Evaluating: 152.572525*(0.12651999-0.5)+-4.51585405
 Parameter: ZPOS <- "-61.4986422"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-61.4986422" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.8196145"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.8196145-0
 Parameter: XTRAN <- "39.8196145"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.6387244"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.6387244-0
 Parameter: YTRAN <- "27.6387244"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-61.4986422"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -61.4986422-0
 Parameter: ZTRAN <- "-61.4986422"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.8196145"
 Parameter: YTRAN -> "27.6387244"
 Parameter: ZTRAN -> "-61.4986422"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    39.819615   27.638724  -61.498642
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.844917601"
Evaluating: 0.844917601*360.0
 Parameter: XPHI <- "304.170336"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.330281995"
Evaluating: 0.330281995*360.0
 Parameter: YPHI <- "118.901518"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.859870848"
Evaluating: 0.859870848*360.0
 Parameter: ZPHI <- "309.553505"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.8196145"
 Parameter: YPOS -> "27.6387244"
 Parameter: ZPOS -> "-61.4986422"
 Parameter: XPHI -> "304.170336"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.561655   -0.827371
    0.000000    0.827371    0.561655

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   55.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.8196145"
 Parameter: YPOS -> "27.6387244"
 Parameter: ZPOS -> "-61.4986422"
 Parameter: YPHI -> "118.901518"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.483306    0.000000   -0.875452
    0.000000    1.000000    0.000000
    0.875452    0.000000   -0.483306

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  118.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.8196145"
 Parameter: YPOS -> "27.6387244"
 Parameter: ZPOS -> "-61.4986422"
 Parameter: ZPHI -> "309.553505"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.636799   -0.771030    0.000000
    0.771030    0.636799    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   50.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.819615 XMAX =   39.819615 XAVE =   39.819615
    YMIN =   27.638724 YMAX =   27.638724 YAVE =   27.638724
    ZMIN =  -61.498642 ZMAX =  -61.498642 ZAVE =  -61.498642
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.8196145"
Evaluating: 39.8196145+3.5
 Parameter: XMAX <- "43.3196145"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.6387244"
Evaluating: 27.6387244+3.5
 Parameter: YMAX <- "31.1387244"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-61.4986422"
Evaluating: -61.4986422+3.5
 Parameter: ZMAX <- "-57.9986422"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.8196145"
Evaluating: 39.8196145-3.5
 Parameter: XMIN <- "36.3196145"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.6387244"
Evaluating: 27.6387244-3.5
 Parameter: YMIN <- "24.1387244"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-61.4986422"
Evaluating: -61.4986422-3.5
 Parameter: ZMIN <- "-64.9986422"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.3196145"
 Parameter: XMIN -> "36.3196145"
 Parameter: YMAX -> "31.1387244"
 Parameter: YMIN -> "24.1387244"
 Parameter: ZMAX -> "-57.9986422"
 Parameter: ZMIN -> "-64.9986422"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "21" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "21" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "3.366546841E-02"
Evaluating: 125.050557*(3.366546841E-02-0.5)
 Parameter: XPOS <- "-58.3153929"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.629865933"
Evaluating: 125.050557*(0.629865933-0.5)
 Parameter: YPOS <- "16.2398073"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.101845525"
Evaluating: 152.572525*(0.101845525-0.5)+-4.51585405
 Parameter: ZPOS <- "-65.2632876"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-65.2632876" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-58.3153929"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -58.3153929-0
 Parameter: XTRAN <- "-58.3153929"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.2398073"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.2398073-0
 Parameter: YTRAN <- "16.2398073"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-65.2632876"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -65.2632876-0
 Parameter: ZTRAN <- "-65.2632876"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.3153929"
 Parameter: YTRAN -> "16.2398073"
 Parameter: ZTRAN -> "-65.2632876"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -58.315393   16.239807  -65.263288
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.515243945"
Evaluating: 0.515243945*360.0
 Parameter: XPHI <- "185.48782"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.761418749"
Evaluating: 0.761418749*360.0
 Parameter: YPHI <- "274.11075"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.14790294"
Evaluating: 0.14790294*360.0
 Parameter: ZPHI <- "53.2450584"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-58.3153929"
 Parameter: YPOS -> "16.2398073"
 Parameter: ZPOS -> "-65.2632876"
 Parameter: XPHI -> "185.48782"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.995417   -0.095634
    0.000000    0.095634   -0.995417

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  174.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-58.3153929"
 Parameter: YPOS -> "16.2398073"
 Parameter: ZPOS -> "-65.2632876"
 Parameter: YPHI -> "274.11075"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.071685    0.000000    0.997427
    0.000000    1.000000    0.000000
   -0.997427    0.000000    0.071685

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   85.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-58.3153929"
 Parameter: YPOS -> "16.2398073"
 Parameter: ZPOS -> "-65.2632876"
 Parameter: ZPHI -> "53.2450584"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.598394    0.801202    0.000000
   -0.801202    0.598394    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   53.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -58.315393 XMAX =  -58.315393 XAVE =  -58.315393
    YMIN =   16.239807 YMAX =   16.239807 YAVE =   16.239807
    ZMIN =  -65.263288 ZMAX =  -65.263288 ZAVE =  -65.263288
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-58.3153929"
Evaluating: -58.3153929+3.5
 Parameter: XMAX <- "-54.8153929"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.2398073"
Evaluating: 16.2398073+3.5
 Parameter: YMAX <- "19.7398073"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-65.2632876"
Evaluating: -65.2632876+3.5
 Parameter: ZMAX <- "-61.7632876"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-58.3153929"
Evaluating: -58.3153929-3.5
 Parameter: XMIN <- "-61.8153929"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.2398073"
Evaluating: 16.2398073-3.5
 Parameter: YMIN <- "12.7398073"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-65.2632876"
Evaluating: -65.2632876-3.5
 Parameter: ZMIN <- "-68.7632876"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-54.8153929"
 Parameter: XMIN -> "-61.8153929"
 Parameter: YMAX -> "19.7398073"
 Parameter: YMIN -> "12.7398073"
 Parameter: ZMAX -> "-61.7632876"
 Parameter: ZMIN -> "-68.7632876"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "22" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "22" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.453509143"
Evaluating: 125.050557*(0.453509143-0.5)
 Parameter: XPOS <- "-5.81370756"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.184727415"
Evaluating: 125.050557*(0.184727415-0.5)
 Parameter: YPOS <- "-39.4250124"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.535895732"
Evaluating: 152.572525*(0.535895732-0.5)+-4.51585405
 Parameter: ZPOS <- "0.960848418"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.960848418" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.960848418" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "22" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.157570249"
Evaluating: 125.050557*(0.157570249-0.5)
 Parameter: XPOS <- "-42.8210311"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.733078688"
Evaluating: 125.050557*(0.733078688-0.5)
 Parameter: YPOS <- "29.1466198"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.503699855"
Evaluating: 152.572525*(0.503699855-0.5)+-4.51585405
 Parameter: ZPOS <- "-3.95135783"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.95135783" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.95135783" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "22" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.582221557"
Evaluating: 125.050557*(0.582221557-0.5)
 Parameter: XPOS <- "10.2818515"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.297509425"
Evaluating: 125.050557*(0.297509425-0.5)
 Parameter: YPOS <- "-25.3215592"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.951700865"
Evaluating: 152.572525*(0.951700865-0.5)+-4.51585405
 Parameter: ZPOS <- "64.4012875"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "64.4012875" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "64.4012875" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.2818515"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.2818515-0
 Parameter: XTRAN <- "10.2818515"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.3215592"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.3215592-0
 Parameter: YTRAN <- "-25.3215592"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "64.4012875"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 64.4012875-0
 Parameter: ZTRAN <- "64.4012875"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.2818515"
 Parameter: YTRAN -> "-25.3215592"
 Parameter: ZTRAN -> "64.4012875"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    10.281852  -25.321559   64.401287
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.420222611E-02"
Evaluating: 1.420222611E-02*360.0
 Parameter: XPHI <- "5.1128014"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.738828823"
Evaluating: 0.738828823*360.0
 Parameter: YPHI <- "265.978376"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.661304267"
Evaluating: 0.661304267*360.0
 Parameter: ZPHI <- "238.069536"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.2818515"
 Parameter: YPOS -> "-25.3215592"
 Parameter: ZPOS -> "64.4012875"
 Parameter: XPHI -> "5.1128014"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.996021    0.089117
    0.000000   -0.089117    0.996021

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    5.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.2818515"
 Parameter: YPOS -> "-25.3215592"
 Parameter: ZPOS -> "64.4012875"
 Parameter: YPHI -> "265.978376"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.070133    0.000000    0.997538
    0.000000    1.000000    0.000000
   -0.997538    0.000000   -0.070133

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   94.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.2818515"
 Parameter: YPOS -> "-25.3215592"
 Parameter: ZPOS -> "64.4012875"
 Parameter: ZPHI -> "238.069536"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.528890   -0.848691    0.000000
    0.848691   -0.528890    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  121.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.281852 XMAX =   10.281852 XAVE =   10.281852
    YMIN =  -25.321559 YMAX =  -25.321559 YAVE =  -25.321559
    ZMIN =   64.401287 ZMAX =   64.401287 ZAVE =   64.401287
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.2818515"
Evaluating: 10.2818515+3.5
 Parameter: XMAX <- "13.7818515"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.3215592"
Evaluating: -25.3215592+3.5
 Parameter: YMAX <- "-21.8215592"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "64.4012875"
Evaluating: 64.4012875+3.5
 Parameter: ZMAX <- "67.9012875"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.2818515"
Evaluating: 10.2818515-3.5
 Parameter: XMIN <- "6.7818515"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.3215592"
Evaluating: -25.3215592-3.5
 Parameter: YMIN <- "-28.8215592"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "64.4012875"
Evaluating: 64.4012875-3.5
 Parameter: ZMIN <- "60.9012875"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.7818515"
 Parameter: XMIN -> "6.7818515"
 Parameter: YMAX -> "-21.8215592"
 Parameter: YMIN -> "-28.8215592"
 Parameter: ZMAX -> "67.9012875"
 Parameter: ZMIN -> "60.9012875"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "23" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "23" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.247413218"
Evaluating: 125.050557*(0.247413218-0.5)
 Parameter: XPOS <- "-31.5861178"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.882901828"
Evaluating: 125.050557*(0.882901828-0.5)
 Parameter: YPOS <- "47.8820869"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.620300176"
Evaluating: 152.572525*(0.620300176-0.5)+-4.51585405
 Parameter: ZPOS <- "13.8386476"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.8386476" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.8386476" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "23" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.972241765"
Evaluating: 125.050557*(0.972241765-0.5)
 Parameter: XPOS <- "59.0540958"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.100997603"
Evaluating: 125.050557*(0.100997603-0.5)
 Parameter: YPOS <- "-49.895472"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.61345303"
Evaluating: 152.572525*(0.61345303-0.5)+-4.51585405
 Parameter: ZPOS <- "12.7939612"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.7939612" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.7939612" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "23" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.614706161"
Evaluating: 125.050557*(0.614706161-0.5)
 Parameter: XPOS <- "14.3440693"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.491789192"
Evaluating: 125.050557*(0.491789192-0.5)
 Parameter: YPOS <- "-1.02676611"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.53325423"
Evaluating: 152.572525*(0.53325423-0.5)+-4.51585405
 Parameter: ZPOS <- "0.557827788"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.557827788" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.557827788" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "23" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.393159111"
Evaluating: 125.050557*(0.393159111-0.5)
 Parameter: XPOS <- "-13.3605127"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "7.019031731E-03"
Evaluating: 125.050557*(7.019031731E-03-0.5)
 Parameter: YPOS <- "-61.6475447"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.300126465"
Evaluating: 152.572525*(0.300126465-0.5)+-4.51585405
 Parameter: ZPOS <- "-35.011064"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.011064" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.3605127"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.3605127-0
 Parameter: XTRAN <- "-13.3605127"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-61.6475447"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -61.6475447-0
 Parameter: YTRAN <- "-61.6475447"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.011064"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -35.011064-0
 Parameter: ZTRAN <- "-35.011064"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.3605127"
 Parameter: YTRAN -> "-61.6475447"
 Parameter: ZTRAN -> "-35.011064"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -13.360513  -61.647545  -35.011064
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.397744809"
Evaluating: 0.397744809*360.0
 Parameter: XPHI <- "143.188131"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.492459131"
Evaluating: 0.492459131*360.0
 Parameter: YPHI <- "177.285287"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.806086896"
Evaluating: 0.806086896*360.0
 Parameter: ZPHI <- "290.191283"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.3605127"
 Parameter: YPOS -> "-61.6475447"
 Parameter: ZPOS -> "-35.011064"
 Parameter: XPHI -> "143.188131"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.800607    0.599189
    0.000000   -0.599189   -0.800607

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  143.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.3605127"
 Parameter: YPOS -> "-61.6475447"
 Parameter: ZPOS -> "-35.011064"
 Parameter: YPHI -> "177.285287"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.998878    0.000000   -0.047363
    0.000000    1.000000    0.000000
    0.047363    0.000000   -0.998878

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  177.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.3605127"
 Parameter: YPOS -> "-61.6475447"
 Parameter: ZPOS -> "-35.011064"
 Parameter: ZPHI -> "290.191283"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.345155   -0.938546    0.000000
    0.938546    0.345155    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   69.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.360513 XMAX =  -13.360513 XAVE =  -13.360513
    YMIN =  -61.647545 YMAX =  -61.647545 YAVE =  -61.647545
    ZMIN =  -35.011064 ZMAX =  -35.011064 ZAVE =  -35.011064
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.3605127"
Evaluating: -13.3605127+3.5
 Parameter: XMAX <- "-9.8605127"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-61.6475447"
Evaluating: -61.6475447+3.5
 Parameter: YMAX <- "-58.1475447"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.011064"
Evaluating: -35.011064+3.5
 Parameter: ZMAX <- "-31.511064"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.3605127"
Evaluating: -13.3605127-3.5
 Parameter: XMIN <- "-16.8605127"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-61.6475447"
Evaluating: -61.6475447-3.5
 Parameter: YMIN <- "-65.1475447"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.011064"
Evaluating: -35.011064-3.5
 Parameter: ZMIN <- "-38.511064"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.8605127"
 Parameter: XMIN -> "-16.8605127"
 Parameter: YMAX -> "-58.1475447"
 Parameter: YMIN -> "-65.1475447"
 Parameter: ZMAX -> "-31.511064"
 Parameter: ZMIN -> "-38.511064"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "24" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "24" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.935711443"
Evaluating: 125.050557*(0.935711443-0.5)
 Parameter: XPOS <- "54.4859586"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.691665214"
Evaluating: 125.050557*(0.691665214-0.5)
 Parameter: YPOS <- "23.9678418"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.882501498"
Evaluating: 152.572525*(0.882501498-0.5)+-4.51585405
 Parameter: ZPOS <- "53.8433653"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "53.8433653" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "53.8433653" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "54.4859586"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 54.4859586-0
 Parameter: XTRAN <- "54.4859586"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.9678418"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.9678418-0
 Parameter: YTRAN <- "23.9678418"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "53.8433653"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 53.8433653-0
 Parameter: ZTRAN <- "53.8433653"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "54.4859586"
 Parameter: YTRAN -> "23.9678418"
 Parameter: ZTRAN -> "53.8433653"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    54.485959   23.967842   53.843365
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.367522776"
Evaluating: 0.367522776*360.0
 Parameter: XPHI <- "132.308199"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.36967265"
Evaluating: 0.36967265*360.0
 Parameter: YPHI <- "133.082154"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453230282"
Evaluating: 0.453230282*360.0
 Parameter: ZPHI <- "163.162902"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "54.4859586"
 Parameter: YPOS -> "23.9678418"
 Parameter: ZPOS -> "53.8433653"
 Parameter: XPHI -> "132.308199"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.673118    0.739535
    0.000000   -0.739535   -0.673118

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "54.4859586"
 Parameter: YPOS -> "23.9678418"
 Parameter: ZPOS -> "53.8433653"
 Parameter: YPHI -> "133.082154"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.683046    0.000000   -0.730375
    0.000000    1.000000    0.000000
    0.730375    0.000000   -0.683046

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  133.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "54.4859586"
 Parameter: YPOS -> "23.9678418"
 Parameter: ZPOS -> "53.8433653"
 Parameter: ZPHI -> "163.162902"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.957132    0.289652    0.000000
   -0.289652   -0.957132    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   54.485959 XMAX =   54.485959 XAVE =   54.485959
    YMIN =   23.967842 YMAX =   23.967842 YAVE =   23.967842
    ZMIN =   53.843365 ZMAX =   53.843365 ZAVE =   53.843365
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "54.4859586"
Evaluating: 54.4859586+3.5
 Parameter: XMAX <- "57.9859586"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.9678418"
Evaluating: 23.9678418+3.5
 Parameter: YMAX <- "27.4678418"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "53.8433653"
Evaluating: 53.8433653+3.5
 Parameter: ZMAX <- "57.3433653"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "54.4859586"
Evaluating: 54.4859586-3.5
 Parameter: XMIN <- "50.9859586"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.9678418"
Evaluating: 23.9678418-3.5
 Parameter: YMIN <- "20.4678418"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "53.8433653"
Evaluating: 53.8433653-3.5
 Parameter: ZMIN <- "50.3433653"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.9859586"
 Parameter: XMIN -> "50.9859586"
 Parameter: YMAX -> "27.4678418"
 Parameter: YMIN -> "20.4678418"
 Parameter: ZMAX -> "57.3433653"
 Parameter: ZMIN -> "50.3433653"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "25" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "25" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.415323545"
Evaluating: 125.050557*(0.415323545-0.5)
 Parameter: XPOS <- "-10.5888379"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.569851972"
Evaluating: 125.050557*(0.569851972-0.5)
 Parameter: YPOS <- "8.73502801"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.436927751"
Evaluating: 152.572525*(0.436927751-0.5)+-4.51585405
 Parameter: ZPOS <- "-14.1389463"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.1389463" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.1389463" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "25" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.464811014"
Evaluating: 125.050557*(0.464811014-0.5)
 Parameter: XPOS <- "-4.4004023"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.863731968"
Evaluating: 125.050557*(0.863731968-0.5)
 Parameter: YPOS <- "45.4848852"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.498676016"
Evaluating: 152.572525*(0.498676016-0.5)+-4.51585405
 Parameter: ZPOS <- "-4.71785763"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.71785763" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.71785763" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "25" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.36422013"
Evaluating: 125.050557*(0.36422013-0.5)
 Parameter: XPOS <- "-16.9793484"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.423307243"
Evaluating: 125.050557*(0.423307243-0.5)
 Parameter: YPOS <- "-9.59047198"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.351524659"
Evaluating: 152.572525*(0.351524659-0.5)+-4.51585405
 Parameter: ZPOS <- "-27.1691117"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.1691117" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.9793484"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.9793484-0
 Parameter: XTRAN <- "-16.9793484"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.59047198"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.59047198-0
 Parameter: YTRAN <- "-9.59047198"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.1691117"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.1691117-0
 Parameter: ZTRAN <- "-27.1691117"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.9793484"
 Parameter: YTRAN -> "-9.59047198"
 Parameter: ZTRAN -> "-27.1691117"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -16.979348   -9.590472  -27.169112
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.698768076"
Evaluating: 0.698768076*360.0
 Parameter: XPHI <- "251.556507"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.809262702"
Evaluating: 0.809262702*360.0
 Parameter: YPHI <- "291.334573"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.43080353"
Evaluating: 0.43080353*360.0
 Parameter: ZPHI <- "155.089271"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.9793484"
 Parameter: YPOS -> "-9.59047198"
 Parameter: ZPOS -> "-27.1691117"
 Parameter: XPHI -> "251.556507"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.316369   -0.948636
    0.000000    0.948636   -0.316369

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  108.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.9793484"
 Parameter: YPOS -> "-9.59047198"
 Parameter: ZPOS -> "-27.1691117"
 Parameter: YPHI -> "291.334573"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.363813    0.000000    0.931472
    0.000000    1.000000    0.000000
   -0.931472    0.000000    0.363813

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   68.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.9793484"
 Parameter: YPOS -> "-9.59047198"
 Parameter: ZPOS -> "-27.1691117"
 Parameter: ZPHI -> "155.089271"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.906965    0.421206    0.000000
   -0.421206   -0.906965    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  155.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.979348 XMAX =  -16.979348 XAVE =  -16.979348
    YMIN =   -9.590472 YMAX =   -9.590472 YAVE =   -9.590472
    ZMIN =  -27.169112 ZMAX =  -27.169112 ZAVE =  -27.169112
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.9793484"
Evaluating: -16.9793484+3.5
 Parameter: XMAX <- "-13.4793484"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.59047198"
Evaluating: -9.59047198+3.5
 Parameter: YMAX <- "-6.09047198"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.1691117"
Evaluating: -27.1691117+3.5
 Parameter: ZMAX <- "-23.6691117"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.9793484"
Evaluating: -16.9793484-3.5
 Parameter: XMIN <- "-20.4793484"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.59047198"
Evaluating: -9.59047198-3.5
 Parameter: YMIN <- "-13.090472"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.1691117"
Evaluating: -27.1691117-3.5
 Parameter: ZMIN <- "-30.6691117"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.4793484"
 Parameter: XMIN -> "-20.4793484"
 Parameter: YMAX -> "-6.09047198"
 Parameter: YMIN -> "-13.090472"
 Parameter: ZMAX -> "-23.6691117"
 Parameter: ZMIN -> "-30.6691117"
 SELRPN>     42 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     22 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64440 POS      SOD      25       SOD     -5095 PROA     PHE      350      O             3.6904
64440 POS      SOD      25       SOD     -5098 PROA     GLN      351      CA            4.2839
64440 POS      SOD      25       SOD     -5111 PROA     GLN      351      C             3.0824
64440 POS      SOD      25       SOD     -5112 PROA     GLN      351      O             2.5178
64440 POS      SOD      25       SOD     -5113 PROA     LYS      352      N             3.2788
64440 POS      SOD      25       SOD     -5115 PROA     LYS      352      CA            2.9664
64440 POS      SOD      25       SOD     -5117 PROA     LYS      352      CB            4.1439
64440 POS      SOD      25       SOD     -5133 PROA     LYS      352      C             1.7522
64440 POS      SOD      25       SOD     -5134 PROA     LYS      352      O             1.8430
64440 POS      SOD      25       SOD     -5135 PROA     LEU      353      N             1.7990
64440 POS      SOD      25       SOD     -5137 PROA     LEU      353      CA            2.0551
64440 POS      SOD      25       SOD     -5139 PROA     LEU      353      CB            3.4564
64440 POS      SOD      25       SOD     -5152 PROA     LEU      353      C             1.8054
64440 POS      SOD      25       SOD     -5153 PROA     LEU      353      O             2.7441
64440 POS      SOD      25       SOD     -5154 PROA     ARG      354      N             1.8516
64440 POS      SOD      25       SOD     -5156 PROA     ARG      354      CA            2.9560
64440 POS      SOD      25       SOD     -5158 PROA     ARG      354      CB            3.9354
64440 POS      SOD      25       SOD     -5176 PROA     ARG      354      C             3.1569
64440 POS      SOD      25       SOD     -5177 PROA     ARG      354      O             4.1917
64440 POS      SOD      25       SOD     -5178 PROA     GLU      355      N             2.8130
64440 POS      SOD      25       SOD     -5180 PROA     GLU      355      CA            3.9206
64440 POS      SOD      25       SOD     -5182 PROA     GLU      355      CB            4.3020
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        22
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "22"
 Comparing "22" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "25" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.381122958"
Evaluating: 125.050557*(0.381122958-0.5)
 Parameter: XPOS <- "-14.8656403"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.495568699"
Evaluating: 125.050557*(0.495568699-0.5)
 Parameter: YPOS <- "-0.554136658"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.156553196"
Evaluating: 152.572525*(0.156553196-0.5)+-4.51585405
 Parameter: ZPOS <- "-56.9164001"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.9164001" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.979348 XMAX =  -16.979348 XAVE =  -16.979348
    YMIN =   -9.590472 YMAX =   -9.590472 YAVE =   -9.590472
    ZMIN =  -27.169112 ZMAX =  -27.169112 ZAVE =  -27.169112
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.8656403"
 RDCMND substituted energy or value "?XAVE" to "-16.9793484"
Evaluating: -14.8656403--16.9793484
 Parameter: XTRAN <- "2.1137081"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.554136658"
 RDCMND substituted energy or value "?YAVE" to "-9.59047198"
Evaluating: -0.554136658--9.59047198
 Parameter: YTRAN <- "9.03633532"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.9164001"
 RDCMND substituted energy or value "?ZAVE" to "-27.1691117"
Evaluating: -56.9164001--27.1691117
 Parameter: ZTRAN <- "-29.7472884"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.1137081"
 Parameter: YTRAN -> "9.03633532"
 Parameter: ZTRAN -> "-29.7472884"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     2.113708    9.036335  -29.747288
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.97591344"
Evaluating: 0.97591344*360.0
 Parameter: XPHI <- "351.328838"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.372291628"
Evaluating: 0.372291628*360.0
 Parameter: YPHI <- "134.024986"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.423969116"
Evaluating: 0.423969116*360.0
 Parameter: ZPHI <- "152.628882"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.8656403"
 Parameter: YPOS -> "-0.554136658"
 Parameter: ZPOS -> "-56.9164001"
 Parameter: XPHI -> "351.328838"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.988570   -0.150763
    0.000000    0.150763    0.988570

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    8.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.8656403"
 Parameter: YPOS -> "-0.554136658"
 Parameter: ZPOS -> "-56.9164001"
 Parameter: YPHI -> "134.024986"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.694972    0.000000   -0.719037
    0.000000    1.000000    0.000000
    0.719037    0.000000   -0.694972

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  134.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.8656403"
 Parameter: YPOS -> "-0.554136658"
 Parameter: ZPOS -> "-56.9164001"
 Parameter: ZPHI -> "152.628882"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.888047    0.459752    0.000000
   -0.459752   -0.888047    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  152.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.865640 XMAX =  -14.865640 XAVE =  -14.865640
    YMIN =   -0.554137 YMAX =   -0.554137 YAVE =   -0.554137
    ZMIN =  -56.916400 ZMAX =  -56.916400 ZAVE =  -56.916400
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.8656403"
Evaluating: -14.8656403+3.5
 Parameter: XMAX <- "-11.3656403"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.554136656"
Evaluating: -0.554136656+3.5
 Parameter: YMAX <- "2.94586334"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.9164001"
Evaluating: -56.9164001+3.5
 Parameter: ZMAX <- "-53.4164001"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.8656403"
Evaluating: -14.8656403-3.5
 Parameter: XMIN <- "-18.3656403"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.554136656"
Evaluating: -0.554136656-3.5
 Parameter: YMIN <- "-4.05413666"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.9164001"
Evaluating: -56.9164001-3.5
 Parameter: ZMIN <- "-60.4164001"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.3656403"
 Parameter: XMIN -> "-18.3656403"
 Parameter: YMAX -> "2.94586334"
 Parameter: YMIN -> "-4.05413666"
 Parameter: ZMAX -> "-53.4164001"
 Parameter: ZMIN -> "-60.4164001"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "26" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "26" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.945419882E-02"
Evaluating: 125.050557*(9.945419882E-02-0.5)
 Parameter: XPOS <- "-50.0884755"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "7.175893986E-02"
Evaluating: 125.050557*(7.175893986E-02-0.5)
 Parameter: YPOS <- "-53.5517831"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.460460277"
Evaluating: 152.572525*(0.460460277-0.5)+-4.51585405
 Parameter: ZPOS <- "-10.5485294"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.5485294" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.5485294" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "26" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.227974157"
Evaluating: 125.050557*(0.227974157-0.5)
 Parameter: XPOS <- "-34.0169832"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.860020389"
Evaluating: 125.050557*(0.860020389-0.5)
 Parameter: YPOS <- "45.0207502"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.740888746"
Evaluating: 152.572525*(0.740888746-0.5)+-4.51585405
 Parameter: ZPOS <- "32.2371502"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.2371502" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.2371502" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.0169832"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.0169832-0
 Parameter: XTRAN <- "-34.0169832"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.0207502"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 45.0207502-0
 Parameter: YTRAN <- "45.0207502"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.2371502"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.2371502-0
 Parameter: ZTRAN <- "32.2371502"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.0169832"
 Parameter: YTRAN -> "45.0207502"
 Parameter: ZTRAN -> "32.2371502"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -34.016983   45.020750   32.237150
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.216412893"
Evaluating: 0.216412893*360.0
 Parameter: XPHI <- "77.9086415"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.612724911"
Evaluating: 0.612724911*360.0
 Parameter: YPHI <- "220.580968"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.324218968"
Evaluating: 0.324218968*360.0
 Parameter: ZPHI <- "116.718828"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.0169832"
 Parameter: YPOS -> "45.0207502"
 Parameter: ZPOS -> "32.2371502"
 Parameter: XPHI -> "77.9086415"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.209471    0.977815
    0.000000   -0.977815    0.209471

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   77.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.0169832"
 Parameter: YPOS -> "45.0207502"
 Parameter: ZPOS -> "32.2371502"
 Parameter: YPHI -> "220.580968"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.759487    0.000000    0.650522
    0.000000    1.000000    0.000000
   -0.650522    0.000000   -0.759487

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  139.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.0169832"
 Parameter: YPOS -> "45.0207502"
 Parameter: ZPOS -> "32.2371502"
 Parameter: ZPHI -> "116.718828"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.449613    0.893224    0.000000
   -0.893224   -0.449613    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  116.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.016983 XMAX =  -34.016983 XAVE =  -34.016983
    YMIN =   45.020750 YMAX =   45.020750 YAVE =   45.020750
    ZMIN =   32.237150 ZMAX =   32.237150 ZAVE =   32.237150
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.0169832"
Evaluating: -34.0169832+3.5
 Parameter: XMAX <- "-30.5169832"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.0207502"
Evaluating: 45.0207502+3.5
 Parameter: YMAX <- "48.5207502"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.2371502"
Evaluating: 32.2371502+3.5
 Parameter: ZMAX <- "35.7371502"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.0169832"
Evaluating: -34.0169832-3.5
 Parameter: XMIN <- "-37.5169832"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.0207502"
Evaluating: 45.0207502-3.5
 Parameter: YMIN <- "41.5207502"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.2371502"
Evaluating: 32.2371502-3.5
 Parameter: ZMIN <- "28.7371502"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.5169832"
 Parameter: XMIN -> "-37.5169832"
 Parameter: YMAX -> "48.5207502"
 Parameter: YMIN -> "41.5207502"
 Parameter: ZMAX -> "35.7371502"
 Parameter: ZMIN -> "28.7371502"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "27" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "27" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.281401576"
Evaluating: 125.050557*(0.281401576-0.5)
 Parameter: XPOS <- "-27.3358547"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.880285134"
Evaluating: 125.050557*(0.880285134-0.5)
 Parameter: YPOS <- "47.5548678"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "8.471022206E-02"
Evaluating: 152.572525*(8.471022206E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-67.8776641"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-67.8776641" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.3358547"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.3358547-0
 Parameter: XTRAN <- "-27.3358547"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "47.5548678"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 47.5548678-0
 Parameter: YTRAN <- "47.5548678"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-67.8776641"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -67.8776641-0
 Parameter: ZTRAN <- "-67.8776641"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.3358547"
 Parameter: YTRAN -> "47.5548678"
 Parameter: ZTRAN -> "-67.8776641"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -27.335855   47.554868  -67.877664
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.198913915"
Evaluating: 0.198913915*360.0
 Parameter: XPHI <- "71.6090094"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.598974629"
Evaluating: 0.598974629*360.0
 Parameter: YPHI <- "215.630866"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.808853914"
Evaluating: 0.808853914*360.0
 Parameter: ZPHI <- "291.187409"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.3358547"
 Parameter: YPOS -> "47.5548678"
 Parameter: ZPOS -> "-67.8776641"
 Parameter: XPHI -> "71.6090094"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.315500    0.948926
    0.000000   -0.948926    0.315500

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   71.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.3358547"
 Parameter: YPOS -> "47.5548678"
 Parameter: ZPOS -> "-67.8776641"
 Parameter: YPHI -> "215.630866"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.812787    0.000000    0.582561
    0.000000    1.000000    0.000000
   -0.582561    0.000000   -0.812787

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  144.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.3358547"
 Parameter: YPOS -> "47.5548678"
 Parameter: ZPOS -> "-67.8776641"
 Parameter: ZPHI -> "291.187409"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.361420   -0.932403    0.000000
    0.932403    0.361420    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.335855 XMAX =  -27.335855 XAVE =  -27.335855
    YMIN =   47.554868 YMAX =   47.554868 YAVE =   47.554868
    ZMIN =  -67.877664 ZMAX =  -67.877664 ZAVE =  -67.877664
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.3358547"
Evaluating: -27.3358547+3.5
 Parameter: XMAX <- "-23.8358547"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "47.5548678"
Evaluating: 47.5548678+3.5
 Parameter: YMAX <- "51.0548678"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-67.8776641"
Evaluating: -67.8776641+3.5
 Parameter: ZMAX <- "-64.3776641"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.3358547"
Evaluating: -27.3358547-3.5
 Parameter: XMIN <- "-30.8358547"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "47.5548678"
Evaluating: 47.5548678-3.5
 Parameter: YMIN <- "44.0548678"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-67.8776641"
Evaluating: -67.8776641-3.5
 Parameter: ZMIN <- "-71.3776641"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.8358547"
 Parameter: XMIN -> "-30.8358547"
 Parameter: YMAX -> "51.0548678"
 Parameter: YMIN -> "44.0548678"
 Parameter: ZMAX -> "-64.3776641"
 Parameter: ZMIN -> "-71.3776641"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "28" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "28" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "6.218388297E-02"
Evaluating: 125.050557*(6.218388297E-02-0.5)
 Parameter: XPOS <- "-54.7491493"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.222915625"
Evaluating: 125.050557*(0.222915625-0.5)
 Parameter: YPOS <- "-34.6495554"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.192723735"
Evaluating: 152.572525*(0.192723735-0.5)+-4.51585405
 Parameter: ZPOS <- "-51.3977697"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.3977697" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-54.7491493"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -54.7491493-0
 Parameter: XTRAN <- "-54.7491493"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.6495554"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.6495554-0
 Parameter: YTRAN <- "-34.6495554"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.3977697"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.3977697-0
 Parameter: ZTRAN <- "-51.3977697"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-54.7491493"
 Parameter: YTRAN -> "-34.6495554"
 Parameter: ZTRAN -> "-51.3977697"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -54.749149  -34.649555  -51.397770
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.466711608"
Evaluating: 0.466711608*360.0
 Parameter: XPHI <- "168.016179"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.568024004"
Evaluating: 0.568024004*360.0
 Parameter: YPHI <- "204.488641"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.602424082"
Evaluating: 0.602424082*360.0
 Parameter: ZPHI <- "216.87267"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-54.7491493"
 Parameter: YPOS -> "-34.6495554"
 Parameter: ZPOS -> "-51.3977697"
 Parameter: XPHI -> "168.016179"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.978206    0.207635
    0.000000   -0.207635   -0.978206

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  168.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-54.7491493"
 Parameter: YPOS -> "-34.6495554"
 Parameter: ZPOS -> "-51.3977697"
 Parameter: YPHI -> "204.488641"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.910043    0.000000    0.414513
    0.000000    1.000000    0.000000
   -0.414513    0.000000   -0.910043

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  155.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-54.7491493"
 Parameter: YPOS -> "-34.6495554"
 Parameter: ZPOS -> "-51.3977697"
 Parameter: ZPHI -> "216.87267"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.799971   -0.600039    0.000000
    0.600039   -0.799971    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  143.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -54.749149 XMAX =  -54.749149 XAVE =  -54.749149
    YMIN =  -34.649555 YMAX =  -34.649555 YAVE =  -34.649555
    ZMIN =  -51.397770 ZMAX =  -51.397770 ZAVE =  -51.397770
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-54.7491493"
Evaluating: -54.7491493+3.5
 Parameter: XMAX <- "-51.2491493"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.6495554"
Evaluating: -34.6495554+3.5
 Parameter: YMAX <- "-31.1495554"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.3977697"
Evaluating: -51.3977697+3.5
 Parameter: ZMAX <- "-47.8977697"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-54.7491493"
Evaluating: -54.7491493-3.5
 Parameter: XMIN <- "-58.2491493"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.6495554"
Evaluating: -34.6495554-3.5
 Parameter: YMIN <- "-38.1495554"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.3977697"
Evaluating: -51.3977697-3.5
 Parameter: ZMIN <- "-54.8977697"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-51.2491493"
 Parameter: XMIN -> "-58.2491493"
 Parameter: YMAX -> "-31.1495554"
 Parameter: YMIN -> "-38.1495554"
 Parameter: ZMAX -> "-47.8977697"
 Parameter: ZMIN -> "-54.8977697"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "29" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "29" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.257771426"
Evaluating: 125.050557*(0.257771426-0.5)
 Parameter: XPOS <- "-30.2908181"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.867165877"
Evaluating: 125.050557*(0.867165877-0.5)
 Parameter: YPOS <- "45.9142974"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.645723392"
Evaluating: 152.572525*(0.645723392-0.5)+-4.51585405
 Parameter: ZPOS <- "17.7175318"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.7175318" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.7175318" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.2908181"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.2908181-0
 Parameter: XTRAN <- "-30.2908181"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.9142974"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 45.9142974-0
 Parameter: YTRAN <- "45.9142974"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.7175318"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.7175318-0
 Parameter: ZTRAN <- "17.7175318"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.2908181"
 Parameter: YTRAN -> "45.9142974"
 Parameter: ZTRAN -> "17.7175318"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -30.290818   45.914297   17.717532
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.639403848"
Evaluating: 0.639403848*360.0
 Parameter: XPHI <- "230.185385"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.375965028"
Evaluating: 0.375965028*360.0
 Parameter: YPHI <- "135.34741"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.529800024"
Evaluating: 0.529800024*360.0
 Parameter: ZPHI <- "190.728009"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.2908181"
 Parameter: YPOS -> "45.9142974"
 Parameter: ZPOS -> "17.7175318"
 Parameter: XPHI -> "230.185385"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.640306   -0.768120
    0.000000    0.768120   -0.640306

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.2908181"
 Parameter: YPOS -> "45.9142974"
 Parameter: ZPOS -> "17.7175318"
 Parameter: YPHI -> "135.34741"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.711381    0.000000   -0.702806
    0.000000    1.000000    0.000000
    0.702806    0.000000   -0.711381

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  135.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.2908181"
 Parameter: YPOS -> "45.9142974"
 Parameter: ZPOS -> "17.7175318"
 Parameter: ZPHI -> "190.728009"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.982522   -0.186147    0.000000
    0.186147   -0.982522    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  169.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.290818 XMAX =  -30.290818 XAVE =  -30.290818
    YMIN =   45.914297 YMAX =   45.914297 YAVE =   45.914297
    ZMIN =   17.717532 ZMAX =   17.717532 ZAVE =   17.717532
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.2908181"
Evaluating: -30.2908181+3.5
 Parameter: XMAX <- "-26.7908181"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.9142974"
Evaluating: 45.9142974+3.5
 Parameter: YMAX <- "49.4142974"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.7175318"
Evaluating: 17.7175318+3.5
 Parameter: ZMAX <- "21.2175318"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.2908181"
Evaluating: -30.2908181-3.5
 Parameter: XMIN <- "-33.7908181"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.9142974"
Evaluating: 45.9142974-3.5
 Parameter: YMIN <- "42.4142974"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.7175318"
Evaluating: 17.7175318-3.5
 Parameter: ZMIN <- "14.2175318"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.7908181"
 Parameter: XMIN -> "-33.7908181"
 Parameter: YMAX -> "49.4142974"
 Parameter: YMIN -> "42.4142974"
 Parameter: ZMAX -> "21.2175318"
 Parameter: ZMIN -> "14.2175318"
 SELRPN>     13 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      7 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64444 POS      SOD      29       SOD     -**** MEMB     POPC     96       P             3.3209
64444 POS      SOD      29       SOD     -**** MEMB     POPC     96       O14           2.5572
64444 POS      SOD      29       SOD     -**** MEMB     POPC     96       O12           3.1876
64444 POS      SOD      29       SOD     -**** MEMB     POPC     96       O11           3.6224
64444 POS      SOD      29       SOD     -**** MEMB     POPC     96       C2            3.5005
64444 POS      SOD      29       SOD     -**** MEMB     POPC     96       O21           3.7475
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "29" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.181325859"
Evaluating: 125.050557*(0.181325859-0.5)
 Parameter: XPOS <- "-39.8503788"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.968912881"
Evaluating: 125.050557*(0.968912881-0.5)
 Parameter: YPOS <- "58.637817"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.518047569"
Evaluating: 152.572525*(0.518047569-0.5)+-4.51585405
 Parameter: ZPOS <- "-1.76229088"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.76229088" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.76229088" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "29" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.984649621"
Evaluating: 125.050557*(0.984649621-0.5)
 Parameter: XPOS <- "60.6057051"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.709048266"
Evaluating: 125.050557*(0.709048266-0.5)
 Parameter: YPOS <- "26.1416021"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.2372973"
Evaluating: 152.572525*(0.2372973-0.5)+-4.51585405
 Parameter: ZPOS <- "-44.5970683"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.5970683" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.290818 XMAX =  -30.290818 XAVE =  -30.290818
    YMIN =   45.914297 YMAX =   45.914297 YAVE =   45.914297
    ZMIN =   17.717532 ZMAX =   17.717532 ZAVE =   17.717532
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "60.6057051"
 RDCMND substituted energy or value "?XAVE" to "-30.2908181"
Evaluating: 60.6057051--30.2908181
 Parameter: XTRAN <- "90.8965232"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.1416021"
 RDCMND substituted energy or value "?YAVE" to "45.9142974"
Evaluating: 26.1416021-45.9142974
 Parameter: YTRAN <- "-19.7726953"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.5970683"
 RDCMND substituted energy or value "?ZAVE" to "17.7175318"
Evaluating: -44.5970683-17.7175318
 Parameter: ZTRAN <- "-62.3146001"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "90.8965232"
 Parameter: YTRAN -> "-19.7726953"
 Parameter: ZTRAN -> "-62.3146001"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    90.896523  -19.772695  -62.314600
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.880935177"
Evaluating: 0.880935177*360.0
 Parameter: XPHI <- "317.136664"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.394581325E-02"
Evaluating: 1.394581325E-02*360.0
 Parameter: YPHI <- "5.02049277"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.541837613"
Evaluating: 0.541837613*360.0
 Parameter: ZPHI <- "195.061541"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "60.6057051"
 Parameter: YPOS -> "26.1416021"
 Parameter: ZPOS -> "-44.5970683"
 Parameter: XPHI -> "317.136664"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.732978   -0.680252
    0.000000    0.680252    0.732978

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   42.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "60.6057051"
 Parameter: YPOS -> "26.1416021"
 Parameter: ZPOS -> "-44.5970683"
 Parameter: YPHI -> "5.02049277"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.996163    0.000000   -0.087512
    0.000000    1.000000    0.000000
    0.087512    0.000000    0.996163

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    5.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "60.6057051"
 Parameter: YPOS -> "26.1416021"
 Parameter: ZPOS -> "-44.5970683"
 Parameter: ZPHI -> "195.061541"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.965647   -0.259856    0.000000
    0.259856   -0.965647    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  164.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   60.605705 XMAX =   60.605705 XAVE =   60.605705
    YMIN =   26.141602 YMAX =   26.141602 YAVE =   26.141602
    ZMIN =  -44.597068 ZMAX =  -44.597068 ZAVE =  -44.597068
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "60.6057051"
Evaluating: 60.6057051+3.5
 Parameter: XMAX <- "64.1057051"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.1416021"
Evaluating: 26.1416021+3.5
 Parameter: YMAX <- "29.6416021"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.5970683"
Evaluating: -44.5970683+3.5
 Parameter: ZMAX <- "-41.0970683"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "60.6057051"
Evaluating: 60.6057051-3.5
 Parameter: XMIN <- "57.1057051"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.1416021"
Evaluating: 26.1416021-3.5
 Parameter: YMIN <- "22.6416021"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.5970683"
Evaluating: -44.5970683-3.5
 Parameter: ZMIN <- "-48.0970683"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "64.1057051"
 Parameter: XMIN -> "57.1057051"
 Parameter: YMAX -> "29.6416021"
 Parameter: YMIN -> "22.6416021"
 Parameter: ZMAX -> "-41.0970683"
 Parameter: ZMIN -> "-48.0970683"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "30" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "30" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.867867233"
Evaluating: 125.050557*(0.867867233-0.5)
 Parameter: XPOS <- "46.0020024"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.952597185"
Evaluating: 125.050557*(0.952597185-0.5)
 Parameter: YPOS <- "56.5975301"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.818524808"
Evaluating: 152.572525*(0.818524808-0.5)+-4.51585405
 Parameter: ZPOS <- "44.0822802"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.0822802" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.0822802" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.0020024"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.0020024-0
 Parameter: XTRAN <- "46.0020024"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "56.5975301"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 56.5975301-0
 Parameter: YTRAN <- "56.5975301"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.0822802"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.0822802-0
 Parameter: ZTRAN <- "44.0822802"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.0020024"
 Parameter: YTRAN -> "56.5975301"
 Parameter: ZTRAN -> "44.0822802"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    46.002002   56.597530   44.082280
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.549583005"
Evaluating: 0.549583005*360.0
 Parameter: XPHI <- "197.849882"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.97809352"
Evaluating: 0.97809352*360.0
 Parameter: YPHI <- "352.113667"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.521317741"
Evaluating: 0.521317741*360.0
 Parameter: ZPHI <- "187.674387"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.0020024"
 Parameter: YPOS -> "56.5975301"
 Parameter: ZPOS -> "44.0822802"
 Parameter: XPHI -> "197.849882"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.951863   -0.306524
    0.000000    0.306524   -0.951863

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.0020024"
 Parameter: YPOS -> "56.5975301"
 Parameter: ZPOS -> "44.0822802"
 Parameter: YPHI -> "352.113667"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.990542    0.000000    0.137208
    0.000000    1.000000    0.000000
   -0.137208    0.000000    0.990542

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    7.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.0020024"
 Parameter: YPOS -> "56.5975301"
 Parameter: ZPOS -> "44.0822802"
 Parameter: ZPHI -> "187.674387"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.991043   -0.133543    0.000000
    0.133543   -0.991043    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  172.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.002002 XMAX =   46.002002 XAVE =   46.002002
    YMIN =   56.597530 YMAX =   56.597530 YAVE =   56.597530
    ZMIN =   44.082280 ZMAX =   44.082280 ZAVE =   44.082280
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.0020024"
Evaluating: 46.0020024+3.5
 Parameter: XMAX <- "49.5020024"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "56.5975301"
Evaluating: 56.5975301+3.5
 Parameter: YMAX <- "60.0975301"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.0822802"
Evaluating: 44.0822802+3.5
 Parameter: ZMAX <- "47.5822802"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.0020024"
Evaluating: 46.0020024-3.5
 Parameter: XMIN <- "42.5020024"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "56.5975301"
Evaluating: 56.5975301-3.5
 Parameter: YMIN <- "53.0975301"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.0822802"
Evaluating: 44.0822802-3.5
 Parameter: ZMIN <- "40.5822802"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.5020024"
 Parameter: XMIN -> "42.5020024"
 Parameter: YMAX -> "60.0975301"
 Parameter: YMIN -> "53.0975301"
 Parameter: ZMAX -> "47.5822802"
 Parameter: ZMIN -> "40.5822802"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "31" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "31" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.794285978"
Evaluating: 125.050557*(0.794285978-0.5)
 Parameter: XPOS <- "36.8006255"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.474117166"
Evaluating: 125.050557*(0.474117166-0.5)
 Parameter: YPOS <- "-3.23666281"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.908594991"
Evaluating: 152.572525*(0.908594991-0.5)+-4.51585405
 Parameter: ZPOS <- "57.8245154"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.8245154" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.8245154" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.8006255"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.8006255-0
 Parameter: XTRAN <- "36.8006255"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.23666281"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -3.23666281-0
 Parameter: YTRAN <- "-3.23666281"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.8245154"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.8245154-0
 Parameter: ZTRAN <- "57.8245154"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.8006255"
 Parameter: YTRAN -> "-3.23666281"
 Parameter: ZTRAN -> "57.8245154"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    36.800626   -3.236663   57.824515
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.903574883"
Evaluating: 0.903574883*360.0
 Parameter: XPHI <- "325.286958"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.423359016"
Evaluating: 0.423359016*360.0
 Parameter: YPHI <- "152.409246"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.383794681"
Evaluating: 0.383794681*360.0
 Parameter: ZPHI <- "138.166085"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.8006255"
 Parameter: YPOS -> "-3.23666281"
 Parameter: ZPOS -> "57.8245154"
 Parameter: XPHI -> "325.286958"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.822014   -0.569467
    0.000000    0.569467    0.822014

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   34.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.8006255"
 Parameter: YPOS -> "-3.23666281"
 Parameter: ZPOS -> "57.8245154"
 Parameter: YPHI -> "152.409246"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.886278    0.000000   -0.463153
    0.000000    1.000000    0.000000
    0.463153    0.000000   -0.886278

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  152.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.8006255"
 Parameter: YPOS -> "-3.23666281"
 Parameter: ZPOS -> "57.8245154"
 Parameter: ZPHI -> "138.166085"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.745081    0.666974    0.000000
   -0.666974   -0.745081    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  138.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.800626 XMAX =   36.800626 XAVE =   36.800626
    YMIN =   -3.236663 YMAX =   -3.236663 YAVE =   -3.236663
    ZMIN =   57.824515 ZMAX =   57.824515 ZAVE =   57.824515
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.8006255"
Evaluating: 36.8006255+3.5
 Parameter: XMAX <- "40.3006255"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.23666281"
Evaluating: -3.23666281+3.5
 Parameter: YMAX <- "0.26333719"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.8245154"
Evaluating: 57.8245154+3.5
 Parameter: ZMAX <- "61.3245154"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.8006255"
Evaluating: 36.8006255-3.5
 Parameter: XMIN <- "33.3006255"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.23666281"
Evaluating: -3.23666281-3.5
 Parameter: YMIN <- "-6.73666281"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.8245154"
Evaluating: 57.8245154-3.5
 Parameter: ZMIN <- "54.3245154"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.3006255"
 Parameter: XMIN -> "33.3006255"
 Parameter: YMAX -> "0.26333719"
 Parameter: YMIN -> "-6.73666281"
 Parameter: ZMAX -> "61.3245154"
 Parameter: ZMIN -> "54.3245154"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "32" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "32" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.256869168"
Evaluating: 125.050557*(0.256869168-0.5)
 Parameter: XPOS <- "-30.403646"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "5.179504763E-02"
Evaluating: 125.050557*(5.179504763E-02-0.5)
 Parameter: YPOS <- "-56.0482789"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.570472118"
Evaluating: 152.572525*(0.570472118-0.5)+-4.51585405
 Parameter: ZPOS <- "6.23625494"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.23625494" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.23625494" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "32" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "4.311605794E-02"
Evaluating: 125.050557*(4.311605794E-02-0.5)
 Parameter: XPOS <- "-57.1335914"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.389153733"
Evaluating: 125.050557*(0.389153733-0.5)
 Parameter: YPOS <- "-13.8613874"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.599665801"
Evaluating: 152.572525*(0.599665801-0.5)+-4.51585405
 Parameter: ZPOS <- "10.6904089"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.6904089" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.6904089" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "32" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "3.201163341E-02"
Evaluating: 125.050557*(3.201163341E-02-0.5)
 Parameter: XPOS <- "-58.5222059"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.823417979"
Evaluating: 125.050557*(0.823417979-0.5)
 Parameter: YPOS <- "40.4435984"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.271771724"
Evaluating: 152.572525*(0.271771724-0.5)+-4.51585405
 Parameter: ZPOS <- "-39.3372184"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.3372184" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-58.5222059"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -58.5222059-0
 Parameter: XTRAN <- "-58.5222059"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "40.4435984"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 40.4435984-0
 Parameter: YTRAN <- "40.4435984"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.3372184"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.3372184-0
 Parameter: ZTRAN <- "-39.3372184"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.5222059"
 Parameter: YTRAN -> "40.4435984"
 Parameter: ZTRAN -> "-39.3372184"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -58.522206   40.443598  -39.337218
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.560074041"
Evaluating: 0.560074041*360.0
 Parameter: XPHI <- "201.626655"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.880638284"
Evaluating: 0.880638284*360.0
 Parameter: YPHI <- "317.029782"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950502882"
Evaluating: 0.950502882*360.0
 Parameter: ZPHI <- "342.181038"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-58.5222059"
 Parameter: YPOS -> "40.4435984"
 Parameter: ZPOS -> "-39.3372184"
 Parameter: XPHI -> "201.626655"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.929605   -0.368557
    0.000000    0.368557   -0.929605

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  158.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-58.5222059"
 Parameter: YPOS -> "40.4435984"
 Parameter: ZPOS -> "-39.3372184"
 Parameter: YPHI -> "317.029782"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.731708    0.000000    0.681618
    0.000000    1.000000    0.000000
   -0.681618    0.000000    0.731708

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   42.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-58.5222059"
 Parameter: YPOS -> "40.4435984"
 Parameter: ZPOS -> "-39.3372184"
 Parameter: ZPHI -> "342.181038"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.952028   -0.306010    0.000000
    0.306010    0.952028    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   17.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -58.522206 XMAX =  -58.522206 XAVE =  -58.522206
    YMIN =   40.443598 YMAX =   40.443598 YAVE =   40.443598
    ZMIN =  -39.337218 ZMAX =  -39.337218 ZAVE =  -39.337218
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-58.5222059"
Evaluating: -58.5222059+3.5
 Parameter: XMAX <- "-55.0222059"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "40.4435984"
Evaluating: 40.4435984+3.5
 Parameter: YMAX <- "43.9435984"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.3372184"
Evaluating: -39.3372184+3.5
 Parameter: ZMAX <- "-35.8372184"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-58.5222059"
Evaluating: -58.5222059-3.5
 Parameter: XMIN <- "-62.0222059"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "40.4435984"
Evaluating: 40.4435984-3.5
 Parameter: YMIN <- "36.9435984"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.3372184"
Evaluating: -39.3372184-3.5
 Parameter: ZMIN <- "-42.8372184"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-55.0222059"
 Parameter: XMIN -> "-62.0222059"
 Parameter: YMAX -> "43.9435984"
 Parameter: YMIN -> "36.9435984"
 Parameter: ZMAX -> "-35.8372184"
 Parameter: ZMIN -> "-42.8372184"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "33" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "33" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.349509226"
Evaluating: 125.050557*(0.349509226-0.5)
 Parameter: XPOS <- "-18.8189551"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.404632395"
Evaluating: 125.050557*(0.404632395-0.5)
 Parameter: YPOS <- "-11.9257721"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.580776739"
Evaluating: 152.572525*(0.580776739-0.5)+-4.51585405
 Parameter: ZPOS <- "7.80845698"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.80845698" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.80845698" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "33" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.298677315"
Evaluating: 125.050557*(0.298677315-0.5)
 Parameter: XPOS <- "-25.1755139"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.115220415E-02"
Evaluating: 125.050557*(9.115220415E-02-0.5)
 Parameter: YPOS <- "-51.1266446"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.31319676"
Evaluating: 152.572525*(0.31319676-0.5)+-4.51585405
 Parameter: ZPOS <- "-33.0168961"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.0168961" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.1755139"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.1755139-0
 Parameter: XTRAN <- "-25.1755139"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-51.1266446"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -51.1266446-0
 Parameter: YTRAN <- "-51.1266446"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.0168961"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.0168961-0
 Parameter: ZTRAN <- "-33.0168961"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.1755139"
 Parameter: YTRAN -> "-51.1266446"
 Parameter: ZTRAN -> "-33.0168961"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -25.175514  -51.126645  -33.016896
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.66476138"
Evaluating: 0.66476138*360.0
 Parameter: XPHI <- "239.314097"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.989276509"
Evaluating: 0.989276509*360.0
 Parameter: YPHI <- "356.139543"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.37702328"
Evaluating: 0.37702328*360.0
 Parameter: ZPHI <- "135.728381"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.1755139"
 Parameter: YPOS -> "-51.1266446"
 Parameter: ZPOS -> "-33.0168961"
 Parameter: XPHI -> "239.314097"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.510331   -0.859978
    0.000000    0.859978   -0.510331

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  120.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.1755139"
 Parameter: YPOS -> "-51.1266446"
 Parameter: ZPOS -> "-33.0168961"
 Parameter: YPHI -> "356.139543"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.997731    0.000000    0.067327
    0.000000    1.000000    0.000000
   -0.067327    0.000000    0.997731

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    3.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.1755139"
 Parameter: YPOS -> "-51.1266446"
 Parameter: ZPOS -> "-33.0168961"
 Parameter: ZPHI -> "135.728381"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.716039    0.698061    0.000000
   -0.698061   -0.716039    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  135.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.175514 XMAX =  -25.175514 XAVE =  -25.175514
    YMIN =  -51.126645 YMAX =  -51.126645 YAVE =  -51.126645
    ZMIN =  -33.016896 ZMAX =  -33.016896 ZAVE =  -33.016896
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.1755139"
Evaluating: -25.1755139+3.5
 Parameter: XMAX <- "-21.6755139"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-51.1266446"
Evaluating: -51.1266446+3.5
 Parameter: YMAX <- "-47.6266446"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.0168961"
Evaluating: -33.0168961+3.5
 Parameter: ZMAX <- "-29.5168961"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.1755139"
Evaluating: -25.1755139-3.5
 Parameter: XMIN <- "-28.6755139"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-51.1266446"
Evaluating: -51.1266446-3.5
 Parameter: YMIN <- "-54.6266446"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.0168961"
Evaluating: -33.0168961-3.5
 Parameter: ZMIN <- "-36.5168961"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.6755139"
 Parameter: XMIN -> "-28.6755139"
 Parameter: YMAX -> "-47.6266446"
 Parameter: YMIN -> "-54.6266446"
 Parameter: ZMAX -> "-29.5168961"
 Parameter: ZMIN -> "-36.5168961"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "34" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "34" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.663166512"
Evaluating: 125.050557*(0.663166512-0.5)
 Parameter: XPOS <- "20.4040632"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.705510117"
Evaluating: 125.050557*(0.705510117-0.5)
 Parameter: YPOS <- "25.6991546"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.205667573"
Evaluating: 152.572525*(0.205667573-0.5)+-4.51585405
 Parameter: ZPOS <- "-49.4228956"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-49.4228956" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.4040632"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.4040632-0
 Parameter: XTRAN <- "20.4040632"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.6991546"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.6991546-0
 Parameter: YTRAN <- "25.6991546"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-49.4228956"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -49.4228956-0
 Parameter: ZTRAN <- "-49.4228956"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.4040632"
 Parameter: YTRAN -> "25.6991546"
 Parameter: ZTRAN -> "-49.4228956"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    20.404063   25.699155  -49.422896
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.917358002"
Evaluating: 0.917358002*360.0
 Parameter: XPHI <- "330.248881"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.184222454E-02"
Evaluating: 1.184222454E-02*360.0
 Parameter: YPHI <- "4.26320083"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.750497433"
Evaluating: 0.750497433*360.0
 Parameter: ZPHI <- "270.179076"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.4040632"
 Parameter: YPOS -> "25.6991546"
 Parameter: ZPOS -> "-49.4228956"
 Parameter: XPHI -> "330.248881"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.868189   -0.496233
    0.000000    0.496233    0.868189

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   29.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.4040632"
 Parameter: YPOS -> "25.6991546"
 Parameter: ZPOS -> "-49.4228956"
 Parameter: YPHI -> "4.26320083"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.997233    0.000000   -0.074338
    0.000000    1.000000    0.000000
    0.074338    0.000000    0.997233

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    4.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.4040632"
 Parameter: YPOS -> "25.6991546"
 Parameter: ZPOS -> "-49.4228956"
 Parameter: ZPHI -> "270.179076"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.003125   -0.999995    0.000000
    0.999995    0.003125    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   89.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.404063 XMAX =   20.404063 XAVE =   20.404063
    YMIN =   25.699155 YMAX =   25.699155 YAVE =   25.699155
    ZMIN =  -49.422896 ZMAX =  -49.422896 ZAVE =  -49.422896
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.4040632"
Evaluating: 20.4040632+3.5
 Parameter: XMAX <- "23.9040632"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.6991546"
Evaluating: 25.6991546+3.5
 Parameter: YMAX <- "29.1991546"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-49.4228956"
Evaluating: -49.4228956+3.5
 Parameter: ZMAX <- "-45.9228956"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.4040632"
Evaluating: 20.4040632-3.5
 Parameter: XMIN <- "16.9040632"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.6991546"
Evaluating: 25.6991546-3.5
 Parameter: YMIN <- "22.1991546"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-49.4228956"
Evaluating: -49.4228956-3.5
 Parameter: ZMIN <- "-52.9228956"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.9040632"
 Parameter: XMIN -> "16.9040632"
 Parameter: YMAX -> "29.1991546"
 Parameter: YMIN -> "22.1991546"
 Parameter: ZMAX -> "-45.9228956"
 Parameter: ZMIN -> "-52.9228956"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "35" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "35" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.51192235"
Evaluating: 125.050557*(0.51192235-0.5)
 Parameter: XPOS <- "1.49089651"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.831632106"
Evaluating: 125.050557*(0.831632106-0.5)
 Parameter: YPOS <- "41.4707796"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.824356894"
Evaluating: 152.572525*(0.824356894-0.5)+-4.51585405
 Parameter: ZPOS <- "44.9720963"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.9720963" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.9720963" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.49089651"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.49089651-0
 Parameter: XTRAN <- "1.49089651"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.4707796"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.4707796-0
 Parameter: YTRAN <- "41.4707796"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.9720963"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.9720963-0
 Parameter: ZTRAN <- "44.9720963"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.49089651"
 Parameter: YTRAN -> "41.4707796"
 Parameter: ZTRAN -> "44.9720963"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     1.490897   41.470780   44.972096
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.56652155"
Evaluating: 0.56652155*360.0
 Parameter: XPHI <- "203.947758"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.223627275"
Evaluating: 0.223627275*360.0
 Parameter: YPHI <- "80.505819"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.211706519"
Evaluating: 0.211706519*360.0
 Parameter: ZPHI <- "76.2143468"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.49089651"
 Parameter: YPOS -> "41.4707796"
 Parameter: ZPOS -> "44.9720963"
 Parameter: XPHI -> "203.947758"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.913916   -0.405904
    0.000000    0.405904   -0.913916

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  156.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.49089651"
 Parameter: YPOS -> "41.4707796"
 Parameter: ZPOS -> "44.9720963"
 Parameter: YPHI -> "80.505819"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.164947    0.000000   -0.986302
    0.000000    1.000000    0.000000
    0.986302    0.000000    0.164947

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   80.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.49089651"
 Parameter: YPOS -> "41.4707796"
 Parameter: ZPOS -> "44.9720963"
 Parameter: ZPHI -> "76.2143468"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.238290    0.971194    0.000000
   -0.971194    0.238290    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   76.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.490897 XMAX =    1.490897 XAVE =    1.490897
    YMIN =   41.470780 YMAX =   41.470780 YAVE =   41.470780
    ZMIN =   44.972096 ZMAX =   44.972096 ZAVE =   44.972096
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.49089651"
Evaluating: 1.49089651+3.5
 Parameter: XMAX <- "4.99089651"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.4707796"
Evaluating: 41.4707796+3.5
 Parameter: YMAX <- "44.9707796"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.9720963"
Evaluating: 44.9720963+3.5
 Parameter: ZMAX <- "48.4720963"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.49089651"
Evaluating: 1.49089651-3.5
 Parameter: XMIN <- "-2.00910349"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.4707796"
Evaluating: 41.4707796-3.5
 Parameter: YMIN <- "37.9707796"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.9720963"
Evaluating: 44.9720963-3.5
 Parameter: ZMIN <- "41.4720963"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.99089651"
 Parameter: XMIN -> "-2.00910349"
 Parameter: YMAX -> "44.9707796"
 Parameter: YMIN -> "37.9707796"
 Parameter: ZMAX -> "48.4720963"
 Parameter: ZMIN -> "41.4720963"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "36" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "36" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.620390421E-03"
Evaluating: 125.050557*(1.620390421E-03-0.5)
 Parameter: XPOS <- "-62.3226478"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.619568844"
Evaluating: 125.050557*(0.619568844-0.5)
 Parameter: YPOS <- "14.9521505"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.796801125"
Evaluating: 152.572525*(0.796801125-0.5)+-4.51585405
 Parameter: ZPOS <- "40.767843"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.767843" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.767843" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-62.3226478"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -62.3226478-0
 Parameter: XTRAN <- "-62.3226478"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.9521505"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.9521505-0
 Parameter: YTRAN <- "14.9521505"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.767843"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.767843-0
 Parameter: ZTRAN <- "40.767843"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.3226478"
 Parameter: YTRAN -> "14.9521505"
 Parameter: ZTRAN -> "40.767843"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -62.322648   14.952151   40.767843
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.161970654"
Evaluating: 0.161970654*360.0
 Parameter: XPHI <- "58.3094354"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.797314137"
Evaluating: 0.797314137*360.0
 Parameter: YPHI <- "287.033089"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.976031053"
Evaluating: 0.976031053*360.0
 Parameter: ZPHI <- "351.371179"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-62.3226478"
 Parameter: YPOS -> "14.9521505"
 Parameter: ZPOS -> "40.767843"
 Parameter: XPHI -> "58.3094354"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.525332    0.850898
    0.000000   -0.850898    0.525332

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   58.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-62.3226478"
 Parameter: YPOS -> "14.9521505"
 Parameter: ZPOS -> "40.767843"
 Parameter: YPHI -> "287.033089"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.292924    0.000000    0.956136
    0.000000    1.000000    0.000000
   -0.956136    0.000000    0.292924

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   72.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-62.3226478"
 Parameter: YPOS -> "14.9521505"
 Parameter: ZPOS -> "40.767843"
 Parameter: ZPHI -> "351.371179"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.988681   -0.150033    0.000000
    0.150033    0.988681    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    8.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -62.322648 XMAX =  -62.322648 XAVE =  -62.322648
    YMIN =   14.952151 YMAX =   14.952151 YAVE =   14.952151
    ZMIN =   40.767843 ZMAX =   40.767843 ZAVE =   40.767843
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-62.3226478"
Evaluating: -62.3226478+3.5
 Parameter: XMAX <- "-58.8226478"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.9521505"
Evaluating: 14.9521505+3.5
 Parameter: YMAX <- "18.4521505"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.767843"
Evaluating: 40.767843+3.5
 Parameter: ZMAX <- "44.267843"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-62.3226478"
Evaluating: -62.3226478-3.5
 Parameter: XMIN <- "-65.8226478"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.9521505"
Evaluating: 14.9521505-3.5
 Parameter: YMIN <- "11.4521505"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.767843"
Evaluating: 40.767843-3.5
 Parameter: ZMIN <- "37.267843"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-58.8226478"
 Parameter: XMIN -> "-65.8226478"
 Parameter: YMAX -> "18.4521505"
 Parameter: YMIN -> "11.4521505"
 Parameter: ZMAX -> "44.267843"
 Parameter: ZMIN -> "37.267843"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "37" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "37" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.503781527"
Evaluating: 125.050557*(0.503781527-0.5)
 Parameter: XPOS <- "0.472882058"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.717582807"
Evaluating: 125.050557*(0.717582807-0.5)
 Parameter: YPOS <- "27.2088512"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.139344702"
Evaluating: 152.572525*(0.139344702-0.5)+-4.51585405
 Parameter: ZPOS <- "-59.5419435"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-59.5419435" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.472882058"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 0.472882058-0
 Parameter: XTRAN <- "0.472882058"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.2088512"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.2088512-0
 Parameter: YTRAN <- "27.2088512"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-59.5419435"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -59.5419435-0
 Parameter: ZTRAN <- "-59.5419435"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.472882058"
 Parameter: YTRAN -> "27.2088512"
 Parameter: ZTRAN -> "-59.5419435"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     0.472882   27.208851  -59.541944
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.547381693"
Evaluating: 0.547381693*360.0
 Parameter: XPHI <- "197.057409"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.603924568"
Evaluating: 0.603924568*360.0
 Parameter: YPHI <- "217.412844"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.928960678"
Evaluating: 0.928960678*360.0
 Parameter: ZPHI <- "334.425844"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.472882058"
 Parameter: YPOS -> "27.2088512"
 Parameter: ZPOS -> "-59.5419435"
 Parameter: XPHI -> "197.057409"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.956011   -0.293330
    0.000000    0.293330   -0.956011

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.472882058"
 Parameter: YPOS -> "27.2088512"
 Parameter: ZPOS -> "-59.5419435"
 Parameter: YPHI -> "217.412844"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.794278    0.000000    0.607554
    0.000000    1.000000    0.000000
   -0.607554    0.000000   -0.794278

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  142.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.472882058"
 Parameter: YPOS -> "27.2088512"
 Parameter: ZPOS -> "-59.5419435"
 Parameter: ZPHI -> "334.425844"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.902027   -0.431679    0.000000
    0.431679    0.902027    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   25.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.472882 XMAX =    0.472882 XAVE =    0.472882
    YMIN =   27.208851 YMAX =   27.208851 YAVE =   27.208851
    ZMIN =  -59.541944 ZMAX =  -59.541944 ZAVE =  -59.541944
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.472882058"
Evaluating: 0.472882058+3.5
 Parameter: XMAX <- "3.97288206"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.2088512"
Evaluating: 27.2088512+3.5
 Parameter: YMAX <- "30.7088512"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-59.5419435"
Evaluating: -59.5419435+3.5
 Parameter: ZMAX <- "-56.0419435"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.472882058"
Evaluating: 0.472882058-3.5
 Parameter: XMIN <- "-3.02711794"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.2088512"
Evaluating: 27.2088512-3.5
 Parameter: YMIN <- "23.7088512"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-59.5419435"
Evaluating: -59.5419435-3.5
 Parameter: ZMIN <- "-63.0419435"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.97288206"
 Parameter: XMIN -> "-3.02711794"
 Parameter: YMAX -> "30.7088512"
 Parameter: YMIN -> "23.7088512"
 Parameter: ZMAX -> "-56.0419435"
 Parameter: ZMIN -> "-63.0419435"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "38" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "38" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.163357015"
Evaluating: 125.050557*(0.163357015-0.5)
 Parameter: XPOS <- "-42.0973928"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.623307026"
Evaluating: 125.050557*(0.623307026-0.5)
 Parameter: YPOS <- "15.4196123"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.348894517"
Evaluating: 152.572525*(0.348894517-0.5)+-4.51585405
 Parameter: ZPOS <- "-27.5703991"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.5703991" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.0973928"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -42.0973928-0
 Parameter: XTRAN <- "-42.0973928"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.4196123"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.4196123-0
 Parameter: YTRAN <- "15.4196123"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.5703991"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.5703991-0
 Parameter: ZTRAN <- "-27.5703991"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.0973928"
 Parameter: YTRAN -> "15.4196123"
 Parameter: ZTRAN -> "-27.5703991"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -42.097393   15.419612  -27.570399
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313873343"
Evaluating: 0.313873343*360.0
 Parameter: XPHI <- "112.994403"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.146540643"
Evaluating: 0.146540643*360.0
 Parameter: YPHI <- "52.7546315"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.131536747"
Evaluating: 0.131536747*360.0
 Parameter: ZPHI <- "47.3532289"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.0973928"
 Parameter: YPOS -> "15.4196123"
 Parameter: ZPOS -> "-27.5703991"
 Parameter: XPHI -> "112.994403"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.390641    0.920543
    0.000000   -0.920543   -0.390641

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  112.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.0973928"
 Parameter: YPOS -> "15.4196123"
 Parameter: ZPOS -> "-27.5703991"
 Parameter: YPHI -> "52.7546315"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.605230    0.000000   -0.796051
    0.000000    1.000000    0.000000
    0.796051    0.000000    0.605230

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   52.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.0973928"
 Parameter: YPOS -> "15.4196123"
 Parameter: ZPOS -> "-27.5703991"
 Parameter: ZPHI -> "47.3532289"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.677477    0.735544    0.000000
   -0.735544    0.677477    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   47.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.097393 XMAX =  -42.097393 XAVE =  -42.097393
    YMIN =   15.419612 YMAX =   15.419612 YAVE =   15.419612
    ZMIN =  -27.570399 ZMAX =  -27.570399 ZAVE =  -27.570399
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.0973928"
Evaluating: -42.0973928+3.5
 Parameter: XMAX <- "-38.5973928"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.4196123"
Evaluating: 15.4196123+3.5
 Parameter: YMAX <- "18.9196123"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.5703991"
Evaluating: -27.5703991+3.5
 Parameter: ZMAX <- "-24.0703991"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.0973928"
Evaluating: -42.0973928-3.5
 Parameter: XMIN <- "-45.5973928"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.4196123"
Evaluating: 15.4196123-3.5
 Parameter: YMIN <- "11.9196123"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.5703991"
Evaluating: -27.5703991-3.5
 Parameter: ZMIN <- "-31.0703991"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.5973928"
 Parameter: XMIN -> "-45.5973928"
 Parameter: YMAX -> "18.9196123"
 Parameter: YMIN -> "11.9196123"
 Parameter: ZMAX -> "-24.0703991"
 Parameter: ZMIN -> "-31.0703991"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "39" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "39" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.910382932"
Evaluating: 125.050557*(0.910382932-0.5)
 Parameter: XPOS <- "51.3186142"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.607531401"
Evaluating: 125.050557*(0.607531401-0.5)
 Parameter: YPOS <- "13.4468616"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.722229156"
Evaluating: 152.572525*(0.722229156-0.5)+-4.51585405
 Parameter: ZPOS <- "29.3902094"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.3902094" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.3902094" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.3186142"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.3186142-0
 Parameter: XTRAN <- "51.3186142"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.4468616"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.4468616-0
 Parameter: YTRAN <- "13.4468616"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.3902094"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.3902094-0
 Parameter: ZTRAN <- "29.3902094"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.3186142"
 Parameter: YTRAN -> "13.4468616"
 Parameter: ZTRAN -> "29.3902094"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    51.318614   13.446862   29.390209
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.791074475"
Evaluating: 0.791074475*360.0
 Parameter: XPHI <- "284.786811"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.815314046"
Evaluating: 0.815314046*360.0
 Parameter: YPHI <- "293.513057"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.975453372"
Evaluating: 0.975453372*360.0
 Parameter: ZPHI <- "351.163214"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.3186142"
 Parameter: YPOS -> "13.4468616"
 Parameter: ZPOS -> "29.3902094"
 Parameter: XPHI -> "284.786811"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.255223   -0.966882
    0.000000    0.966882    0.255223

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   75.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.3186142"
 Parameter: YPOS -> "13.4468616"
 Parameter: ZPOS -> "29.3902094"
 Parameter: YPHI -> "293.513057"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.398958    0.000000    0.916969
    0.000000    1.000000    0.000000
   -0.916969    0.000000    0.398958

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   66.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.3186142"
 Parameter: YPOS -> "13.4468616"
 Parameter: ZPOS -> "29.3902094"
 Parameter: ZPHI -> "351.163214"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.988130   -0.153620    0.000000
    0.153620    0.988130    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    8.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.318614 XMAX =   51.318614 XAVE =   51.318614
    YMIN =   13.446862 YMAX =   13.446862 YAVE =   13.446862
    ZMIN =   29.390209 ZMAX =   29.390209 ZAVE =   29.390209
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.3186142"
Evaluating: 51.3186142+3.5
 Parameter: XMAX <- "54.8186142"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.4468616"
Evaluating: 13.4468616+3.5
 Parameter: YMAX <- "16.9468616"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.3902094"
Evaluating: 29.3902094+3.5
 Parameter: ZMAX <- "32.8902094"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.3186142"
Evaluating: 51.3186142-3.5
 Parameter: XMIN <- "47.8186142"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.4468616"
Evaluating: 13.4468616-3.5
 Parameter: YMIN <- "9.9468616"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.3902094"
Evaluating: 29.3902094-3.5
 Parameter: ZMIN <- "25.8902094"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "54.8186142"
 Parameter: XMIN -> "47.8186142"
 Parameter: YMAX -> "16.9468616"
 Parameter: YMIN -> "9.9468616"
 Parameter: ZMAX -> "32.8902094"
 Parameter: ZMIN -> "25.8902094"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "40" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "40" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.480832108"
Evaluating: 125.050557*(0.480832108-0.5)
 Parameter: XPOS <- "-2.39695557"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.472586695"
Evaluating: 125.050557*(0.472586695-0.5)
 Parameter: YPOS <- "-3.42804906"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.640218191"
Evaluating: 152.572525*(0.640218191-0.5)+-4.51585405
 Parameter: ZPOS <- "16.8775894"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.8775894" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.8775894" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.39695557"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.39695557-0
 Parameter: XTRAN <- "-2.39695557"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.42804906"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -3.42804906-0
 Parameter: YTRAN <- "-3.42804906"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.8775894"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.8775894-0
 Parameter: ZTRAN <- "16.8775894"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.39695557"
 Parameter: YTRAN -> "-3.42804906"
 Parameter: ZTRAN -> "16.8775894"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -2.396956   -3.428049   16.877589
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.128310951"
Evaluating: 0.128310951*360.0
 Parameter: XPHI <- "46.1919424"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.858291719"
Evaluating: 0.858291719*360.0
 Parameter: YPHI <- "308.985019"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.574875959"
Evaluating: 0.574875959*360.0
 Parameter: ZPHI <- "206.955345"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.39695557"
 Parameter: YPOS -> "-3.42804906"
 Parameter: ZPOS -> "16.8775894"
 Parameter: XPHI -> "46.1919424"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.692245    0.721663
    0.000000   -0.721663    0.692245

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   46.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.39695557"
 Parameter: YPOS -> "-3.42804906"
 Parameter: ZPOS -> "16.8775894"
 Parameter: YPHI -> "308.985019"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.629117    0.000000    0.777310
    0.000000    1.000000    0.000000
   -0.777310    0.000000    0.629117

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   51.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.39695557"
 Parameter: YPOS -> "-3.42804906"
 Parameter: ZPOS -> "16.8775894"
 Parameter: ZPHI -> "206.955345"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.891360   -0.453296    0.000000
    0.453296   -0.891360    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  153.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.396956 XMAX =   -2.396956 XAVE =   -2.396956
    YMIN =   -3.428049 YMAX =   -3.428049 YAVE =   -3.428049
    ZMIN =   16.877589 ZMAX =   16.877589 ZAVE =   16.877589
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.39695557"
Evaluating: -2.39695557+3.5
 Parameter: XMAX <- "1.10304443"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.42804906"
Evaluating: -3.42804906+3.5
 Parameter: YMAX <- "7.195094E-02"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.8775894"
Evaluating: 16.8775894+3.5
 Parameter: ZMAX <- "20.3775894"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.39695557"
Evaluating: -2.39695557-3.5
 Parameter: XMIN <- "-5.89695557"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.42804906"
Evaluating: -3.42804906-3.5
 Parameter: YMIN <- "-6.92804906"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.8775894"
Evaluating: 16.8775894-3.5
 Parameter: ZMIN <- "13.3775894"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.10304443"
 Parameter: XMIN -> "-5.89695557"
 Parameter: YMAX -> "7.195094E-02"
 Parameter: YMIN -> "-6.92804906"
 Parameter: ZMAX -> "20.3775894"
 Parameter: ZMIN -> "13.3775894"
 SELRPN>     14 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      8 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64455 POS      SOD      40       SOD     -8825 PROA     ASP      615      CB            4.2384
64455 POS      SOD      40       SOD     -8830 PROA     ASP      615      OD2           3.8159
64455 POS      SOD      40       SOD     -**** PROA     GLY      1015     CA            4.9429
64455 POS      SOD      40       SOD     -**** PROA     PRO      1017     CB            4.3781
64455 POS      SOD      40       SOD     -**** PROA     GLN      1018     CG            3.4481
64455 POS      SOD      40       SOD     -**** PROA     GLN      1018     CD            2.8759
64455 POS      SOD      40       SOD     -**** PROA     GLN      1018     OE1           1.9032
64455 POS      SOD      40       SOD     -**** PROA     GLN      1018     NE2           4.0042
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "40" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.685134107"
Evaluating: 125.050557*(0.685134107-0.5)
 Parameter: XPOS <- "23.1511232"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.444013227"
Evaluating: 125.050557*(0.444013227-0.5)
 Parameter: YPOS <- "-7.00117715"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.882590506"
Evaluating: 152.572525*(0.882590506-0.5)+-4.51585405
 Parameter: ZPOS <- "53.8569455"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "53.8569455" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "53.8569455" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.396956 XMAX =   -2.396956 XAVE =   -2.396956
    YMIN =   -3.428049 YMAX =   -3.428049 YAVE =   -3.428049
    ZMIN =   16.877589 ZMAX =   16.877589 ZAVE =   16.877589
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.1511232"
 RDCMND substituted energy or value "?XAVE" to "-2.39695557"
Evaluating: 23.1511232--2.39695557
 Parameter: XTRAN <- "25.5480788"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.00117715"
 RDCMND substituted energy or value "?YAVE" to "-3.42804906"
Evaluating: -7.00117715--3.42804906
 Parameter: YTRAN <- "-3.57312809"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "53.8569455"
 RDCMND substituted energy or value "?ZAVE" to "16.8775894"
Evaluating: 53.8569455-16.8775894
 Parameter: ZTRAN <- "36.9793561"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.5480788"
 Parameter: YTRAN -> "-3.57312809"
 Parameter: ZTRAN -> "36.9793561"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    25.548079   -3.573128   36.979356
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.623085834"
Evaluating: 0.623085834*360.0
 Parameter: XPHI <- "224.3109"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.88872727"
Evaluating: 0.88872727*360.0
 Parameter: YPHI <- "319.941817"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.683684066"
Evaluating: 0.683684066*360.0
 Parameter: ZPHI <- "246.126264"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.1511232"
 Parameter: YPOS -> "-7.00117715"
 Parameter: ZPOS -> "53.8569455"
 Parameter: XPHI -> "224.3109"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.715560   -0.698551
    0.000000    0.698551   -0.715560

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  135.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.1511232"
 Parameter: YPOS -> "-7.00117715"
 Parameter: ZPOS -> "53.8569455"
 Parameter: YPHI -> "319.941817"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.765391    0.000000    0.643565
    0.000000    1.000000    0.000000
   -0.643565    0.000000    0.765391

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   40.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.1511232"
 Parameter: YPOS -> "-7.00117715"
 Parameter: ZPOS -> "53.8569455"
 Parameter: ZPHI -> "246.126264"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.404722   -0.914440    0.000000
    0.914440   -0.404722    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  113.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.151123 XMAX =   23.151123 XAVE =   23.151123
    YMIN =   -7.001177 YMAX =   -7.001177 YAVE =   -7.001177
    ZMIN =   53.856945 ZMAX =   53.856945 ZAVE =   53.856945
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.1511232"
Evaluating: 23.1511232+3.5
 Parameter: XMAX <- "26.6511232"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.00117713"
Evaluating: -7.00117713+3.5
 Parameter: YMAX <- "-3.50117713"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "53.8569455"
Evaluating: 53.8569455+3.5
 Parameter: ZMAX <- "57.3569455"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.1511232"
Evaluating: 23.1511232-3.5
 Parameter: XMIN <- "19.6511232"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.00117713"
Evaluating: -7.00117713-3.5
 Parameter: YMIN <- "-10.5011771"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "53.8569455"
Evaluating: 53.8569455-3.5
 Parameter: ZMIN <- "50.3569455"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.6511232"
 Parameter: XMIN -> "19.6511232"
 Parameter: YMAX -> "-3.50117713"
 Parameter: YMIN -> "-10.5011771"
 Parameter: ZMAX -> "57.3569455"
 Parameter: ZMIN -> "50.3569455"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "41" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "41" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.157035047"
Evaluating: 125.050557*(0.157035047-0.5)
 Parameter: XPOS <- "-42.8879584"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.577654825"
Evaluating: 125.050557*(0.577654825-0.5)
 Parameter: YPOS <- "9.71077912"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.797697822"
Evaluating: 152.572525*(0.797697822-0.5)+-4.51585405
 Parameter: ZPOS <- "40.9046543"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.9046543" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.9046543" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.8879584"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -42.8879584-0
 Parameter: XTRAN <- "-42.8879584"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.71077912"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.71077912-0
 Parameter: YTRAN <- "9.71077912"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.9046543"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.9046543-0
 Parameter: ZTRAN <- "40.9046543"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.8879584"
 Parameter: YTRAN -> "9.71077912"
 Parameter: ZTRAN -> "40.9046543"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -42.887958    9.710779   40.904654
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.655964646"
Evaluating: 0.655964646*360.0
 Parameter: XPHI <- "236.147273"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.10319807E-02"
Evaluating: 6.10319807E-02*360.0
 Parameter: YPHI <- "21.9715131"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.691203322"
Evaluating: 0.691203322*360.0
 Parameter: ZPHI <- "248.833196"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.8879584"
 Parameter: YPOS -> "9.71077912"
 Parameter: ZPOS -> "40.9046543"
 Parameter: XPHI -> "236.147273"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.557060   -0.830472
    0.000000    0.830472   -0.557060

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  123.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.8879584"
 Parameter: YPOS -> "9.71077912"
 Parameter: ZPOS -> "40.9046543"
 Parameter: YPHI -> "21.9715131"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.927370    0.000000   -0.374146
    0.000000    1.000000    0.000000
    0.374146    0.000000    0.927370

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   21.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.8879584"
 Parameter: YPOS -> "9.71077912"
 Parameter: ZPOS -> "40.9046543"
 Parameter: ZPHI -> "248.833196"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.361084   -0.932533    0.000000
    0.932533   -0.361084    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  111.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.887958 XMAX =  -42.887958 XAVE =  -42.887958
    YMIN =    9.710779 YMAX =    9.710779 YAVE =    9.710779
    ZMIN =   40.904654 ZMAX =   40.904654 ZAVE =   40.904654
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.8879584"
Evaluating: -42.8879584+3.5
 Parameter: XMAX <- "-39.3879584"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.71077912"
Evaluating: 9.71077912+3.5
 Parameter: YMAX <- "13.2107791"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.9046543"
Evaluating: 40.9046543+3.5
 Parameter: ZMAX <- "44.4046543"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.8879584"
Evaluating: -42.8879584-3.5
 Parameter: XMIN <- "-46.3879584"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.71077912"
Evaluating: 9.71077912-3.5
 Parameter: YMIN <- "6.21077912"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.9046543"
Evaluating: 40.9046543-3.5
 Parameter: ZMIN <- "37.4046543"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.3879584"
 Parameter: XMIN -> "-46.3879584"
 Parameter: YMAX -> "13.2107791"
 Parameter: YMIN -> "6.21077912"
 Parameter: ZMAX -> "44.4046543"
 Parameter: ZMIN -> "37.4046543"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "42" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "42" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.602792996"
Evaluating: 125.050557*(0.602792996-0.5)
 Parameter: XPOS <- "12.8543214"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.524342737"
Evaluating: 125.050557*(0.524342737-0.5)
 Parameter: YPOS <- "3.04407282"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.580418236"
Evaluating: 152.572525*(0.580418236-0.5)+-4.51585405
 Parameter: ZPOS <- "7.75375927"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.75375927" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.75375927" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "42" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.786575798"
Evaluating: 125.050557*(0.786575798-0.5)
 Parameter: XPOS <- "35.8364632"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.375546306"
Evaluating: 125.050557*(0.375546306-0.5)
 Parameter: YPOS <- "-15.5630038"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.380735753"
Evaluating: 152.572525*(0.380735753-0.5)+-4.51585405
 Parameter: ZPOS <- "-22.7123014"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.7123014" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.8364632"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 35.8364632-0
 Parameter: XTRAN <- "35.8364632"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.5630038"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.5630038-0
 Parameter: YTRAN <- "-15.5630038"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.7123014"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.7123014-0
 Parameter: ZTRAN <- "-22.7123014"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.8364632"
 Parameter: YTRAN -> "-15.5630038"
 Parameter: ZTRAN -> "-22.7123014"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    35.836463  -15.563004  -22.712301
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.938243841"
Evaluating: 0.938243841*360.0
 Parameter: XPHI <- "337.767783"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.137727435"
Evaluating: 0.137727435*360.0
 Parameter: YPHI <- "49.5818766"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.409963519"
Evaluating: 0.409963519*360.0
 Parameter: ZPHI <- "147.586867"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.8364632"
 Parameter: YPOS -> "-15.5630038"
 Parameter: ZPOS -> "-22.7123014"
 Parameter: XPHI -> "337.767783"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.925658   -0.378361
    0.000000    0.378361    0.925658

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   22.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.8364632"
 Parameter: YPOS -> "-15.5630038"
 Parameter: ZPOS -> "-22.7123014"
 Parameter: YPHI -> "49.5818766"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.648361    0.000000   -0.761333
    0.000000    1.000000    0.000000
    0.761333    0.000000    0.648361

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   49.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.8364632"
 Parameter: YPOS -> "-15.5630038"
 Parameter: ZPOS -> "-22.7123014"
 Parameter: ZPHI -> "147.586867"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.844205    0.536020    0.000000
   -0.536020   -0.844205    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  147.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.836463 XMAX =   35.836463 XAVE =   35.836463
    YMIN =  -15.563004 YMAX =  -15.563004 YAVE =  -15.563004
    ZMIN =  -22.712301 ZMAX =  -22.712301 ZAVE =  -22.712301
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.8364632"
Evaluating: 35.8364632+3.5
 Parameter: XMAX <- "39.3364632"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.5630038"
Evaluating: -15.5630038+3.5
 Parameter: YMAX <- "-12.0630038"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.7123014"
Evaluating: -22.7123014+3.5
 Parameter: ZMAX <- "-19.2123014"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.8364632"
Evaluating: 35.8364632-3.5
 Parameter: XMIN <- "32.3364632"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.5630038"
Evaluating: -15.5630038-3.5
 Parameter: YMIN <- "-19.0630038"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.7123014"
Evaluating: -22.7123014-3.5
 Parameter: ZMIN <- "-26.2123014"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.3364632"
 Parameter: XMIN -> "32.3364632"
 Parameter: YMAX -> "-12.0630038"
 Parameter: YMIN -> "-19.0630038"
 Parameter: ZMAX -> "-19.2123014"
 Parameter: ZMIN -> "-26.2123014"
 SELRPN>     10 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      3 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "43" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "43" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.496556013"
Evaluating: 125.050557*(0.496556013-0.5)
 Parameter: XPOS <- "-0.430672493"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.493558014"
Evaluating: 125.050557*(0.493558014-0.5)
 Parameter: YPOS <- "-0.805573937"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.622817282"
Evaluating: 152.572525*(0.622817282-0.5)+-4.51585405
 Parameter: ZPOS <- "14.2226888"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.2226888" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.2226888" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "43" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "2.988192529E-02"
Evaluating: 125.050557*(2.988192529E-02-0.5)
 Parameter: XPOS <- "-58.7885271"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "8.830209887E-02"
Evaluating: 125.050557*(8.830209887E-02-0.5)
 Parameter: YPOS <- "-51.4830519"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.996520106"
Evaluating: 152.572525*(0.996520106-0.5)+-4.51585405
 Parameter: ZPOS <- "71.2394722"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "71.2394722" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "71.2394722" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-58.7885271"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -58.7885271-0
 Parameter: XTRAN <- "-58.7885271"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-51.4830519"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -51.4830519-0
 Parameter: YTRAN <- "-51.4830519"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "71.2394722"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 71.2394722-0
 Parameter: ZTRAN <- "71.2394722"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.7885271"
 Parameter: YTRAN -> "-51.4830519"
 Parameter: ZTRAN -> "71.2394722"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -58.788527  -51.483052   71.239472
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.1845826"
Evaluating: 0.1845826*360.0
 Parameter: XPHI <- "66.449736"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.475028211"
Evaluating: 0.475028211*360.0
 Parameter: YPHI <- "171.010156"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.107230159"
Evaluating: 0.107230159*360.0
 Parameter: ZPHI <- "38.6028572"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-58.7885271"
 Parameter: YPOS -> "-51.4830519"
 Parameter: ZPOS -> "71.2394722"
 Parameter: XPHI -> "66.449736"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.399553    0.916710
    0.000000   -0.916710    0.399553

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   66.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-58.7885271"
 Parameter: YPOS -> "-51.4830519"
 Parameter: ZPOS -> "71.2394722"
 Parameter: YPHI -> "171.010156"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.987716    0.000000   -0.156259
    0.000000    1.000000    0.000000
    0.156259    0.000000   -0.987716

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  171.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-58.7885271"
 Parameter: YPOS -> "-51.4830519"
 Parameter: ZPOS -> "71.2394722"
 Parameter: ZPHI -> "38.6028572"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.781489    0.623919    0.000000
   -0.623919    0.781489    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   38.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -58.788527 XMAX =  -58.788527 XAVE =  -58.788527
    YMIN =  -51.483052 YMAX =  -51.483052 YAVE =  -51.483052
    ZMIN =   71.239472 ZMAX =   71.239472 ZAVE =   71.239472
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-58.7885271"
Evaluating: -58.7885271+3.5
 Parameter: XMAX <- "-55.2885271"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-51.4830519"
Evaluating: -51.4830519+3.5
 Parameter: YMAX <- "-47.9830519"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "71.2394722"
Evaluating: 71.2394722+3.5
 Parameter: ZMAX <- "74.7394722"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-58.7885271"
Evaluating: -58.7885271-3.5
 Parameter: XMIN <- "-62.2885271"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-51.4830519"
Evaluating: -51.4830519-3.5
 Parameter: YMIN <- "-54.9830519"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "71.2394722"
Evaluating: 71.2394722-3.5
 Parameter: ZMIN <- "67.7394722"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-55.2885271"
 Parameter: XMIN -> "-62.2885271"
 Parameter: YMAX -> "-47.9830519"
 Parameter: YMIN -> "-54.9830519"
 Parameter: ZMAX -> "74.7394722"
 Parameter: ZMIN -> "67.7394722"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "44" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "44" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.384826055"
Evaluating: 125.050557*(0.384826055-0.5)
 Parameter: XPOS <- "-14.402566"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.661259436"
Evaluating: 125.050557*(0.661259436-0.5)
 Parameter: YPOS <- "20.1655823"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.909538952"
Evaluating: 152.572525*(0.909538952-0.5)+-4.51585405
 Parameter: ZPOS <- "57.9685379"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.9685379" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.9685379" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.402566"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.402566-0
 Parameter: XTRAN <- "-14.402566"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.1655823"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 20.1655823-0
 Parameter: YTRAN <- "20.1655823"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.9685379"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.9685379-0
 Parameter: ZTRAN <- "57.9685379"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.402566"
 Parameter: YTRAN -> "20.1655823"
 Parameter: ZTRAN -> "57.9685379"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -14.402566   20.165582   57.968538
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.130687221"
Evaluating: 0.130687221*360.0
 Parameter: XPHI <- "47.0473996"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.274533263E-03"
Evaluating: 8.274533263E-03*360.0
 Parameter: YPHI <- "2.97883197"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.376385203E-02"
Evaluating: 6.376385203E-02*360.0
 Parameter: ZPHI <- "22.9549867"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.402566"
 Parameter: YPOS -> "20.1655823"
 Parameter: ZPOS -> "57.9685379"
 Parameter: XPHI -> "47.0473996"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.681393    0.731918
    0.000000   -0.731918    0.681393

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   47.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.402566"
 Parameter: YPOS -> "20.1655823"
 Parameter: ZPOS -> "57.9685379"
 Parameter: YPHI -> "2.97883197"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.998649    0.000000   -0.051967
    0.000000    1.000000    0.000000
    0.051967    0.000000    0.998649

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.402566"
 Parameter: YPOS -> "20.1655823"
 Parameter: ZPOS -> "57.9685379"
 Parameter: ZPHI -> "22.9549867"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.920812    0.390008    0.000000
   -0.390008    0.920812    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   22.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.402566 XMAX =  -14.402566 XAVE =  -14.402566
    YMIN =   20.165582 YMAX =   20.165582 YAVE =   20.165582
    ZMIN =   57.968538 ZMAX =   57.968538 ZAVE =   57.968538
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.402566"
Evaluating: -14.402566+3.5
 Parameter: XMAX <- "-10.902566"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.1655823"
Evaluating: 20.1655823+3.5
 Parameter: YMAX <- "23.6655823"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.9685379"
Evaluating: 57.9685379+3.5
 Parameter: ZMAX <- "61.4685379"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.402566"
Evaluating: -14.402566-3.5
 Parameter: XMIN <- "-17.902566"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.1655823"
Evaluating: 20.1655823-3.5
 Parameter: YMIN <- "16.6655823"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.9685379"
Evaluating: 57.9685379-3.5
 Parameter: ZMIN <- "54.4685379"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.902566"
 Parameter: XMIN -> "-17.902566"
 Parameter: YMAX -> "23.6655823"
 Parameter: YMIN -> "16.6655823"
 Parameter: ZMAX -> "61.4685379"
 Parameter: ZMIN -> "54.4685379"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "45" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "45" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.451831923"
Evaluating: 125.050557*(0.451831923-0.5)
 Parameter: XPOS <- "-6.02344486"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.172787503"
Evaluating: 125.050557*(0.172787503-0.5)
 Parameter: YPOS <- "-40.918105"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.638435357"
Evaluating: 152.572525*(0.638435357-0.5)+-4.51585405
 Parameter: ZPOS <- "16.6055779"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.6055779" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.6055779" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.02344486"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.02344486-0
 Parameter: XTRAN <- "-6.02344486"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.918105"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.918105-0
 Parameter: YTRAN <- "-40.918105"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.6055779"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.6055779-0
 Parameter: ZTRAN <- "16.6055779"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.02344486"
 Parameter: YTRAN -> "-40.918105"
 Parameter: ZTRAN -> "16.6055779"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -6.023445  -40.918105   16.605578
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.310613312"
Evaluating: 0.310613312*360.0
 Parameter: XPHI <- "111.820792"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.433171712"
Evaluating: 0.433171712*360.0
 Parameter: YPHI <- "155.941816"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.283542022"
Evaluating: 0.283542022*360.0
 Parameter: ZPHI <- "102.075128"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.02344486"
 Parameter: YPOS -> "-40.918105"
 Parameter: ZPOS -> "16.6055779"
 Parameter: XPHI -> "111.820792"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.371705    0.928351
    0.000000   -0.928351   -0.371705

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  111.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.02344486"
 Parameter: YPOS -> "-40.918105"
 Parameter: ZPOS -> "16.6055779"
 Parameter: YPHI -> "155.941816"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.913132    0.000000   -0.407664
    0.000000    1.000000    0.000000
    0.407664    0.000000   -0.913132

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  155.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.02344486"
 Parameter: YPOS -> "-40.918105"
 Parameter: ZPOS -> "16.6055779"
 Parameter: ZPHI -> "102.075128"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.209194    0.977874    0.000000
   -0.977874   -0.209194    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  102.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.023445 XMAX =   -6.023445 XAVE =   -6.023445
    YMIN =  -40.918105 YMAX =  -40.918105 YAVE =  -40.918105
    ZMIN =   16.605578 ZMAX =   16.605578 ZAVE =   16.605578
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.02344486"
Evaluating: -6.02344486+3.5
 Parameter: XMAX <- "-2.52344486"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.918105"
Evaluating: -40.918105+3.5
 Parameter: YMAX <- "-37.418105"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.6055779"
Evaluating: 16.6055779+3.5
 Parameter: ZMAX <- "20.1055779"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.02344486"
Evaluating: -6.02344486-3.5
 Parameter: XMIN <- "-9.52344486"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.918105"
Evaluating: -40.918105-3.5
 Parameter: YMIN <- "-44.418105"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.6055779"
Evaluating: 16.6055779-3.5
 Parameter: ZMIN <- "13.1055779"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.52344486"
 Parameter: XMIN -> "-9.52344486"
 Parameter: YMAX -> "-37.418105"
 Parameter: YMIN -> "-44.418105"
 Parameter: ZMAX -> "20.1055779"
 Parameter: ZMIN -> "13.1055779"
 SELRPN>     23 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     12 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64460 POS      SOD      45       SOD     - 834 PROA     LEU      84       N             5.1658
64460 POS      SOD      45       SOD     - 836 PROA     LEU      84       CA            4.1820
64460 POS      SOD      45       SOD     - 852 PROA     LEU      84       O             3.2073
64460 POS      SOD      45       SOD     - 877 PROA     LEU      86       C             5.1675
64460 POS      SOD      45       SOD     - 879 PROA     GLU      87       N             3.8241
64460 POS      SOD      45       SOD     - 881 PROA     GLU      87       CA            3.1534
64460 POS      SOD      45       SOD     - 883 PROA     GLU      87       CB            1.6787
64460 POS      SOD      45       SOD     - 886 PROA     GLU      87       CG            2.0840
64460 POS      SOD      45       SOD     - 889 PROA     GLU      87       CD            3.4654
64460 POS      SOD      45       SOD     - 890 PROA     GLU      87       OE1           3.8744
64460 POS      SOD      45       SOD     - 892 PROA     GLU      87       C             3.7547
64460 POS      SOD      45       SOD     - 894 PROA     LYS      88       N             4.1867
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "45" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.287599293"
Evaluating: 125.050557*(0.287599293-0.5)
 Parameter: XPOS <- "-26.5608267"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.515436614"
Evaluating: 125.050557*(0.515436614-0.5)
 Parameter: YPOS <- "1.93035718"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.450008525"
Evaluating: 152.572525*(0.450008525-0.5)+-4.51585405
 Parameter: ZPOS <- "-12.1431796"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.1431796" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.1431796" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "45" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.793170175"
Evaluating: 125.050557*(0.793170175-0.5)
 Parameter: XPOS <- "36.6610937"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.936412809"
Evaluating: 125.050557*(0.936412809-0.5)
 Parameter: YPOS <- "54.5736648"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.142773121"
Evaluating: 152.572525*(0.142773121-0.5)+-4.51585405
 Parameter: ZPOS <- "-59.018861"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-59.018861" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.023445 XMAX =   -6.023445 XAVE =   -6.023445
    YMIN =  -40.918105 YMAX =  -40.918105 YAVE =  -40.918105
    ZMIN =   16.605578 ZMAX =   16.605578 ZAVE =   16.605578
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.6610937"
 RDCMND substituted energy or value "?XAVE" to "-6.02344486"
Evaluating: 36.6610937--6.02344486
 Parameter: XTRAN <- "42.6845386"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "54.5736648"
 RDCMND substituted energy or value "?YAVE" to "-40.918105"
Evaluating: 54.5736648--40.918105
 Parameter: YTRAN <- "95.4917698"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-59.018861"
 RDCMND substituted energy or value "?ZAVE" to "16.6055779"
Evaluating: -59.018861-16.6055779
 Parameter: ZTRAN <- "-75.6244389"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.6845386"
 Parameter: YTRAN -> "95.4917698"
 Parameter: ZTRAN -> "-75.6244389"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    42.684539   95.491770  -75.624439
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.412104843"
Evaluating: 0.412104843*360.0
 Parameter: XPHI <- "148.357743"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.849605587E-02"
Evaluating: 1.849605587E-02*360.0
 Parameter: YPHI <- "6.65858011"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.599132238"
Evaluating: 0.599132238*360.0
 Parameter: ZPHI <- "215.687606"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.6610937"
 Parameter: YPOS -> "54.5736648"
 Parameter: ZPOS -> "-59.018861"
 Parameter: XPHI -> "148.357743"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.851340    0.524614
    0.000000   -0.524614   -0.851340

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  148.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.6610937"
 Parameter: YPOS -> "54.5736648"
 Parameter: ZPOS -> "-59.018861"
 Parameter: YPHI -> "6.65858011"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.993255    0.000000   -0.115953
    0.000000    1.000000    0.000000
    0.115953    0.000000    0.993255

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    6.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.6610937"
 Parameter: YPOS -> "54.5736648"
 Parameter: ZPOS -> "-59.018861"
 Parameter: ZPHI -> "215.687606"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.812210   -0.583366    0.000000
    0.583366   -0.812210    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  144.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.661094 XMAX =   36.661094 XAVE =   36.661094
    YMIN =   54.573665 YMAX =   54.573665 YAVE =   54.573665
    ZMIN =  -59.018861 ZMAX =  -59.018861 ZAVE =  -59.018861
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.6610937"
Evaluating: 36.6610937+3.5
 Parameter: XMAX <- "40.1610937"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "54.5736648"
Evaluating: 54.5736648+3.5
 Parameter: YMAX <- "58.0736648"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-59.018861"
Evaluating: -59.018861+3.5
 Parameter: ZMAX <- "-55.518861"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.6610937"
Evaluating: 36.6610937-3.5
 Parameter: XMIN <- "33.1610937"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "54.5736648"
Evaluating: 54.5736648-3.5
 Parameter: YMIN <- "51.0736648"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-59.018861"
Evaluating: -59.018861-3.5
 Parameter: ZMIN <- "-62.518861"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.1610937"
 Parameter: XMIN -> "33.1610937"
 Parameter: YMAX -> "58.0736648"
 Parameter: YMIN -> "51.0736648"
 Parameter: ZMAX -> "-55.518861"
 Parameter: ZMIN -> "-62.518861"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "46" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "46" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.500594449"
Evaluating: 125.050557*(0.500594449-0.5)
 Parameter: XPOS <- "7.433617856E-02"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "8.305574223E-02"
Evaluating: 125.050557*(8.305574223E-02-0.5)
 Parameter: YPOS <- "-52.1391117"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.99289459"
Evaluating: 152.572525*(0.99289459-0.5)+-4.51585405
 Parameter: ZPOS <- "70.6863181"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "70.6863181" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "70.6863181" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.433617856E-02"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.433617856E-02-0
 Parameter: XTRAN <- "7.433617856E-02"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-52.1391117"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -52.1391117-0
 Parameter: YTRAN <- "-52.1391117"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "70.6863181"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 70.6863181-0
 Parameter: ZTRAN <- "70.6863181"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.433617856E-02"
 Parameter: YTRAN -> "-52.1391117"
 Parameter: ZTRAN -> "70.6863181"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     0.074336  -52.139112   70.686318
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.842401874"
Evaluating: 0.842401874*360.0
 Parameter: XPHI <- "303.264675"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.737769619"
Evaluating: 0.737769619*360.0
 Parameter: YPHI <- "265.597063"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.948616558"
Evaluating: 0.948616558*360.0
 Parameter: ZPHI <- "341.501961"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.433617856E-02"
 Parameter: YPOS -> "-52.1391117"
 Parameter: ZPOS -> "70.6863181"
 Parameter: XPHI -> "303.264675"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.548507   -0.836146
    0.000000    0.836146    0.548507

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   56.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.433617856E-02"
 Parameter: YPOS -> "-52.1391117"
 Parameter: ZPOS -> "70.6863181"
 Parameter: YPHI -> "265.597063"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.076770    0.000000    0.997049
    0.000000    1.000000    0.000000
   -0.997049    0.000000   -0.076770

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   94.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.433617856E-02"
 Parameter: YPOS -> "-52.1391117"
 Parameter: ZPOS -> "70.6863181"
 Parameter: ZPHI -> "341.501961"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.948335   -0.317272    0.000000
    0.317272    0.948335    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   18.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.074336 XMAX =    0.074336 XAVE =    0.074336
    YMIN =  -52.139112 YMAX =  -52.139112 YAVE =  -52.139112
    ZMIN =   70.686318 ZMAX =   70.686318 ZAVE =   70.686318
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.433617856E-02"
Evaluating: 7.433617856E-02+3.5
 Parameter: XMAX <- "3.57433618"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-52.1391117"
Evaluating: -52.1391117+3.5
 Parameter: YMAX <- "-48.6391117"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "70.6863181"
Evaluating: 70.6863181+3.5
 Parameter: ZMAX <- "74.1863181"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.433617856E-02"
Evaluating: 7.433617856E-02-3.5
 Parameter: XMIN <- "-3.42566382"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-52.1391117"
Evaluating: -52.1391117-3.5
 Parameter: YMIN <- "-55.6391117"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "70.6863181"
Evaluating: 70.6863181-3.5
 Parameter: ZMIN <- "67.1863181"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.57433618"
 Parameter: XMIN -> "-3.42566382"
 Parameter: YMAX -> "-48.6391117"
 Parameter: YMIN -> "-55.6391117"
 Parameter: ZMAX -> "74.1863181"
 Parameter: ZMIN -> "67.1863181"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "47" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "47" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.604186514"
Evaluating: 125.050557*(0.604186514-0.5)
 Parameter: XPOS <- "13.0285816"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.464620387"
Evaluating: 125.050557*(0.464620387-0.5)
 Parameter: YPOS <- "-4.42424031"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.688882712"
Evaluating: 152.572525*(0.688882712-0.5)+-4.51585405
 Parameter: ZPOS <- "24.3024582"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.3024582" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.3024582" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.0285816"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.0285816-0
 Parameter: XTRAN <- "13.0285816"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.42424031"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.42424031-0
 Parameter: YTRAN <- "-4.42424031"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.3024582"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.3024582-0
 Parameter: ZTRAN <- "24.3024582"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.0285816"
 Parameter: YTRAN -> "-4.42424031"
 Parameter: ZTRAN -> "24.3024582"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    13.028582   -4.424240   24.302458
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.262979228"
Evaluating: 0.262979228*360.0
 Parameter: XPHI <- "94.6725221"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.534162062E-02"
Evaluating: 5.534162062E-02*360.0
 Parameter: YPHI <- "19.9229834"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919323761"
Evaluating: 0.919323761*360.0
 Parameter: ZPHI <- "330.956554"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.0285816"
 Parameter: YPOS -> "-4.42424031"
 Parameter: ZPOS -> "24.3024582"
 Parameter: XPHI -> "94.6725221"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.081461    0.996677
    0.000000   -0.996677   -0.081461

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   94.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.0285816"
 Parameter: YPOS -> "-4.42424031"
 Parameter: ZPOS -> "24.3024582"
 Parameter: YPHI -> "19.9229834"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.940152    0.000000   -0.340757
    0.000000    1.000000    0.000000
    0.340757    0.000000    0.940152

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   19.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.0285816"
 Parameter: YPOS -> "-4.42424031"
 Parameter: ZPOS -> "24.3024582"
 Parameter: ZPHI -> "330.956554"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.874252   -0.485473    0.000000
    0.485473    0.874252    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.028582 XMAX =   13.028582 XAVE =   13.028582
    YMIN =   -4.424240 YMAX =   -4.424240 YAVE =   -4.424240
    ZMIN =   24.302458 ZMAX =   24.302458 ZAVE =   24.302458
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.0285816"
Evaluating: 13.0285816+3.5
 Parameter: XMAX <- "16.5285816"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.42424031"
Evaluating: -4.42424031+3.5
 Parameter: YMAX <- "-0.92424031"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.3024582"
Evaluating: 24.3024582+3.5
 Parameter: ZMAX <- "27.8024582"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.0285816"
Evaluating: 13.0285816-3.5
 Parameter: XMIN <- "9.5285816"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.42424031"
Evaluating: -4.42424031-3.5
 Parameter: YMIN <- "-7.92424031"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.3024582"
Evaluating: 24.3024582-3.5
 Parameter: ZMIN <- "20.8024582"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.5285816"
 Parameter: XMIN -> "9.5285816"
 Parameter: YMAX -> "-0.92424031"
 Parameter: YMIN -> "-7.92424031"
 Parameter: ZMAX -> "27.8024582"
 Parameter: ZMIN -> "20.8024582"
 SELRPN>     29 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     19 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64462 POS      SOD      47       SOD     -3410 PROA     PRO      242      CA            5.0517
64462 POS      SOD      47       SOD     -3418 PROA     PRO      242      C             4.2872
64462 POS      SOD      47       SOD     -3419 PROA     PRO      242      O             3.2305
64462 POS      SOD      47       SOD     -3726 PROA     TRP      265      CE2           3.7943
64462 POS      SOD      47       SOD     -3727 PROA     TRP      265      CD2           4.6736
64462 POS      SOD      47       SOD     -3730 PROA     TRP      265      CZ3           3.6001
64462 POS      SOD      47       SOD     -3732 PROA     TRP      265      CZ2           2.5181
64462 POS      SOD      47       SOD     -3734 PROA     TRP      265      CH2           2.3651
64462 POS      SOD      47       SOD     -3757 PROA     GLY      267      C             3.1272
64462 POS      SOD      47       SOD     -3758 PROA     GLY      267      O             2.8881
64462 POS      SOD      47       SOD     -3759 PROA     PRO      268      N             2.6985
64462 POS      SOD      47       SOD     -3760 PROA     PRO      268      CD            3.7816
64462 POS      SOD      47       SOD     -3763 PROA     PRO      268      CA            1.6254
64462 POS      SOD      47       SOD     -3765 PROA     PRO      268      CB            2.6916
64462 POS      SOD      47       SOD     -3768 PROA     PRO      268      CG            3.9059
64462 POS      SOD      47       SOD     -3771 PROA     PRO      268      C             1.9022
64462 POS      SOD      47       SOD     -3772 PROA     PRO      268      O             1.7688
64462 POS      SOD      47       SOD     -3773 PROA     ASN      269      N             3.2211
64462 POS      SOD      47       SOD     -3775 PROA     ASN      269      CA            4.1233
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        19
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "47" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.792329472"
Evaluating: 125.050557*(0.792329472-0.5)
 Parameter: XPOS <- "36.5559633"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.4074004"
Evaluating: 125.050557*(0.4074004-0.5)
 Parameter: YPOS <- "-11.5796316"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.954516451"
Evaluating: 152.572525*(0.954516451-0.5)+-4.51585405
 Parameter: ZPOS <- "64.8308685"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "64.8308685" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "64.8308685" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.028582 XMAX =   13.028582 XAVE =   13.028582
    YMIN =   -4.424240 YMAX =   -4.424240 YAVE =   -4.424240
    ZMIN =   24.302458 ZMAX =   24.302458 ZAVE =   24.302458
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.5559633"
 RDCMND substituted energy or value "?XAVE" to "13.0285816"
Evaluating: 36.5559633-13.0285816
 Parameter: XTRAN <- "23.5273817"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.5796316"
 RDCMND substituted energy or value "?YAVE" to "-4.42424031"
Evaluating: -11.5796316--4.42424031
 Parameter: YTRAN <- "-7.15539129"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "64.8308685"
 RDCMND substituted energy or value "?ZAVE" to "24.3024582"
Evaluating: 64.8308685-24.3024582
 Parameter: ZTRAN <- "40.5284103"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.5273817"
 Parameter: YTRAN -> "-7.15539129"
 Parameter: ZTRAN -> "40.5284103"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    23.527382   -7.155391   40.528410
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.5758447"
Evaluating: 0.5758447*360.0
 Parameter: XPHI <- "207.304092"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.731297304"
Evaluating: 0.731297304*360.0
 Parameter: YPHI <- "263.267029"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.223765785"
Evaluating: 0.223765785*360.0
 Parameter: ZPHI <- "80.5556826"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.5559633"
 Parameter: YPOS -> "-11.5796316"
 Parameter: ZPOS -> "64.8308685"
 Parameter: XPHI -> "207.304092"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.888584   -0.458713
    0.000000    0.458713   -0.888584

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  152.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.5559633"
 Parameter: YPOS -> "-11.5796316"
 Parameter: ZPOS -> "64.8308685"
 Parameter: YPHI -> "263.267029"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.117242    0.000000    0.993103
    0.000000    1.000000    0.000000
   -0.993103    0.000000   -0.117242

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   96.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.5559633"
 Parameter: YPOS -> "-11.5796316"
 Parameter: ZPOS -> "64.8308685"
 Parameter: ZPHI -> "80.5556826"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.164089    0.986446    0.000000
   -0.986446    0.164089    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   80.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.555963 XMAX =   36.555963 XAVE =   36.555963
    YMIN =  -11.579632 YMAX =  -11.579632 YAVE =  -11.579632
    ZMIN =   64.830868 ZMAX =   64.830868 ZAVE =   64.830868
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.5559633"
Evaluating: 36.5559633+3.5
 Parameter: XMAX <- "40.0559633"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.5796316"
Evaluating: -11.5796316+3.5
 Parameter: YMAX <- "-8.0796316"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "64.8308685"
Evaluating: 64.8308685+3.5
 Parameter: ZMAX <- "68.3308685"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.5559633"
Evaluating: 36.5559633-3.5
 Parameter: XMIN <- "33.0559633"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.5796316"
Evaluating: -11.5796316-3.5
 Parameter: YMIN <- "-15.0796316"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "64.8308685"
Evaluating: 64.8308685-3.5
 Parameter: ZMIN <- "61.3308685"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.0559633"
 Parameter: XMIN -> "33.0559633"
 Parameter: YMAX -> "-8.0796316"
 Parameter: YMIN -> "-15.0796316"
 Parameter: ZMAX -> "68.3308685"
 Parameter: ZMIN -> "61.3308685"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "48" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "48" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.788366084"
Evaluating: 125.050557*(0.788366084-0.5)
 Parameter: XPOS <- "36.0603394"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.407612458"
Evaluating: 125.050557*(0.407612458-0.5)
 Parameter: YPOS <- "-11.5531136"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.329972612"
Evaluating: 152.572525*(0.329972612-0.5)+-4.51585405
 Parameter: ZPOS <- "-30.457362"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.457362" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.0603394"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.0603394-0
 Parameter: XTRAN <- "36.0603394"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.5531136"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.5531136-0
 Parameter: YTRAN <- "-11.5531136"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.457362"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.457362-0
 Parameter: ZTRAN <- "-30.457362"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.0603394"
 Parameter: YTRAN -> "-11.5531136"
 Parameter: ZTRAN -> "-30.457362"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    36.060339  -11.553114  -30.457362
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.968699672"
Evaluating: 0.968699672*360.0
 Parameter: XPHI <- "348.731882"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.373527607"
Evaluating: 0.373527607*360.0
 Parameter: YPHI <- "134.469939"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.396676923"
Evaluating: 0.396676923*360.0
 Parameter: ZPHI <- "142.803692"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.0603394"
 Parameter: YPOS -> "-11.5531136"
 Parameter: ZPOS -> "-30.457362"
 Parameter: XPHI -> "348.731882"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.980724   -0.195400
    0.000000    0.195400    0.980724

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   11.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.0603394"
 Parameter: YPOS -> "-11.5531136"
 Parameter: ZPOS -> "-30.457362"
 Parameter: YPHI -> "134.469939"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.700535    0.000000   -0.713618
    0.000000    1.000000    0.000000
    0.713618    0.000000   -0.700535

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  134.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.0603394"
 Parameter: YPOS -> "-11.5531136"
 Parameter: ZPOS -> "-30.457362"
 Parameter: ZPHI -> "142.803692"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.796569    0.604548    0.000000
   -0.604548   -0.796569    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.060339 XMAX =   36.060339 XAVE =   36.060339
    YMIN =  -11.553114 YMAX =  -11.553114 YAVE =  -11.553114
    ZMIN =  -30.457362 ZMAX =  -30.457362 ZAVE =  -30.457362
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.0603394"
Evaluating: 36.0603394+3.5
 Parameter: XMAX <- "39.5603394"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.5531136"
Evaluating: -11.5531136+3.5
 Parameter: YMAX <- "-8.0531136"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.457362"
Evaluating: -30.457362+3.5
 Parameter: ZMAX <- "-26.957362"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.0603394"
Evaluating: 36.0603394-3.5
 Parameter: XMIN <- "32.5603394"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.5531136"
Evaluating: -11.5531136-3.5
 Parameter: YMIN <- "-15.0531136"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.457362"
Evaluating: -30.457362-3.5
 Parameter: ZMIN <- "-33.957362"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.5603394"
 Parameter: XMIN -> "32.5603394"
 Parameter: YMAX -> "-8.0531136"
 Parameter: YMIN -> "-15.0531136"
 Parameter: ZMAX -> "-26.957362"
 Parameter: ZMIN -> "-33.957362"
 SELRPN>      9 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      4 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64463 POS      SOD      48       SOD     -**** PROA     ARG      1428     NE            3.7356
64463 POS      SOD      48       SOD     -**** PROA     ARG      1428     CZ            2.4086
64463 POS      SOD      48       SOD     -**** PROA     ARG      1428     NH1           2.2202
64463 POS      SOD      48       SOD     -**** PROA     ARG      1428     NH2           2.0293
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "48" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.775443405"
Evaluating: 125.050557*(0.775443405-0.5)
 Parameter: XPOS <- "34.4443512"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.544726265"
Evaluating: 125.050557*(0.544726265-0.5)
 Parameter: YPOS <- "5.59304435"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.307265352"
Evaluating: 152.572525*(0.307265352-0.5)+-4.51585405
 Parameter: ZPOS <- "-33.921866"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.921866" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.060339 XMAX =   36.060339 XAVE =   36.060339
    YMIN =  -11.553114 YMAX =  -11.553114 YAVE =  -11.553114
    ZMIN =  -30.457362 ZMAX =  -30.457362 ZAVE =  -30.457362
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.4443512"
 RDCMND substituted energy or value "?XAVE" to "36.0603394"
Evaluating: 34.4443512-36.0603394
 Parameter: XTRAN <- "-1.6159882"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.59304435"
 RDCMND substituted energy or value "?YAVE" to "-11.5531136"
Evaluating: 5.59304435--11.5531136
 Parameter: YTRAN <- "17.1461579"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.921866"
 RDCMND substituted energy or value "?ZAVE" to "-30.457362"
Evaluating: -33.921866--30.457362
 Parameter: ZTRAN <- "-3.464504"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-1.6159882"
 Parameter: YTRAN -> "17.1461579"
 Parameter: ZTRAN -> "-3.464504"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -1.615988   17.146158   -3.464504
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.905781112"
Evaluating: 0.905781112*360.0
 Parameter: XPHI <- "326.0812"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720679467"
Evaluating: 0.720679467*360.0
 Parameter: YPHI <- "259.444608"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.276075442"
Evaluating: 0.276075442*360.0
 Parameter: ZPHI <- "99.3871591"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.4443512"
 Parameter: YPOS -> "5.59304435"
 Parameter: ZPOS -> "-33.921866"
 Parameter: XPHI -> "326.0812"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.829829   -0.558017
    0.000000    0.558017    0.829829

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   33.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.4443512"
 Parameter: YPOS -> "5.59304435"
 Parameter: ZPOS -> "-33.921866"
 Parameter: YPHI -> "259.444608"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.183186    0.000000    0.983078
    0.000000    1.000000    0.000000
   -0.983078    0.000000   -0.183186

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  100.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.4443512"
 Parameter: YPOS -> "5.59304435"
 Parameter: ZPOS -> "-33.921866"
 Parameter: ZPHI -> "99.3871591"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.163105    0.986609    0.000000
   -0.986609   -0.163105    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   99.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.444351 XMAX =   34.444351 XAVE =   34.444351
    YMIN =    5.593044 YMAX =    5.593044 YAVE =    5.593044
    ZMIN =  -33.921866 ZMAX =  -33.921866 ZAVE =  -33.921866
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.4443512"
Evaluating: 34.4443512+3.5
 Parameter: XMAX <- "37.9443512"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.59304438"
Evaluating: 5.59304438+3.5
 Parameter: YMAX <- "9.09304438"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.921866"
Evaluating: -33.921866+3.5
 Parameter: ZMAX <- "-30.421866"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.4443512"
Evaluating: 34.4443512-3.5
 Parameter: XMIN <- "30.9443512"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.59304438"
Evaluating: 5.59304438-3.5
 Parameter: YMIN <- "2.09304438"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.921866"
Evaluating: -33.921866-3.5
 Parameter: ZMIN <- "-37.421866"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.9443512"
 Parameter: XMIN -> "30.9443512"
 Parameter: YMAX -> "9.09304438"
 Parameter: YMIN -> "2.09304438"
 Parameter: ZMAX -> "-30.421866"
 Parameter: ZMIN -> "-37.421866"
 SELRPN>     31 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     18 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64463 POS      SOD      48       SOD     -**** PROA     PRO      1097     CB            4.6063
64463 POS      SOD      48       SOD     -**** PROA     TRP      1406     CG            4.0299
64463 POS      SOD      48       SOD     -**** PROA     TRP      1406     CD1           2.9207
64463 POS      SOD      48       SOD     -**** PROA     TRP      1406     NE1           2.1146
64463 POS      SOD      48       SOD     -**** PROA     TRP      1406     CE2           3.0961
64463 POS      SOD      48       SOD     -**** PROA     TRP      1406     CD2           4.1186
64463 POS      SOD      48       SOD     -**** PROA     TRP      1406     CZ2           3.6714
64463 POS      SOD      48       SOD     -**** PROA     ASP      1410     N             4.1970
64463 POS      SOD      48       SOD     -**** PROA     ASP      1410     CA            3.8738
64463 POS      SOD      48       SOD     -**** PROA     ASP      1410     CB            2.5514
64463 POS      SOD      48       SOD     -**** PROA     ASP      1410     CG            1.5968
64463 POS      SOD      48       SOD     -**** PROA     ASP      1410     OD1           2.4289
64463 POS      SOD      48       SOD     -**** PROA     ASP      1410     OD2           0.9924
64463 POS      SOD      48       SOD     -**** PROA     GLU      1412     C             4.7983
64463 POS      SOD      48       SOD     -**** PROA     GLU      1412     O             4.1274
64463 POS      SOD      48       SOD     -**** PROA     ALA      1413     O             3.0755
64463 POS      SOD      48       SOD     -**** PROA     GLY      1415     O             4.2536
64463 POS      SOD      48       SOD     -**** PROA     ILE      1417     CG2           4.1173
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        18
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "18"
 Comparing "18" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "48" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.742461565"
Evaluating: 125.050557*(0.742461565-0.5)
 Parameter: XPOS <- "30.3199538"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.142141999"
Evaluating: 125.050557*(0.142141999-0.5)
 Parameter: YPOS <- "-44.7503424"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.830097486"
Evaluating: 152.572525*(0.830097486-0.5)+-4.51585405
 Parameter: ZPOS <- "45.8479529"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.8479529" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.8479529" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.444351 XMAX =   34.444351 XAVE =   34.444351
    YMIN =    5.593044 YMAX =    5.593044 YAVE =    5.593044
    ZMIN =  -33.921866 ZMAX =  -33.921866 ZAVE =  -33.921866
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.3199538"
 RDCMND substituted energy or value "?XAVE" to "34.4443512"
Evaluating: 30.3199538-34.4443512
 Parameter: XTRAN <- "-4.1243974"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.7503424"
 RDCMND substituted energy or value "?YAVE" to "5.59304438"
Evaluating: -44.7503424-5.59304438
 Parameter: YTRAN <- "-50.3433868"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.8479529"
 RDCMND substituted energy or value "?ZAVE" to "-33.921866"
Evaluating: 45.8479529--33.921866
 Parameter: ZTRAN <- "79.7698189"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.1243974"
 Parameter: YTRAN -> "-50.3433868"
 Parameter: ZTRAN -> "79.7698189"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -4.124397  -50.343387   79.769819
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.036444913E-02"
Evaluating: 4.036444913E-02*360.0
 Parameter: XPHI <- "14.5312017"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.414839786"
Evaluating: 0.414839786*360.0
 Parameter: YPHI <- "149.342323"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.622229038"
Evaluating: 0.622229038*360.0
 Parameter: ZPHI <- "224.002454"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.3199538"
 Parameter: YPOS -> "-44.7503424"
 Parameter: ZPOS -> "45.8479529"
 Parameter: XPHI -> "14.5312017"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.968011    0.250907
    0.000000   -0.250907    0.968011

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   14.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.3199538"
 Parameter: YPOS -> "-44.7503424"
 Parameter: ZPOS -> "45.8479529"
 Parameter: YPHI -> "149.342323"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.860229    0.000000   -0.509908
    0.000000    1.000000    0.000000
    0.509908    0.000000   -0.860229

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  149.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.3199538"
 Parameter: YPOS -> "-44.7503424"
 Parameter: ZPOS -> "45.8479529"
 Parameter: ZPHI -> "224.002454"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.719310   -0.694689    0.000000
    0.694689   -0.719310    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  136.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.319954 XMAX =   30.319954 XAVE =   30.319954
    YMIN =  -44.750342 YMAX =  -44.750342 YAVE =  -44.750342
    ZMIN =   45.847953 ZMAX =   45.847953 ZAVE =   45.847953
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.3199538"
Evaluating: 30.3199538+3.5
 Parameter: XMAX <- "33.8199538"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.7503424"
Evaluating: -44.7503424+3.5
 Parameter: YMAX <- "-41.2503424"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.8479529"
Evaluating: 45.8479529+3.5
 Parameter: ZMAX <- "49.3479529"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.3199538"
Evaluating: 30.3199538-3.5
 Parameter: XMIN <- "26.8199538"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.7503424"
Evaluating: -44.7503424-3.5
 Parameter: YMIN <- "-48.2503424"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.8479529"
Evaluating: 45.8479529-3.5
 Parameter: ZMIN <- "42.3479529"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.8199538"
 Parameter: XMIN -> "26.8199538"
 Parameter: YMAX -> "-41.2503424"
 Parameter: YMIN -> "-48.2503424"
 Parameter: ZMAX -> "49.3479529"
 Parameter: ZMIN -> "42.3479529"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "49" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "49" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.453809411"
Evaluating: 125.050557*(0.453809411-0.5)
 Parameter: XPOS <- "-5.77615888"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "8.958477722E-02"
Evaluating: 125.050557*(8.958477722E-02-0.5)
 Parameter: YPOS <- "-51.3226522"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.599149325"
Evaluating: 152.572525*(0.599149325-0.5)+-4.51585405
 Parameter: ZPOS <- "10.6116088"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.6116088" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.6116088" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "49" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.927424539"
Evaluating: 125.050557*(0.927424539-0.5)
 Parameter: XPOS <- "53.4496767"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.609909546"
Evaluating: 125.050557*(0.609909546-0.5)
 Parameter: YPOS <- "13.7442499"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.132380575"
Evaluating: 152.572525*(0.132380575-0.5)+-4.51585405
 Parameter: ZPOS <- "-60.604478"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-60.604478" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "53.4496767"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 53.4496767-0
 Parameter: XTRAN <- "53.4496767"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.7442499"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.7442499-0
 Parameter: YTRAN <- "13.7442499"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-60.604478"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -60.604478-0
 Parameter: ZTRAN <- "-60.604478"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "53.4496767"
 Parameter: YTRAN -> "13.7442499"
 Parameter: ZTRAN -> "-60.604478"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    53.449677   13.744250  -60.604478
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.667873033"
Evaluating: 0.667873033*360.0
 Parameter: XPHI <- "240.434292"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.782392571E-04"
Evaluating: 1.782392571E-04*360.0
 Parameter: YPHI <- "6.416613256E-02"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.718091917"
Evaluating: 0.718091917*360.0
 Parameter: ZPHI <- "258.51309"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "53.4496767"
 Parameter: YPOS -> "13.7442499"
 Parameter: ZPOS -> "-60.604478"
 Parameter: XPHI -> "240.434292"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.493421   -0.869790
    0.000000    0.869790   -0.493421

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  119.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "53.4496767"
 Parameter: YPOS -> "13.7442499"
 Parameter: ZPOS -> "-60.604478"
 Parameter: YPHI -> "6.416613256E-02"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999999    0.000000   -0.001120
    0.000000    1.000000    0.000000
    0.001120    0.000000    0.999999

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    0.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "53.4496767"
 Parameter: YPOS -> "13.7442499"
 Parameter: ZPOS -> "-60.604478"
 Parameter: ZPHI -> "258.51309"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.199144   -0.979970    0.000000
    0.979970   -0.199144    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  101.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   53.449677 XMAX =   53.449677 XAVE =   53.449677
    YMIN =   13.744250 YMAX =   13.744250 YAVE =   13.744250
    ZMIN =  -60.604478 ZMAX =  -60.604478 ZAVE =  -60.604478
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "53.4496767"
Evaluating: 53.4496767+3.5
 Parameter: XMAX <- "56.9496767"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.7442499"
Evaluating: 13.7442499+3.5
 Parameter: YMAX <- "17.2442499"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-60.604478"
Evaluating: -60.604478+3.5
 Parameter: ZMAX <- "-57.104478"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "53.4496767"
Evaluating: 53.4496767-3.5
 Parameter: XMIN <- "49.9496767"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.7442499"
Evaluating: 13.7442499-3.5
 Parameter: YMIN <- "10.2442499"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-60.604478"
Evaluating: -60.604478-3.5
 Parameter: ZMIN <- "-64.104478"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "56.9496767"
 Parameter: XMIN -> "49.9496767"
 Parameter: YMAX -> "17.2442499"
 Parameter: YMIN -> "10.2442499"
 Parameter: ZMAX -> "-57.104478"
 Parameter: ZMIN -> "-64.104478"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "50" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "50" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.452154198"
Evaluating: 125.050557*(0.452154198-0.5)
 Parameter: XPOS <- "-5.98314419"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "6.545852989E-02"
Evaluating: 125.050557*(6.545852989E-02-0.5)
 Parameter: YPOS <- "-54.3396529"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "8.002031119E-02"
Evaluating: 152.572525*(8.002031119E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-68.5932156"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-68.5932156" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.98314419"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.98314419-0
 Parameter: XTRAN <- "-5.98314419"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-54.3396529"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -54.3396529-0
 Parameter: YTRAN <- "-54.3396529"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-68.5932156"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -68.5932156-0
 Parameter: ZTRAN <- "-68.5932156"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.98314419"
 Parameter: YTRAN -> "-54.3396529"
 Parameter: ZTRAN -> "-68.5932156"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -5.983144  -54.339653  -68.593216
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.662817553"
Evaluating: 0.662817553*360.0
 Parameter: XPHI <- "238.614319"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.329140421"
Evaluating: 0.329140421*360.0
 Parameter: YPHI <- "118.490552"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.632782345"
Evaluating: 0.632782345*360.0
 Parameter: ZPHI <- "227.801644"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.98314419"
 Parameter: YPOS -> "-54.3396529"
 Parameter: ZPOS -> "-68.5932156"
 Parameter: XPHI -> "238.614319"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.520796   -0.853681
    0.000000    0.853681   -0.520796

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  121.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.98314419"
 Parameter: YPOS -> "-54.3396529"
 Parameter: ZPOS -> "-68.5932156"
 Parameter: YPHI -> "118.490552"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.477014    0.000000   -0.878896
    0.000000    1.000000    0.000000
    0.878896    0.000000   -0.477014

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  118.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.98314419"
 Parameter: YPOS -> "-54.3396529"
 Parameter: ZPOS -> "-68.5932156"
 Parameter: ZPHI -> "227.801644"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.671699   -0.740824    0.000000
    0.740824   -0.671699    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  132.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.983144 XMAX =   -5.983144 XAVE =   -5.983144
    YMIN =  -54.339653 YMAX =  -54.339653 YAVE =  -54.339653
    ZMIN =  -68.593216 ZMAX =  -68.593216 ZAVE =  -68.593216
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.98314419"
Evaluating: -5.98314419+3.5
 Parameter: XMAX <- "-2.48314419"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-54.3396529"
Evaluating: -54.3396529+3.5
 Parameter: YMAX <- "-50.8396529"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-68.5932156"
Evaluating: -68.5932156+3.5
 Parameter: ZMAX <- "-65.0932156"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.98314419"
Evaluating: -5.98314419-3.5
 Parameter: XMIN <- "-9.48314419"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-54.3396529"
Evaluating: -54.3396529-3.5
 Parameter: YMIN <- "-57.8396529"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-68.5932156"
Evaluating: -68.5932156-3.5
 Parameter: ZMIN <- "-72.0932156"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.48314419"
 Parameter: XMIN -> "-9.48314419"
 Parameter: YMAX -> "-50.8396529"
 Parameter: YMIN -> "-57.8396529"
 Parameter: ZMAX -> "-65.0932156"
 Parameter: ZMIN -> "-72.0932156"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "51" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "51" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.419819103"
Evaluating: 125.050557*(0.419819103-0.5)
 Parameter: XPOS <- "-10.0266658"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.546090942"
Evaluating: 125.050557*(0.546090942-0.5)
 Parameter: YPOS <- "5.76369797"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.364493609"
Evaluating: 152.572525*(0.364493609-0.5)+-4.51585405
 Parameter: ZPOS <- "-25.1904063"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.1904063" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.0266658"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.0266658-0
 Parameter: XTRAN <- "-10.0266658"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.76369797"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.76369797-0
 Parameter: YTRAN <- "5.76369797"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.1904063"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.1904063-0
 Parameter: ZTRAN <- "-25.1904063"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.0266658"
 Parameter: YTRAN -> "5.76369797"
 Parameter: ZTRAN -> "-25.1904063"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -10.026666    5.763698  -25.190406
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.626174775"
Evaluating: 0.626174775*360.0
 Parameter: XPHI <- "225.422919"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.732691747"
Evaluating: 0.732691747*360.0
 Parameter: YPHI <- "263.769029"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.593614786"
Evaluating: 0.593614786*360.0
 Parameter: ZPHI <- "213.701323"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.0266658"
 Parameter: YPOS -> "5.76369797"
 Parameter: ZPOS -> "-25.1904063"
 Parameter: XPHI -> "225.422919"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.701868   -0.712307
    0.000000    0.712307   -0.701868

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  134.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.0266658"
 Parameter: YPOS -> "5.76369797"
 Parameter: ZPOS -> "-25.1904063"
 Parameter: YPHI -> "263.769029"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.108537    0.000000    0.994092
    0.000000    1.000000    0.000000
   -0.994092    0.000000   -0.108537

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   96.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.0266658"
 Parameter: YPOS -> "5.76369797"
 Parameter: ZPOS -> "-25.1904063"
 Parameter: ZPHI -> "213.701323"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.831941   -0.554864    0.000000
    0.554864   -0.831941    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  146.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.026666 XMAX =  -10.026666 XAVE =  -10.026666
    YMIN =    5.763698 YMAX =    5.763698 YAVE =    5.763698
    ZMIN =  -25.190406 ZMAX =  -25.190406 ZAVE =  -25.190406
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.0266658"
Evaluating: -10.0266658+3.5
 Parameter: XMAX <- "-6.5266658"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.76369797"
Evaluating: 5.76369797+3.5
 Parameter: YMAX <- "9.26369797"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.1904063"
Evaluating: -25.1904063+3.5
 Parameter: ZMAX <- "-21.6904063"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.0266658"
Evaluating: -10.0266658-3.5
 Parameter: XMIN <- "-13.5266658"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.76369797"
Evaluating: 5.76369797-3.5
 Parameter: YMIN <- "2.26369797"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.1904063"
Evaluating: -25.1904063-3.5
 Parameter: ZMIN <- "-28.6904063"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.5266658"
 Parameter: XMIN -> "-13.5266658"
 Parameter: YMAX -> "9.26369797"
 Parameter: YMIN -> "2.26369797"
 Parameter: ZMAX -> "-21.6904063"
 Parameter: ZMIN -> "-28.6904063"
 SELRPN>     15 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      9 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64466 POS      SOD      51       SOD     -9646 PROA     GLU      668      CD            3.2791
64466 POS      SOD      51       SOD     -9647 PROA     GLU      668      OE1           3.5016
64466 POS      SOD      51       SOD     -9648 PROA     GLU      668      OE2           2.4127
64466 POS      SOD      51       SOD     -9651 PROA     GLU      668      O             4.2809
64466 POS      SOD      51       SOD     -9700 PROA     SER      672      CB            3.1948
64466 POS      SOD      51       SOD     -9703 PROA     SER      672      OG            3.6225
64466 POS      SOD      51       SOD     -**** PROA     GLU      1070     CG            4.3383
64466 POS      SOD      51       SOD     -**** PROA     GLU      1070     CD            3.7735
64466 POS      SOD      51       SOD     -**** PROA     GLU      1070     OE1           3.5119
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "51" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.715438688"
Evaluating: 125.050557*(0.715438688-0.5)
 Parameter: XPOS <- "26.9407279"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.964698002"
Evaluating: 125.050557*(0.964698002-0.5)
 Parameter: YPOS <- "58.110744"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "9.00327029E-02"
Evaluating: 152.572525*(9.00327029E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-67.0655997"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-67.0655997" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.026666 XMAX =  -10.026666 XAVE =  -10.026666
    YMIN =    5.763698 YMAX =    5.763698 YAVE =    5.763698
    ZMIN =  -25.190406 ZMAX =  -25.190406 ZAVE =  -25.190406
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.9407279"
 RDCMND substituted energy or value "?XAVE" to "-10.0266658"
Evaluating: 26.9407279--10.0266658
 Parameter: XTRAN <- "36.9673937"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "58.110744"
 RDCMND substituted energy or value "?YAVE" to "5.76369797"
Evaluating: 58.110744-5.76369797
 Parameter: YTRAN <- "52.347046"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-67.0655997"
 RDCMND substituted energy or value "?ZAVE" to "-25.1904063"
Evaluating: -67.0655997--25.1904063
 Parameter: ZTRAN <- "-41.8751934"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.9673937"
 Parameter: YTRAN -> "52.347046"
 Parameter: ZTRAN -> "-41.8751934"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    36.967394   52.347046  -41.875193
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.246742057"
Evaluating: 0.246742057*360.0
 Parameter: XPHI <- "88.8271405"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.140523734E-02"
Evaluating: 3.140523734E-02*360.0
 Parameter: YPHI <- "11.3058854"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.404824522"
Evaluating: 0.404824522*360.0
 Parameter: ZPHI <- "145.736828"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.9407279"
 Parameter: YPOS -> "58.110744"
 Parameter: ZPOS -> "-67.0655997"
 Parameter: XPHI -> "88.8271405"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.020469    0.999790
    0.000000   -0.999790    0.020469

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   88.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.9407279"
 Parameter: YPOS -> "58.110744"
 Parameter: ZPOS -> "-67.0655997"
 Parameter: YPHI -> "11.3058854"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.980595    0.000000   -0.196047
    0.000000    1.000000    0.000000
    0.196047    0.000000    0.980595

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   11.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.9407279"
 Parameter: YPOS -> "58.110744"
 Parameter: ZPOS -> "-67.0655997"
 Parameter: ZPHI -> "145.736828"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.826460    0.562995    0.000000
   -0.562995   -0.826460    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  145.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.940728 XMAX =   26.940728 XAVE =   26.940728
    YMIN =   58.110744 YMAX =   58.110744 YAVE =   58.110744
    ZMIN =  -67.065600 ZMAX =  -67.065600 ZAVE =  -67.065600
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.9407279"
Evaluating: 26.9407279+3.5
 Parameter: XMAX <- "30.4407279"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "58.110744"
Evaluating: 58.110744+3.5
 Parameter: YMAX <- "61.610744"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-67.0655997"
Evaluating: -67.0655997+3.5
 Parameter: ZMAX <- "-63.5655997"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.9407279"
Evaluating: 26.9407279-3.5
 Parameter: XMIN <- "23.4407279"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "58.110744"
Evaluating: 58.110744-3.5
 Parameter: YMIN <- "54.610744"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-67.0655997"
Evaluating: -67.0655997-3.5
 Parameter: ZMIN <- "-70.5655997"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.4407279"
 Parameter: XMIN -> "23.4407279"
 Parameter: YMAX -> "61.610744"
 Parameter: YMIN -> "54.610744"
 Parameter: ZMAX -> "-63.5655997"
 Parameter: ZMIN -> "-70.5655997"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "52" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "52" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.394687923"
Evaluating: 125.050557*(0.394687923-0.5)
 Parameter: XPOS <- "-13.1693339"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.867527728"
Evaluating: 125.050557*(0.867527728-0.5)
 Parameter: YPOS <- "45.9595471"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.201812281"
Evaluating: 152.572525*(0.201812281-0.5)+-4.51585405
 Parameter: ZPOS <- "-50.0111073"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.0111073" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.1693339"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.1693339-0
 Parameter: XTRAN <- "-13.1693339"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.9595471"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 45.9595471-0
 Parameter: YTRAN <- "45.9595471"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.0111073"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.0111073-0
 Parameter: ZTRAN <- "-50.0111073"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.1693339"
 Parameter: YTRAN -> "45.9595471"
 Parameter: ZTRAN -> "-50.0111073"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -13.169334   45.959547  -50.011107
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.290466107"
Evaluating: 0.290466107*360.0
 Parameter: XPHI <- "104.567799"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.957164833"
Evaluating: 0.957164833*360.0
 Parameter: YPHI <- "344.57934"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.988594866"
Evaluating: 0.988594866*360.0
 Parameter: ZPHI <- "355.894152"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.1693339"
 Parameter: YPOS -> "45.9595471"
 Parameter: ZPOS -> "-50.0111073"
 Parameter: XPHI -> "104.567799"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.251525    0.967851
    0.000000   -0.967851   -0.251525

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  104.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.1693339"
 Parameter: YPOS -> "45.9595471"
 Parameter: ZPOS -> "-50.0111073"
 Parameter: YPHI -> "344.57934"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.964000    0.000000    0.265904
    0.000000    1.000000    0.000000
   -0.265904    0.000000    0.964000

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   15.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.1693339"
 Parameter: YPOS -> "45.9595471"
 Parameter: ZPOS -> "-50.0111073"
 Parameter: ZPHI -> "355.894152"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.997433   -0.071599    0.000000
    0.071599    0.997433    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    4.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.169334 XMAX =  -13.169334 XAVE =  -13.169334
    YMIN =   45.959547 YMAX =   45.959547 YAVE =   45.959547
    ZMIN =  -50.011107 ZMAX =  -50.011107 ZAVE =  -50.011107
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.1693339"
Evaluating: -13.1693339+3.5
 Parameter: XMAX <- "-9.6693339"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.9595471"
Evaluating: 45.9595471+3.5
 Parameter: YMAX <- "49.4595471"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.0111073"
Evaluating: -50.0111073+3.5
 Parameter: ZMAX <- "-46.5111073"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.1693339"
Evaluating: -13.1693339-3.5
 Parameter: XMIN <- "-16.6693339"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.9595471"
Evaluating: 45.9595471-3.5
 Parameter: YMIN <- "42.4595471"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.0111073"
Evaluating: -50.0111073-3.5
 Parameter: ZMIN <- "-53.5111073"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.6693339"
 Parameter: XMIN -> "-16.6693339"
 Parameter: YMAX -> "49.4595471"
 Parameter: YMIN -> "42.4595471"
 Parameter: ZMAX -> "-46.5111073"
 Parameter: ZMIN -> "-53.5111073"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "53" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "53" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.717190412"
Evaluating: 125.050557*(0.717190412-0.5)
 Parameter: XPOS <- "27.159782"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.209683635"
Evaluating: 125.050557*(0.209683635-0.5)
 Parameter: YPOS <- "-36.3042231"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.983926602"
Evaluating: 152.572525*(0.983926602-0.5)+-4.51585405
 Parameter: ZPOS <- "69.3180495"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.3180495" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.3180495" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.159782"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 27.159782-0
 Parameter: XTRAN <- "27.159782"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.3042231"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -36.3042231-0
 Parameter: YTRAN <- "-36.3042231"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.3180495"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 69.3180495-0
 Parameter: ZTRAN <- "69.3180495"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.159782"
 Parameter: YTRAN -> "-36.3042231"
 Parameter: ZTRAN -> "69.3180495"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    27.159782  -36.304223   69.318050
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.392130481"
Evaluating: 0.392130481*360.0
 Parameter: XPHI <- "141.166973"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.516225377"
Evaluating: 0.516225377*360.0
 Parameter: YPHI <- "185.841136"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.279530271"
Evaluating: 0.279530271*360.0
 Parameter: ZPHI <- "100.630898"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.159782"
 Parameter: YPOS -> "-36.3042231"
 Parameter: ZPOS -> "69.3180495"
 Parameter: XPHI -> "141.166973"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.778977    0.627053
    0.000000   -0.627053   -0.778977

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  141.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.159782"
 Parameter: YPOS -> "-36.3042231"
 Parameter: ZPOS -> "69.3180495"
 Parameter: YPHI -> "185.841136"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.994808    0.000000    0.101771
    0.000000    1.000000    0.000000
   -0.101771    0.000000   -0.994808

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  174.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.159782"
 Parameter: YPOS -> "-36.3042231"
 Parameter: ZPOS -> "69.3180495"
 Parameter: ZPHI -> "100.630898"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.184481    0.982836    0.000000
   -0.982836   -0.184481    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  100.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.159782 XMAX =   27.159782 XAVE =   27.159782
    YMIN =  -36.304223 YMAX =  -36.304223 YAVE =  -36.304223
    ZMIN =   69.318050 ZMAX =   69.318050 ZAVE =   69.318050
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.159782"
Evaluating: 27.159782+3.5
 Parameter: XMAX <- "30.659782"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.3042231"
Evaluating: -36.3042231+3.5
 Parameter: YMAX <- "-32.8042231"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.3180495"
Evaluating: 69.3180495+3.5
 Parameter: ZMAX <- "72.8180495"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.159782"
Evaluating: 27.159782-3.5
 Parameter: XMIN <- "23.659782"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.3042231"
Evaluating: -36.3042231-3.5
 Parameter: YMIN <- "-39.8042231"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.3180495"
Evaluating: 69.3180495-3.5
 Parameter: ZMIN <- "65.8180495"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.659782"
 Parameter: XMIN -> "23.659782"
 Parameter: YMAX -> "-32.8042231"
 Parameter: YMIN -> "-39.8042231"
 Parameter: ZMAX -> "72.8180495"
 Parameter: ZMIN -> "65.8180495"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "54" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "54" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.703001251E-02"
Evaluating: 125.050557*(1.703001251E-02-0.5)
 Parameter: XPOS <- "-60.3956659"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.395368569"
Evaluating: 125.050557*(0.395368569-0.5)
 Parameter: YPOS <- "-13.0842187"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.693683725"
Evaluating: 152.572525*(0.693683725-0.5)+-4.51585405
 Parameter: ZPOS <- "25.0349609"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.0349609" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.0349609" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-60.3956659"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -60.3956659-0
 Parameter: XTRAN <- "-60.3956659"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.0842187"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.0842187-0
 Parameter: YTRAN <- "-13.0842187"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.0349609"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.0349609-0
 Parameter: ZTRAN <- "25.0349609"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-60.3956659"
 Parameter: YTRAN -> "-13.0842187"
 Parameter: ZTRAN -> "25.0349609"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -60.395666  -13.084219   25.034961
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.289708429E-02"
Evaluating: 8.289708429E-02*360.0
 Parameter: XPHI <- "29.8429503"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.158142666"
Evaluating: 0.158142666*360.0
 Parameter: YPHI <- "56.9313598"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.742250178"
Evaluating: 0.742250178*360.0
 Parameter: ZPHI <- "267.210064"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-60.3956659"
 Parameter: YPOS -> "-13.0842187"
 Parameter: ZPOS -> "25.0349609"
 Parameter: XPHI -> "29.8429503"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.867393    0.497624
    0.000000   -0.497624    0.867393

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   29.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-60.3956659"
 Parameter: YPOS -> "-13.0842187"
 Parameter: ZPOS -> "25.0349609"
 Parameter: YPHI -> "56.9313598"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.545643    0.000000   -0.838017
    0.000000    1.000000    0.000000
    0.838017    0.000000    0.545643

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   56.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-60.3956659"
 Parameter: YPOS -> "-13.0842187"
 Parameter: ZPOS -> "25.0349609"
 Parameter: ZPHI -> "267.210064"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.048674   -0.998815    0.000000
    0.998815   -0.048674    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   92.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -60.395666 XMAX =  -60.395666 XAVE =  -60.395666
    YMIN =  -13.084219 YMAX =  -13.084219 YAVE =  -13.084219
    ZMIN =   25.034961 ZMAX =   25.034961 ZAVE =   25.034961
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-60.3956659"
Evaluating: -60.3956659+3.5
 Parameter: XMAX <- "-56.8956659"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.0842187"
Evaluating: -13.0842187+3.5
 Parameter: YMAX <- "-9.5842187"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.0349609"
Evaluating: 25.0349609+3.5
 Parameter: ZMAX <- "28.5349609"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-60.3956659"
Evaluating: -60.3956659-3.5
 Parameter: XMIN <- "-63.8956659"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.0842187"
Evaluating: -13.0842187-3.5
 Parameter: YMIN <- "-16.5842187"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.0349609"
Evaluating: 25.0349609-3.5
 Parameter: ZMIN <- "21.5349609"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-56.8956659"
 Parameter: XMIN -> "-63.8956659"
 Parameter: YMAX -> "-9.5842187"
 Parameter: YMIN -> "-16.5842187"
 Parameter: ZMAX -> "28.5349609"
 Parameter: ZMIN -> "21.5349609"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "55" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "55" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.102318254"
Evaluating: 125.050557*(0.102318254-0.5)
 Parameter: XPOS <- "-49.7303238"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.902570821"
Evaluating: 125.050557*(0.902570821-0.5)
 Parameter: YPOS <- "50.3417054"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.229686602"
Evaluating: 152.572525*(0.229686602-0.5)+-4.51585405
 Parameter: ZPOS <- "-45.7582517"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-45.7582517" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-49.7303238"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -49.7303238-0
 Parameter: XTRAN <- "-49.7303238"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "50.3417054"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 50.3417054-0
 Parameter: YTRAN <- "50.3417054"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-45.7582517"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -45.7582517-0
 Parameter: ZTRAN <- "-45.7582517"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.7303238"
 Parameter: YTRAN -> "50.3417054"
 Parameter: ZTRAN -> "-45.7582517"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -49.730324   50.341705  -45.758252
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.300949217"
Evaluating: 0.300949217*360.0
 Parameter: XPHI <- "108.341718"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111066741"
Evaluating: 0.111066741*360.0
 Parameter: YPHI <- "39.9840268"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.739443862"
Evaluating: 0.739443862*360.0
 Parameter: ZPHI <- "266.19979"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-49.7303238"
 Parameter: YPOS -> "50.3417054"
 Parameter: ZPOS -> "-45.7582517"
 Parameter: XPHI -> "108.341718"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.314684    0.949197
    0.000000   -0.949197   -0.314684

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  108.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-49.7303238"
 Parameter: YPOS -> "50.3417054"
 Parameter: ZPOS -> "-45.7582517"
 Parameter: YPHI -> "39.9840268"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.766224    0.000000   -0.642574
    0.000000    1.000000    0.000000
    0.642574    0.000000    0.766224

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   39.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-49.7303238"
 Parameter: YPOS -> "50.3417054"
 Parameter: ZPOS -> "-45.7582517"
 Parameter: ZPHI -> "266.19979"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.066278   -0.997801    0.000000
    0.997801   -0.066278    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   93.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.730324 XMAX =  -49.730324 XAVE =  -49.730324
    YMIN =   50.341705 YMAX =   50.341705 YAVE =   50.341705
    ZMIN =  -45.758252 ZMAX =  -45.758252 ZAVE =  -45.758252
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-49.7303238"
Evaluating: -49.7303238+3.5
 Parameter: XMAX <- "-46.2303238"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "50.3417054"
Evaluating: 50.3417054+3.5
 Parameter: YMAX <- "53.8417054"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-45.7582517"
Evaluating: -45.7582517+3.5
 Parameter: ZMAX <- "-42.2582517"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-49.7303238"
Evaluating: -49.7303238-3.5
 Parameter: XMIN <- "-53.2303238"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "50.3417054"
Evaluating: 50.3417054-3.5
 Parameter: YMIN <- "46.8417054"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-45.7582517"
Evaluating: -45.7582517-3.5
 Parameter: ZMIN <- "-49.2582517"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.2303238"
 Parameter: XMIN -> "-53.2303238"
 Parameter: YMAX -> "53.8417054"
 Parameter: YMIN -> "46.8417054"
 Parameter: ZMAX -> "-42.2582517"
 Parameter: ZMIN -> "-49.2582517"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "56" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "56" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.81893055"
Evaluating: 125.050557*(0.81893055-0.5)
 Parameter: XPOS <- "39.8824429"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.77156222"
Evaluating: 125.050557*(0.77156222-0.5)
 Parameter: YPOS <- "33.9590069"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.333473197"
Evaluating: 152.572525*(0.333473197-0.5)+-4.51585405
 Parameter: ZPOS <- "-29.9232689"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.9232689" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.8824429"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.8824429-0
 Parameter: XTRAN <- "39.8824429"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.9590069"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.9590069-0
 Parameter: YTRAN <- "33.9590069"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.9232689"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.9232689-0
 Parameter: ZTRAN <- "-29.9232689"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.8824429"
 Parameter: YTRAN -> "33.9590069"
 Parameter: ZTRAN -> "-29.9232689"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    39.882443   33.959007  -29.923269
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.333187573"
Evaluating: 0.333187573*360.0
 Parameter: XPHI <- "119.947526"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.6347352"
Evaluating: 0.6347352*360.0
 Parameter: YPHI <- "228.504672"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.921777956"
Evaluating: 0.921777956*360.0
 Parameter: ZPHI <- "331.840064"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.8824429"
 Parameter: YPOS -> "33.9590069"
 Parameter: ZPOS -> "-29.9232689"
 Parameter: XPHI -> "119.947526"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.499207    0.866483
    0.000000   -0.866483   -0.499207

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  119.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.8824429"
 Parameter: YPOS -> "33.9590069"
 Parameter: ZPOS -> "-29.9232689"
 Parameter: YPHI -> "228.504672"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.662559    0.000000    0.749010
    0.000000    1.000000    0.000000
   -0.749010    0.000000   -0.662559

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  131.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.8824429"
 Parameter: YPOS -> "33.9590069"
 Parameter: ZPOS -> "-29.9232689"
 Parameter: ZPHI -> "331.840064"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.881634   -0.471934    0.000000
    0.471934    0.881634    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.882443 XMAX =   39.882443 XAVE =   39.882443
    YMIN =   33.959007 YMAX =   33.959007 YAVE =   33.959007
    ZMIN =  -29.923269 ZMAX =  -29.923269 ZAVE =  -29.923269
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.8824429"
Evaluating: 39.8824429+3.5
 Parameter: XMAX <- "43.3824429"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.9590069"
Evaluating: 33.9590069+3.5
 Parameter: YMAX <- "37.4590069"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.9232689"
Evaluating: -29.9232689+3.5
 Parameter: ZMAX <- "-26.4232689"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.8824429"
Evaluating: 39.8824429-3.5
 Parameter: XMIN <- "36.3824429"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.9590069"
Evaluating: 33.9590069-3.5
 Parameter: YMIN <- "30.4590069"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.9232689"
Evaluating: -29.9232689-3.5
 Parameter: ZMIN <- "-33.4232689"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.3824429"
 Parameter: XMIN -> "36.3824429"
 Parameter: YMAX -> "37.4590069"
 Parameter: YMIN -> "30.4590069"
 Parameter: ZMAX -> "-26.4232689"
 Parameter: ZMIN -> "-33.4232689"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "57" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "57" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.954204595"
Evaluating: 125.050557*(0.954204595-0.5)
 Parameter: XPOS <- "56.7985376"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.308252281"
Evaluating: 125.050557*(0.308252281-0.5)
 Parameter: YPOS <- "-23.9781591"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.578516624"
Evaluating: 152.572525*(0.578516624-0.5)+-4.51585405
 Parameter: ZPOS <- "7.46362553"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.46362553" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.46362553" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "57" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.241129308"
Evaluating: 125.050557*(0.241129308-0.5)
 Parameter: XPOS <- "-32.3719242"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.971483379"
Evaluating: 125.050557*(0.971483379-0.5)
 Parameter: YPOS <- "58.9592592"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.7722133"
Evaluating: 152.572525*(0.7722133-0.5)+-4.51585405
 Parameter: ZPOS <- "37.0164165"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.0164165" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.0164165" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.3719242"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.3719242-0
 Parameter: XTRAN <- "-32.3719242"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "58.9592592"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 58.9592592-0
 Parameter: YTRAN <- "58.9592592"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.0164165"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.0164165-0
 Parameter: ZTRAN <- "37.0164165"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.3719242"
 Parameter: YTRAN -> "58.9592592"
 Parameter: ZTRAN -> "37.0164165"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -32.371924   58.959259   37.016416
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.93435273"
Evaluating: 0.93435273*360.0
 Parameter: XPHI <- "336.366983"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.26816441"
Evaluating: 0.26816441*360.0
 Parameter: YPHI <- "96.5391876"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.381693153"
Evaluating: 0.381693153*360.0
 Parameter: ZPHI <- "137.409535"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.3719242"
 Parameter: YPOS -> "58.9592592"
 Parameter: ZPOS -> "37.0164165"
 Parameter: XPHI -> "336.366983"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.916132   -0.400877
    0.000000    0.400877    0.916132

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   23.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.3719242"
 Parameter: YPOS -> "58.9592592"
 Parameter: ZPOS -> "37.0164165"
 Parameter: YPHI -> "96.5391876"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.113883    0.000000   -0.993494
    0.000000    1.000000    0.000000
    0.993494    0.000000   -0.113883

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   96.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.3719242"
 Parameter: YPOS -> "58.9592592"
 Parameter: ZPOS -> "37.0164165"
 Parameter: ZPHI -> "137.409535"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.736210    0.676753    0.000000
   -0.676753   -0.736210    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  137.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.371924 XMAX =  -32.371924 XAVE =  -32.371924
    YMIN =   58.959259 YMAX =   58.959259 YAVE =   58.959259
    ZMIN =   37.016416 ZMAX =   37.016416 ZAVE =   37.016416
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.3719242"
Evaluating: -32.3719242+3.5
 Parameter: XMAX <- "-28.8719242"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "58.9592592"
Evaluating: 58.9592592+3.5
 Parameter: YMAX <- "62.4592592"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.0164165"
Evaluating: 37.0164165+3.5
 Parameter: ZMAX <- "40.5164165"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.3719242"
Evaluating: -32.3719242-3.5
 Parameter: XMIN <- "-35.8719242"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "58.9592592"
Evaluating: 58.9592592-3.5
 Parameter: YMIN <- "55.4592592"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.0164165"
Evaluating: 37.0164165-3.5
 Parameter: ZMIN <- "33.5164165"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.8719242"
 Parameter: XMIN -> "-35.8719242"
 Parameter: YMAX -> "62.4592592"
 Parameter: YMIN -> "55.4592592"
 Parameter: ZMAX -> "40.5164165"
 Parameter: ZMIN -> "33.5164165"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "58"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "58" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "58" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.773949725"
Evaluating: 125.050557*(0.773949725-0.5)
 Parameter: XPOS <- "34.2575657"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.446907745"
Evaluating: 125.050557*(0.446907745-0.5)
 Parameter: YPOS <- "-6.63921606"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.842156603"
Evaluating: 152.572525*(0.842156603-0.5)+-4.51585405
 Parameter: ZPOS <- "47.6878428"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.6878428" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.6878428" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.2575657"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.2575657-0
 Parameter: XTRAN <- "34.2575657"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.63921606"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.63921606-0
 Parameter: YTRAN <- "-6.63921606"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.6878428"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.6878428-0
 Parameter: ZTRAN <- "47.6878428"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.2575657"
 Parameter: YTRAN -> "-6.63921606"
 Parameter: ZTRAN -> "47.6878428"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    34.257566   -6.639216   47.687843
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.098140215E-03"
Evaluating: 5.098140215E-03*360.0
 Parameter: XPHI <- "1.83533048"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.46697926"
Evaluating: 0.46697926*360.0
 Parameter: YPHI <- "168.112534"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.95428598"
Evaluating: 0.95428598*360.0
 Parameter: ZPHI <- "343.542953"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.2575657"
 Parameter: YPOS -> "-6.63921606"
 Parameter: ZPOS -> "47.6878428"
 Parameter: XPHI -> "1.83533048"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999487    0.032027
    0.000000   -0.032027    0.999487

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    1.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.2575657"
 Parameter: YPOS -> "-6.63921606"
 Parameter: ZPOS -> "47.6878428"
 Parameter: YPHI -> "168.112534"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.978554    0.000000   -0.205990
    0.000000    1.000000    0.000000
    0.205990    0.000000   -0.978554

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  168.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.2575657"
 Parameter: YPOS -> "-6.63921606"
 Parameter: ZPOS -> "47.6878428"
 Parameter: ZPHI -> "343.542953"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.959032   -0.283296    0.000000
    0.283296    0.959032    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   16.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.257566 XMAX =   34.257566 XAVE =   34.257566
    YMIN =   -6.639216 YMAX =   -6.639216 YAVE =   -6.639216
    ZMIN =   47.687843 ZMAX =   47.687843 ZAVE =   47.687843
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.2575657"
Evaluating: 34.2575657+3.5
 Parameter: XMAX <- "37.7575657"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.63921606"
Evaluating: -6.63921606+3.5
 Parameter: YMAX <- "-3.13921606"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.6878428"
Evaluating: 47.6878428+3.5
 Parameter: ZMAX <- "51.1878428"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.2575657"
Evaluating: 34.2575657-3.5
 Parameter: XMIN <- "30.7575657"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.63921606"
Evaluating: -6.63921606-3.5
 Parameter: YMIN <- "-10.1392161"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.6878428"
Evaluating: 47.6878428-3.5
 Parameter: ZMIN <- "44.1878428"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.7575657"
 Parameter: XMIN -> "30.7575657"
 Parameter: YMAX -> "-3.13921606"
 Parameter: YMIN -> "-10.1392161"
 Parameter: ZMAX -> "51.1878428"
 Parameter: ZMIN -> "44.1878428"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "59"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "59" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "59" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.764078589"
Evaluating: 125.050557*(0.764078589-0.5)
 Parameter: XPOS <- "33.0231746"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.348599414"
Evaluating: 125.050557*(0.348599414-0.5)
 Parameter: YPOS <- "-18.9327276"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.328107629"
Evaluating: 152.572525*(0.328107629-0.5)+-4.51585405
 Parameter: ZPOS <- "-30.7419071"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.7419071" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.0231746"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.0231746-0
 Parameter: XTRAN <- "33.0231746"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.9327276"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.9327276-0
 Parameter: YTRAN <- "-18.9327276"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.7419071"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.7419071-0
 Parameter: ZTRAN <- "-30.7419071"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.0231746"
 Parameter: YTRAN -> "-18.9327276"
 Parameter: ZTRAN -> "-30.7419071"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    33.023175  -18.932728  -30.741907
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.49479926E-02"
Evaluating: 3.49479926E-02*360.0
 Parameter: XPHI <- "12.5812773"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.408725895"
Evaluating: 0.408725895*360.0
 Parameter: YPHI <- "147.141322"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.913903341"
Evaluating: 0.913903341*360.0
 Parameter: ZPHI <- "329.005203"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.0231746"
 Parameter: YPOS -> "-18.9327276"
 Parameter: ZPOS -> "-30.7419071"
 Parameter: XPHI -> "12.5812773"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.975988    0.217824
    0.000000   -0.217824    0.975988

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   12.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.0231746"
 Parameter: YPOS -> "-18.9327276"
 Parameter: ZPOS -> "-30.7419071"
 Parameter: YPHI -> "147.141322"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.840011    0.000000   -0.542569
    0.000000    1.000000    0.000000
    0.542569    0.000000   -0.840011

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  147.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.0231746"
 Parameter: YPOS -> "-18.9327276"
 Parameter: ZPOS -> "-30.7419071"
 Parameter: ZPHI -> "329.005203"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.857214   -0.514960    0.000000
    0.514960    0.857214    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   30.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.023175 XMAX =   33.023175 XAVE =   33.023175
    YMIN =  -18.932728 YMAX =  -18.932728 YAVE =  -18.932728
    ZMIN =  -30.741907 ZMAX =  -30.741907 ZAVE =  -30.741907
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.0231746"
Evaluating: 33.0231746+3.5
 Parameter: XMAX <- "36.5231746"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.9327276"
Evaluating: -18.9327276+3.5
 Parameter: YMAX <- "-15.4327276"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.7419071"
Evaluating: -30.7419071+3.5
 Parameter: ZMAX <- "-27.2419071"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.0231746"
Evaluating: 33.0231746-3.5
 Parameter: XMIN <- "29.5231746"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.9327276"
Evaluating: -18.9327276-3.5
 Parameter: YMIN <- "-22.4327276"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.7419071"
Evaluating: -30.7419071-3.5
 Parameter: ZMIN <- "-34.2419071"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.5231746"
 Parameter: XMIN -> "29.5231746"
 Parameter: YMAX -> "-15.4327276"
 Parameter: YMIN -> "-22.4327276"
 Parameter: ZMAX -> "-27.2419071"
 Parameter: ZMIN -> "-34.2419071"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "60"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "60" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "60" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.73103831"
Evaluating: 125.050557*(0.73103831-0.5)
 Parameter: XPOS <- "28.8914694"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "8.38676587E-02"
Evaluating: 125.050557*(8.38676587E-02-0.5)
 Parameter: YPOS <- "-52.0375811"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.388258742"
Evaluating: 152.572525*(0.388258742-0.5)+-4.51585405
 Parameter: ZPOS <- "-21.5644999"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.5644999" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.8914694"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.8914694-0
 Parameter: XTRAN <- "28.8914694"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-52.0375811"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -52.0375811-0
 Parameter: YTRAN <- "-52.0375811"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.5644999"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.5644999-0
 Parameter: ZTRAN <- "-21.5644999"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.8914694"
 Parameter: YTRAN -> "-52.0375811"
 Parameter: ZTRAN -> "-21.5644999"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    28.891469  -52.037581  -21.564500
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.321157184"
Evaluating: 0.321157184*360.0
 Parameter: XPHI <- "115.616586"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.220015613"
Evaluating: 0.220015613*360.0
 Parameter: YPHI <- "79.2056207"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.990278092"
Evaluating: 0.990278092*360.0
 Parameter: ZPHI <- "356.500113"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.8914694"
 Parameter: YPOS -> "-52.0375811"
 Parameter: ZPOS -> "-21.5644999"
 Parameter: XPHI -> "115.616586"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.432347    0.901707
    0.000000   -0.901707   -0.432347

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  115.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.8914694"
 Parameter: YPOS -> "-52.0375811"
 Parameter: ZPOS -> "-21.5644999"
 Parameter: YPHI -> "79.2056207"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.187285    0.000000   -0.982306
    0.000000    1.000000    0.000000
    0.982306    0.000000    0.187285

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   79.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.8914694"
 Parameter: YPOS -> "-52.0375811"
 Parameter: ZPOS -> "-21.5644999"
 Parameter: ZPHI -> "356.500113"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.998135   -0.061047    0.000000
    0.061047    0.998135    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    3.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.891469 XMAX =   28.891469 XAVE =   28.891469
    YMIN =  -52.037581 YMAX =  -52.037581 YAVE =  -52.037581
    ZMIN =  -21.564500 ZMAX =  -21.564500 ZAVE =  -21.564500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.8914694"
Evaluating: 28.8914694+3.5
 Parameter: XMAX <- "32.3914694"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-52.0375811"
Evaluating: -52.0375811+3.5
 Parameter: YMAX <- "-48.5375811"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.5644999"
Evaluating: -21.5644999+3.5
 Parameter: ZMAX <- "-18.0644999"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.8914694"
Evaluating: 28.8914694-3.5
 Parameter: XMIN <- "25.3914694"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-52.0375811"
Evaluating: -52.0375811-3.5
 Parameter: YMIN <- "-55.5375811"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.5644999"
Evaluating: -21.5644999-3.5
 Parameter: ZMIN <- "-25.0644999"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.3914694"
 Parameter: XMIN -> "25.3914694"
 Parameter: YMAX -> "-48.5375811"
 Parameter: YMIN -> "-55.5375811"
 Parameter: ZMAX -> "-18.0644999"
 Parameter: ZMIN -> "-25.0644999"
 SELRPN>     21 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      7 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64475 POS      SOD      60       SOD     -**** MEMB     POPC     263      N             2.2742
64475 POS      SOD      60       SOD     -**** MEMB     POPC     263      C12           2.8613
64475 POS      SOD      60       SOD     -**** MEMB     POPC     263      C13           2.5266
64475 POS      SOD      60       SOD     -**** MEMB     POPC     263      C14           1.4386
64475 POS      SOD      60       SOD     -**** MEMB     POPC     263      C15           3.6932
64475 POS      SOD      60       SOD     -**** MEMB     POPC     263      C11           2.8752
64475 POS      SOD      60       SOD     -**** MEMB     POPC     263      O12           3.0292
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "60" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "2.931593984E-02"
Evaluating: 125.050557*(2.931593984E-02-0.5)
 Parameter: XPOS <- "-58.8593039"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "4.186766263E-02"
Evaluating: 125.050557*(4.186766263E-02-0.5)
 Parameter: YPOS <- "-57.289704"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.983724485"
Evaluating: 152.572525*(0.983724485-0.5)+-4.51585405
 Parameter: ZPOS <- "69.287212"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.287212" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.287212" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.891469 XMAX =   28.891469 XAVE =   28.891469
    YMIN =  -52.037581 YMAX =  -52.037581 YAVE =  -52.037581
    ZMIN =  -21.564500 ZMAX =  -21.564500 ZAVE =  -21.564500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-58.8593039"
 RDCMND substituted energy or value "?XAVE" to "28.8914694"
Evaluating: -58.8593039-28.8914694
 Parameter: XTRAN <- "-87.7507733"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-57.289704"
 RDCMND substituted energy or value "?YAVE" to "-52.0375811"
Evaluating: -57.289704--52.0375811
 Parameter: YTRAN <- "-5.2521229"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.287212"
 RDCMND substituted energy or value "?ZAVE" to "-21.5644999"
Evaluating: 69.287212--21.5644999
 Parameter: ZTRAN <- "90.8517119"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-87.7507733"
 Parameter: YTRAN -> "-5.2521229"
 Parameter: ZTRAN -> "90.8517119"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -87.750773   -5.252123   90.851712
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.407604315"
Evaluating: 0.407604315*360.0
 Parameter: XPHI <- "146.737553"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.664296784"
Evaluating: 0.664296784*360.0
 Parameter: YPHI <- "239.146842"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193995041"
Evaluating: 0.193995041*360.0
 Parameter: ZPHI <- "69.8382148"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-58.8593039"
 Parameter: YPOS -> "-57.289704"
 Parameter: ZPOS -> "69.287212"
 Parameter: XPHI -> "146.737553"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.836167    0.548475
    0.000000   -0.548475   -0.836167

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  146.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-58.8593039"
 Parameter: YPOS -> "-57.289704"
 Parameter: ZPOS -> "69.287212"
 Parameter: YPHI -> "239.146842"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.512840    0.000000    0.858484
    0.000000    1.000000    0.000000
   -0.858484    0.000000   -0.512840

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  120.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-58.8593039"
 Parameter: YPOS -> "-57.289704"
 Parameter: ZPOS -> "69.287212"
 Parameter: ZPHI -> "69.8382148"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.344672    0.938723    0.000000
   -0.938723    0.344672    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -58.859304 XMAX =  -58.859304 XAVE =  -58.859304
    YMIN =  -57.289704 YMAX =  -57.289704 YAVE =  -57.289704
    ZMIN =   69.287212 ZMAX =   69.287212 ZAVE =   69.287212
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-58.8593039"
Evaluating: -58.8593039+3.5
 Parameter: XMAX <- "-55.3593039"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-57.289704"
Evaluating: -57.289704+3.5
 Parameter: YMAX <- "-53.789704"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.287212"
Evaluating: 69.287212+3.5
 Parameter: ZMAX <- "72.787212"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-58.8593039"
Evaluating: -58.8593039-3.5
 Parameter: XMIN <- "-62.3593039"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-57.289704"
Evaluating: -57.289704-3.5
 Parameter: YMIN <- "-60.789704"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.287212"
Evaluating: 69.287212-3.5
 Parameter: ZMIN <- "65.787212"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-55.3593039"
 Parameter: XMIN -> "-62.3593039"
 Parameter: YMAX -> "-53.789704"
 Parameter: YMIN -> "-60.789704"
 Parameter: ZMAX -> "72.787212"
 Parameter: ZMIN -> "65.787212"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "61"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "61" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "61" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.844873422"
Evaluating: 125.050557*(0.844873422-0.5)
 Parameter: XPOS <- "43.1266135"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.661255043E-02"
Evaluating: 125.050557*(1.661255043E-02-0.5)
 Parameter: YPOS <- "-60.4478698"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.82373884"
Evaluating: 152.572525*(0.82373884-0.5)+-4.51585405
 Parameter: ZPOS <- "44.8777982"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.8777982" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.8777982" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.1266135"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 43.1266135-0
 Parameter: XTRAN <- "43.1266135"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-60.4478698"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -60.4478698-0
 Parameter: YTRAN <- "-60.4478698"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.8777982"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.8777982-0
 Parameter: ZTRAN <- "44.8777982"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "43.1266135"
 Parameter: YTRAN -> "-60.4478698"
 Parameter: ZTRAN -> "44.8777982"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    43.126613  -60.447870   44.877798
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.371505624"
Evaluating: 0.371505624*360.0
 Parameter: XPHI <- "133.742025"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.665048199"
Evaluating: 0.665048199*360.0
 Parameter: YPHI <- "239.417352"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.642996325"
Evaluating: 0.642996325*360.0
 Parameter: ZPHI <- "231.478677"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.1266135"
 Parameter: YPOS -> "-60.4478698"
 Parameter: ZPOS -> "44.8777982"
 Parameter: XPHI -> "133.742025"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.691413    0.722460
    0.000000   -0.722460   -0.691413

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  133.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.1266135"
 Parameter: YPOS -> "-60.4478698"
 Parameter: ZPOS -> "44.8777982"
 Parameter: YPHI -> "239.417352"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.508781    0.000000    0.860896
    0.000000    1.000000    0.000000
   -0.860896    0.000000   -0.508781

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  120.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.1266135"
 Parameter: YPOS -> "-60.4478698"
 Parameter: ZPOS -> "44.8777982"
 Parameter: ZPHI -> "231.478677"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.622806   -0.782376    0.000000
    0.782376   -0.622806    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.126613 XMAX =   43.126613 XAVE =   43.126613
    YMIN =  -60.447870 YMAX =  -60.447870 YAVE =  -60.447870
    ZMIN =   44.877798 ZMAX =   44.877798 ZAVE =   44.877798
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.1266135"
Evaluating: 43.1266135+3.5
 Parameter: XMAX <- "46.6266135"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-60.4478698"
Evaluating: -60.4478698+3.5
 Parameter: YMAX <- "-56.9478698"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.8777982"
Evaluating: 44.8777982+3.5
 Parameter: ZMAX <- "48.3777982"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.1266135"
Evaluating: 43.1266135-3.5
 Parameter: XMIN <- "39.6266135"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-60.4478698"
Evaluating: -60.4478698-3.5
 Parameter: YMIN <- "-63.9478698"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.8777982"
Evaluating: 44.8777982-3.5
 Parameter: ZMIN <- "41.3777982"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.6266135"
 Parameter: XMIN -> "39.6266135"
 Parameter: YMAX -> "-56.9478698"
 Parameter: YMIN -> "-63.9478698"
 Parameter: ZMAX -> "48.3777982"
 Parameter: ZMIN -> "41.3777982"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "62"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "62" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "62" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.592549109"
Evaluating: 125.050557*(0.592549109-0.5)
 Parameter: XPOS <- "11.5733176"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.421050785"
Evaluating: 125.050557*(0.421050785-0.5)
 Parameter: YPOS <- "-9.87264331"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.87077955"
Evaluating: 152.572525*(0.87077955-0.5)+-4.51585405
 Parameter: ZPOS <- "52.0549181"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.0549181" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.0549181" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.5733176"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.5733176-0
 Parameter: XTRAN <- "11.5733176"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.87264331"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.87264331-0
 Parameter: YTRAN <- "-9.87264331"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.0549181"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 52.0549181-0
 Parameter: ZTRAN <- "52.0549181"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.5733176"
 Parameter: YTRAN -> "-9.87264331"
 Parameter: ZTRAN -> "52.0549181"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    11.573318   -9.872643   52.054918
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.368335173"
Evaluating: 0.368335173*360.0
 Parameter: XPHI <- "132.600662"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.717920053"
Evaluating: 0.717920053*360.0
 Parameter: YPHI <- "258.451219"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.806694354"
Evaluating: 0.806694354*360.0
 Parameter: ZPHI <- "290.409967"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.5733176"
 Parameter: YPOS -> "-9.87264331"
 Parameter: ZPOS -> "52.0549181"
 Parameter: XPHI -> "132.600662"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.676884    0.736089
    0.000000   -0.736089   -0.676884

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.5733176"
 Parameter: YPOS -> "-9.87264331"
 Parameter: ZPOS -> "52.0549181"
 Parameter: YPHI -> "258.451219"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.200202    0.000000    0.979755
    0.000000    1.000000    0.000000
   -0.979755    0.000000   -0.200202

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  101.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.5733176"
 Parameter: YPOS -> "-9.87264331"
 Parameter: ZPOS -> "52.0549181"
 Parameter: ZPHI -> "290.409967"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.348735   -0.937221    0.000000
    0.937221    0.348735    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   69.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.573318 XMAX =   11.573318 XAVE =   11.573318
    YMIN =   -9.872643 YMAX =   -9.872643 YAVE =   -9.872643
    ZMIN =   52.054918 ZMAX =   52.054918 ZAVE =   52.054918
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.5733176"
Evaluating: 11.5733176+3.5
 Parameter: XMAX <- "15.0733176"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.87264331"
Evaluating: -9.87264331+3.5
 Parameter: YMAX <- "-6.37264331"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.0549181"
Evaluating: 52.0549181+3.5
 Parameter: ZMAX <- "55.5549181"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.5733176"
Evaluating: 11.5733176-3.5
 Parameter: XMIN <- "8.0733176"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.87264331"
Evaluating: -9.87264331-3.5
 Parameter: YMIN <- "-13.3726433"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.0549181"
Evaluating: 52.0549181-3.5
 Parameter: ZMIN <- "48.5549181"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.0733176"
 Parameter: XMIN -> "8.0733176"
 Parameter: YMAX -> "-6.37264331"
 Parameter: YMIN -> "-13.3726433"
 Parameter: ZMAX -> "55.5549181"
 Parameter: ZMIN -> "48.5549181"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "63"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "63" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "63" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.680938615"
Evaluating: 125.050557*(0.680938615-0.5)
 Parameter: XPOS <- "22.6264746"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.144473956"
Evaluating: 125.050557*(0.144473956-0.5)
 Parameter: YPOS <- "-44.4587298"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.196981288"
Evaluating: 152.572525*(0.196981288-0.5)+-4.51585405
 Parameter: ZPOS <- "-50.7481841"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.7481841" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.6264746"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 22.6264746-0
 Parameter: XTRAN <- "22.6264746"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.4587298"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -44.4587298-0
 Parameter: YTRAN <- "-44.4587298"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.7481841"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.7481841-0
 Parameter: ZTRAN <- "-50.7481841"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.6264746"
 Parameter: YTRAN -> "-44.4587298"
 Parameter: ZTRAN -> "-50.7481841"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    22.626475  -44.458730  -50.748184
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.316233871"
Evaluating: 0.316233871*360.0
 Parameter: XPHI <- "113.844194"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.283929812E-03"
Evaluating: 5.283929812E-03*360.0
 Parameter: YPHI <- "1.90221473"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.934706053"
Evaluating: 0.934706053*360.0
 Parameter: ZPHI <- "336.494179"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.6264746"
 Parameter: YPOS -> "-44.4587298"
 Parameter: ZPOS -> "-50.7481841"
 Parameter: XPHI -> "113.844194"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.404251    0.914648
    0.000000   -0.914648   -0.404251

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  113.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.6264746"
 Parameter: YPOS -> "-44.4587298"
 Parameter: ZPOS -> "-50.7481841"
 Parameter: YPHI -> "1.90221473"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999449    0.000000   -0.033194
    0.000000    1.000000    0.000000
    0.033194    0.000000    0.999449

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    1.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.6264746"
 Parameter: YPOS -> "-44.4587298"
 Parameter: ZPOS -> "-50.7481841"
 Parameter: ZPHI -> "336.494179"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.917020   -0.398842    0.000000
    0.398842    0.917020    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   23.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.626475 XMAX =   22.626475 XAVE =   22.626475
    YMIN =  -44.458730 YMAX =  -44.458730 YAVE =  -44.458730
    ZMIN =  -50.748184 ZMAX =  -50.748184 ZAVE =  -50.748184
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.6264746"
Evaluating: 22.6264746+3.5
 Parameter: XMAX <- "26.1264746"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.4587298"
Evaluating: -44.4587298+3.5
 Parameter: YMAX <- "-40.9587298"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.7481841"
Evaluating: -50.7481841+3.5
 Parameter: ZMAX <- "-47.2481841"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.6264746"
Evaluating: 22.6264746-3.5
 Parameter: XMIN <- "19.1264746"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.4587298"
Evaluating: -44.4587298-3.5
 Parameter: YMIN <- "-47.9587298"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.7481841"
Evaluating: -50.7481841-3.5
 Parameter: ZMIN <- "-54.2481841"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.1264746"
 Parameter: XMIN -> "19.1264746"
 Parameter: YMAX -> "-40.9587298"
 Parameter: YMIN -> "-47.9587298"
 Parameter: ZMAX -> "-47.2481841"
 Parameter: ZMIN -> "-54.2481841"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "64"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "64" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "64" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "6.844594052E-02"
Evaluating: 125.050557*(6.844594052E-02-0.5)
 Parameter: XPOS <- "-53.9660755"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.757103677"
Evaluating: 125.050557*(0.757103677-0.5)
 Parameter: YPOS <- "32.150958"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.833564925"
Evaluating: 152.572525*(0.833564925-0.5)+-4.51585405
 Parameter: ZPOS <- "46.3769888"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.3769888" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.3769888" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-53.9660755"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -53.9660755-0
 Parameter: XTRAN <- "-53.9660755"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.150958"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.150958-0
 Parameter: YTRAN <- "32.150958"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.3769888"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.3769888-0
 Parameter: ZTRAN <- "46.3769888"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-53.9660755"
 Parameter: YTRAN -> "32.150958"
 Parameter: ZTRAN -> "46.3769888"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -53.966076   32.150958   46.376989
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.24146522E-02"
Evaluating: 1.24146522E-02*360.0
 Parameter: XPHI <- "4.46927479"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.99415281"
Evaluating: 0.99415281*360.0
 Parameter: YPHI <- "357.895012"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.765716884"
Evaluating: 0.765716884*360.0
 Parameter: ZPHI <- "275.658078"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-53.9660755"
 Parameter: YPOS -> "32.150958"
 Parameter: ZPOS -> "46.3769888"
 Parameter: XPHI -> "4.46927479"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.996959    0.077924
    0.000000   -0.077924    0.996959

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    4.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-53.9660755"
 Parameter: YPOS -> "32.150958"
 Parameter: ZPOS -> "46.3769888"
 Parameter: YPHI -> "357.895012"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999325    0.000000    0.036731
    0.000000    1.000000    0.000000
   -0.036731    0.000000    0.999325

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    2.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-53.9660755"
 Parameter: YPOS -> "32.150958"
 Parameter: ZPOS -> "46.3769888"
 Parameter: ZPHI -> "275.658078"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.098592   -0.995128    0.000000
    0.995128    0.098592    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   84.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -53.966076 XMAX =  -53.966076 XAVE =  -53.966076
    YMIN =   32.150958 YMAX =   32.150958 YAVE =   32.150958
    ZMIN =   46.376989 ZMAX =   46.376989 ZAVE =   46.376989
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-53.9660755"
Evaluating: -53.9660755+3.5
 Parameter: XMAX <- "-50.4660755"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.150958"
Evaluating: 32.150958+3.5
 Parameter: YMAX <- "35.650958"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.3769888"
Evaluating: 46.3769888+3.5
 Parameter: ZMAX <- "49.8769888"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-53.9660755"
Evaluating: -53.9660755-3.5
 Parameter: XMIN <- "-57.4660755"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.150958"
Evaluating: 32.150958-3.5
 Parameter: YMIN <- "28.650958"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.3769888"
Evaluating: 46.3769888-3.5
 Parameter: ZMIN <- "42.8769888"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-50.4660755"
 Parameter: XMIN -> "-57.4660755"
 Parameter: YMAX -> "35.650958"
 Parameter: YMIN -> "28.650958"
 Parameter: ZMAX -> "49.8769888"
 Parameter: ZMIN -> "42.8769888"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "65"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "65" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "65" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "2.143152444E-02"
Evaluating: 125.050557*(2.143152444E-02-0.5)
 Parameter: XPOS <- "-59.8452544"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.687401009"
Evaluating: 125.050557*(0.687401009-0.5)
 Parameter: YPOS <- "23.4346006"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.719835434"
Evaluating: 152.572525*(0.719835434-0.5)+-4.51585405
 Parameter: ZPOS <- "29.0249932"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.0249932" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.0249932" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-59.8452544"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -59.8452544-0
 Parameter: XTRAN <- "-59.8452544"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.4346006"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.4346006-0
 Parameter: YTRAN <- "23.4346006"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.0249932"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.0249932-0
 Parameter: ZTRAN <- "29.0249932"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-59.8452544"
 Parameter: YTRAN -> "23.4346006"
 Parameter: ZTRAN -> "29.0249932"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -59.845254   23.434601   29.024993
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.897920021"
Evaluating: 0.897920021*360.0
 Parameter: XPHI <- "323.251208"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.346613487"
Evaluating: 0.346613487*360.0
 Parameter: YPHI <- "124.780855"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.938639343"
Evaluating: 0.938639343*360.0
 Parameter: ZPHI <- "337.910163"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-59.8452544"
 Parameter: YPOS -> "23.4346006"
 Parameter: ZPOS -> "29.0249932"
 Parameter: XPHI -> "323.251208"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.801266   -0.598308
    0.000000    0.598308    0.801266

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   36.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-59.8452544"
 Parameter: YPOS -> "23.4346006"
 Parameter: ZPOS -> "29.0249932"
 Parameter: YPHI -> "124.780855"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.570439    0.000000   -0.821340
    0.000000    1.000000    0.000000
    0.821340    0.000000   -0.570439

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  124.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-59.8452544"
 Parameter: YPOS -> "23.4346006"
 Parameter: ZPOS -> "29.0249932"
 Parameter: ZPHI -> "337.910163"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.926595   -0.376060    0.000000
    0.376060    0.926595    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   22.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -59.845254 XMAX =  -59.845254 XAVE =  -59.845254
    YMIN =   23.434601 YMAX =   23.434601 YAVE =   23.434601
    ZMIN =   29.024993 ZMAX =   29.024993 ZAVE =   29.024993
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-59.8452544"
Evaluating: -59.8452544+3.5
 Parameter: XMAX <- "-56.3452544"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.4346006"
Evaluating: 23.4346006+3.5
 Parameter: YMAX <- "26.9346006"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.0249932"
Evaluating: 29.0249932+3.5
 Parameter: ZMAX <- "32.5249932"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-59.8452544"
Evaluating: -59.8452544-3.5
 Parameter: XMIN <- "-63.3452544"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.4346006"
Evaluating: 23.4346006-3.5
 Parameter: YMIN <- "19.9346006"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.0249932"
Evaluating: 29.0249932-3.5
 Parameter: ZMIN <- "25.5249932"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-56.3452544"
 Parameter: XMIN -> "-63.3452544"
 Parameter: YMAX -> "26.9346006"
 Parameter: YMIN -> "19.9346006"
 Parameter: ZMAX -> "32.5249932"
 Parameter: ZMIN -> "25.5249932"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "66"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "66" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "66" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.551644021"
Evaluating: 125.050557*(0.551644021-0.5)
 Parameter: XPOS <- "6.45811359"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.423039562"
Evaluating: 125.050557*(0.423039562-0.5)
 Parameter: YPOS <- "-9.62394564"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.850533927"
Evaluating: 152.572525*(0.850533927-0.5)+-4.51585405
 Parameter: ZPOS <- "48.9659923"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.9659923" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.9659923" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.45811359"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.45811359-0
 Parameter: XTRAN <- "6.45811359"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.62394564"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.62394564-0
 Parameter: YTRAN <- "-9.62394564"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.9659923"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 48.9659923-0
 Parameter: ZTRAN <- "48.9659923"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.45811359"
 Parameter: YTRAN -> "-9.62394564"
 Parameter: ZTRAN -> "48.9659923"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     6.458114   -9.623946   48.965992
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.242695616"
Evaluating: 0.242695616*360.0
 Parameter: XPHI <- "87.3704218"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.870090441"
Evaluating: 0.870090441*360.0
 Parameter: YPHI <- "313.232559"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.56309363"
Evaluating: 0.56309363*360.0
 Parameter: ZPHI <- "202.713707"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.45811359"
 Parameter: YPOS -> "-9.62394564"
 Parameter: ZPOS -> "48.9659923"
 Parameter: XPHI -> "87.3704218"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.045879    0.998947
    0.000000   -0.998947    0.045879

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   87.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.45811359"
 Parameter: YPOS -> "-9.62394564"
 Parameter: ZPOS -> "48.9659923"
 Parameter: YPHI -> "313.232559"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.684961    0.000000    0.728580
    0.000000    1.000000    0.000000
   -0.728580    0.000000    0.684961

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   46.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.45811359"
 Parameter: YPOS -> "-9.62394564"
 Parameter: ZPOS -> "48.9659923"
 Parameter: ZPHI -> "202.713707"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.922446   -0.386127    0.000000
    0.386127   -0.922446    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  157.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.458114 XMAX =    6.458114 XAVE =    6.458114
    YMIN =   -9.623946 YMAX =   -9.623946 YAVE =   -9.623946
    ZMIN =   48.965992 ZMAX =   48.965992 ZAVE =   48.965992
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.45811359"
Evaluating: 6.45811359+3.5
 Parameter: XMAX <- "9.95811359"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.62394564"
Evaluating: -9.62394564+3.5
 Parameter: YMAX <- "-6.12394564"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.9659923"
Evaluating: 48.9659923+3.5
 Parameter: ZMAX <- "52.4659923"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.45811359"
Evaluating: 6.45811359-3.5
 Parameter: XMIN <- "2.95811359"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.62394564"
Evaluating: -9.62394564-3.5
 Parameter: YMIN <- "-13.1239456"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.9659923"
Evaluating: 48.9659923-3.5
 Parameter: ZMIN <- "45.4659923"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.95811359"
 Parameter: XMIN -> "2.95811359"
 Parameter: YMAX -> "-6.12394564"
 Parameter: YMIN -> "-13.1239456"
 Parameter: ZMAX -> "52.4659923"
 Parameter: ZMIN -> "45.4659923"
 SELRPN>      5 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      3 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64481 POS      SOD      66       SOD     -**** PROA     MET      981      CB            4.3631
64481 POS      SOD      66       SOD     -**** PROA     MET      981      CG            4.7308
64481 POS      SOD      66       SOD     -**** PROA     MET      981      SD            4.5093
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "66" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.847081319"
Evaluating: 125.050557*(0.847081319-0.5)
 Parameter: XPOS <- "43.4027123"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.182742037"
Evaluating: 125.050557*(0.182742037-0.5)
 Parameter: YPOS <- "-39.673285"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.451275959"
Evaluating: 152.572525*(0.451275959-0.5)+-4.51585405
 Parameter: ZPOS <- "-11.949804"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.949804" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.949804" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "66" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.575437101"
Evaluating: 125.050557*(0.575437101-0.5)
 Parameter: XPOS <- "9.4334515"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.528045766"
Evaluating: 125.050557*(0.528045766-0.5)
 Parameter: YPOS <- "3.50713866"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.567697891"
Evaluating: 152.572525*(0.567697891-0.5)+-4.51585405
 Parameter: ZPOS <- "5.81298412"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.81298412" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.81298412" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "66" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.449218814"
Evaluating: 125.050557*(0.449218814-0.5)
 Parameter: XPOS <- "-6.35021559"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.461555324"
Evaluating: 125.050557*(0.461555324-0.5)
 Parameter: YPOS <- "-4.80752815"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.988720104"
Evaluating: 152.572525*(0.988720104-0.5)+-4.51585405
 Parameter: ZPOS <- "70.0494062"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "70.0494062" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "70.0494062" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.458114 XMAX =    6.458114 XAVE =    6.458114
    YMIN =   -9.623946 YMAX =   -9.623946 YAVE =   -9.623946
    ZMIN =   48.965992 ZMAX =   48.965992 ZAVE =   48.965992
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.35021559"
 RDCMND substituted energy or value "?XAVE" to "6.45811359"
Evaluating: -6.35021559-6.45811359
 Parameter: XTRAN <- "-12.8083292"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.80752815"
 RDCMND substituted energy or value "?YAVE" to "-9.62394564"
Evaluating: -4.80752815--9.62394564
 Parameter: YTRAN <- "4.81641749"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "70.0494062"
 RDCMND substituted energy or value "?ZAVE" to "48.9659923"
Evaluating: 70.0494062-48.9659923
 Parameter: ZTRAN <- "21.0834139"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.8083292"
 Parameter: YTRAN -> "4.81641749"
 Parameter: ZTRAN -> "21.0834139"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -12.808329    4.816417   21.083414
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.104079904"
Evaluating: 0.104079904*360.0
 Parameter: XPHI <- "37.4687654"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.895758949"
Evaluating: 0.895758949*360.0
 Parameter: YPHI <- "322.473222"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.262519941"
Evaluating: 0.262519941*360.0
 Parameter: ZPHI <- "94.5071788"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.35021559"
 Parameter: YPOS -> "-4.80752815"
 Parameter: ZPOS -> "70.0494062"
 Parameter: XPHI -> "37.4687654"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.793685    0.608329
    0.000000   -0.608329    0.793685

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   37.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.35021559"
 Parameter: YPOS -> "-4.80752815"
 Parameter: ZPOS -> "70.0494062"
 Parameter: YPHI -> "322.473222"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.793069    0.000000    0.609132
    0.000000    1.000000    0.000000
   -0.609132    0.000000    0.793069

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   37.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.35021559"
 Parameter: YPOS -> "-4.80752815"
 Parameter: ZPOS -> "70.0494062"
 Parameter: ZPHI -> "94.5071788"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.078584    0.996907    0.000000
   -0.996907   -0.078584    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   94.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.350216 XMAX =   -6.350216 XAVE =   -6.350216
    YMIN =   -4.807528 YMAX =   -4.807528 YAVE =   -4.807528
    ZMIN =   70.049406 ZMAX =   70.049406 ZAVE =   70.049406
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.35021559"
Evaluating: -6.35021559+3.5
 Parameter: XMAX <- "-2.85021559"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.80752813"
Evaluating: -4.80752813+3.5
 Parameter: YMAX <- "-1.30752813"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "70.0494062"
Evaluating: 70.0494062+3.5
 Parameter: ZMAX <- "73.5494062"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.35021559"
Evaluating: -6.35021559-3.5
 Parameter: XMIN <- "-9.85021559"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.80752813"
Evaluating: -4.80752813-3.5
 Parameter: YMIN <- "-8.30752813"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "70.0494062"
Evaluating: 70.0494062-3.5
 Parameter: ZMIN <- "66.5494062"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.85021559"
 Parameter: XMIN -> "-9.85021559"
 Parameter: YMAX -> "-1.30752813"
 Parameter: YMIN -> "-8.30752813"
 Parameter: ZMAX -> "73.5494062"
 Parameter: ZMIN -> "66.5494062"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "67"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "67" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "67" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.843578056"
Evaluating: 125.050557*(0.843578056-0.5)
 Parameter: XPOS <- "42.9646273"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.237215048"
Evaluating: 125.050557*(0.237215048-0.5)
 Parameter: YPOS <- "-32.8614046"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.350319853"
Evaluating: 152.572525*(0.350319853-0.5)+-4.51585405
 Parameter: ZPOS <- "-27.352932"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.352932" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.9646273"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 42.9646273-0
 Parameter: XTRAN <- "42.9646273"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.8614046"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.8614046-0
 Parameter: YTRAN <- "-32.8614046"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.352932"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.352932-0
 Parameter: ZTRAN <- "-27.352932"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.9646273"
 Parameter: YTRAN -> "-32.8614046"
 Parameter: ZTRAN -> "-27.352932"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    42.964627  -32.861405  -27.352932
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.899726208"
Evaluating: 0.899726208*360.0
 Parameter: XPHI <- "323.901435"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.664493282"
Evaluating: 0.664493282*360.0
 Parameter: YPHI <- "239.217582"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.814322799"
Evaluating: 0.814322799*360.0
 Parameter: ZPHI <- "293.156208"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.9646273"
 Parameter: YPOS -> "-32.8614046"
 Parameter: ZPOS -> "-27.352932"
 Parameter: XPHI -> "323.901435"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.808005   -0.589176
    0.000000    0.589176    0.808005

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   36.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.9646273"
 Parameter: YPOS -> "-32.8614046"
 Parameter: ZPOS -> "-27.352932"
 Parameter: YPHI -> "239.217582"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.511779    0.000000    0.859117
    0.000000    1.000000    0.000000
   -0.859117    0.000000   -0.511779

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  120.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.9646273"
 Parameter: YPOS -> "-32.8614046"
 Parameter: ZPOS -> "-27.352932"
 Parameter: ZPHI -> "293.156208"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.393239   -0.919436    0.000000
    0.919436    0.393239    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   66.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.964627 XMAX =   42.964627 XAVE =   42.964627
    YMIN =  -32.861405 YMAX =  -32.861405 YAVE =  -32.861405
    ZMIN =  -27.352932 ZMAX =  -27.352932 ZAVE =  -27.352932
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.9646273"
Evaluating: 42.9646273+3.5
 Parameter: XMAX <- "46.4646273"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.8614046"
Evaluating: -32.8614046+3.5
 Parameter: YMAX <- "-29.3614046"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.352932"
Evaluating: -27.352932+3.5
 Parameter: ZMAX <- "-23.852932"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.9646273"
Evaluating: 42.9646273-3.5
 Parameter: XMIN <- "39.4646273"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.8614046"
Evaluating: -32.8614046-3.5
 Parameter: YMIN <- "-36.3614046"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.352932"
Evaluating: -27.352932-3.5
 Parameter: ZMIN <- "-30.852932"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.4646273"
 Parameter: XMIN -> "39.4646273"
 Parameter: YMAX -> "-29.3614046"
 Parameter: YMIN -> "-36.3614046"
 Parameter: ZMAX -> "-23.852932"
 Parameter: ZMIN -> "-30.852932"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "68"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "68" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "68" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.401709413"
Evaluating: 125.050557*(0.401709413-0.5)
 Parameter: XPOS <- "-12.2912927"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.03231705E-02"
Evaluating: 125.050557*(1.03231705E-02-0.5)
 Parameter: YPOS <- "-61.2343603"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.639140951"
Evaluating: 152.572525*(0.639140951-0.5)+-4.51585405
 Parameter: ZPOS <- "16.7132322"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.7132322" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.7132322" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.2912927"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.2912927-0
 Parameter: XTRAN <- "-12.2912927"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-61.2343603"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -61.2343603-0
 Parameter: YTRAN <- "-61.2343603"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.7132322"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.7132322-0
 Parameter: ZTRAN <- "16.7132322"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.2912927"
 Parameter: YTRAN -> "-61.2343603"
 Parameter: ZTRAN -> "16.7132322"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -12.291293  -61.234360   16.713232
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.46799322"
Evaluating: 0.46799322*360.0
 Parameter: XPHI <- "168.477559"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.705719775"
Evaluating: 0.705719775*360.0
 Parameter: YPHI <- "254.059119"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.644300166"
Evaluating: 0.644300166*360.0
 Parameter: ZPHI <- "231.94806"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.2912927"
 Parameter: YPOS -> "-61.2343603"
 Parameter: ZPOS -> "16.7132322"
 Parameter: XPHI -> "168.477559"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.979847    0.199752
    0.000000   -0.199752   -0.979847

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  168.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.2912927"
 Parameter: YPOS -> "-61.2343603"
 Parameter: ZPOS -> "16.7132322"
 Parameter: YPHI -> "254.059119"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.274645    0.000000    0.961546
    0.000000    1.000000    0.000000
   -0.961546    0.000000   -0.274645

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  105.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.2912927"
 Parameter: YPOS -> "-61.2343603"
 Parameter: ZPOS -> "16.7132322"
 Parameter: ZPHI -> "231.94806"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.616376   -0.787452    0.000000
    0.787452   -0.616376    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.291293 XMAX =  -12.291293 XAVE =  -12.291293
    YMIN =  -61.234360 YMAX =  -61.234360 YAVE =  -61.234360
    ZMIN =   16.713232 ZMAX =   16.713232 ZAVE =   16.713232
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.2912927"
Evaluating: -12.2912927+3.5
 Parameter: XMAX <- "-8.7912927"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-61.2343603"
Evaluating: -61.2343603+3.5
 Parameter: YMAX <- "-57.7343603"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.7132322"
Evaluating: 16.7132322+3.5
 Parameter: ZMAX <- "20.2132322"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.2912927"
Evaluating: -12.2912927-3.5
 Parameter: XMIN <- "-15.7912927"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-61.2343603"
Evaluating: -61.2343603-3.5
 Parameter: YMIN <- "-64.7343603"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.7132322"
Evaluating: 16.7132322-3.5
 Parameter: ZMIN <- "13.2132322"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.7912927"
 Parameter: XMIN -> "-15.7912927"
 Parameter: YMAX -> "-57.7343603"
 Parameter: YMIN -> "-64.7343603"
 Parameter: ZMAX -> "20.2132322"
 Parameter: ZMIN -> "13.2132322"
 SELRPN>      6 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      2 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64483 POS      SOD      68       SOD     -**** MEMB     POPC     50       C3            3.1546
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "68" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.461912745"
Evaluating: 125.050557*(0.461912745-0.5)
 Parameter: XPOS <- "-4.76283245"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.323834122E-02"
Evaluating: 125.050557*(9.323834122E-02-0.5)
 Parameter: YPOS <- "-50.865772"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.647541864"
Evaluating: 152.572525*(0.647541864-0.5)+-4.51585405
 Parameter: ZPOS <- "17.9949807"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.9949807" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.9949807" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.291293 XMAX =  -12.291293 XAVE =  -12.291293
    YMIN =  -61.234360 YMAX =  -61.234360 YAVE =  -61.234360
    ZMIN =   16.713232 ZMAX =   16.713232 ZAVE =   16.713232
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.76283245"
 RDCMND substituted energy or value "?XAVE" to "-12.2912927"
Evaluating: -4.76283245--12.2912927
 Parameter: XTRAN <- "7.52846025"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.865772"
 RDCMND substituted energy or value "?YAVE" to "-61.2343603"
Evaluating: -50.865772--61.2343603
 Parameter: YTRAN <- "10.3685883"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.9949807"
 RDCMND substituted energy or value "?ZAVE" to "16.7132322"
Evaluating: 17.9949807-16.7132322
 Parameter: ZTRAN <- "1.2817485"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.52846025"
 Parameter: YTRAN -> "10.3685883"
 Parameter: ZTRAN -> "1.2817485"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     7.528460   10.368588    1.281748
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.448917746"
Evaluating: 0.448917746*360.0
 Parameter: XPHI <- "161.610389"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.428756091"
Evaluating: 0.428756091*360.0
 Parameter: YPHI <- "154.352193"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.171820888E-02"
Evaluating: 2.171820888E-02*360.0
 Parameter: ZPHI <- "7.8185552"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.76283245"
 Parameter: YPOS -> "-50.865772"
 Parameter: ZPOS -> "17.9949807"
 Parameter: XPHI -> "161.610389"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.948933    0.315477
    0.000000   -0.315477   -0.948933

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  161.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.76283245"
 Parameter: YPOS -> "-50.865772"
 Parameter: ZPOS -> "17.9949807"
 Parameter: YPHI -> "154.352193"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.901472    0.000000   -0.432838
    0.000000    1.000000    0.000000
    0.432838    0.000000   -0.901472

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  154.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.76283245"
 Parameter: YPOS -> "-50.865772"
 Parameter: ZPOS -> "17.9949807"
 Parameter: ZPHI -> "7.8185552"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.990704    0.136036    0.000000
   -0.136036    0.990704    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    7.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.762832 XMAX =   -4.762832 XAVE =   -4.762832
    YMIN =  -50.865772 YMAX =  -50.865772 YAVE =  -50.865772
    ZMIN =   17.994981 ZMAX =   17.994981 ZAVE =   17.994981
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.76283245"
Evaluating: -4.76283245+3.5
 Parameter: XMAX <- "-1.26283245"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.865772"
Evaluating: -50.865772+3.5
 Parameter: YMAX <- "-47.365772"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.9949807"
Evaluating: 17.9949807+3.5
 Parameter: ZMAX <- "21.4949807"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.76283245"
Evaluating: -4.76283245-3.5
 Parameter: XMIN <- "-8.26283245"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.865772"
Evaluating: -50.865772-3.5
 Parameter: YMIN <- "-54.365772"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.9949807"
Evaluating: 17.9949807-3.5
 Parameter: ZMIN <- "14.4949807"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.26283245"
 Parameter: XMIN -> "-8.26283245"
 Parameter: YMAX -> "-47.365772"
 Parameter: YMIN -> "-54.365772"
 Parameter: ZMAX -> "21.4949807"
 Parameter: ZMIN -> "14.4949807"
 SELRPN>     30 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      2 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64483 POS      SOD      68       SOD     -1998 PROA     LYS      155      CE            2.8343
64483 POS      SOD      68       SOD     -2001 PROA     LYS      155      NZ            2.4928
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "68" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.955266086"
Evaluating: 125.050557*(0.955266086-0.5)
 Parameter: XPOS <- "56.9312776"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.831592723"
Evaluating: 125.050557*(0.831592723-0.5)
 Parameter: YPOS <- "41.4658547"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.434626475"
Evaluating: 152.572525*(0.434626475-0.5)+-4.51585405
 Parameter: ZPOS <- "-14.4900578"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.4900578" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.4900578" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "68" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.902352508"
Evaluating: 125.050557*(0.902352508-0.5)
 Parameter: XPOS <- "50.3144052"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "5.950353487E-02"
Evaluating: 125.050557*(5.950353487E-02-0.5)
 Parameter: YPOS <- "-55.0843283"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.175685124"
Evaluating: 152.572525*(0.175685124-0.5)+-4.51585405
 Parameter: ZPOS <- "-53.9973936"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.9973936" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.762832 XMAX =   -4.762832 XAVE =   -4.762832
    YMIN =  -50.865772 YMAX =  -50.865772 YAVE =  -50.865772
    ZMIN =   17.994981 ZMAX =   17.994981 ZAVE =   17.994981
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.3144052"
 RDCMND substituted energy or value "?XAVE" to "-4.76283245"
Evaluating: 50.3144052--4.76283245
 Parameter: XTRAN <- "55.0772377"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-55.0843283"
 RDCMND substituted energy or value "?YAVE" to "-50.865772"
Evaluating: -55.0843283--50.865772
 Parameter: YTRAN <- "-4.2185563"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.9973936"
 RDCMND substituted energy or value "?ZAVE" to "17.9949807"
Evaluating: -53.9973936-17.9949807
 Parameter: ZTRAN <- "-71.9923743"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "55.0772377"
 Parameter: YTRAN -> "-4.2185563"
 Parameter: ZTRAN -> "-71.9923743"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    55.077238   -4.218556  -71.992374
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.993393569"
Evaluating: 0.993393569*360.0
 Parameter: XPHI <- "357.621685"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.527299039E-02"
Evaluating: 3.527299039E-02*360.0
 Parameter: YPHI <- "12.6982765"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.810796527"
Evaluating: 0.810796527*360.0
 Parameter: ZPHI <- "291.88675"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.3144052"
 Parameter: YPOS -> "-55.0843283"
 Parameter: ZPOS -> "-53.9973936"
 Parameter: XPHI -> "357.621685"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999139   -0.041498
    0.000000    0.041498    0.999139

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    2.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.3144052"
 Parameter: YPOS -> "-55.0843283"
 Parameter: ZPOS -> "-53.9973936"
 Parameter: YPHI -> "12.6982765"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.975541    0.000000   -0.219817
    0.000000    1.000000    0.000000
    0.219817    0.000000    0.975541

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   12.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.3144052"
 Parameter: YPOS -> "-55.0843283"
 Parameter: ZPOS -> "-53.9973936"
 Parameter: ZPHI -> "291.88675"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.372773   -0.927922    0.000000
    0.927922    0.372773    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.314405 XMAX =   50.314405 XAVE =   50.314405
    YMIN =  -55.084328 YMAX =  -55.084328 YAVE =  -55.084328
    ZMIN =  -53.997394 ZMAX =  -53.997394 ZAVE =  -53.997394
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.3144052"
Evaluating: 50.3144052+3.5
 Parameter: XMAX <- "53.8144052"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-55.0843283"
Evaluating: -55.0843283+3.5
 Parameter: YMAX <- "-51.5843283"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.9973936"
Evaluating: -53.9973936+3.5
 Parameter: ZMAX <- "-50.4973936"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.3144052"
Evaluating: 50.3144052-3.5
 Parameter: XMIN <- "46.8144052"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-55.0843283"
Evaluating: -55.0843283-3.5
 Parameter: YMIN <- "-58.5843283"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.9973936"
Evaluating: -53.9973936-3.5
 Parameter: ZMIN <- "-57.4973936"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.8144052"
 Parameter: XMIN -> "46.8144052"
 Parameter: YMAX -> "-51.5843283"
 Parameter: YMIN -> "-58.5843283"
 Parameter: ZMAX -> "-50.4973936"
 Parameter: ZMIN -> "-57.4973936"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "69"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "69" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "69" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.714428985"
Evaluating: 125.050557*(0.714428985-0.5)
 Parameter: XPOS <- "26.814464"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.446023238"
Evaluating: 125.050557*(0.446023238-0.5)
 Parameter: YPOS <- "-6.74982415"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.419601655"
Evaluating: 152.572525*(0.419601655-0.5)+-4.51585405
 Parameter: ZPOS <- "-16.7824326"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.7824326" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.814464"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.814464-0
 Parameter: XTRAN <- "26.814464"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.74982415"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.74982415-0
 Parameter: YTRAN <- "-6.74982415"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.7824326"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.7824326-0
 Parameter: ZTRAN <- "-16.7824326"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.814464"
 Parameter: YTRAN -> "-6.74982415"
 Parameter: ZTRAN -> "-16.7824326"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    26.814464   -6.749824  -16.782433
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.936033893"
Evaluating: 0.936033893*360.0
 Parameter: XPHI <- "336.972201"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.377198216E-02"
Evaluating: 1.377198216E-02*360.0
 Parameter: YPHI <- "4.95791358"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.722745174"
Evaluating: 0.722745174*360.0
 Parameter: ZPHI <- "260.188263"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.814464"
 Parameter: YPOS -> "-6.74982415"
 Parameter: ZPOS -> "-16.7824326"
 Parameter: XPHI -> "336.972201"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.920315   -0.391178
    0.000000    0.391178    0.920315

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   23.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.814464"
 Parameter: YPOS -> "-6.74982415"
 Parameter: ZPOS -> "-16.7824326"
 Parameter: YPHI -> "4.95791358"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.996258    0.000000   -0.086424
    0.000000    1.000000    0.000000
    0.086424    0.000000    0.996258

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    4.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.814464"
 Parameter: YPOS -> "-6.74982415"
 Parameter: ZPOS -> "-16.7824326"
 Parameter: ZPHI -> "260.188263"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.170411   -0.985373    0.000000
    0.985373   -0.170411    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   99.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.814464 XMAX =   26.814464 XAVE =   26.814464
    YMIN =   -6.749824 YMAX =   -6.749824 YAVE =   -6.749824
    ZMIN =  -16.782433 ZMAX =  -16.782433 ZAVE =  -16.782433
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.814464"
Evaluating: 26.814464+3.5
 Parameter: XMAX <- "30.314464"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.74982415"
Evaluating: -6.74982415+3.5
 Parameter: YMAX <- "-3.24982415"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.7824326"
Evaluating: -16.7824326+3.5
 Parameter: ZMAX <- "-13.2824326"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.814464"
Evaluating: 26.814464-3.5
 Parameter: XMIN <- "23.314464"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.74982415"
Evaluating: -6.74982415-3.5
 Parameter: YMIN <- "-10.2498242"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.7824326"
Evaluating: -16.7824326-3.5
 Parameter: ZMIN <- "-20.2824326"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.314464"
 Parameter: XMIN -> "23.314464"
 Parameter: YMAX -> "-3.24982415"
 Parameter: YMIN -> "-10.2498242"
 Parameter: ZMAX -> "-13.2824326"
 Parameter: ZMIN -> "-20.2824326"
 SELRPN>     35 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     17 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64484 POS      SOD      69       SOD     -**** PROA     ARG      1249     CA            4.3907
64484 POS      SOD      69       SOD     -**** PROA     ARG      1249     CG            4.3502
64484 POS      SOD      69       SOD     -**** PROA     ARG      1249     NE            3.1566
64484 POS      SOD      69       SOD     -**** PROA     ARG      1249     CZ            3.3484
64484 POS      SOD      69       SOD     -**** PROA     ARG      1249     NH2           3.0781
64484 POS      SOD      69       SOD     -**** PROA     ARG      1249     C             3.2955
64484 POS      SOD      69       SOD     -**** PROA     ARG      1249     O             2.1489
64484 POS      SOD      69       SOD     -**** PROA     ALA      1250     CA            3.7540
64484 POS      SOD      69       SOD     -**** PROA     ALA      1250     C             3.6296
64484 POS      SOD      69       SOD     -**** PROA     ALA      1250     O             4.6510
64484 POS      SOD      69       SOD     -**** PROA     GLU      1251     N             2.8433
64484 POS      SOD      69       SOD     -**** PROA     GLU      1251     CA            3.5054
64484 POS      SOD      69       SOD     -**** PROA     GLU      1251     CB            3.1400
64484 POS      SOD      69       SOD     -**** PROA     GLU      1251     CG            2.3684
64484 POS      SOD      69       SOD     -**** PROA     GLU      1251     CD            2.4149
64484 POS      SOD      69       SOD     -**** PROA     GLU      1251     OE1           2.6695
64484 POS      SOD      69       SOD     -**** PROA     GLU      1251     OE2           3.0910
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        17
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "17"
 Comparing "17" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "69" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.744705681"
Evaluating: 125.050557*(0.744705681-0.5)
 Parameter: XPOS <- "30.6005817"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.253069873"
Evaluating: 125.050557*(0.253069873-0.5)
 Parameter: YPOS <- "-30.8787499"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "4.081092092E-02"
Evaluating: 152.572525*(4.081092092E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-74.5754913"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-74.5754913" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.814464 XMAX =   26.814464 XAVE =   26.814464
    YMIN =   -6.749824 YMAX =   -6.749824 YAVE =   -6.749824
    ZMIN =  -16.782433 ZMAX =  -16.782433 ZAVE =  -16.782433
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.6005817"
 RDCMND substituted energy or value "?XAVE" to "26.814464"
Evaluating: 30.6005817-26.814464
 Parameter: XTRAN <- "3.7861177"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.8787499"
 RDCMND substituted energy or value "?YAVE" to "-6.74982415"
Evaluating: -30.8787499--6.74982415
 Parameter: YTRAN <- "-24.1289258"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-74.5754913"
 RDCMND substituted energy or value "?ZAVE" to "-16.7824326"
Evaluating: -74.5754913--16.7824326
 Parameter: ZTRAN <- "-57.7930587"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.7861177"
 Parameter: YTRAN -> "-24.1289258"
 Parameter: ZTRAN -> "-57.7930587"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     3.786118  -24.128926  -57.793059
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.52095999E-02"
Evaluating: 7.52095999E-02*360.0
 Parameter: XPHI <- "27.075456"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.667709589"
Evaluating: 0.667709589*360.0
 Parameter: YPHI <- "240.375452"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.374234488"
Evaluating: 0.374234488*360.0
 Parameter: ZPHI <- "134.724416"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.6005817"
 Parameter: YPOS -> "-30.8787499"
 Parameter: ZPOS -> "-74.5754913"
 Parameter: XPHI -> "27.075456"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.890408    0.455164
    0.000000   -0.455164    0.890408

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   27.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.6005817"
 Parameter: YPOS -> "-30.8787499"
 Parameter: ZPOS -> "-74.5754913"
 Parameter: YPHI -> "240.375452"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.494314    0.000000    0.869283
    0.000000    1.000000    0.000000
   -0.869283    0.000000   -0.494314

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  119.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.6005817"
 Parameter: YPOS -> "-30.8787499"
 Parameter: ZPOS -> "-74.5754913"
 Parameter: ZPHI -> "134.724416"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.703698    0.710500    0.000000
   -0.710500   -0.703698    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  134.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.600582 XMAX =   30.600582 XAVE =   30.600582
    YMIN =  -30.878750 YMAX =  -30.878750 YAVE =  -30.878750
    ZMIN =  -74.575491 ZMAX =  -74.575491 ZAVE =  -74.575491
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.6005817"
Evaluating: 30.6005817+3.5
 Parameter: XMAX <- "34.1005817"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.8787499"
Evaluating: -30.8787499+3.5
 Parameter: YMAX <- "-27.3787499"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-74.5754913"
Evaluating: -74.5754913+3.5
 Parameter: ZMAX <- "-71.0754913"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.6005817"
Evaluating: 30.6005817-3.5
 Parameter: XMIN <- "27.1005817"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.8787499"
Evaluating: -30.8787499-3.5
 Parameter: YMIN <- "-34.3787499"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-74.5754913"
Evaluating: -74.5754913-3.5
 Parameter: ZMIN <- "-78.0754913"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.1005817"
 Parameter: XMIN -> "27.1005817"
 Parameter: YMAX -> "-27.3787499"
 Parameter: YMIN -> "-34.3787499"
 Parameter: ZMAX -> "-71.0754913"
 Parameter: ZMIN -> "-78.0754913"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "70"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "70" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "70" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.365563009"
Evaluating: 125.050557*(0.365563009-0.5)
 Parameter: XPOS <- "-16.8114206"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.435492757"
Evaluating: 125.050557*(0.435492757-0.5)
 Parameter: YPOS <- "-8.06666667"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.254137926"
Evaluating: 152.572525*(0.254137926-0.5)+-4.51585405
 Parameter: ZPOS <- "-42.0276515"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.0276515" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.8114206"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.8114206-0
 Parameter: XTRAN <- "-16.8114206"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.06666667"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.06666667-0
 Parameter: YTRAN <- "-8.06666667"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.0276515"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.0276515-0
 Parameter: ZTRAN <- "-42.0276515"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.8114206"
 Parameter: YTRAN -> "-8.06666667"
 Parameter: ZTRAN -> "-42.0276515"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -16.811421   -8.066667  -42.027651
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.918399491"
Evaluating: 0.918399491*360.0
 Parameter: XPHI <- "330.623817"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.856489078"
Evaluating: 0.856489078*360.0
 Parameter: YPHI <- "308.336068"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.343205041"
Evaluating: 0.343205041*360.0
 Parameter: ZPHI <- "123.553815"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.8114206"
 Parameter: YPOS -> "-8.06666667"
 Parameter: ZPOS -> "-42.0276515"
 Parameter: XPHI -> "330.623817"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.871418   -0.490542
    0.000000    0.490542    0.871418

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   29.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.8114206"
 Parameter: YPOS -> "-8.06666667"
 Parameter: ZPOS -> "-42.0276515"
 Parameter: YPHI -> "308.336068"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.620273    0.000000    0.784386
    0.000000    1.000000    0.000000
   -0.784386    0.000000    0.620273

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   51.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.8114206"
 Parameter: YPOS -> "-8.06666667"
 Parameter: ZPOS -> "-42.0276515"
 Parameter: ZPHI -> "123.553815"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.552720    0.833367    0.000000
   -0.833367   -0.552720    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  123.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.811421 XMAX =  -16.811421 XAVE =  -16.811421
    YMIN =   -8.066667 YMAX =   -8.066667 YAVE =   -8.066667
    ZMIN =  -42.027651 ZMAX =  -42.027651 ZAVE =  -42.027651
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.8114206"
Evaluating: -16.8114206+3.5
 Parameter: XMAX <- "-13.3114206"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.06666667"
Evaluating: -8.06666667+3.5
 Parameter: YMAX <- "-4.56666667"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.0276515"
Evaluating: -42.0276515+3.5
 Parameter: ZMAX <- "-38.5276515"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.8114206"
Evaluating: -16.8114206-3.5
 Parameter: XMIN <- "-20.3114206"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.06666667"
Evaluating: -8.06666667-3.5
 Parameter: YMIN <- "-11.5666667"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.0276515"
Evaluating: -42.0276515-3.5
 Parameter: ZMIN <- "-45.5276515"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.3114206"
 Parameter: XMIN -> "-20.3114206"
 Parameter: YMAX -> "-4.56666667"
 Parameter: YMIN -> "-11.5666667"
 Parameter: ZMAX -> "-38.5276515"
 Parameter: ZMIN -> "-45.5276515"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "71"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "71" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "71" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.352301425"
Evaluating: 125.050557*(0.352301425-0.5)
 Parameter: XPOS <- "-18.4697891"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "8.392542052E-02"
Evaluating: 125.050557*(8.392542052E-02-0.5)
 Parameter: YPOS <- "-52.0303579"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.333453951"
Evaluating: 152.572525*(0.333453951-0.5)+-4.51585405
 Parameter: ZPOS <- "-29.9262053"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.9262053" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.4697891"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.4697891-0
 Parameter: XTRAN <- "-18.4697891"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-52.0303579"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -52.0303579-0
 Parameter: YTRAN <- "-52.0303579"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.9262053"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.9262053-0
 Parameter: ZTRAN <- "-29.9262053"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.4697891"
 Parameter: YTRAN -> "-52.0303579"
 Parameter: ZTRAN -> "-29.9262053"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -18.469789  -52.030358  -29.926205
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.158351341"
Evaluating: 0.158351341*360.0
 Parameter: XPHI <- "57.0064828"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.754087984"
Evaluating: 0.754087984*360.0
 Parameter: YPHI <- "271.471674"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.275944625"
Evaluating: 0.275944625*360.0
 Parameter: ZPHI <- "99.340065"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.4697891"
 Parameter: YPOS -> "-52.0303579"
 Parameter: ZPOS -> "-29.9262053"
 Parameter: XPHI -> "57.0064828"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.544544    0.838732
    0.000000   -0.838732    0.544544

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   57.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.4697891"
 Parameter: YPOS -> "-52.0303579"
 Parameter: ZPOS -> "-29.9262053"
 Parameter: YPHI -> "271.471674"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.025683    0.000000    0.999670
    0.000000    1.000000    0.000000
   -0.999670    0.000000    0.025683

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   88.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.4697891"
 Parameter: YPOS -> "-52.0303579"
 Parameter: ZPOS -> "-29.9262053"
 Parameter: ZPHI -> "99.340065"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.162294    0.986742    0.000000
   -0.986742   -0.162294    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   99.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.469789 XMAX =  -18.469789 XAVE =  -18.469789
    YMIN =  -52.030358 YMAX =  -52.030358 YAVE =  -52.030358
    ZMIN =  -29.926205 ZMAX =  -29.926205 ZAVE =  -29.926205
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.4697891"
Evaluating: -18.4697891+3.5
 Parameter: XMAX <- "-14.9697891"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-52.0303579"
Evaluating: -52.0303579+3.5
 Parameter: YMAX <- "-48.5303579"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.9262053"
Evaluating: -29.9262053+3.5
 Parameter: ZMAX <- "-26.4262053"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.4697891"
Evaluating: -18.4697891-3.5
 Parameter: XMIN <- "-21.9697891"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-52.0303579"
Evaluating: -52.0303579-3.5
 Parameter: YMIN <- "-55.5303579"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.9262053"
Evaluating: -29.9262053-3.5
 Parameter: ZMIN <- "-33.4262053"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.9697891"
 Parameter: XMIN -> "-21.9697891"
 Parameter: YMAX -> "-48.5303579"
 Parameter: YMIN -> "-55.5303579"
 Parameter: ZMAX -> "-26.4262053"
 Parameter: ZMIN -> "-33.4262053"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "72"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "72" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "72" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.369740508"
Evaluating: 125.050557*(0.369740508-0.5)
 Parameter: XPOS <- "-16.289022"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.71098677"
Evaluating: 125.050557*(0.71098677-0.5)
 Parameter: YPOS <- "26.3840131"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.453263243"
Evaluating: 152.572525*(0.453263243-0.5)+-4.51585405
 Parameter: ZPOS <- "-11.6465991"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.6465991" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.6465991" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "72" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.901263291"
Evaluating: 125.050557*(0.901263291-0.5)
 Parameter: XPOS <- "50.178198"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.783195186"
Evaluating: 125.050557*(0.783195186-0.5)
 Parameter: YPOS <- "35.4137157"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "6.319519624E-02"
Evaluating: 152.572525*(6.319519624E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-71.1602659"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-71.1602659" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.178198"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 50.178198-0
 Parameter: XTRAN <- "50.178198"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.4137157"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.4137157-0
 Parameter: YTRAN <- "35.4137157"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-71.1602659"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -71.1602659-0
 Parameter: ZTRAN <- "-71.1602659"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.178198"
 Parameter: YTRAN -> "35.4137157"
 Parameter: ZTRAN -> "-71.1602659"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    50.178198   35.413716  -71.160266
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.219229085"
Evaluating: 0.219229085*360.0
 Parameter: XPHI <- "78.9224706"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.188408975"
Evaluating: 0.188408975*360.0
 Parameter: YPHI <- "67.827231"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.990574686"
Evaluating: 0.990574686*360.0
 Parameter: ZPHI <- "356.606887"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.178198"
 Parameter: YPOS -> "35.4137157"
 Parameter: ZPOS -> "-71.1602659"
 Parameter: XPHI -> "78.9224706"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.192137    0.981368
    0.000000   -0.981368    0.192137

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   78.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.178198"
 Parameter: YPOS -> "35.4137157"
 Parameter: ZPOS -> "-71.1602659"
 Parameter: YPHI -> "67.827231"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.377401    0.000000   -0.926050
    0.000000    1.000000    0.000000
    0.926050    0.000000    0.377401

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   67.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.178198"
 Parameter: YPOS -> "35.4137157"
 Parameter: ZPOS -> "-71.1602659"
 Parameter: ZPHI -> "356.606887"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.998247   -0.059186    0.000000
    0.059186    0.998247    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    3.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.178198 XMAX =   50.178198 XAVE =   50.178198
    YMIN =   35.413716 YMAX =   35.413716 YAVE =   35.413716
    ZMIN =  -71.160266 ZMAX =  -71.160266 ZAVE =  -71.160266
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.178198"
Evaluating: 50.178198+3.5
 Parameter: XMAX <- "53.678198"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.4137157"
Evaluating: 35.4137157+3.5
 Parameter: YMAX <- "38.9137157"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-71.1602659"
Evaluating: -71.1602659+3.5
 Parameter: ZMAX <- "-67.6602659"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.178198"
Evaluating: 50.178198-3.5
 Parameter: XMIN <- "46.678198"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.4137157"
Evaluating: 35.4137157-3.5
 Parameter: YMIN <- "31.9137157"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-71.1602659"
Evaluating: -71.1602659-3.5
 Parameter: ZMIN <- "-74.6602659"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.678198"
 Parameter: XMIN -> "46.678198"
 Parameter: YMAX -> "38.9137157"
 Parameter: YMIN -> "31.9137157"
 Parameter: ZMAX -> "-67.6602659"
 Parameter: ZMIN -> "-74.6602659"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "73"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "73" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "73"
Evaluating: 73
 Parameter: J <- "73"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "73" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.116249192"
Evaluating: 125.050557*(0.116249192-0.5)
 Parameter: XPOS <- "-47.9882523"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.105141298"
Evaluating: 125.050557*(0.105141298-0.5)
 Parameter: YPOS <- "-49.3773006"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "2.31191212E-03"
Evaluating: 152.572525*(2.31191212E-03-0.5)+-4.51585405
 Parameter: ZPOS <- "-80.4493823"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-80.4493823" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.9882523"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -47.9882523-0
 Parameter: XTRAN <- "-47.9882523"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.3773006"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -49.3773006-0
 Parameter: YTRAN <- "-49.3773006"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-80.4493823"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -80.4493823-0
 Parameter: ZTRAN <- "-80.4493823"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.9882523"
 Parameter: YTRAN -> "-49.3773006"
 Parameter: ZTRAN -> "-80.4493823"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -47.988252  -49.377301  -80.449382
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.739945346"
Evaluating: 0.739945346*360.0
 Parameter: XPHI <- "266.380325"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.454898498"
Evaluating: 0.454898498*360.0
 Parameter: YPHI <- "163.763459"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.961499156E-02"
Evaluating: 6.961499156E-02*360.0
 Parameter: ZPHI <- "25.061397"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.9882523"
 Parameter: YPOS -> "-49.3773006"
 Parameter: ZPOS -> "-80.4493823"
 Parameter: XPHI -> "266.380325"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.063133   -0.998005
    0.000000    0.998005   -0.063133

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   93.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.9882523"
 Parameter: YPOS -> "-49.3773006"
 Parameter: ZPOS -> "-80.4493823"
 Parameter: YPHI -> "163.763459"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.960116    0.000000   -0.279603
    0.000000    1.000000    0.000000
    0.279603    0.000000   -0.960116

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  163.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.9882523"
 Parameter: YPOS -> "-49.3773006"
 Parameter: ZPOS -> "-80.4493823"
 Parameter: ZPHI -> "25.061397"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.905854    0.423589    0.000000
   -0.423589    0.905854    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   25.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.988252 XMAX =  -47.988252 XAVE =  -47.988252
    YMIN =  -49.377301 YMAX =  -49.377301 YAVE =  -49.377301
    ZMIN =  -80.449382 ZMAX =  -80.449382 ZAVE =  -80.449382
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.9882523"
Evaluating: -47.9882523+3.5
 Parameter: XMAX <- "-44.4882523"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.3773006"
Evaluating: -49.3773006+3.5
 Parameter: YMAX <- "-45.8773006"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-80.4493823"
Evaluating: -80.4493823+3.5
 Parameter: ZMAX <- "-76.9493823"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.9882523"
Evaluating: -47.9882523-3.5
 Parameter: XMIN <- "-51.4882523"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.3773006"
Evaluating: -49.3773006-3.5
 Parameter: YMIN <- "-52.8773006"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-80.4493823"
Evaluating: -80.4493823-3.5
 Parameter: ZMIN <- "-83.9493823"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.4882523"
 Parameter: XMIN -> "-51.4882523"
 Parameter: YMAX -> "-45.8773006"
 Parameter: YMIN -> "-52.8773006"
 Parameter: ZMAX -> "-76.9493823"
 Parameter: ZMIN -> "-83.9493823"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "74"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "74" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "74" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.910176063"
Evaluating: 125.050557*(0.910176063-0.5)
 Parameter: XPOS <- "51.2927451"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.319799672"
Evaluating: 125.050557*(0.319799672-0.5)
 Parameter: YPOS <- "-22.5341514"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.502314853"
Evaluating: 152.572525*(0.502314853-0.5)+-4.51585405
 Parameter: ZPOS <- "-4.16267108"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.16267108" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.16267108" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "74" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.708308566"
Evaluating: 125.050557*(0.708308566-0.5)
 Parameter: XPOS <- "26.0491022"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.74270053"
Evaluating: 125.050557*(0.74270053-0.5)
 Parameter: YPOS <- "30.3498365"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.868965715"
Evaluating: 152.572525*(0.868965715-0.5)+-4.51585405
 Parameter: ZPOS <- "51.7781767"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "51.7781767" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "51.7781767" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.0491022"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.0491022-0
 Parameter: XTRAN <- "26.0491022"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.3498365"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.3498365-0
 Parameter: YTRAN <- "30.3498365"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "51.7781767"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 51.7781767-0
 Parameter: ZTRAN <- "51.7781767"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.0491022"
 Parameter: YTRAN -> "30.3498365"
 Parameter: ZTRAN -> "51.7781767"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    26.049102   30.349836   51.778177
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.866490705"
Evaluating: 0.866490705*360.0
 Parameter: XPHI <- "311.936654"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.418155808"
Evaluating: 0.418155808*360.0
 Parameter: YPHI <- "150.536091"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.594148255"
Evaluating: 0.594148255*360.0
 Parameter: ZPHI <- "213.893372"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.0491022"
 Parameter: YPOS -> "30.3498365"
 Parameter: ZPOS -> "51.7781767"
 Parameter: XPHI -> "311.936654"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.668309   -0.743884
    0.000000    0.743884    0.668309

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   48.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.0491022"
 Parameter: YPOS -> "30.3498365"
 Parameter: ZPOS -> "51.7781767"
 Parameter: YPHI -> "150.536091"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.870666    0.000000   -0.491875
    0.000000    1.000000    0.000000
    0.491875    0.000000   -0.870666

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  150.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.0491022"
 Parameter: YPOS -> "30.3498365"
 Parameter: ZPOS -> "51.7781767"
 Parameter: ZPHI -> "213.893372"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.830077   -0.557649    0.000000
    0.557649   -0.830077    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  146.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.049102 XMAX =   26.049102 XAVE =   26.049102
    YMIN =   30.349836 YMAX =   30.349836 YAVE =   30.349836
    ZMIN =   51.778177 ZMAX =   51.778177 ZAVE =   51.778177
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.0491022"
Evaluating: 26.0491022+3.5
 Parameter: XMAX <- "29.5491022"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.3498365"
Evaluating: 30.3498365+3.5
 Parameter: YMAX <- "33.8498365"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "51.7781767"
Evaluating: 51.7781767+3.5
 Parameter: ZMAX <- "55.2781767"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.0491022"
Evaluating: 26.0491022-3.5
 Parameter: XMIN <- "22.5491022"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.3498365"
Evaluating: 30.3498365-3.5
 Parameter: YMIN <- "26.8498365"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "51.7781767"
Evaluating: 51.7781767-3.5
 Parameter: ZMIN <- "48.2781767"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.5491022"
 Parameter: XMIN -> "22.5491022"
 Parameter: YMAX -> "33.8498365"
 Parameter: YMIN -> "26.8498365"
 Parameter: ZMAX -> "55.2781767"
 Parameter: ZMIN -> "48.2781767"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "75"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "75" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "75" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.899594621"
Evaluating: 125.050557*(0.899594621-0.5)
 Parameter: XPOS <- "49.9695299"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.905196725"
Evaluating: 125.050557*(0.905196725-0.5)
 Parameter: YPOS <- "50.6700762"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.473900125"
Evaluating: 152.572525*(0.473900125-0.5)+-4.51585405
 Parameter: ZPOS <- "-8.49797788"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.49797788" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.49797788" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "75" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "2.476484291E-03"
Evaluating: 125.050557*(2.476484291E-03-0.5)
 Parameter: XPOS <- "-62.2155928"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.410938248"
Evaluating: 125.050557*(0.410938248-0.5)
 Parameter: YPOS <- "-11.1372217"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.848319424"
Evaluating: 152.572525*(0.848319424-0.5)+-4.51585405
 Parameter: ZPOS <- "48.62812"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.62812" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.62812" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-62.2155928"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -62.2155928-0
 Parameter: XTRAN <- "-62.2155928"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.1372217"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.1372217-0
 Parameter: YTRAN <- "-11.1372217"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.62812"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 48.62812-0
 Parameter: ZTRAN <- "48.62812"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.2155928"
 Parameter: YTRAN -> "-11.1372217"
 Parameter: ZTRAN -> "48.62812"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -62.215593  -11.137222   48.628120
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.820179364"
Evaluating: 0.820179364*360.0
 Parameter: XPHI <- "295.264571"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.154300614"
Evaluating: 0.154300614*360.0
 Parameter: YPHI <- "55.548221"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.20196506"
Evaluating: 0.20196506*360.0
 Parameter: ZPHI <- "72.7074216"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-62.2155928"
 Parameter: YPOS -> "-11.1372217"
 Parameter: ZPOS -> "48.62812"
 Parameter: XPHI -> "295.264571"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.426799   -0.904347
    0.000000    0.904347    0.426799

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   64.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-62.2155928"
 Parameter: YPOS -> "-11.1372217"
 Parameter: ZPOS -> "48.62812"
 Parameter: YPHI -> "55.548221"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.565712    0.000000   -0.824603
    0.000000    1.000000    0.000000
    0.824603    0.000000    0.565712

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   55.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-62.2155928"
 Parameter: YPOS -> "-11.1372217"
 Parameter: ZPOS -> "48.62812"
 Parameter: ZPHI -> "72.7074216"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.297251    0.954799    0.000000
   -0.954799    0.297251    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   72.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -62.215593 XMAX =  -62.215593 XAVE =  -62.215593
    YMIN =  -11.137222 YMAX =  -11.137222 YAVE =  -11.137222
    ZMIN =   48.628120 ZMAX =   48.628120 ZAVE =   48.628120
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-62.2155928"
Evaluating: -62.2155928+3.5
 Parameter: XMAX <- "-58.7155928"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.1372217"
Evaluating: -11.1372217+3.5
 Parameter: YMAX <- "-7.6372217"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.62812"
Evaluating: 48.62812+3.5
 Parameter: ZMAX <- "52.12812"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-62.2155928"
Evaluating: -62.2155928-3.5
 Parameter: XMIN <- "-65.7155928"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.1372217"
Evaluating: -11.1372217-3.5
 Parameter: YMIN <- "-14.6372217"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.62812"
Evaluating: 48.62812-3.5
 Parameter: ZMIN <- "45.12812"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-58.7155928"
 Parameter: XMIN -> "-65.7155928"
 Parameter: YMAX -> "-7.6372217"
 Parameter: YMIN -> "-14.6372217"
 Parameter: ZMAX -> "52.12812"
 Parameter: ZMIN -> "45.12812"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "76"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "76" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "76" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.780482946"
Evaluating: 125.050557*(0.780482946-0.5)
 Parameter: XPOS <- "35.0745486"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.560495296"
Evaluating: 125.050557*(0.560495296-0.5)
 Parameter: YPOS <- "7.56497046"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.832842753"
Evaluating: 152.572525*(0.832842753-0.5)+-4.51585405
 Parameter: ZPOS <- "46.2668052"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.2668052" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.2668052" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.0745486"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 35.0745486-0
 Parameter: XTRAN <- "35.0745486"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.56497046"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.56497046-0
 Parameter: YTRAN <- "7.56497046"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.2668052"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.2668052-0
 Parameter: ZTRAN <- "46.2668052"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.0745486"
 Parameter: YTRAN -> "7.56497046"
 Parameter: ZTRAN -> "46.2668052"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    35.074549    7.564970   46.266805
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.660433282"
Evaluating: 0.660433282*360.0
 Parameter: XPHI <- "237.755982"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.473968157"
Evaluating: 0.473968157*360.0
 Parameter: YPHI <- "170.628537"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.945959822"
Evaluating: 0.945959822*360.0
 Parameter: ZPHI <- "340.545536"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.0745486"
 Parameter: YPOS -> "7.56497046"
 Parameter: ZPOS -> "46.2668052"
 Parameter: XPHI -> "237.755982"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.533526   -0.845784
    0.000000    0.845784   -0.533526

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  122.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.0745486"
 Parameter: YPOS -> "7.56497046"
 Parameter: ZPOS -> "46.2668052"
 Parameter: YPHI -> "170.628537"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.986653    0.000000   -0.162835
    0.000000    1.000000    0.000000
    0.162835    0.000000   -0.986653

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  170.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.0745486"
 Parameter: YPOS -> "7.56497046"
 Parameter: ZPOS -> "46.2668052"
 Parameter: ZPHI -> "340.545536"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.942906   -0.333058    0.000000
    0.333058    0.942906    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   19.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.074549 XMAX =   35.074549 XAVE =   35.074549
    YMIN =    7.564970 YMAX =    7.564970 YAVE =    7.564970
    ZMIN =   46.266805 ZMAX =   46.266805 ZAVE =   46.266805
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.0745486"
Evaluating: 35.0745486+3.5
 Parameter: XMAX <- "38.5745486"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.56497046"
Evaluating: 7.56497046+3.5
 Parameter: YMAX <- "11.0649705"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.2668052"
Evaluating: 46.2668052+3.5
 Parameter: ZMAX <- "49.7668052"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.0745486"
Evaluating: 35.0745486-3.5
 Parameter: XMIN <- "31.5745486"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.56497046"
Evaluating: 7.56497046-3.5
 Parameter: YMIN <- "4.06497046"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.2668052"
Evaluating: 46.2668052-3.5
 Parameter: ZMIN <- "42.7668052"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.5745486"
 Parameter: XMIN -> "31.5745486"
 Parameter: YMAX -> "11.0649705"
 Parameter: YMIN -> "4.06497046"
 Parameter: ZMAX -> "49.7668052"
 Parameter: ZMIN -> "42.7668052"
 SELRPN>      8 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      3 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64491 POS      SOD      76       SOD     -**** PROA     TYR      1213     OH            4.1489
64491 POS      SOD      76       SOD     -**** PROA     LEU      1215     C             4.6414
64491 POS      SOD      76       SOD     -**** PROA     GLY      1216     N             3.8897
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "76" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.17429059"
Evaluating: 125.050557*(0.17429059-0.5)
 Parameter: XPOS <- "-40.7301431"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.620549108"
Evaluating: 125.050557*(0.620549108-0.5)
 Parameter: YPOS <- "15.0747331"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.63889833"
Evaluating: 152.572525*(0.63889833-0.5)+-4.51585405
 Parameter: ZPOS <- "16.6762149"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.6762149" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.6762149" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.074549 XMAX =   35.074549 XAVE =   35.074549
    YMIN =    7.564970 YMAX =    7.564970 YAVE =    7.564970
    ZMIN =   46.266805 ZMAX =   46.266805 ZAVE =   46.266805
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.7301431"
 RDCMND substituted energy or value "?XAVE" to "35.0745486"
Evaluating: -40.7301431-35.0745486
 Parameter: XTRAN <- "-75.8046917"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.0747331"
 RDCMND substituted energy or value "?YAVE" to "7.56497046"
Evaluating: 15.0747331-7.56497046
 Parameter: YTRAN <- "7.50976264"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.6762149"
 RDCMND substituted energy or value "?ZAVE" to "46.2668052"
Evaluating: 16.6762149-46.2668052
 Parameter: ZTRAN <- "-29.5905903"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-75.8046917"
 Parameter: YTRAN -> "7.50976264"
 Parameter: ZTRAN -> "-29.5905903"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -75.804692    7.509763  -29.590590
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.638370854"
Evaluating: 0.638370854*360.0
 Parameter: XPHI <- "229.813507"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.201637863"
Evaluating: 0.201637863*360.0
 Parameter: YPHI <- "72.5896307"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487746586"
Evaluating: 0.487746586*360.0
 Parameter: ZPHI <- "175.588771"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.7301431"
 Parameter: YPOS -> "15.0747331"
 Parameter: ZPOS -> "16.6762149"
 Parameter: XPHI -> "229.813507"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.645278   -0.763948
    0.000000    0.763948   -0.645278

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  130.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.7301431"
 Parameter: YPOS -> "15.0747331"
 Parameter: ZPOS -> "16.6762149"
 Parameter: YPHI -> "72.5896307"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.299213    0.000000   -0.954186
    0.000000    1.000000    0.000000
    0.954186    0.000000    0.299213

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   72.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.7301431"
 Parameter: YPOS -> "15.0747331"
 Parameter: ZPOS -> "16.6762149"
 Parameter: ZPHI -> "175.588771"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.997038    0.076914    0.000000
   -0.076914   -0.997038    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  175.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.730143 XMAX =  -40.730143 XAVE =  -40.730143
    YMIN =   15.074733 YMAX =   15.074733 YAVE =   15.074733
    ZMIN =   16.676215 ZMAX =   16.676215 ZAVE =   16.676215
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.7301431"
Evaluating: -40.7301431+3.5
 Parameter: XMAX <- "-37.2301431"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.0747331"
Evaluating: 15.0747331+3.5
 Parameter: YMAX <- "18.5747331"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.6762149"
Evaluating: 16.6762149+3.5
 Parameter: ZMAX <- "20.1762149"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.7301431"
Evaluating: -40.7301431-3.5
 Parameter: XMIN <- "-44.2301431"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.0747331"
Evaluating: 15.0747331-3.5
 Parameter: YMIN <- "11.5747331"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.6762149"
Evaluating: 16.6762149-3.5
 Parameter: ZMIN <- "13.1762149"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.2301431"
 Parameter: XMIN -> "-44.2301431"
 Parameter: YMAX -> "18.5747331"
 Parameter: YMIN -> "11.5747331"
 Parameter: ZMAX -> "20.1762149"
 Parameter: ZMIN -> "13.1762149"
 SELRPN>     30 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      7 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64491 POS      SOD      76       SOD     -6311 PROA     ARG      462      NE            3.9467
64491 POS      SOD      76       SOD     -6313 PROA     ARG      462      CZ            2.8965
64491 POS      SOD      76       SOD     -6314 PROA     ARG      462      NH1           3.2813
64491 POS      SOD      76       SOD     -6317 PROA     ARG      462      NH2           2.1023
64491 POS      SOD      76       SOD     -6329 PROA     LEU      463      CG            3.0301
64491 POS      SOD      76       SOD     -6331 PROA     LEU      463      CD1           2.9193
64491 POS      SOD      76       SOD     -6335 PROA     LEU      463      CD2           2.6046
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "76" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.216615385"
Evaluating: 125.050557*(0.216615385-0.5)
 Parameter: XPOS <- "-35.437404"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.425722453"
Evaluating: 125.050557*(0.425722453-0.5)
 Parameter: YPOS <- "-9.28844862"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.62441114"
Evaluating: 152.572525*(0.62441114-0.5)+-4.51585405
 Parameter: ZPOS <- "14.4658677"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.4658677" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.4658677" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "76" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.49385626"
Evaluating: 125.050557*(0.49385626-0.5)
 Parameter: XPOS <- "-0.768278109"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.248556712"
Evaluating: 125.050557*(0.248556712-0.5)
 Parameter: YPOS <- "-31.4431232"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.463496723"
Evaluating: 152.572525*(0.463496723-0.5)+-4.51585405
 Parameter: ZPOS <- "-10.0852512"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.0852512" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.0852512" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "76" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.525688651"
Evaluating: 125.050557*(0.525688651-0.5)
 Parameter: XPOS <- "3.21238012"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.335558683"
Evaluating: 125.050557*(0.335558683-0.5)
 Parameter: YPOS <- "-20.5634783"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.44557448"
Evaluating: 152.572525*(0.44557448-0.5)+-4.51585405
 Parameter: ZPOS <- "-12.8196931"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.8196931" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.8196931" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "76" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.711943179E-02"
Evaluating: 125.050557*(9.711943179E-02-0.5)
 Parameter: XPOS <- "-50.3804395"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.50865371"
Evaluating: 125.050557*(0.50865371-0.5)
 Parameter: YPOS <- "1.08215126"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "8.641256545E-04"
Evaluating: 152.572525*(8.641256545E-04-0.5)+-4.51585405
 Parameter: ZPOS <- "-80.6702747"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-80.6702747" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.730143 XMAX =  -40.730143 XAVE =  -40.730143
    YMIN =   15.074733 YMAX =   15.074733 YAVE =   15.074733
    ZMIN =   16.676215 ZMAX =   16.676215 ZAVE =   16.676215
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.3804395"
 RDCMND substituted energy or value "?XAVE" to "-40.7301431"
Evaluating: -50.3804395--40.7301431
 Parameter: XTRAN <- "-9.6502964"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.08215126"
 RDCMND substituted energy or value "?YAVE" to "15.0747331"
Evaluating: 1.08215126-15.0747331
 Parameter: YTRAN <- "-13.9925818"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-80.6702747"
 RDCMND substituted energy or value "?ZAVE" to "16.6762149"
Evaluating: -80.6702747-16.6762149
 Parameter: ZTRAN <- "-97.3464896"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.6502964"
 Parameter: YTRAN -> "-13.9925818"
 Parameter: ZTRAN -> "-97.3464896"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -9.650296  -13.992582  -97.346490
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.686497624"
Evaluating: 0.686497624*360.0
 Parameter: XPHI <- "247.139145"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.895532469"
Evaluating: 0.895532469*360.0
 Parameter: YPHI <- "322.391689"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.214503353"
Evaluating: 0.214503353*360.0
 Parameter: ZPHI <- "77.2212071"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.3804395"
 Parameter: YPOS -> "1.08215126"
 Parameter: ZPOS -> "-80.6702747"
 Parameter: XPHI -> "247.139145"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.388494   -0.921451
    0.000000    0.921451   -0.388494

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  112.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.3804395"
 Parameter: YPOS -> "1.08215126"
 Parameter: ZPOS -> "-80.6702747"
 Parameter: YPHI -> "322.391689"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.792201    0.000000    0.610260
    0.000000    1.000000    0.000000
   -0.610260    0.000000    0.792201

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   37.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.3804395"
 Parameter: YPOS -> "1.08215126"
 Parameter: ZPOS -> "-80.6702747"
 Parameter: ZPHI -> "77.2212071"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.221188    0.975231    0.000000
   -0.975231    0.221188    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   77.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.380440 XMAX =  -50.380440 XAVE =  -50.380440
    YMIN =    1.082151 YMAX =    1.082151 YAVE =    1.082151
    ZMIN =  -80.670275 ZMAX =  -80.670275 ZAVE =  -80.670275
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.3804395"
Evaluating: -50.3804395+3.5
 Parameter: XMAX <- "-46.8804395"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.08215123"
Evaluating: 1.08215123+3.5
 Parameter: YMAX <- "4.58215123"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-80.6702747"
Evaluating: -80.6702747+3.5
 Parameter: ZMAX <- "-77.1702747"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.3804395"
Evaluating: -50.3804395-3.5
 Parameter: XMIN <- "-53.8804395"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.08215123"
Evaluating: 1.08215123-3.5
 Parameter: YMIN <- "-2.41784877"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-80.6702747"
Evaluating: -80.6702747-3.5
 Parameter: ZMIN <- "-84.1702747"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.8804395"
 Parameter: XMIN -> "-53.8804395"
 Parameter: YMAX -> "4.58215123"
 Parameter: YMIN -> "-2.41784877"
 Parameter: ZMAX -> "-77.1702747"
 Parameter: ZMIN -> "-84.1702747"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "77"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "77" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "77" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.793937918"
Evaluating: 125.050557*(0.793937918-0.5)
 Parameter: XPOS <- "36.7571004"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.493899791"
Evaluating: 125.050557*(0.493899791-0.5)
 Parameter: YPOS <- "-0.762834533"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.318845293"
Evaluating: 152.572525*(0.318845293-0.5)+-4.51585405
 Parameter: ZPOS <- "-32.1550851"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.1550851" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.7571004"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.7571004-0
 Parameter: XTRAN <- "36.7571004"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.762834533"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.762834533-0
 Parameter: YTRAN <- "-0.762834533"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.1550851"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.1550851-0
 Parameter: ZTRAN <- "-32.1550851"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.7571004"
 Parameter: YTRAN -> "-0.762834533"
 Parameter: ZTRAN -> "-32.1550851"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    36.757100   -0.762835  -32.155085
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.948910798"
Evaluating: 0.948910798*360.0
 Parameter: XPHI <- "341.607887"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.660705452"
Evaluating: 0.660705452*360.0
 Parameter: YPHI <- "237.853963"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.548850723E-02"
Evaluating: 8.548850723E-02*360.0
 Parameter: ZPHI <- "30.7758626"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.7571004"
 Parameter: YPOS -> "-0.762834533"
 Parameter: ZPOS -> "-32.1550851"
 Parameter: XPHI -> "341.607887"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.948919   -0.315518
    0.000000    0.315518    0.948919

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   18.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.7571004"
 Parameter: YPOS -> "-0.762834533"
 Parameter: ZPOS -> "-32.1550851"
 Parameter: YPHI -> "237.853963"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.532079    0.000000    0.846695
    0.000000    1.000000    0.000000
   -0.846695    0.000000   -0.532079

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  122.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.7571004"
 Parameter: YPOS -> "-0.762834533"
 Parameter: ZPOS -> "-32.1550851"
 Parameter: ZPHI -> "30.7758626"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.859176    0.511681    0.000000
   -0.511681    0.859176    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   30.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.757100 XMAX =   36.757100 XAVE =   36.757100
    YMIN =   -0.762835 YMAX =   -0.762835 YAVE =   -0.762835
    ZMIN =  -32.155085 ZMAX =  -32.155085 ZAVE =  -32.155085
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.7571004"
Evaluating: 36.7571004+3.5
 Parameter: XMAX <- "40.2571004"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.762834533"
Evaluating: -0.762834533+3.5
 Parameter: YMAX <- "2.73716547"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.1550851"
Evaluating: -32.1550851+3.5
 Parameter: ZMAX <- "-28.6550851"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.7571004"
Evaluating: 36.7571004-3.5
 Parameter: XMIN <- "33.2571004"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.762834533"
Evaluating: -0.762834533-3.5
 Parameter: YMIN <- "-4.26283453"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.1550851"
Evaluating: -32.1550851-3.5
 Parameter: ZMIN <- "-35.6550851"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.2571004"
 Parameter: XMIN -> "33.2571004"
 Parameter: YMAX -> "2.73716547"
 Parameter: YMIN -> "-4.26283453"
 Parameter: ZMAX -> "-28.6550851"
 Parameter: ZMIN -> "-35.6550851"
 SELRPN>     36 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     24 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64492 POS      SOD      77       SOD     -**** PROA     ILE      1405     O             2.8799
64492 POS      SOD      77       SOD     -**** PROA     TRP      1406     C             3.4318
64492 POS      SOD      77       SOD     -**** PROA     TRP      1406     O             3.1257
64492 POS      SOD      77       SOD     -**** PROA     ALA      1407     N             3.8706
64492 POS      SOD      77       SOD     -**** PROA     ALA      1407     CA            4.0812
64492 POS      SOD      77       SOD     -**** PROA     ALA      1407     C             3.0474
64492 POS      SOD      77       SOD     -**** PROA     ALA      1407     O             3.5210
64492 POS      SOD      77       SOD     -**** PROA     GLU      1408     N             2.2124
64492 POS      SOD      77       SOD     -**** PROA     GLU      1408     CA            1.9447
64492 POS      SOD      77       SOD     -**** PROA     GLU      1408     CB            2.5317
64492 POS      SOD      77       SOD     -**** PROA     GLU      1408     CG            3.8722
64492 POS      SOD      77       SOD     -**** PROA     GLU      1408     C             1.4025
64492 POS      SOD      77       SOD     -**** PROA     GLU      1408     O             2.4833
64492 POS      SOD      77       SOD     -**** PROA     TYR      1409     N             0.9540
64492 POS      SOD      77       SOD     -**** PROA     TYR      1409     CA            2.2611
64492 POS      SOD      77       SOD     -**** PROA     TYR      1409     CB            2.9979
64492 POS      SOD      77       SOD     -**** PROA     TYR      1409     CG            2.8872
64492 POS      SOD      77       SOD     -**** PROA     TYR      1409     CD1           3.4448
64492 POS      SOD      77       SOD     -**** PROA     TYR      1409     CE1           4.1380
64492 POS      SOD      77       SOD     -**** PROA     TYR      1409     CZ            4.3456
64492 POS      SOD      77       SOD     -**** PROA     TYR      1409     CD2           3.1791
64492 POS      SOD      77       SOD     -**** PROA     TYR      1409     CE2           3.9188
64492 POS      SOD      77       SOD     -**** PROA     TYR      1409     C             3.3955
64492 POS      SOD      77       SOD     -**** PROA     TYR      1409     O             4.4698
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        24
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "24"
 Comparing "24" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "77" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.322658223"
Evaluating: 125.050557*(0.322658223-0.5)
 Parameter: XPOS <- "-22.176688"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.860063637"
Evaluating: 125.050557*(0.860063637-0.5)
 Parameter: YPOS <- "45.0261584"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.357077972"
Evaluating: 152.572525*(0.357077972-0.5)+-4.51585405
 Parameter: ZPOS <- "-26.3218287"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.3218287" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.757100 XMAX =   36.757100 XAVE =   36.757100
    YMIN =   -0.762835 YMAX =   -0.762835 YAVE =   -0.762835
    ZMIN =  -32.155085 ZMAX =  -32.155085 ZAVE =  -32.155085
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.176688"
 RDCMND substituted energy or value "?XAVE" to "36.7571004"
Evaluating: -22.176688-36.7571004
 Parameter: XTRAN <- "-58.9337884"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.0261584"
 RDCMND substituted energy or value "?YAVE" to "-0.762834533"
Evaluating: 45.0261584--0.762834533
 Parameter: YTRAN <- "45.7889929"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.3218287"
 RDCMND substituted energy or value "?ZAVE" to "-32.1550851"
Evaluating: -26.3218287--32.1550851
 Parameter: ZTRAN <- "5.8332564"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.9337884"
 Parameter: YTRAN -> "45.7889929"
 Parameter: ZTRAN -> "5.8332564"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -58.933788   45.788993    5.833256
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.844912322"
Evaluating: 0.844912322*360.0
 Parameter: XPHI <- "304.168436"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.142904912"
Evaluating: 0.142904912*360.0
 Parameter: YPHI <- "51.4457683"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.199379066"
Evaluating: 0.199379066*360.0
 Parameter: ZPHI <- "71.7764638"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.176688"
 Parameter: YPOS -> "45.0261584"
 Parameter: ZPOS -> "-26.3218287"
 Parameter: XPHI -> "304.168436"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.561628   -0.827390
    0.000000    0.827390    0.561628

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   55.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.176688"
 Parameter: YPOS -> "45.0261584"
 Parameter: ZPOS -> "-26.3218287"
 Parameter: YPHI -> "51.4457683"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.623255    0.000000   -0.782019
    0.000000    1.000000    0.000000
    0.782019    0.000000    0.623255

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   51.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.176688"
 Parameter: YPOS -> "45.0261584"
 Parameter: ZPOS -> "-26.3218287"
 Parameter: ZPHI -> "71.7764638"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.312725    0.949844    0.000000
   -0.949844    0.312725    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   71.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.176688 XMAX =  -22.176688 XAVE =  -22.176688
    YMIN =   45.026158 YMAX =   45.026158 YAVE =   45.026158
    ZMIN =  -26.321829 ZMAX =  -26.321829 ZAVE =  -26.321829
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.176688"
Evaluating: -22.176688+3.5
 Parameter: XMAX <- "-18.676688"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.0261584"
Evaluating: 45.0261584+3.5
 Parameter: YMAX <- "48.5261584"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.3218287"
Evaluating: -26.3218287+3.5
 Parameter: ZMAX <- "-22.8218287"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.176688"
Evaluating: -22.176688-3.5
 Parameter: XMIN <- "-25.676688"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.0261584"
Evaluating: 45.0261584-3.5
 Parameter: YMIN <- "41.5261584"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.3218287"
Evaluating: -26.3218287-3.5
 Parameter: ZMIN <- "-29.8218287"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.676688"
 Parameter: XMIN -> "-25.676688"
 Parameter: YMAX -> "48.5261584"
 Parameter: YMIN -> "41.5261584"
 Parameter: ZMAX -> "-22.8218287"
 Parameter: ZMIN -> "-29.8218287"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "78"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "78" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "78" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.24247338"
Evaluating: 125.050557*(0.24247338-0.5)
 Parameter: XPOS <- "-32.2038473"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.374613586"
Evaluating: 125.050557*(0.374613586-0.5)
 Parameter: YPOS <- "-15.6796409"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.407476149"
Evaluating: 152.572525*(0.407476149-0.5)+-4.51585405
 Parameter: ZPOS <- "-18.6324516"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.6324516" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.2038473"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.2038473-0
 Parameter: XTRAN <- "-32.2038473"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.6796409"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.6796409-0
 Parameter: YTRAN <- "-15.6796409"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.6324516"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.6324516-0
 Parameter: ZTRAN <- "-18.6324516"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.2038473"
 Parameter: YTRAN -> "-15.6796409"
 Parameter: ZTRAN -> "-18.6324516"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -32.203847  -15.679641  -18.632452
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.814506062"
Evaluating: 0.814506062*360.0
 Parameter: XPHI <- "293.222182"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.319660193"
Evaluating: 0.319660193*360.0
 Parameter: YPHI <- "115.077669"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.805444607"
Evaluating: 0.805444607*360.0
 Parameter: ZPHI <- "289.960059"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.2038473"
 Parameter: YPOS -> "-15.6796409"
 Parameter: ZPOS -> "-18.6324516"
 Parameter: XPHI -> "293.222182"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.394298   -0.918983
    0.000000    0.918983    0.394298

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   66.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.2038473"
 Parameter: YPOS -> "-15.6796409"
 Parameter: ZPOS -> "-18.6324516"
 Parameter: YPHI -> "115.077669"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.423846    0.000000   -0.905734
    0.000000    1.000000    0.000000
    0.905734    0.000000   -0.423846

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  115.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.2038473"
 Parameter: YPOS -> "-15.6796409"
 Parameter: ZPOS -> "-18.6324516"
 Parameter: ZPHI -> "289.960059"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.341365   -0.939931    0.000000
    0.939931    0.341365    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   70.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.203847 XMAX =  -32.203847 XAVE =  -32.203847
    YMIN =  -15.679641 YMAX =  -15.679641 YAVE =  -15.679641
    ZMIN =  -18.632452 ZMAX =  -18.632452 ZAVE =  -18.632452
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.2038473"
Evaluating: -32.2038473+3.5
 Parameter: XMAX <- "-28.7038473"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.6796409"
Evaluating: -15.6796409+3.5
 Parameter: YMAX <- "-12.1796409"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.6324516"
Evaluating: -18.6324516+3.5
 Parameter: ZMAX <- "-15.1324516"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.2038473"
Evaluating: -32.2038473-3.5
 Parameter: XMIN <- "-35.7038473"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.6796409"
Evaluating: -15.6796409-3.5
 Parameter: YMIN <- "-19.1796409"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.6324516"
Evaluating: -18.6324516-3.5
 Parameter: ZMIN <- "-22.1324516"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.7038473"
 Parameter: XMIN -> "-35.7038473"
 Parameter: YMAX -> "-12.1796409"
 Parameter: YMIN -> "-19.1796409"
 Parameter: ZMAX -> "-15.1324516"
 Parameter: ZMIN -> "-22.1324516"
 SELRPN>     29 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     16 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64493 POS      SOD      78       SOD     -**** MEMB     POPC     180      C15           3.0401
64493 POS      SOD      78       SOD     -**** MEMB     POPC     204      C13           2.9890
64493 POS      SOD      78       SOD     -**** MEMB     POPC     204      O14           3.0794
64493 POS      SOD      78       SOD     -**** MEMB     POPC     204      O21           3.8409
64493 POS      SOD      78       SOD     -**** MEMB     POPC     204      C21           3.5464
64493 POS      SOD      78       SOD     -**** MEMB     POPC     204      C22           2.3384
64493 POS      SOD      78       SOD     -**** MEMB     POPC     204      C23           3.2185
64493 POS      SOD      78       SOD     -**** MEMB     POPC     223      P             3.1955
64493 POS      SOD      78       SOD     -**** MEMB     POPC     223      O13           3.0261
64493 POS      SOD      78       SOD     -**** MEMB     POPC     223      O11           2.3241
64493 POS      SOD      78       SOD     -**** MEMB     POPC     223      C1            2.3225
64493 POS      SOD      78       SOD     -**** MEMB     POPC     223      C2            3.1609
64493 POS      SOD      78       SOD     -**** MEMB     POPC     223      O21           3.7597
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        13
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "13"
 Comparing "13" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "78" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.802072241"
Evaluating: 125.050557*(0.802072241-0.5)
 Parameter: XPOS <- "37.774302"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.456757903"
Evaluating: 125.050557*(0.456757903-0.5)
 Parameter: YPOS <- "-5.40744832"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.590376377"
Evaluating: 152.572525*(0.590376377-0.5)+-4.51585405
 Parameter: ZPOS <- "9.27309799"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.27309799" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.27309799" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "78" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.827149092"
Evaluating: 125.050557*(0.827149092-0.5)
 Parameter: XPOS <- "40.9101762"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.264642735"
Evaluating: 125.050557*(0.264642735-0.5)
 Parameter: YPOS <- "-29.4315571"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.397620016"
Evaluating: 152.572525*(0.397620016-0.5)+-4.51585405
 Parameter: ZPOS <- "-20.1362267"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.1362267" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.203847 XMAX =  -32.203847 XAVE =  -32.203847
    YMIN =  -15.679641 YMAX =  -15.679641 YAVE =  -15.679641
    ZMIN =  -18.632452 ZMAX =  -18.632452 ZAVE =  -18.632452
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.9101762"
 RDCMND substituted energy or value "?XAVE" to "-32.2038473"
Evaluating: 40.9101762--32.2038473
 Parameter: XTRAN <- "73.1140235"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.4315571"
 RDCMND substituted energy or value "?YAVE" to "-15.6796409"
Evaluating: -29.4315571--15.6796409
 Parameter: YTRAN <- "-13.7519162"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.1362267"
 RDCMND substituted energy or value "?ZAVE" to "-18.6324516"
Evaluating: -20.1362267--18.6324516
 Parameter: ZTRAN <- "-1.5037751"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "73.1140235"
 Parameter: YTRAN -> "-13.7519162"
 Parameter: ZTRAN -> "-1.5037751"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    73.114024  -13.751916   -1.503775
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.921829031"
Evaluating: 0.921829031*360.0
 Parameter: XPHI <- "331.858451"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.581274453"
Evaluating: 0.581274453*360.0
 Parameter: YPHI <- "209.258803"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.270910203"
Evaluating: 0.270910203*360.0
 Parameter: ZPHI <- "97.5276731"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.9101762"
 Parameter: YPOS -> "-29.4315571"
 Parameter: ZPOS -> "-20.1362267"
 Parameter: XPHI -> "331.858451"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.881785   -0.471651
    0.000000    0.471651    0.881785

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   28.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.9101762"
 Parameter: YPOS -> "-29.4315571"
 Parameter: ZPOS -> "-20.1362267"
 Parameter: YPHI -> "209.258803"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.872421    0.000000    0.488755
    0.000000    1.000000    0.000000
   -0.488755    0.000000   -0.872421

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  150.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.9101762"
 Parameter: YPOS -> "-29.4315571"
 Parameter: ZPOS -> "-20.1362267"
 Parameter: ZPHI -> "97.5276731"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.131005    0.991382    0.000000
   -0.991382   -0.131005    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   97.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.910176 XMAX =   40.910176 XAVE =   40.910176
    YMIN =  -29.431557 YMAX =  -29.431557 YAVE =  -29.431557
    ZMIN =  -20.136227 ZMAX =  -20.136227 ZAVE =  -20.136227
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.9101762"
Evaluating: 40.9101762+3.5
 Parameter: XMAX <- "44.4101762"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.4315571"
Evaluating: -29.4315571+3.5
 Parameter: YMAX <- "-25.9315571"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.1362267"
Evaluating: -20.1362267+3.5
 Parameter: ZMAX <- "-16.6362267"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.9101762"
Evaluating: 40.9101762-3.5
 Parameter: XMIN <- "37.4101762"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.4315571"
Evaluating: -29.4315571-3.5
 Parameter: YMIN <- "-32.9315571"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.1362267"
Evaluating: -20.1362267-3.5
 Parameter: ZMIN <- "-23.6362267"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.4101762"
 Parameter: XMIN -> "37.4101762"
 Parameter: YMAX -> "-25.9315571"
 Parameter: YMIN -> "-32.9315571"
 Parameter: ZMAX -> "-16.6362267"
 Parameter: ZMIN -> "-23.6362267"
 SELRPN>     17 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      6 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64493 POS      SOD      78       SOD     -**** MEMB     POPC     244      C15           3.8160
64493 POS      SOD      78       SOD     -**** MEMB     POPC     244      O22           3.9465
64493 POS      SOD      78       SOD     -**** MEMB     POPC     246      C22           3.9101
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "78" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.402219836"
Evaluating: 125.050557*(0.402219836-0.5)
 Parameter: XPOS <- "-12.227464"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.9014559"
Evaluating: 125.050557*(0.9014559-0.5)
 Parameter: YPOS <- "50.2022839"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.810845629"
Evaluating: 152.572525*(0.810845629-0.5)+-4.51585405
 Parameter: ZPOS <- "42.9106485"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "42.9106485" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "42.9106485" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.910176 XMAX =   40.910176 XAVE =   40.910176
    YMIN =  -29.431557 YMAX =  -29.431557 YAVE =  -29.431557
    ZMIN =  -20.136227 ZMAX =  -20.136227 ZAVE =  -20.136227
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.227464"
 RDCMND substituted energy or value "?XAVE" to "40.9101762"
Evaluating: -12.227464-40.9101762
 Parameter: XTRAN <- "-53.1376402"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "50.2022839"
 RDCMND substituted energy or value "?YAVE" to "-29.4315571"
Evaluating: 50.2022839--29.4315571
 Parameter: YTRAN <- "79.633841"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "42.9106485"
 RDCMND substituted energy or value "?ZAVE" to "-20.1362267"
Evaluating: 42.9106485--20.1362267
 Parameter: ZTRAN <- "63.0468752"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-53.1376402"
 Parameter: YTRAN -> "79.633841"
 Parameter: ZTRAN -> "63.0468752"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -53.137640   79.633841   63.046875
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.985234746E-02"
Evaluating: 1.985234746E-02*360.0
 Parameter: XPHI <- "7.14684509"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.951538746"
Evaluating: 0.951538746*360.0
 Parameter: YPHI <- "342.553949"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.734102823"
Evaluating: 0.734102823*360.0
 Parameter: ZPHI <- "264.277016"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.227464"
 Parameter: YPOS -> "50.2022839"
 Parameter: ZPOS -> "42.9106485"
 Parameter: XPHI -> "7.14684509"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.992231    0.124413
    0.000000   -0.124413    0.992231

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    7.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.227464"
 Parameter: YPOS -> "50.2022839"
 Parameter: ZPOS -> "42.9106485"
 Parameter: YPHI -> "342.553949"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.954000    0.000000    0.299808
    0.000000    1.000000    0.000000
   -0.299808    0.000000    0.954000

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   17.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.227464"
 Parameter: YPOS -> "50.2022839"
 Parameter: ZPOS -> "42.9106485"
 Parameter: ZPHI -> "264.277016"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.099719   -0.995016    0.000000
    0.995016   -0.099719    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   95.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.227464 XMAX =  -12.227464 XAVE =  -12.227464
    YMIN =   50.202284 YMAX =   50.202284 YAVE =   50.202284
    ZMIN =   42.910648 ZMAX =   42.910648 ZAVE =   42.910648
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.227464"
Evaluating: -12.227464+3.5
 Parameter: XMAX <- "-8.727464"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "50.2022839"
Evaluating: 50.2022839+3.5
 Parameter: YMAX <- "53.7022839"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "42.9106485"
Evaluating: 42.9106485+3.5
 Parameter: ZMAX <- "46.4106485"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.227464"
Evaluating: -12.227464-3.5
 Parameter: XMIN <- "-15.727464"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "50.2022839"
Evaluating: 50.2022839-3.5
 Parameter: YMIN <- "46.7022839"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "42.9106485"
Evaluating: 42.9106485-3.5
 Parameter: ZMIN <- "39.4106485"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.727464"
 Parameter: XMIN -> "-15.727464"
 Parameter: YMAX -> "53.7022839"
 Parameter: YMIN -> "46.7022839"
 Parameter: ZMAX -> "46.4106485"
 Parameter: ZMIN -> "39.4106485"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "79"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "79" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "79" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.920068326"
Evaluating: 125.050557*(0.920068326-0.5)
 Parameter: XPOS <- "52.5297781"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.919365432"
Evaluating: 125.050557*(0.919365432-0.5)
 Parameter: YPOS <- "52.4418809"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.162531409"
Evaluating: 152.572525*(0.162531409-0.5)+-4.51585405
 Parameter: ZPOS <- "-56.0042891"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.0042891" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "52.5297781"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 52.5297781-0
 Parameter: XTRAN <- "52.5297781"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "52.4418809"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 52.4418809-0
 Parameter: YTRAN <- "52.4418809"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.0042891"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -56.0042891-0
 Parameter: ZTRAN <- "-56.0042891"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "52.5297781"
 Parameter: YTRAN -> "52.4418809"
 Parameter: ZTRAN -> "-56.0042891"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    52.529778   52.441881  -56.004289
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.450198034"
Evaluating: 0.450198034*360.0
 Parameter: XPHI <- "162.071292"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.620420998"
Evaluating: 0.620420998*360.0
 Parameter: YPHI <- "223.351559"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.3406801"
Evaluating: 0.3406801*360.0
 Parameter: ZPHI <- "122.644836"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "52.5297781"
 Parameter: YPOS -> "52.4418809"
 Parameter: ZPOS -> "-56.0042891"
 Parameter: XPHI -> "162.071292"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.951440    0.307833
    0.000000   -0.307833   -0.951440

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  162.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "52.5297781"
 Parameter: YPOS -> "52.4418809"
 Parameter: ZPOS -> "-56.0042891"
 Parameter: YPHI -> "223.351559"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.727155    0.000000    0.686473
    0.000000    1.000000    0.000000
   -0.686473    0.000000   -0.727155

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  136.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "52.5297781"
 Parameter: YPOS -> "52.4418809"
 Parameter: ZPOS -> "-56.0042891"
 Parameter: ZPHI -> "122.644836"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.539430    0.842031    0.000000
   -0.842031   -0.539430    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  122.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   52.529778 XMAX =   52.529778 XAVE =   52.529778
    YMIN =   52.441881 YMAX =   52.441881 YAVE =   52.441881
    ZMIN =  -56.004289 ZMAX =  -56.004289 ZAVE =  -56.004289
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "52.5297781"
Evaluating: 52.5297781+3.5
 Parameter: XMAX <- "56.0297781"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "52.4418809"
Evaluating: 52.4418809+3.5
 Parameter: YMAX <- "55.9418809"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.0042891"
Evaluating: -56.0042891+3.5
 Parameter: ZMAX <- "-52.5042891"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "52.5297781"
Evaluating: 52.5297781-3.5
 Parameter: XMIN <- "49.0297781"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "52.4418809"
Evaluating: 52.4418809-3.5
 Parameter: YMIN <- "48.9418809"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.0042891"
Evaluating: -56.0042891-3.5
 Parameter: ZMIN <- "-59.5042891"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "56.0297781"
 Parameter: XMIN -> "49.0297781"
 Parameter: YMAX -> "55.9418809"
 Parameter: YMIN -> "48.9418809"
 Parameter: ZMAX -> "-52.5042891"
 Parameter: ZMIN -> "-59.5042891"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "80"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "80" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "80" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.826927366"
Evaluating: 125.050557*(0.826927366-0.5)
 Parameter: XPOS <- "40.8824492"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.77450984E-03"
Evaluating: 125.050557*(1.77450984E-03-0.5)
 Parameter: YPOS <- "-62.3033751"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.326400253"
Evaluating: 152.572525*(0.326400253-0.5)+-4.51585405
 Parameter: ZPOS <- "-31.0024058"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.0024058" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.8824492"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.8824492-0
 Parameter: XTRAN <- "40.8824492"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-62.3033751"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -62.3033751-0
 Parameter: YTRAN <- "-62.3033751"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.0024058"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.0024058-0
 Parameter: ZTRAN <- "-31.0024058"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.8824492"
 Parameter: YTRAN -> "-62.3033751"
 Parameter: ZTRAN -> "-31.0024058"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    40.882449  -62.303375  -31.002406
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.992680212"
Evaluating: 0.992680212*360.0
 Parameter: XPHI <- "357.364876"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.274068774"
Evaluating: 0.274068774*360.0
 Parameter: YPHI <- "98.6647586"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.504939294"
Evaluating: 0.504939294*360.0
 Parameter: ZPHI <- "181.778146"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.8824492"
 Parameter: YPOS -> "-62.3033751"
 Parameter: ZPOS -> "-31.0024058"
 Parameter: XPHI -> "357.364876"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998943   -0.045975
    0.000000    0.045975    0.998943

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    2.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.8824492"
 Parameter: YPOS -> "-62.3033751"
 Parameter: ZPOS -> "-31.0024058"
 Parameter: YPHI -> "98.6647586"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.150653    0.000000   -0.988587
    0.000000    1.000000    0.000000
    0.988587    0.000000   -0.150653

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   98.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.8824492"
 Parameter: YPOS -> "-62.3033751"
 Parameter: ZPOS -> "-31.0024058"
 Parameter: ZPHI -> "181.778146"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.999518   -0.031030    0.000000
    0.031030   -0.999518    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  178.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.882449 XMAX =   40.882449 XAVE =   40.882449
    YMIN =  -62.303375 YMAX =  -62.303375 YAVE =  -62.303375
    ZMIN =  -31.002406 ZMAX =  -31.002406 ZAVE =  -31.002406
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.8824492"
Evaluating: 40.8824492+3.5
 Parameter: XMAX <- "44.3824492"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-62.3033751"
Evaluating: -62.3033751+3.5
 Parameter: YMAX <- "-58.8033751"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.0024058"
Evaluating: -31.0024058+3.5
 Parameter: ZMAX <- "-27.5024058"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.8824492"
Evaluating: 40.8824492-3.5
 Parameter: XMIN <- "37.3824492"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-62.3033751"
Evaluating: -62.3033751-3.5
 Parameter: YMIN <- "-65.8033751"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.0024058"
Evaluating: -31.0024058-3.5
 Parameter: ZMIN <- "-34.5024058"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.3824492"
 Parameter: XMIN -> "37.3824492"
 Parameter: YMAX -> "-58.8033751"
 Parameter: YMIN -> "-65.8033751"
 Parameter: ZMAX -> "-27.5024058"
 Parameter: ZMIN -> "-34.5024058"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "81"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "81" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "81" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.623797665"
Evaluating: 125.050557*(0.623797665-0.5)
 Parameter: XPOS <- "15.480967"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.959124579"
Evaluating: 125.050557*(0.959124579-0.5)
 Parameter: YPOS <- "57.4137843"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.130784258"
Evaluating: 152.572525*(0.130784258-0.5)+-4.51585405
 Parameter: ZPOS <- "-60.8480321"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-60.8480321" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.480967"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.480967-0
 Parameter: XTRAN <- "15.480967"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "57.4137843"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 57.4137843-0
 Parameter: YTRAN <- "57.4137843"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-60.8480321"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -60.8480321-0
 Parameter: ZTRAN <- "-60.8480321"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.480967"
 Parameter: YTRAN -> "57.4137843"
 Parameter: ZTRAN -> "-60.8480321"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    15.480967   57.413784  -60.848032
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.423607615"
Evaluating: 0.423607615*360.0
 Parameter: XPHI <- "152.498741"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.30510124"
Evaluating: 0.30510124*360.0
 Parameter: YPHI <- "109.836446"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.61791498"
Evaluating: 0.61791498*360.0
 Parameter: ZPHI <- "222.449393"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.480967"
 Parameter: YPOS -> "57.4137843"
 Parameter: ZPOS -> "-60.8480321"
 Parameter: XPHI -> "152.498741"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.887001    0.461768
    0.000000   -0.461768   -0.887001

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  152.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.480967"
 Parameter: YPOS -> "57.4137843"
 Parameter: ZPOS -> "-60.8480321"
 Parameter: YPHI -> "109.836446"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.339336    0.000000   -0.940665
    0.000000    1.000000    0.000000
    0.940665    0.000000   -0.339336

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  109.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.480967"
 Parameter: YPOS -> "57.4137843"
 Parameter: ZPOS -> "-60.8480321"
 Parameter: ZPHI -> "222.449393"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.737874   -0.674939    0.000000
    0.674939   -0.737874    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  137.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.480967 XMAX =   15.480967 XAVE =   15.480967
    YMIN =   57.413784 YMAX =   57.413784 YAVE =   57.413784
    ZMIN =  -60.848032 ZMAX =  -60.848032 ZAVE =  -60.848032
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.480967"
Evaluating: 15.480967+3.5
 Parameter: XMAX <- "18.980967"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "57.4137843"
Evaluating: 57.4137843+3.5
 Parameter: YMAX <- "60.9137843"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-60.8480321"
Evaluating: -60.8480321+3.5
 Parameter: ZMAX <- "-57.3480321"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.480967"
Evaluating: 15.480967-3.5
 Parameter: XMIN <- "11.980967"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "57.4137843"
Evaluating: 57.4137843-3.5
 Parameter: YMIN <- "53.9137843"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-60.8480321"
Evaluating: -60.8480321-3.5
 Parameter: ZMIN <- "-64.3480321"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.980967"
 Parameter: XMIN -> "11.980967"
 Parameter: YMAX -> "60.9137843"
 Parameter: YMIN -> "53.9137843"
 Parameter: ZMAX -> "-57.3480321"
 Parameter: ZMIN -> "-64.3480321"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "82"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "82" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "82" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.646621037"
Evaluating: 125.050557*(0.646621037-0.5)
 Parameter: XPOS <- "18.3350423"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.5683379"
Evaluating: 125.050557*(0.5683379-0.5)
 Parameter: YPOS <- "8.54569246"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.799279103"
Evaluating: 152.572525*(0.799279103-0.5)+-4.51585405
 Parameter: ZPOS <- "41.1459144"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.1459144" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.1459144" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.3350423"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.3350423-0
 Parameter: XTRAN <- "18.3350423"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.54569246"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.54569246-0
 Parameter: YTRAN <- "8.54569246"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.1459144"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.1459144-0
 Parameter: ZTRAN <- "41.1459144"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.3350423"
 Parameter: YTRAN -> "8.54569246"
 Parameter: ZTRAN -> "41.1459144"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    18.335042    8.545692   41.145914
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.472293926"
Evaluating: 0.472293926*360.0
 Parameter: XPHI <- "170.025813"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877074931"
Evaluating: 0.877074931*360.0
 Parameter: YPHI <- "315.746975"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.321259431"
Evaluating: 0.321259431*360.0
 Parameter: ZPHI <- "115.653395"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.3350423"
 Parameter: YPOS -> "8.54569246"
 Parameter: ZPOS -> "41.1459144"
 Parameter: XPHI -> "170.025813"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.984886    0.173204
    0.000000   -0.173204   -0.984886

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  170.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.3350423"
 Parameter: YPOS -> "8.54569246"
 Parameter: ZPOS -> "41.1459144"
 Parameter: YPHI -> "315.746975"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.716265    0.000000    0.697828
    0.000000    1.000000    0.000000
   -0.697828    0.000000    0.716265

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   44.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.3350423"
 Parameter: YPOS -> "8.54569246"
 Parameter: ZPOS -> "41.1459144"
 Parameter: ZPHI -> "115.653395"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.432926    0.901429    0.000000
   -0.901429   -0.432926    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  115.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.335042 XMAX =   18.335042 XAVE =   18.335042
    YMIN =    8.545692 YMAX =    8.545692 YAVE =    8.545692
    ZMIN =   41.145914 ZMAX =   41.145914 ZAVE =   41.145914
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.3350423"
Evaluating: 18.3350423+3.5
 Parameter: XMAX <- "21.8350423"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.54569246"
Evaluating: 8.54569246+3.5
 Parameter: YMAX <- "12.0456925"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.1459144"
Evaluating: 41.1459144+3.5
 Parameter: ZMAX <- "44.6459144"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.3350423"
Evaluating: 18.3350423-3.5
 Parameter: XMIN <- "14.8350423"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.54569246"
Evaluating: 8.54569246-3.5
 Parameter: YMIN <- "5.04569246"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.1459144"
Evaluating: 41.1459144-3.5
 Parameter: ZMIN <- "37.6459144"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.8350423"
 Parameter: XMIN -> "14.8350423"
 Parameter: YMAX -> "12.0456925"
 Parameter: YMIN -> "5.04569246"
 Parameter: ZMAX -> "44.6459144"
 Parameter: ZMIN -> "37.6459144"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "83"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "83" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "83" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.805220556"
Evaluating: 125.050557*(0.805220556-0.5)
 Parameter: XPOS <- "38.1680005"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.179304674"
Evaluating: 125.050557*(0.179304674-0.5)
 Parameter: YPOS <- "-40.1031291"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.568005514"
Evaluating: 152.572525*(0.568005514-0.5)+-4.51585405
 Parameter: ZPOS <- "5.85991893"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.85991893" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.85991893" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "83" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.25550809"
Evaluating: 125.050557*(0.25550809-0.5)
 Parameter: XPOS <- "-30.5738495"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.591123324"
Evaluating: 125.050557*(0.591123324-0.5)
 Parameter: YPOS <- "11.3950224"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.931129914"
Evaluating: 152.572525*(0.931129914-0.5)+-4.51585405
 Parameter: ZPOS <- "61.2627255"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "61.2627255" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "61.2627255" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.5738495"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.5738495-0
 Parameter: XTRAN <- "-30.5738495"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.3950224"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 11.3950224-0
 Parameter: YTRAN <- "11.3950224"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.2627255"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 61.2627255-0
 Parameter: ZTRAN <- "61.2627255"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.5738495"
 Parameter: YTRAN -> "11.3950224"
 Parameter: ZTRAN -> "61.2627255"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -30.573850   11.395022   61.262726
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.735667901"
Evaluating: 0.735667901*360.0
 Parameter: XPHI <- "264.840444"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.546360693"
Evaluating: 0.546360693*360.0
 Parameter: YPHI <- "196.689849"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.698409524"
Evaluating: 0.698409524*360.0
 Parameter: ZPHI <- "251.427429"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.5738495"
 Parameter: YPOS -> "11.3950224"
 Parameter: ZPOS -> "61.2627255"
 Parameter: XPHI -> "264.840444"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.089930   -0.995948
    0.000000    0.995948   -0.089930

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   95.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.5738495"
 Parameter: YPOS -> "11.3950224"
 Parameter: ZPOS -> "61.2627255"
 Parameter: YPHI -> "196.689849"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.957873    0.000000    0.287191
    0.000000    1.000000    0.000000
   -0.287191    0.000000   -0.957873

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  163.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.5738495"
 Parameter: YPOS -> "11.3950224"
 Parameter: ZPOS -> "61.2627255"
 Parameter: ZPHI -> "251.427429"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.318506   -0.947921    0.000000
    0.947921   -0.318506    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  108.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.573850 XMAX =  -30.573850 XAVE =  -30.573850
    YMIN =   11.395022 YMAX =   11.395022 YAVE =   11.395022
    ZMIN =   61.262726 ZMAX =   61.262726 ZAVE =   61.262726
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.5738495"
Evaluating: -30.5738495+3.5
 Parameter: XMAX <- "-27.0738495"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.3950224"
Evaluating: 11.3950224+3.5
 Parameter: YMAX <- "14.8950224"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.2627255"
Evaluating: 61.2627255+3.5
 Parameter: ZMAX <- "64.7627255"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.5738495"
Evaluating: -30.5738495-3.5
 Parameter: XMIN <- "-34.0738495"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.3950224"
Evaluating: 11.3950224-3.5
 Parameter: YMIN <- "7.8950224"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.2627255"
Evaluating: 61.2627255-3.5
 Parameter: ZMIN <- "57.7627255"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.0738495"
 Parameter: XMIN -> "-34.0738495"
 Parameter: YMAX -> "14.8950224"
 Parameter: YMIN -> "7.8950224"
 Parameter: ZMAX -> "64.7627255"
 Parameter: ZMIN -> "57.7627255"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "84"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "84" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "84" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.543492915"
Evaluating: 125.050557*(0.543492915-0.5)
 Parameter: XPOS <- "5.43881325"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.689970218"
Evaluating: 125.050557*(0.689970218-0.5)
 Parameter: YPOS <- "23.7558816"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.933588713"
Evaluating: 152.572525*(0.933588713-0.5)+-4.51585405
 Parameter: ZPOS <- "61.6378707"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "61.6378707" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "61.6378707" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.43881325"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.43881325-0
 Parameter: XTRAN <- "5.43881325"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.7558816"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.7558816-0
 Parameter: YTRAN <- "23.7558816"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.6378707"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 61.6378707-0
 Parameter: ZTRAN <- "61.6378707"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.43881325"
 Parameter: YTRAN -> "23.7558816"
 Parameter: ZTRAN -> "61.6378707"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     5.438813   23.755882   61.637871
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.221307505"
Evaluating: 0.221307505*360.0
 Parameter: XPHI <- "79.6707018"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.235190372"
Evaluating: 0.235190372*360.0
 Parameter: YPHI <- "84.6685339"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.429186735E-02"
Evaluating: 5.429186735E-02*360.0
 Parameter: ZPHI <- "19.5450722"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.43881325"
 Parameter: YPOS -> "23.7558816"
 Parameter: ZPOS -> "61.6378707"
 Parameter: XPHI -> "79.6707018"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.179305    0.983793
    0.000000   -0.983793    0.179305

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   79.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.43881325"
 Parameter: YPOS -> "23.7558816"
 Parameter: ZPOS -> "61.6378707"
 Parameter: YPHI -> "84.6685339"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.092917    0.000000   -0.995674
    0.000000    1.000000    0.000000
    0.995674    0.000000    0.092917

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   84.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.43881325"
 Parameter: YPOS -> "23.7558816"
 Parameter: ZPOS -> "61.6378707"
 Parameter: ZPHI -> "19.5450722"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.942379    0.334548    0.000000
   -0.334548    0.942379    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   19.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.438813 XMAX =    5.438813 XAVE =    5.438813
    YMIN =   23.755882 YMAX =   23.755882 YAVE =   23.755882
    ZMIN =   61.637871 ZMAX =   61.637871 ZAVE =   61.637871
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.43881325"
Evaluating: 5.43881325+3.5
 Parameter: XMAX <- "8.93881325"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.7558816"
Evaluating: 23.7558816+3.5
 Parameter: YMAX <- "27.2558816"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.6378707"
Evaluating: 61.6378707+3.5
 Parameter: ZMAX <- "65.1378707"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.43881325"
Evaluating: 5.43881325-3.5
 Parameter: XMIN <- "1.93881325"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.7558816"
Evaluating: 23.7558816-3.5
 Parameter: YMIN <- "20.2558816"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.6378707"
Evaluating: 61.6378707-3.5
 Parameter: ZMIN <- "58.1378707"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.93881325"
 Parameter: XMIN -> "1.93881325"
 Parameter: YMAX -> "27.2558816"
 Parameter: YMIN -> "20.2558816"
 Parameter: ZMAX -> "65.1378707"
 Parameter: ZMIN -> "58.1378707"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "85"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "85" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "85" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "85"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.684627329"
Evaluating: 125.050557*(0.684627329-0.5)
 Parameter: XPOS <- "23.0877503"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.740965837"
Evaluating: 125.050557*(0.740965837-0.5)
 Parameter: YPOS <- "30.1329121"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.813182121"
Evaluating: 152.572525*(0.813182121-0.5)+-4.51585405
 Parameter: ZPOS <- "43.2671329"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.2671329" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.2671329" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.0877503"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 23.0877503-0
 Parameter: XTRAN <- "23.0877503"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.1329121"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.1329121-0
 Parameter: YTRAN <- "30.1329121"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.2671329"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 43.2671329-0
 Parameter: ZTRAN <- "43.2671329"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.0877503"
 Parameter: YTRAN -> "30.1329121"
 Parameter: ZTRAN -> "43.2671329"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    23.087750   30.132912   43.267133
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.723398447"
Evaluating: 0.723398447*360.0
 Parameter: XPHI <- "260.423441"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.221403738"
Evaluating: 0.221403738*360.0
 Parameter: YPHI <- "79.7053457"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.21660227"
Evaluating: 0.21660227*360.0
 Parameter: ZPHI <- "77.9768172"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.0877503"
 Parameter: YPOS -> "30.1329121"
 Parameter: ZPOS -> "43.2671329"
 Parameter: XPHI -> "260.423441"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.166365   -0.986064
    0.000000    0.986064   -0.166365

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   99.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.0877503"
 Parameter: YPOS -> "30.1329121"
 Parameter: ZPOS -> "43.2671329"
 Parameter: YPHI -> "79.7053457"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.178710    0.000000   -0.983902
    0.000000    1.000000    0.000000
    0.983902    0.000000    0.178710

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   79.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.0877503"
 Parameter: YPOS -> "30.1329121"
 Parameter: ZPOS -> "43.2671329"
 Parameter: ZPHI -> "77.9768172"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.208307    0.978063    0.000000
   -0.978063    0.208307    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   77.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.087750 XMAX =   23.087750 XAVE =   23.087750
    YMIN =   30.132912 YMAX =   30.132912 YAVE =   30.132912
    ZMIN =   43.267133 ZMAX =   43.267133 ZAVE =   43.267133
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.0877503"
Evaluating: 23.0877503+3.5
 Parameter: XMAX <- "26.5877503"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.1329121"
Evaluating: 30.1329121+3.5
 Parameter: YMAX <- "33.6329121"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.2671329"
Evaluating: 43.2671329+3.5
 Parameter: ZMAX <- "46.7671329"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.0877503"
Evaluating: 23.0877503-3.5
 Parameter: XMIN <- "19.5877503"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.1329121"
Evaluating: 30.1329121-3.5
 Parameter: YMIN <- "26.6329121"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.2671329"
Evaluating: 43.2671329-3.5
 Parameter: ZMIN <- "39.7671329"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.5877503"
 Parameter: XMIN -> "19.5877503"
 Parameter: YMAX -> "33.6329121"
 Parameter: YMIN -> "26.6329121"
 Parameter: ZMAX -> "46.7671329"
 Parameter: ZMIN -> "39.7671329"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "86"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "86" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "86"
Evaluating: 86
 Parameter: J <- "86"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "86" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "86"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.311199425"
Evaluating: 125.050557*(0.311199425-0.5)
 Parameter: XPOS <- "-23.6096171"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.436943102"
Evaluating: 125.050557*(0.436943102-0.5)
 Parameter: YPOS <- "-7.88530022"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.939457537"
Evaluating: 152.572525*(0.939457537-0.5)+-4.51585405
 Parameter: ZPOS <- "62.533292"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "62.533292" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "62.533292" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.6096171"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.6096171-0
 Parameter: XTRAN <- "-23.6096171"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.88530022"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.88530022-0
 Parameter: YTRAN <- "-7.88530022"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "62.533292"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 62.533292-0
 Parameter: ZTRAN <- "62.533292"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.6096171"
 Parameter: YTRAN -> "-7.88530022"
 Parameter: ZTRAN -> "62.533292"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -23.609617   -7.885300   62.533292
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.71782495"
Evaluating: 0.71782495*360.0
 Parameter: XPHI <- "258.416982"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.626169221"
Evaluating: 0.626169221*360.0
 Parameter: YPHI <- "225.42092"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.661254015"
Evaluating: 0.661254015*360.0
 Parameter: ZPHI <- "238.051445"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.6096171"
 Parameter: YPOS -> "-7.88530022"
 Parameter: ZPOS -> "62.533292"
 Parameter: XPHI -> "258.416982"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.200788   -0.979635
    0.000000    0.979635   -0.200788

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  101.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.6096171"
 Parameter: YPOS -> "-7.88530022"
 Parameter: ZPOS -> "62.533292"
 Parameter: YPHI -> "225.42092"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.701893    0.000000    0.712282
    0.000000    1.000000    0.000000
   -0.712282    0.000000   -0.701893

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  134.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.6096171"
 Parameter: YPOS -> "-7.88530022"
 Parameter: ZPOS -> "62.533292"
 Parameter: ZPHI -> "238.051445"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.529158   -0.848524    0.000000
    0.848524   -0.529158    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  121.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.609617 XMAX =  -23.609617 XAVE =  -23.609617
    YMIN =   -7.885300 YMAX =   -7.885300 YAVE =   -7.885300
    ZMIN =   62.533292 ZMAX =   62.533292 ZAVE =   62.533292
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.6096171"
Evaluating: -23.6096171+3.5
 Parameter: XMAX <- "-20.1096171"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.88530022"
Evaluating: -7.88530022+3.5
 Parameter: YMAX <- "-4.38530022"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "62.533292"
Evaluating: 62.533292+3.5
 Parameter: ZMAX <- "66.033292"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.6096171"
Evaluating: -23.6096171-3.5
 Parameter: XMIN <- "-27.1096171"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.88530022"
Evaluating: -7.88530022-3.5
 Parameter: YMIN <- "-11.3853002"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "62.533292"
Evaluating: 62.533292-3.5
 Parameter: ZMIN <- "59.033292"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.1096171"
 Parameter: XMIN -> "-27.1096171"
 Parameter: YMAX -> "-4.38530022"
 Parameter: YMIN -> "-11.3853002"
 Parameter: ZMAX -> "66.033292"
 Parameter: ZMIN -> "59.033292"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "87"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "87" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "87" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.984970735"
Evaluating: 125.050557*(0.984970735-0.5)
 Parameter: XPOS <- "60.6458605"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.604088056"
Evaluating: 125.050557*(0.604088056-0.5)
 Parameter: YPOS <- "13.0162694"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "3.429109867E-02"
Evaluating: 152.572525*(3.429109867E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-75.570237"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-75.570237" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "60.6458605"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 60.6458605-0
 Parameter: XTRAN <- "60.6458605"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.0162694"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.0162694-0
 Parameter: YTRAN <- "13.0162694"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-75.570237"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -75.570237-0
 Parameter: ZTRAN <- "-75.570237"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "60.6458605"
 Parameter: YTRAN -> "13.0162694"
 Parameter: ZTRAN -> "-75.570237"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    60.645860   13.016269  -75.570237
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.516404118"
Evaluating: 0.516404118*360.0
 Parameter: XPHI <- "185.905482"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.348357943"
Evaluating: 0.348357943*360.0
 Parameter: YPHI <- "125.408859"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.221909195"
Evaluating: 0.221909195*360.0
 Parameter: ZPHI <- "79.8873102"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "60.6458605"
 Parameter: YPOS -> "13.0162694"
 Parameter: ZPOS -> "-75.570237"
 Parameter: XPHI -> "185.905482"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.994693   -0.102888
    0.000000    0.102888   -0.994693

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  174.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "60.6458605"
 Parameter: YPOS -> "13.0162694"
 Parameter: ZPOS -> "-75.570237"
 Parameter: YPHI -> "125.408859"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.579407    0.000000   -0.815038
    0.000000    1.000000    0.000000
    0.815038    0.000000   -0.579407

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  125.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "60.6458605"
 Parameter: YPOS -> "13.0162694"
 Parameter: ZPOS -> "-75.570237"
 Parameter: ZPHI -> "79.8873102"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.175585    0.984464    0.000000
   -0.984464    0.175585    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   79.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   60.645860 XMAX =   60.645860 XAVE =   60.645860
    YMIN =   13.016269 YMAX =   13.016269 YAVE =   13.016269
    ZMIN =  -75.570237 ZMAX =  -75.570237 ZAVE =  -75.570237
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "60.6458605"
Evaluating: 60.6458605+3.5
 Parameter: XMAX <- "64.1458605"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.0162694"
Evaluating: 13.0162694+3.5
 Parameter: YMAX <- "16.5162694"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-75.570237"
Evaluating: -75.570237+3.5
 Parameter: ZMAX <- "-72.070237"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "60.6458605"
Evaluating: 60.6458605-3.5
 Parameter: XMIN <- "57.1458605"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.0162694"
Evaluating: 13.0162694-3.5
 Parameter: YMIN <- "9.5162694"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-75.570237"
Evaluating: -75.570237-3.5
 Parameter: ZMIN <- "-79.070237"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "64.1458605"
 Parameter: XMIN -> "57.1458605"
 Parameter: YMAX -> "16.5162694"
 Parameter: YMIN -> "9.5162694"
 Parameter: ZMAX -> "-72.070237"
 Parameter: ZMIN -> "-79.070237"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "88"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "88" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "88"
Evaluating: 88
 Parameter: J <- "88"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "88" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "88"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.36019139"
Evaluating: 125.050557*(0.36019139-0.5)
 Parameter: XPOS <- "-17.4831446"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.465242777"
Evaluating: 125.050557*(0.465242777-0.5)
 Parameter: YPOS <- "-4.3464101"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.835772393"
Evaluating: 152.572525*(0.835772393-0.5)+-4.51585405
 Parameter: ZPOS <- "46.7137878"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.7137878" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.7137878" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.4831446"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.4831446-0
 Parameter: XTRAN <- "-17.4831446"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.3464101"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.3464101-0
 Parameter: YTRAN <- "-4.3464101"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.7137878"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.7137878-0
 Parameter: ZTRAN <- "46.7137878"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.4831446"
 Parameter: YTRAN -> "-4.3464101"
 Parameter: ZTRAN -> "46.7137878"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -17.483145   -4.346410   46.713788
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.633575455E-02"
Evaluating: 2.633575455E-02*360.0
 Parameter: XPHI <- "9.48087164"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.886830172"
Evaluating: 0.886830172*360.0
 Parameter: YPHI <- "319.258862"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336891633"
Evaluating: 0.336891633*360.0
 Parameter: ZPHI <- "121.280988"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.4831446"
 Parameter: YPOS -> "-4.3464101"
 Parameter: ZPOS -> "46.7137878"
 Parameter: XPHI -> "9.48087164"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.986341    0.164718
    0.000000   -0.164718    0.986341

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    9.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.4831446"
 Parameter: YPOS -> "-4.3464101"
 Parameter: ZPOS -> "46.7137878"
 Parameter: YPHI -> "319.258862"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.757666    0.000000    0.652643
    0.000000    1.000000    0.000000
   -0.652643    0.000000    0.757666

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   40.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.4831446"
 Parameter: YPOS -> "-4.3464101"
 Parameter: ZPOS -> "46.7137878"
 Parameter: ZPHI -> "121.280988"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.519236    0.854631    0.000000
   -0.854631   -0.519236    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  121.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.483145 XMAX =  -17.483145 XAVE =  -17.483145
    YMIN =   -4.346410 YMAX =   -4.346410 YAVE =   -4.346410
    ZMIN =   46.713788 ZMAX =   46.713788 ZAVE =   46.713788
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.4831446"
Evaluating: -17.4831446+3.5
 Parameter: XMAX <- "-13.9831446"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.3464101"
Evaluating: -4.3464101+3.5
 Parameter: YMAX <- "-0.8464101"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.7137878"
Evaluating: 46.7137878+3.5
 Parameter: ZMAX <- "50.2137878"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.4831446"
Evaluating: -17.4831446-3.5
 Parameter: XMIN <- "-20.9831446"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.3464101"
Evaluating: -4.3464101-3.5
 Parameter: YMIN <- "-7.8464101"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.7137878"
Evaluating: 46.7137878-3.5
 Parameter: ZMIN <- "43.2137878"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.9831446"
 Parameter: XMIN -> "-20.9831446"
 Parameter: YMAX -> "-0.8464101"
 Parameter: YMIN -> "-7.8464101"
 Parameter: ZMAX -> "50.2137878"
 Parameter: ZMIN -> "43.2137878"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "89"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "89" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "89" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "89"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "2.002007956E-02"
Evaluating: 125.050557*(2.002007956E-02-0.5)
 Parameter: XPOS <- "-60.0217564"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.709564622"
Evaluating: 125.050557*(0.709564622-0.5)
 Parameter: YPOS <- "26.2061727"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.914633507"
Evaluating: 152.572525*(0.914633507-0.5)+-4.51585405
 Parameter: ZPOS <- "58.7458271"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "58.7458271" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "58.7458271" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-60.0217564"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -60.0217564-0
 Parameter: XTRAN <- "-60.0217564"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.2061727"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 26.2061727-0
 Parameter: YTRAN <- "26.2061727"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "58.7458271"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 58.7458271-0
 Parameter: ZTRAN <- "58.7458271"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-60.0217564"
 Parameter: YTRAN -> "26.2061727"
 Parameter: ZTRAN -> "58.7458271"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -60.021756   26.206173   58.745827
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.64369268"
Evaluating: 0.64369268*360.0
 Parameter: XPHI <- "231.729365"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225657028"
Evaluating: 0.225657028*360.0
 Parameter: YPHI <- "81.2365301"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.535969022"
Evaluating: 0.535969022*360.0
 Parameter: ZPHI <- "192.948848"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-60.0217564"
 Parameter: YPOS -> "26.2061727"
 Parameter: ZPOS -> "58.7458271"
 Parameter: XPHI -> "231.729365"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.619377   -0.785094
    0.000000    0.785094   -0.619377

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-60.0217564"
 Parameter: YPOS -> "26.2061727"
 Parameter: ZPOS -> "58.7458271"
 Parameter: YPHI -> "81.2365301"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.152356    0.000000   -0.988326
    0.000000    1.000000    0.000000
    0.988326    0.000000    0.152356

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-60.0217564"
 Parameter: YPOS -> "26.2061727"
 Parameter: ZPOS -> "58.7458271"
 Parameter: ZPHI -> "192.948848"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.974571   -0.224081    0.000000
    0.224081   -0.974571    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  167.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -60.021756 XMAX =  -60.021756 XAVE =  -60.021756
    YMIN =   26.206173 YMAX =   26.206173 YAVE =   26.206173
    ZMIN =   58.745827 ZMAX =   58.745827 ZAVE =   58.745827
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-60.0217564"
Evaluating: -60.0217564+3.5
 Parameter: XMAX <- "-56.5217564"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.2061727"
Evaluating: 26.2061727+3.5
 Parameter: YMAX <- "29.7061727"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "58.7458271"
Evaluating: 58.7458271+3.5
 Parameter: ZMAX <- "62.2458271"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-60.0217564"
Evaluating: -60.0217564-3.5
 Parameter: XMIN <- "-63.5217564"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.2061727"
Evaluating: 26.2061727-3.5
 Parameter: YMIN <- "22.7061727"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "58.7458271"
Evaluating: 58.7458271-3.5
 Parameter: ZMIN <- "55.2458271"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-56.5217564"
 Parameter: XMIN -> "-63.5217564"
 Parameter: YMAX -> "29.7061727"
 Parameter: YMIN -> "22.7061727"
 Parameter: ZMAX -> "62.2458271"
 Parameter: ZMIN -> "55.2458271"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "90"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "90" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "90" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "90"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.813511218"
Evaluating: 125.050557*(0.813511218-0.5)
 Parameter: XPOS <- "39.2047524"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.706203047"
Evaluating: 125.050557*(0.706203047-0.5)
 Parameter: YPOS <- "25.7858059"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.970692613"
Evaluating: 152.572525*(0.970692613-0.5)+-4.51585405
 Parameter: ZPOS <- "67.2989064"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "67.2989064" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "67.2989064" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.2047524"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.2047524-0
 Parameter: XTRAN <- "39.2047524"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.7858059"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.7858059-0
 Parameter: YTRAN <- "25.7858059"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "67.2989064"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 67.2989064-0
 Parameter: ZTRAN <- "67.2989064"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.2047524"
 Parameter: YTRAN -> "25.7858059"
 Parameter: ZTRAN -> "67.2989064"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    39.204752   25.785806   67.298906
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.574536163"
Evaluating: 0.574536163*360.0
 Parameter: XPHI <- "206.833019"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.995306295"
Evaluating: 0.995306295*360.0
 Parameter: YPHI <- "358.310266"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.704955033"
Evaluating: 0.704955033*360.0
 Parameter: ZPHI <- "253.783812"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.2047524"
 Parameter: YPOS -> "25.7858059"
 Parameter: ZPOS -> "67.2989064"
 Parameter: XPHI -> "206.833019"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.892326   -0.451392
    0.000000    0.451392   -0.892326

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  153.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.2047524"
 Parameter: YPOS -> "25.7858059"
 Parameter: ZPOS -> "67.2989064"
 Parameter: YPHI -> "358.310266"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999565    0.000000    0.029487
    0.000000    1.000000    0.000000
   -0.029487    0.000000    0.999565

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    1.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.2047524"
 Parameter: YPOS -> "25.7858059"
 Parameter: ZPOS -> "67.2989064"
 Parameter: ZPHI -> "253.783812"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.279262   -0.960215    0.000000
    0.960215   -0.279262    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  106.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.204752 XMAX =   39.204752 XAVE =   39.204752
    YMIN =   25.785806 YMAX =   25.785806 YAVE =   25.785806
    ZMIN =   67.298906 ZMAX =   67.298906 ZAVE =   67.298906
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.2047524"
Evaluating: 39.2047524+3.5
 Parameter: XMAX <- "42.7047524"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.7858059"
Evaluating: 25.7858059+3.5
 Parameter: YMAX <- "29.2858059"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "67.2989064"
Evaluating: 67.2989064+3.5
 Parameter: ZMAX <- "70.7989064"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.2047524"
Evaluating: 39.2047524-3.5
 Parameter: XMIN <- "35.7047524"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.7858059"
Evaluating: 25.7858059-3.5
 Parameter: YMIN <- "22.2858059"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "67.2989064"
Evaluating: 67.2989064-3.5
 Parameter: ZMIN <- "63.7989064"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.7047524"
 Parameter: XMIN -> "35.7047524"
 Parameter: YMAX -> "29.2858059"
 Parameter: YMIN -> "22.2858059"
 Parameter: ZMAX -> "70.7989064"
 Parameter: ZMIN -> "63.7989064"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "91"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "91" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "91"
Evaluating: 91
 Parameter: J <- "91"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "91" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "91"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.867276531"
Evaluating: 125.050557*(0.867276531-0.5)
 Parameter: XPOS <- "45.9281348"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.231813732"
Evaluating: 125.050557*(0.231813732-0.5)
 Parameter: YPOS <- "-33.5368422"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.985692506"
Evaluating: 152.572525*(0.985692506-0.5)+-4.51585405
 Parameter: ZPOS <- "69.587478"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.587478" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.587478" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.9281348"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.9281348-0
 Parameter: XTRAN <- "45.9281348"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.5368422"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.5368422-0
 Parameter: YTRAN <- "-33.5368422"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.587478"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 69.587478-0
 Parameter: ZTRAN <- "69.587478"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.9281348"
 Parameter: YTRAN -> "-33.5368422"
 Parameter: ZTRAN -> "69.587478"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    45.928135  -33.536842   69.587478
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.685881542"
Evaluating: 0.685881542*360.0
 Parameter: XPHI <- "246.917355"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.221895099"
Evaluating: 0.221895099*360.0
 Parameter: YPHI <- "79.8822356"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.6414606"
Evaluating: 0.6414606*360.0
 Parameter: ZPHI <- "230.925816"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.9281348"
 Parameter: YPOS -> "-33.5368422"
 Parameter: ZPOS -> "69.587478"
 Parameter: XPHI -> "246.917355"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.392058   -0.919940
    0.000000    0.919940   -0.392058

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  113.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.9281348"
 Parameter: YPOS -> "-33.5368422"
 Parameter: ZPOS -> "69.587478"
 Parameter: YPHI -> "79.8822356"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.175672    0.000000   -0.984449
    0.000000    1.000000    0.000000
    0.984449    0.000000    0.175672

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   79.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.9281348"
 Parameter: YPOS -> "-33.5368422"
 Parameter: ZPOS -> "69.587478"
 Parameter: ZPHI -> "230.925816"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.630326   -0.776330    0.000000
    0.776330   -0.630326    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  129.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.928135 XMAX =   45.928135 XAVE =   45.928135
    YMIN =  -33.536842 YMAX =  -33.536842 YAVE =  -33.536842
    ZMIN =   69.587478 ZMAX =   69.587478 ZAVE =   69.587478
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.9281348"
Evaluating: 45.9281348+3.5
 Parameter: XMAX <- "49.4281348"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.5368422"
Evaluating: -33.5368422+3.5
 Parameter: YMAX <- "-30.0368422"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.587478"
Evaluating: 69.587478+3.5
 Parameter: ZMAX <- "73.087478"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.9281348"
Evaluating: 45.9281348-3.5
 Parameter: XMIN <- "42.4281348"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.5368422"
Evaluating: -33.5368422-3.5
 Parameter: YMIN <- "-37.0368422"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.587478"
Evaluating: 69.587478-3.5
 Parameter: ZMIN <- "66.087478"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.4281348"
 Parameter: XMIN -> "42.4281348"
 Parameter: YMAX -> "-30.0368422"
 Parameter: YMIN -> "-37.0368422"
 Parameter: ZMAX -> "73.087478"
 Parameter: ZMIN -> "66.087478"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "92"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "92" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "92" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "92"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.283175107"
Evaluating: 125.050557*(0.283175107-0.5)
 Parameter: XPOS <- "-27.1140736"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.134678895"
Evaluating: 125.050557*(0.134678895-0.5)
 Parameter: YPOS <- "-45.6836077"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "6.385145346E-02"
Evaluating: 152.572525*(6.385145346E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-71.0601391"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-71.0601391" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.1140736"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.1140736-0
 Parameter: XTRAN <- "-27.1140736"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-45.6836077"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -45.6836077-0
 Parameter: YTRAN <- "-45.6836077"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-71.0601391"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -71.0601391-0
 Parameter: ZTRAN <- "-71.0601391"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.1140736"
 Parameter: YTRAN -> "-45.6836077"
 Parameter: ZTRAN -> "-71.0601391"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -27.114074  -45.683608  -71.060139
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.443553389"
Evaluating: 0.443553389*360.0
 Parameter: XPHI <- "159.67922"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.525623202"
Evaluating: 0.525623202*360.0
 Parameter: YPHI <- "189.224353"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.252819839"
Evaluating: 0.252819839*360.0
 Parameter: ZPHI <- "91.015142"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.1140736"
 Parameter: YPOS -> "-45.6836077"
 Parameter: ZPOS -> "-71.0601391"
 Parameter: XPHI -> "159.67922"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.937763    0.347276
    0.000000   -0.347276   -0.937763

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  159.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.1140736"
 Parameter: YPOS -> "-45.6836077"
 Parameter: ZPOS -> "-71.0601391"
 Parameter: YPHI -> "189.224353"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.987068    0.000000    0.160301
    0.000000    1.000000    0.000000
   -0.160301    0.000000   -0.987068

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  170.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.1140736"
 Parameter: YPOS -> "-45.6836077"
 Parameter: ZPOS -> "-71.0601391"
 Parameter: ZPHI -> "91.015142"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.017717    0.999843    0.000000
   -0.999843   -0.017717    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   91.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.114074 XMAX =  -27.114074 XAVE =  -27.114074
    YMIN =  -45.683608 YMAX =  -45.683608 YAVE =  -45.683608
    ZMIN =  -71.060139 ZMAX =  -71.060139 ZAVE =  -71.060139
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.1140736"
Evaluating: -27.1140736+3.5
 Parameter: XMAX <- "-23.6140736"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-45.6836077"
Evaluating: -45.6836077+3.5
 Parameter: YMAX <- "-42.1836077"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-71.0601391"
Evaluating: -71.0601391+3.5
 Parameter: ZMAX <- "-67.5601391"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.1140736"
Evaluating: -27.1140736-3.5
 Parameter: XMIN <- "-30.6140736"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-45.6836077"
Evaluating: -45.6836077-3.5
 Parameter: YMIN <- "-49.1836077"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-71.0601391"
Evaluating: -71.0601391-3.5
 Parameter: ZMIN <- "-74.5601391"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.6140736"
 Parameter: XMIN -> "-30.6140736"
 Parameter: YMAX -> "-42.1836077"
 Parameter: YMIN -> "-49.1836077"
 Parameter: ZMAX -> "-67.5601391"
 Parameter: ZMIN -> "-74.5601391"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "93"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "93" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "93" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.127801357"
Evaluating: 125.050557*(0.127801357-0.5)
 Parameter: XPOS <- "-46.5436476"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.436585138"
Evaluating: 125.050557*(0.436585138-0.5)
 Parameter: YPOS <- "-7.93006382"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "8.390880266E-02"
Evaluating: 152.572525*(8.390880266E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-67.9999387"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-67.9999387" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-46.5436476"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -46.5436476-0
 Parameter: XTRAN <- "-46.5436476"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.93006382"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.93006382-0
 Parameter: YTRAN <- "-7.93006382"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-67.9999387"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -67.9999387-0
 Parameter: ZTRAN <- "-67.9999387"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.5436476"
 Parameter: YTRAN -> "-7.93006382"
 Parameter: ZTRAN -> "-67.9999387"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -46.543648   -7.930064  -67.999939
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.465285682"
Evaluating: 0.465285682*360.0
 Parameter: XPHI <- "167.502846"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.27617256"
Evaluating: 0.27617256*360.0
 Parameter: YPHI <- "99.4221216"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.91623938"
Evaluating: 0.91623938*360.0
 Parameter: ZPHI <- "329.846177"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-46.5436476"
 Parameter: YPOS -> "-7.93006382"
 Parameter: ZPOS -> "-67.9999387"
 Parameter: XPHI -> "167.502846"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.976307    0.216391
    0.000000   -0.216391   -0.976307

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  167.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-46.5436476"
 Parameter: YPOS -> "-7.93006382"
 Parameter: ZPOS -> "-67.9999387"
 Parameter: YPHI -> "99.4221216"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.163707    0.000000   -0.986509
    0.000000    1.000000    0.000000
    0.986509    0.000000   -0.163707

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   99.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-46.5436476"
 Parameter: YPOS -> "-7.93006382"
 Parameter: ZPOS -> "-67.9999387"
 Parameter: ZPHI -> "329.846177"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.864680   -0.502323    0.000000
    0.502323    0.864680    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   30.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.543648 XMAX =  -46.543648 XAVE =  -46.543648
    YMIN =   -7.930064 YMAX =   -7.930064 YAVE =   -7.930064
    ZMIN =  -67.999939 ZMAX =  -67.999939 ZAVE =  -67.999939
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-46.5436476"
Evaluating: -46.5436476+3.5
 Parameter: XMAX <- "-43.0436476"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.93006382"
Evaluating: -7.93006382+3.5
 Parameter: YMAX <- "-4.43006382"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-67.9999387"
Evaluating: -67.9999387+3.5
 Parameter: ZMAX <- "-64.4999387"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-46.5436476"
Evaluating: -46.5436476-3.5
 Parameter: XMIN <- "-50.0436476"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.93006382"
Evaluating: -7.93006382-3.5
 Parameter: YMIN <- "-11.4300638"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-67.9999387"
Evaluating: -67.9999387-3.5
 Parameter: ZMIN <- "-71.4999387"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-43.0436476"
 Parameter: XMIN -> "-50.0436476"
 Parameter: YMAX -> "-4.43006382"
 Parameter: YMIN -> "-11.4300638"
 Parameter: ZMAX -> "-64.4999387"
 Parameter: ZMIN -> "-71.4999387"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "94"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "94" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "94"
Evaluating: 94
 Parameter: J <- "94"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "94" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "94"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.674979795"
Evaluating: 125.050557*(0.674979795-0.5)
 Parameter: XPOS <- "21.8813208"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.342514273"
Evaluating: 125.050557*(0.342514273-0.5)
 Parameter: YPOS <- "-19.6936779"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "3.53641887E-02"
Evaluating: 152.572525*(3.53641887E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-75.406513"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-75.406513" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.8813208"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.8813208-0
 Parameter: XTRAN <- "21.8813208"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.6936779"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -19.6936779-0
 Parameter: YTRAN <- "-19.6936779"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-75.406513"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -75.406513-0
 Parameter: ZTRAN <- "-75.406513"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.8813208"
 Parameter: YTRAN -> "-19.6936779"
 Parameter: ZTRAN -> "-75.406513"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    21.881321  -19.693678  -75.406513
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.353211731"
Evaluating: 0.353211731*360.0
 Parameter: XPHI <- "127.156223"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.271871166"
Evaluating: 0.271871166*360.0
 Parameter: YPHI <- "97.8736198"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.329858209"
Evaluating: 0.329858209*360.0
 Parameter: ZPHI <- "118.748955"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.8813208"
 Parameter: YPOS -> "-19.6936779"
 Parameter: ZPOS -> "-75.406513"
 Parameter: XPHI -> "127.156223"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.603990    0.796992
    0.000000   -0.796992   -0.603990

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  127.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.8813208"
 Parameter: YPOS -> "-19.6936779"
 Parameter: ZPOS -> "-75.406513"
 Parameter: YPHI -> "97.8736198"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.136988    0.000000   -0.990573
    0.000000    1.000000    0.000000
    0.990573    0.000000   -0.136988

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   97.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.8813208"
 Parameter: YPOS -> "-19.6936779"
 Parameter: ZPOS -> "-75.406513"
 Parameter: ZPHI -> "118.748955"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.480973    0.876736    0.000000
   -0.876736   -0.480973    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  118.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.881321 XMAX =   21.881321 XAVE =   21.881321
    YMIN =  -19.693678 YMAX =  -19.693678 YAVE =  -19.693678
    ZMIN =  -75.406513 ZMAX =  -75.406513 ZAVE =  -75.406513
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.8813208"
Evaluating: 21.8813208+3.5
 Parameter: XMAX <- "25.3813208"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.6936779"
Evaluating: -19.6936779+3.5
 Parameter: YMAX <- "-16.1936779"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-75.406513"
Evaluating: -75.406513+3.5
 Parameter: ZMAX <- "-71.906513"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.8813208"
Evaluating: 21.8813208-3.5
 Parameter: XMIN <- "18.3813208"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.6936779"
Evaluating: -19.6936779-3.5
 Parameter: YMIN <- "-23.1936779"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-75.406513"
Evaluating: -75.406513-3.5
 Parameter: ZMIN <- "-78.906513"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.3813208"
 Parameter: XMIN -> "18.3813208"
 Parameter: YMAX -> "-16.1936779"
 Parameter: YMIN -> "-23.1936779"
 Parameter: ZMAX -> "-71.906513"
 Parameter: ZMIN -> "-78.906513"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "95"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "95" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "95" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "95"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.536930036"
Evaluating: 125.050557*(0.536930036-0.5)
 Parameter: XPOS <- "4.61812157"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "3.834982696E-02"
Evaluating: 125.050557*(3.834982696E-02-0.5)
 Parameter: YPOS <- "-57.7296113"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.346853564"
Evaluating: 152.572525*(0.346853564-0.5)+-4.51585405
 Parameter: ZPOS <- "-27.8817925"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.8817925" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.61812157"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.61812157-0
 Parameter: XTRAN <- "4.61812157"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-57.7296113"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -57.7296113-0
 Parameter: YTRAN <- "-57.7296113"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.8817925"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.8817925-0
 Parameter: ZTRAN <- "-27.8817925"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.61812157"
 Parameter: YTRAN -> "-57.7296113"
 Parameter: ZTRAN -> "-27.8817925"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     4.618122  -57.729611  -27.881792
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.675369065"
Evaluating: 0.675369065*360.0
 Parameter: XPHI <- "243.132863"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.842794104"
Evaluating: 0.842794104*360.0
 Parameter: YPHI <- "303.405877"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.738931188"
Evaluating: 0.738931188*360.0
 Parameter: ZPHI <- "266.015228"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.61812157"
 Parameter: YPOS -> "-57.7296113"
 Parameter: ZPOS -> "-27.8817925"
 Parameter: XPHI -> "243.132863"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.451923   -0.892057
    0.000000    0.892057   -0.451923

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  116.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.61812157"
 Parameter: YPOS -> "-57.7296113"
 Parameter: ZPOS -> "-27.8817925"
 Parameter: YPHI -> "303.405877"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.550566    0.000000    0.834791
    0.000000    1.000000    0.000000
   -0.834791    0.000000    0.550566

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   56.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.61812157"
 Parameter: YPOS -> "-57.7296113"
 Parameter: ZPOS -> "-27.8817925"
 Parameter: ZPHI -> "266.015228"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.069491   -0.997583    0.000000
    0.997583   -0.069491    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   93.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.618122 XMAX =    4.618122 XAVE =    4.618122
    YMIN =  -57.729611 YMAX =  -57.729611 YAVE =  -57.729611
    ZMIN =  -27.881792 ZMAX =  -27.881792 ZAVE =  -27.881792
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.61812157"
Evaluating: 4.61812157+3.5
 Parameter: XMAX <- "8.11812157"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-57.7296113"
Evaluating: -57.7296113+3.5
 Parameter: YMAX <- "-54.2296113"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.8817925"
Evaluating: -27.8817925+3.5
 Parameter: ZMAX <- "-24.3817925"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.61812157"
Evaluating: 4.61812157-3.5
 Parameter: XMIN <- "1.11812157"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-57.7296113"
Evaluating: -57.7296113-3.5
 Parameter: YMIN <- "-61.2296113"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.8817925"
Evaluating: -27.8817925-3.5
 Parameter: ZMIN <- "-31.3817925"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.11812157"
 Parameter: XMIN -> "1.11812157"
 Parameter: YMAX -> "-54.2296113"
 Parameter: YMIN -> "-61.2296113"
 Parameter: ZMAX -> "-24.3817925"
 Parameter: ZMIN -> "-31.3817925"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "96"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "96" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "96" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "96"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.152989536"
Evaluating: 125.050557*(0.152989536-0.5)
 Parameter: XPOS <- "-43.3938518"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.191109558"
Evaluating: 125.050557*(0.191109558-0.5)
 Parameter: YPOS <- "-38.6269218"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.881708265"
Evaluating: 152.572525*(0.881708265-0.5)+-4.51585405
 Parameter: ZPOS <- "53.7223398"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "53.7223398" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "53.7223398" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.3938518"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.3938518-0
 Parameter: XTRAN <- "-43.3938518"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.6269218"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.6269218-0
 Parameter: YTRAN <- "-38.6269218"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "53.7223398"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 53.7223398-0
 Parameter: ZTRAN <- "53.7223398"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.3938518"
 Parameter: YTRAN -> "-38.6269218"
 Parameter: ZTRAN -> "53.7223398"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -43.393852  -38.626922   53.722340
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.205574196"
Evaluating: 0.205574196*360.0
 Parameter: XPHI <- "74.0067106"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.665331375"
Evaluating: 0.665331375*360.0
 Parameter: YPHI <- "239.519295"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.924872325"
Evaluating: 0.924872325*360.0
 Parameter: ZPHI <- "332.954037"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.3938518"
 Parameter: YPOS -> "-38.6269218"
 Parameter: ZPOS -> "53.7223398"
 Parameter: XPHI -> "74.0067106"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.275525    0.961294
    0.000000   -0.961294    0.275525

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   74.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.3938518"
 Parameter: YPOS -> "-38.6269218"
 Parameter: ZPOS -> "53.7223398"
 Parameter: YPHI -> "239.519295"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.507248    0.000000    0.861800
    0.000000    1.000000    0.000000
   -0.861800    0.000000   -0.507248

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  120.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.3938518"
 Parameter: YPOS -> "-38.6269218"
 Parameter: ZPOS -> "53.7223398"
 Parameter: ZPHI -> "332.954037"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.890642   -0.454705    0.000000
    0.454705    0.890642    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   27.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.393852 XMAX =  -43.393852 XAVE =  -43.393852
    YMIN =  -38.626922 YMAX =  -38.626922 YAVE =  -38.626922
    ZMIN =   53.722340 ZMAX =   53.722340 ZAVE =   53.722340
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.3938518"
Evaluating: -43.3938518+3.5
 Parameter: XMAX <- "-39.8938518"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.6269218"
Evaluating: -38.6269218+3.5
 Parameter: YMAX <- "-35.1269218"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "53.7223398"
Evaluating: 53.7223398+3.5
 Parameter: ZMAX <- "57.2223398"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.3938518"
Evaluating: -43.3938518-3.5
 Parameter: XMIN <- "-46.8938518"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.6269218"
Evaluating: -38.6269218-3.5
 Parameter: YMIN <- "-42.1269218"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "53.7223398"
Evaluating: 53.7223398-3.5
 Parameter: ZMIN <- "50.2223398"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.8938518"
 Parameter: XMIN -> "-46.8938518"
 Parameter: YMAX -> "-35.1269218"
 Parameter: YMIN -> "-42.1269218"
 Parameter: ZMAX -> "57.2223398"
 Parameter: ZMIN -> "50.2223398"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "97"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "97" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "97" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "5.863902515E-02"
Evaluating: 125.050557*(5.863902515E-02-0.5)
 Parameter: XPOS <- "-55.1924357"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.764219401"
Evaluating: 125.050557*(0.764219401-0.5)
 Parameter: YPOS <- "33.0407833"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.86614843"
Evaluating: 152.572525*(0.86614843-0.5)+-4.51585405
 Parameter: ZPOS <- "51.3483364"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "51.3483364" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "51.3483364" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-55.1924357"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -55.1924357-0
 Parameter: XTRAN <- "-55.1924357"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.0407833"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.0407833-0
 Parameter: YTRAN <- "33.0407833"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "51.3483364"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 51.3483364-0
 Parameter: ZTRAN <- "51.3483364"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-55.1924357"
 Parameter: YTRAN -> "33.0407833"
 Parameter: ZTRAN -> "51.3483364"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -55.192436   33.040783   51.348336
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.716028569"
Evaluating: 0.716028569*360.0
 Parameter: XPHI <- "257.770285"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.146117147"
Evaluating: 0.146117147*360.0
 Parameter: YPHI <- "52.6021729"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.603152899"
Evaluating: 0.603152899*360.0
 Parameter: ZPHI <- "217.135044"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-55.1924357"
 Parameter: YPOS -> "33.0407833"
 Parameter: ZPOS -> "51.3483364"
 Parameter: XPHI -> "257.770285"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.211832   -0.977306
    0.000000    0.977306   -0.211832

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  102.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-55.1924357"
 Parameter: YPOS -> "33.0407833"
 Parameter: ZPOS -> "51.3483364"
 Parameter: YPHI -> "52.6021729"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.607346    0.000000   -0.794438
    0.000000    1.000000    0.000000
    0.794438    0.000000    0.607346

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   52.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-55.1924357"
 Parameter: YPOS -> "33.0407833"
 Parameter: ZPOS -> "51.3483364"
 Parameter: ZPHI -> "217.135044"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.797215   -0.603696    0.000000
    0.603696   -0.797215    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  142.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -55.192436 XMAX =  -55.192436 XAVE =  -55.192436
    YMIN =   33.040783 YMAX =   33.040783 YAVE =   33.040783
    ZMIN =   51.348336 ZMAX =   51.348336 ZAVE =   51.348336
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-55.1924357"
Evaluating: -55.1924357+3.5
 Parameter: XMAX <- "-51.6924357"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.0407833"
Evaluating: 33.0407833+3.5
 Parameter: YMAX <- "36.5407833"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "51.3483364"
Evaluating: 51.3483364+3.5
 Parameter: ZMAX <- "54.8483364"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-55.1924357"
Evaluating: -55.1924357-3.5
 Parameter: XMIN <- "-58.6924357"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.0407833"
Evaluating: 33.0407833-3.5
 Parameter: YMIN <- "29.5407833"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "51.3483364"
Evaluating: 51.3483364-3.5
 Parameter: ZMIN <- "47.8483364"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-51.6924357"
 Parameter: XMIN -> "-58.6924357"
 Parameter: YMAX -> "36.5407833"
 Parameter: YMIN -> "29.5407833"
 Parameter: ZMAX -> "54.8483364"
 Parameter: ZMIN -> "47.8483364"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "98"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "98" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "98" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "98"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.837815674"
Evaluating: 125.050557*(0.837815674-0.5)
 Parameter: XPOS <- "42.2440382"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.569359579"
Evaluating: 125.050557*(0.569359579-0.5)
 Parameter: YPOS <- "8.67345399"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.65624203"
Evaluating: 152.572525*(0.65624203-0.5)+-4.51585405
 Parameter: ZPOS <- "19.322387"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.322387" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.322387" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.2440382"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 42.2440382-0
 Parameter: XTRAN <- "42.2440382"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.67345399"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.67345399-0
 Parameter: YTRAN <- "8.67345399"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.322387"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.322387-0
 Parameter: ZTRAN <- "19.322387"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.2440382"
 Parameter: YTRAN -> "8.67345399"
 Parameter: ZTRAN -> "19.322387"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    42.244038    8.673454   19.322387
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.99635221E-02"
Evaluating: 8.99635221E-02*360.0
 Parameter: XPHI <- "32.386868"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.767236958"
Evaluating: 0.767236958*360.0
 Parameter: YPHI <- "276.205305"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.868634689"
Evaluating: 0.868634689*360.0
 Parameter: ZPHI <- "312.708488"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.2440382"
 Parameter: YPOS -> "8.67345399"
 Parameter: ZPOS -> "19.322387"
 Parameter: XPHI -> "32.386868"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.844451    0.535633
    0.000000   -0.535633    0.844451

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   32.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.2440382"
 Parameter: YPOS -> "8.67345399"
 Parameter: ZPOS -> "19.322387"
 Parameter: YPHI -> "276.205305"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.108091    0.000000    0.994141
    0.000000    1.000000    0.000000
   -0.994141    0.000000    0.108091

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   83.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.2440382"
 Parameter: YPOS -> "8.67345399"
 Parameter: ZPOS -> "19.322387"
 Parameter: ZPHI -> "312.708488"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.678269   -0.734814    0.000000
    0.734814    0.678269    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.244038 XMAX =   42.244038 XAVE =   42.244038
    YMIN =    8.673454 YMAX =    8.673454 YAVE =    8.673454
    ZMIN =   19.322387 ZMAX =   19.322387 ZAVE =   19.322387
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.2440382"
Evaluating: 42.2440382+3.5
 Parameter: XMAX <- "45.7440382"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.67345399"
Evaluating: 8.67345399+3.5
 Parameter: YMAX <- "12.173454"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.322387"
Evaluating: 19.322387+3.5
 Parameter: ZMAX <- "22.822387"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.2440382"
Evaluating: 42.2440382-3.5
 Parameter: XMIN <- "38.7440382"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.67345399"
Evaluating: 8.67345399-3.5
 Parameter: YMIN <- "5.17345399"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.322387"
Evaluating: 19.322387-3.5
 Parameter: ZMIN <- "15.822387"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.7440382"
 Parameter: XMIN -> "38.7440382"
 Parameter: YMAX -> "12.173454"
 Parameter: YMIN -> "5.17345399"
 Parameter: ZMAX -> "22.822387"
 Parameter: ZMIN -> "15.822387"
 SELRPN>     27 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     14 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64513 POS      SOD      98       SOD     -**** PROA     ASP      1203     N             5.1071
64513 POS      SOD      98       SOD     -**** PROA     ASP      1203     CA            4.4495
64513 POS      SOD      98       SOD     -**** PROA     ASP      1203     OD1           4.0128
64513 POS      SOD      98       SOD     -**** PROA     ARG      1229     CA            3.2588
64513 POS      SOD      98       SOD     -**** PROA     ARG      1229     CB            2.9536
64513 POS      SOD      98       SOD     -**** PROA     ARG      1229     CG            2.7745
64513 POS      SOD      98       SOD     -**** PROA     ARG      1229     CD            4.2080
64513 POS      SOD      98       SOD     -**** PROA     ARG      1229     C             2.4050
64513 POS      SOD      98       SOD     -**** PROA     ARG      1229     O             2.2966
64513 POS      SOD      98       SOD     -**** PROA     ILE      1230     N             2.7833
64513 POS      SOD      98       SOD     -**** PROA     ILE      1230     CA            3.0787
64513 POS      SOD      98       SOD     -**** PROA     ILE      1230     CG1           4.8294
64513 POS      SOD      98       SOD     -**** PROA     ILE      1230     CD            5.0668
64513 POS      SOD      98       SOD     -**** PROA     ILE      1230     C             3.5263
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        14
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "14"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "98" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "98"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.841683839"
Evaluating: 125.050557*(0.841683839-0.5)
 Parameter: XPOS <- "42.7277544"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.154044692"
Evaluating: 125.050557*(0.154044692-0.5)
 Parameter: YPOS <- "-43.261904"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.135058213"
Evaluating: 152.572525*(0.135058213-0.5)+-4.51585405
 Parameter: ZPOS <- "-60.195944"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-60.195944" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.244038 XMAX =   42.244038 XAVE =   42.244038
    YMIN =    8.673454 YMAX =    8.673454 YAVE =    8.673454
    ZMIN =   19.322387 ZMAX =   19.322387 ZAVE =   19.322387
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.7277544"
 RDCMND substituted energy or value "?XAVE" to "42.2440382"
Evaluating: 42.7277544-42.2440382
 Parameter: XTRAN <- "0.4837162"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.261904"
 RDCMND substituted energy or value "?YAVE" to "8.67345399"
Evaluating: -43.261904-8.67345399
 Parameter: YTRAN <- "-51.935358"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-60.195944"
 RDCMND substituted energy or value "?ZAVE" to "19.322387"
Evaluating: -60.195944-19.322387
 Parameter: ZTRAN <- "-79.518331"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.4837162"
 Parameter: YTRAN -> "-51.935358"
 Parameter: ZTRAN -> "-79.518331"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     0.483716  -51.935358  -79.518331
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.691809519"
Evaluating: 0.691809519*360.0
 Parameter: XPHI <- "249.051427"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.903779437"
Evaluating: 0.903779437*360.0
 Parameter: YPHI <- "325.360597"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.177108076"
Evaluating: 0.177108076*360.0
 Parameter: ZPHI <- "63.7589074"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.7277544"
 Parameter: YPOS -> "-43.261904"
 Parameter: ZPOS -> "-60.195944"
 Parameter: XPHI -> "249.051427"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.357530   -0.933902
    0.000000    0.933902   -0.357530

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  110.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.7277544"
 Parameter: YPOS -> "-43.261904"
 Parameter: ZPOS -> "-60.195944"
 Parameter: YPHI -> "325.360597"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.822746    0.000000    0.568410
    0.000000    1.000000    0.000000
   -0.568410    0.000000    0.822746

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   34.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.7277544"
 Parameter: YPOS -> "-43.261904"
 Parameter: ZPOS -> "-60.195944"
 Parameter: ZPHI -> "63.7589074"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.442149    0.896941    0.000000
   -0.896941    0.442149    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   63.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.727754 XMAX =   42.727754 XAVE =   42.727754
    YMIN =  -43.261904 YMAX =  -43.261904 YAVE =  -43.261904
    ZMIN =  -60.195944 ZMAX =  -60.195944 ZAVE =  -60.195944
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.7277544"
Evaluating: 42.7277544+3.5
 Parameter: XMAX <- "46.2277544"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.261904"
Evaluating: -43.261904+3.5
 Parameter: YMAX <- "-39.761904"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-60.195944"
Evaluating: -60.195944+3.5
 Parameter: ZMAX <- "-56.695944"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.7277544"
Evaluating: 42.7277544-3.5
 Parameter: XMIN <- "39.2277544"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.261904"
Evaluating: -43.261904-3.5
 Parameter: YMIN <- "-46.761904"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-60.195944"
Evaluating: -60.195944-3.5
 Parameter: ZMIN <- "-63.695944"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.2277544"
 Parameter: XMIN -> "39.2277544"
 Parameter: YMAX -> "-39.761904"
 Parameter: YMIN -> "-46.761904"
 Parameter: ZMAX -> "-56.695944"
 Parameter: ZMIN -> "-63.695944"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "99"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "99" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "99" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.419209273"
Evaluating: 125.050557*(0.419209273-0.5)
 Parameter: XPOS <- "-10.1029254"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.247523979"
Evaluating: 125.050557*(0.247523979-0.5)
 Parameter: YPOS <- "-31.5722671"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.936955942"
Evaluating: 152.572525*(0.936955942-0.5)+-4.51585405
 Parameter: ZPOS <- "62.1516173"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "62.1516173" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "62.1516173" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.1029254"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.1029254-0
 Parameter: XTRAN <- "-10.1029254"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.5722671"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.5722671-0
 Parameter: YTRAN <- "-31.5722671"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "62.1516173"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 62.1516173-0
 Parameter: ZTRAN <- "62.1516173"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.1029254"
 Parameter: YTRAN -> "-31.5722671"
 Parameter: ZTRAN -> "62.1516173"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -10.102925  -31.572267   62.151617
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.321048001"
Evaluating: 0.321048001*360.0
 Parameter: XPHI <- "115.57728"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.208783018"
Evaluating: 0.208783018*360.0
 Parameter: YPHI <- "75.1618865"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.805542573"
Evaluating: 0.805542573*360.0
 Parameter: ZPHI <- "289.995326"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.1029254"
 Parameter: YPOS -> "-31.5722671"
 Parameter: ZPOS -> "62.1516173"
 Parameter: XPHI -> "115.57728"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.431728    0.902004
    0.000000   -0.902004   -0.431728

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  115.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.1029254"
 Parameter: YPOS -> "-31.5722671"
 Parameter: ZPOS -> "62.1516173"
 Parameter: YPHI -> "75.1618865"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.256089    0.000000   -0.966653
    0.000000    1.000000    0.000000
    0.966653    0.000000    0.256089

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   75.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.1029254"
 Parameter: YPOS -> "-31.5722671"
 Parameter: ZPOS -> "62.1516173"
 Parameter: ZPHI -> "289.995326"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.341943   -0.939721    0.000000
    0.939721    0.341943    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   70.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.102925 XMAX =  -10.102925 XAVE =  -10.102925
    YMIN =  -31.572267 YMAX =  -31.572267 YAVE =  -31.572267
    ZMIN =   62.151617 ZMAX =   62.151617 ZAVE =   62.151617
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.1029254"
Evaluating: -10.1029254+3.5
 Parameter: XMAX <- "-6.6029254"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.5722671"
Evaluating: -31.5722671+3.5
 Parameter: YMAX <- "-28.0722671"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "62.1516173"
Evaluating: 62.1516173+3.5
 Parameter: ZMAX <- "65.6516173"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.1029254"
Evaluating: -10.1029254-3.5
 Parameter: XMIN <- "-13.6029254"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.5722671"
Evaluating: -31.5722671-3.5
 Parameter: YMIN <- "-35.0722671"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "62.1516173"
Evaluating: 62.1516173-3.5
 Parameter: ZMIN <- "58.6516173"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.6029254"
 Parameter: XMIN -> "-13.6029254"
 Parameter: YMAX -> "-28.0722671"
 Parameter: YMIN -> "-35.0722671"
 Parameter: ZMAX -> "65.6516173"
 Parameter: ZMIN -> "58.6516173"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "100"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "100" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "100"
Evaluating: 100
 Parameter: J <- "100"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "100" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "100"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.879533056"
Evaluating: 125.050557*(0.879533056-0.5)
 Parameter: XPOS <- "47.4608201"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "6.144318534E-02"
Evaluating: 125.050557*(6.144318534E-02-0.5)
 Parameter: YPOS <- "-54.8417739"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.98376493"
Evaluating: 152.572525*(0.98376493-0.5)+-4.51585405
 Parameter: ZPOS <- "69.2933828"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.2933828" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.2933828" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "47.4608201"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 47.4608201-0
 Parameter: XTRAN <- "47.4608201"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-54.8417739"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -54.8417739-0
 Parameter: YTRAN <- "-54.8417739"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.2933828"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 69.2933828-0
 Parameter: ZTRAN <- "69.2933828"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "47.4608201"
 Parameter: YTRAN -> "-54.8417739"
 Parameter: ZTRAN -> "69.2933828"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    47.460820  -54.841774   69.293383
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.20687333"
Evaluating: 0.20687333*360.0
 Parameter: XPHI <- "74.4743988"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.244451216"
Evaluating: 0.244451216*360.0
 Parameter: YPHI <- "88.0024378"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.137809494"
Evaluating: 0.137809494*360.0
 Parameter: ZPHI <- "49.6114178"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "47.4608201"
 Parameter: YPOS -> "-54.8417739"
 Parameter: ZPOS -> "69.2933828"
 Parameter: XPHI -> "74.4743988"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.267669    0.963511
    0.000000   -0.963511    0.267669

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   74.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "47.4608201"
 Parameter: YPOS -> "-54.8417739"
 Parameter: ZPOS -> "69.2933828"
 Parameter: YPHI -> "88.0024378"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.034857    0.000000   -0.999392
    0.000000    1.000000    0.000000
    0.999392    0.000000    0.034857

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   88.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "47.4608201"
 Parameter: YPOS -> "-54.8417739"
 Parameter: ZPOS -> "69.2933828"
 Parameter: ZPHI -> "49.6114178"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.647968    0.761667    0.000000
   -0.761667    0.647968    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   49.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.460820 XMAX =   47.460820 XAVE =   47.460820
    YMIN =  -54.841774 YMAX =  -54.841774 YAVE =  -54.841774
    ZMIN =   69.293383 ZMAX =   69.293383 ZAVE =   69.293383
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "47.4608201"
Evaluating: 47.4608201+3.5
 Parameter: XMAX <- "50.9608201"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-54.8417739"
Evaluating: -54.8417739+3.5
 Parameter: YMAX <- "-51.3417739"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.2933828"
Evaluating: 69.2933828+3.5
 Parameter: ZMAX <- "72.7933828"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "47.4608201"
Evaluating: 47.4608201-3.5
 Parameter: XMIN <- "43.9608201"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-54.8417739"
Evaluating: -54.8417739-3.5
 Parameter: YMIN <- "-58.3417739"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.2933828"
Evaluating: 69.2933828-3.5
 Parameter: ZMIN <- "65.7933828"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.9608201"
 Parameter: XMIN -> "43.9608201"
 Parameter: YMAX -> "-51.3417739"
 Parameter: YMIN -> "-58.3417739"
 Parameter: ZMAX -> "72.7933828"
 Parameter: ZMIN -> "65.7933828"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "101"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "101" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "101" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.547247092"
Evaluating: 125.050557*(0.547247092-0.5)
 Parameter: XPOS <- "5.90827517"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.753452076"
Evaluating: 125.050557*(0.753452076-0.5)
 Parameter: YPOS <- "31.6943233"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.198203115"
Evaluating: 152.572525*(0.198203115-0.5)+-4.51585405
 Parameter: ZPOS <- "-50.5617668"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.5617668" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.90827517"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.90827517-0
 Parameter: XTRAN <- "5.90827517"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.6943233"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.6943233-0
 Parameter: YTRAN <- "31.6943233"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.5617668"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.5617668-0
 Parameter: ZTRAN <- "-50.5617668"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.90827517"
 Parameter: YTRAN -> "31.6943233"
 Parameter: ZTRAN -> "-50.5617668"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     5.908275   31.694323  -50.561767
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.389218052E-02"
Evaluating: 4.389218052E-02*360.0
 Parameter: XPHI <- "15.801185"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.716418442"
Evaluating: 0.716418442*360.0
 Parameter: YPHI <- "257.910639"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.315293542"
Evaluating: 0.315293542*360.0
 Parameter: ZPHI <- "113.505675"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.90827517"
 Parameter: YPOS -> "31.6943233"
 Parameter: ZPOS -> "-50.5617668"
 Parameter: XPHI -> "15.801185"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.962212    0.272300
    0.000000   -0.272300    0.962212

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   15.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.90827517"
 Parameter: YPOS -> "31.6943233"
 Parameter: ZPOS -> "-50.5617668"
 Parameter: YPHI -> "257.910639"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.209437    0.000000    0.977822
    0.000000    1.000000    0.000000
   -0.977822    0.000000   -0.209437

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  102.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.90827517"
 Parameter: YPOS -> "31.6943233"
 Parameter: ZPOS -> "-50.5617668"
 Parameter: ZPHI -> "113.505675"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.398840    0.917021    0.000000
   -0.917021   -0.398840    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  113.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.908275 XMAX =    5.908275 XAVE =    5.908275
    YMIN =   31.694323 YMAX =   31.694323 YAVE =   31.694323
    ZMIN =  -50.561767 ZMAX =  -50.561767 ZAVE =  -50.561767
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.90827517"
Evaluating: 5.90827517+3.5
 Parameter: XMAX <- "9.40827517"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.6943233"
Evaluating: 31.6943233+3.5
 Parameter: YMAX <- "35.1943233"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.5617668"
Evaluating: -50.5617668+3.5
 Parameter: ZMAX <- "-47.0617668"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.90827517"
Evaluating: 5.90827517-3.5
 Parameter: XMIN <- "2.40827517"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.6943233"
Evaluating: 31.6943233-3.5
 Parameter: YMIN <- "28.1943233"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.5617668"
Evaluating: -50.5617668-3.5
 Parameter: ZMIN <- "-54.0617668"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.40827517"
 Parameter: XMIN -> "2.40827517"
 Parameter: YMAX -> "35.1943233"
 Parameter: YMIN -> "28.1943233"
 Parameter: ZMAX -> "-47.0617668"
 Parameter: ZMIN -> "-54.0617668"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "102"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "102" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "102" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.508813219"
Evaluating: 125.050557*(0.508813219-0.5)
 Parameter: XPOS <- "1.10209794"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.564002806"
Evaluating: 125.050557*(0.564002806-0.5)
 Parameter: YPOS <- "8.00358654"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.324107841"
Evaluating: 152.572525*(0.324107841-0.5)+-4.51585405
 Parameter: ZPOS <- "-31.3521649"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.3521649" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.10209794"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.10209794-0
 Parameter: XTRAN <- "1.10209794"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.00358654"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.00358654-0
 Parameter: YTRAN <- "8.00358654"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.3521649"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.3521649-0
 Parameter: ZTRAN <- "-31.3521649"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.10209794"
 Parameter: YTRAN -> "8.00358654"
 Parameter: ZTRAN -> "-31.3521649"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     1.102098    8.003587  -31.352165
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.898365515"
Evaluating: 0.898365515*360.0
 Parameter: XPHI <- "323.411585"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.868822337"
Evaluating: 0.868822337*360.0
 Parameter: YPHI <- "312.776041"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.717606139"
Evaluating: 0.717606139*360.0
 Parameter: ZPHI <- "258.33821"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.10209794"
 Parameter: YPOS -> "8.00358654"
 Parameter: ZPOS -> "-31.3521649"
 Parameter: XPHI -> "323.411585"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.802938   -0.596063
    0.000000    0.596063    0.802938

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   36.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.10209794"
 Parameter: YPOS -> "8.00358654"
 Parameter: ZPOS -> "-31.3521649"
 Parameter: YPHI -> "312.776041"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.679134    0.000000    0.734014
    0.000000    1.000000    0.000000
   -0.734014    0.000000    0.679134

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   47.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.10209794"
 Parameter: YPOS -> "8.00358654"
 Parameter: ZPOS -> "-31.3521649"
 Parameter: ZPHI -> "258.33821"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.202134   -0.979358    0.000000
    0.979358   -0.202134    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  101.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.102098 XMAX =    1.102098 XAVE =    1.102098
    YMIN =    8.003587 YMAX =    8.003587 YAVE =    8.003587
    ZMIN =  -31.352165 ZMAX =  -31.352165 ZAVE =  -31.352165
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.10209794"
Evaluating: 1.10209794+3.5
 Parameter: XMAX <- "4.60209794"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.00358654"
Evaluating: 8.00358654+3.5
 Parameter: YMAX <- "11.5035865"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.3521649"
Evaluating: -31.3521649+3.5
 Parameter: ZMAX <- "-27.8521649"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.10209794"
Evaluating: 1.10209794-3.5
 Parameter: XMIN <- "-2.39790206"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.00358654"
Evaluating: 8.00358654-3.5
 Parameter: YMIN <- "4.50358654"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.3521649"
Evaluating: -31.3521649-3.5
 Parameter: ZMIN <- "-34.8521649"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.60209794"
 Parameter: XMIN -> "-2.39790206"
 Parameter: YMAX -> "11.5035865"
 Parameter: YMIN -> "4.50358654"
 Parameter: ZMAX -> "-27.8521649"
 Parameter: ZMIN -> "-34.8521649"
 SELRPN>     27 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     11 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64517 POS      SOD      102      SOD     -**** PROA     GLU      1075     C             4.1535
64517 POS      SOD      102      SOD     -**** PROA     GLU      1075     O             3.5112
64517 POS      SOD      102      SOD     -**** PROA     TYR      1076     C             3.8709
64517 POS      SOD      102      SOD     -**** PROA     TYR      1076     O             4.6949
64517 POS      SOD      102      SOD     -**** PROA     LYS      1077     N             3.0350
64517 POS      SOD      102      SOD     -**** PROA     LYS      1077     CA            3.1594
64517 POS      SOD      102      SOD     -**** PROA     LYS      1077     CB            2.6403
64517 POS      SOD      102      SOD     -**** PROA     LYS      1077     CG            1.4681
64517 POS      SOD      102      SOD     -**** PROA     LYS      1077     CD            0.4994
64517 POS      SOD      102      SOD     -**** PROA     LYS      1077     CE            2.0246
64517 POS      SOD      102      SOD     -**** PROA     LYS      1077     NZ            2.8576
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "102" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.179597934"
Evaluating: 125.050557*(0.179597934-0.5)
 Parameter: XPOS <- "-40.0664568"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.287801632"
Evaluating: 125.050557*(0.287801632-0.5)
 Parameter: YPOS <- "-26.5355241"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.194810995"
Evaluating: 152.572525*(0.194810995-0.5)+-4.51585405
 Parameter: ZPOS <- "-51.0793111"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.0793111" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.102098 XMAX =    1.102098 XAVE =    1.102098
    YMIN =    8.003587 YMAX =    8.003587 YAVE =    8.003587
    ZMIN =  -31.352165 ZMAX =  -31.352165 ZAVE =  -31.352165
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.0664568"
 RDCMND substituted energy or value "?XAVE" to "1.10209794"
Evaluating: -40.0664568-1.10209794
 Parameter: XTRAN <- "-41.1685547"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.5355241"
 RDCMND substituted energy or value "?YAVE" to "8.00358654"
Evaluating: -26.5355241-8.00358654
 Parameter: YTRAN <- "-34.5391106"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.0793111"
 RDCMND substituted energy or value "?ZAVE" to "-31.3521649"
Evaluating: -51.0793111--31.3521649
 Parameter: ZTRAN <- "-19.7271462"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.1685547"
 Parameter: YTRAN -> "-34.5391106"
 Parameter: ZTRAN -> "-19.7271462"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -41.168555  -34.539111  -19.727146
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.469600189"
Evaluating: 0.469600189*360.0
 Parameter: XPHI <- "169.056068"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.190145989"
Evaluating: 0.190145989*360.0
 Parameter: YPHI <- "68.452556"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.914607703"
Evaluating: 0.914607703*360.0
 Parameter: ZPHI <- "329.258773"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.0664568"
 Parameter: YPOS -> "-26.5355241"
 Parameter: ZPOS -> "-51.0793111"
 Parameter: XPHI -> "169.056068"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.981813    0.189848
    0.000000   -0.189848   -0.981813

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  169.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.0664568"
 Parameter: YPOS -> "-26.5355241"
 Parameter: ZPOS -> "-51.0793111"
 Parameter: YPHI -> "68.452556"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.367272    0.000000   -0.930114
    0.000000    1.000000    0.000000
    0.930114    0.000000    0.367272

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.0664568"
 Parameter: YPOS -> "-26.5355241"
 Parameter: ZPOS -> "-51.0793111"
 Parameter: ZPHI -> "329.258773"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.859485   -0.511161    0.000000
    0.511161    0.859485    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   30.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.066457 XMAX =  -40.066457 XAVE =  -40.066457
    YMIN =  -26.535524 YMAX =  -26.535524 YAVE =  -26.535524
    ZMIN =  -51.079311 ZMAX =  -51.079311 ZAVE =  -51.079311
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.0664568"
Evaluating: -40.0664568+3.5
 Parameter: XMAX <- "-36.5664568"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.5355241"
Evaluating: -26.5355241+3.5
 Parameter: YMAX <- "-23.0355241"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.0793111"
Evaluating: -51.0793111+3.5
 Parameter: ZMAX <- "-47.5793111"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.0664568"
Evaluating: -40.0664568-3.5
 Parameter: XMIN <- "-43.5664568"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.5355241"
Evaluating: -26.5355241-3.5
 Parameter: YMIN <- "-30.0355241"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.0793111"
Evaluating: -51.0793111-3.5
 Parameter: ZMIN <- "-54.5793111"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.5664568"
 Parameter: XMIN -> "-43.5664568"
 Parameter: YMAX -> "-23.0355241"
 Parameter: YMIN -> "-30.0355241"
 Parameter: ZMAX -> "-47.5793111"
 Parameter: ZMIN -> "-54.5793111"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "103"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "103" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "103"
Evaluating: 103
 Parameter: J <- "103"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "103" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "103"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.367346113"
Evaluating: 125.050557*(0.367346113-0.5)
 Parameter: XPOS <- "-16.5884425"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.024945597E-02"
Evaluating: 125.050557*(1.024945597E-02-0.5)
 Parameter: YPOS <- "-61.2435783"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.110077835"
Evaluating: 152.572525*(0.110077835-0.5)+-4.51585405
 Parameter: ZPOS <- "-64.0072633"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-64.0072633" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.5884425"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.5884425-0
 Parameter: XTRAN <- "-16.5884425"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-61.2435783"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -61.2435783-0
 Parameter: YTRAN <- "-61.2435783"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-64.0072633"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -64.0072633-0
 Parameter: ZTRAN <- "-64.0072633"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.5884425"
 Parameter: YTRAN -> "-61.2435783"
 Parameter: ZTRAN -> "-64.0072633"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -16.588442  -61.243578  -64.007263
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.787943712"
Evaluating: 0.787943712*360.0
 Parameter: XPHI <- "283.659736"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.288247503"
Evaluating: 0.288247503*360.0
 Parameter: YPHI <- "103.769101"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.637589713"
Evaluating: 0.637589713*360.0
 Parameter: ZPHI <- "229.532297"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.5884425"
 Parameter: YPOS -> "-61.2435783"
 Parameter: ZPOS -> "-64.0072633"
 Parameter: XPHI -> "283.659736"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.236155   -0.971715
    0.000000    0.971715    0.236155

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   76.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.5884425"
 Parameter: YPOS -> "-61.2435783"
 Parameter: ZPOS -> "-64.0072633"
 Parameter: YPHI -> "103.769101"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.238010    0.000000   -0.971263
    0.000000    1.000000    0.000000
    0.971263    0.000000   -0.238010

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  103.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.5884425"
 Parameter: YPOS -> "-61.2435783"
 Parameter: ZPOS -> "-64.0072633"
 Parameter: ZPHI -> "229.532297"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.649019   -0.760772    0.000000
    0.760772   -0.649019    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  130.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.588442 XMAX =  -16.588442 XAVE =  -16.588442
    YMIN =  -61.243578 YMAX =  -61.243578 YAVE =  -61.243578
    ZMIN =  -64.007263 ZMAX =  -64.007263 ZAVE =  -64.007263
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.5884425"
Evaluating: -16.5884425+3.5
 Parameter: XMAX <- "-13.0884425"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-61.2435783"
Evaluating: -61.2435783+3.5
 Parameter: YMAX <- "-57.7435783"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-64.0072633"
Evaluating: -64.0072633+3.5
 Parameter: ZMAX <- "-60.5072633"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.5884425"
Evaluating: -16.5884425-3.5
 Parameter: XMIN <- "-20.0884425"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-61.2435783"
Evaluating: -61.2435783-3.5
 Parameter: YMIN <- "-64.7435783"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-64.0072633"
Evaluating: -64.0072633-3.5
 Parameter: ZMIN <- "-67.5072633"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.0884425"
 Parameter: XMIN -> "-20.0884425"
 Parameter: YMAX -> "-57.7435783"
 Parameter: YMIN -> "-64.7435783"
 Parameter: ZMAX -> "-60.5072633"
 Parameter: ZMIN -> "-67.5072633"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "104"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "104" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "104"
Evaluating: 104
 Parameter: J <- "104"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "104" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.618558346"
Evaluating: 125.050557*(0.618558346-0.5)
 Parameter: XPOS <- "14.8257872"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "5.296162984E-02"
Evaluating: 125.050557*(5.296162984E-02-0.5)
 Parameter: YPOS <- "-55.9023972"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.876816026"
Evaluating: 152.572525*(0.876816026-0.5)+-4.51585405
 Parameter: ZPOS <- "52.9759185"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.9759185" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.9759185" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.8257872"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.8257872-0
 Parameter: XTRAN <- "14.8257872"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-55.9023972"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -55.9023972-0
 Parameter: YTRAN <- "-55.9023972"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.9759185"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 52.9759185-0
 Parameter: ZTRAN <- "52.9759185"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.8257872"
 Parameter: YTRAN -> "-55.9023972"
 Parameter: ZTRAN -> "52.9759185"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    14.825787  -55.902397   52.975918
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.387430318"
Evaluating: 0.387430318*360.0
 Parameter: XPHI <- "139.474914"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.928973275"
Evaluating: 0.928973275*360.0
 Parameter: YPHI <- "334.430379"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.79797404"
Evaluating: 0.79797404*360.0
 Parameter: ZPHI <- "287.270654"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.8257872"
 Parameter: YPOS -> "-55.9023972"
 Parameter: ZPOS -> "52.9759185"
 Parameter: XPHI -> "139.474914"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.760122    0.649781
    0.000000   -0.649781   -0.760122

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  139.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.8257872"
 Parameter: YPOS -> "-55.9023972"
 Parameter: ZPOS -> "52.9759185"
 Parameter: YPHI -> "334.430379"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.902061    0.000000    0.431608
    0.000000    1.000000    0.000000
   -0.431608    0.000000    0.902061

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   25.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.8257872"
 Parameter: YPOS -> "-55.9023972"
 Parameter: ZPOS -> "52.9759185"
 Parameter: ZPHI -> "287.270654"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.296886   -0.954913    0.000000
    0.954913    0.296886    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   72.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.825787 XMAX =   14.825787 XAVE =   14.825787
    YMIN =  -55.902397 YMAX =  -55.902397 YAVE =  -55.902397
    ZMIN =   52.975918 ZMAX =   52.975918 ZAVE =   52.975918
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.8257872"
Evaluating: 14.8257872+3.5
 Parameter: XMAX <- "18.3257872"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-55.9023972"
Evaluating: -55.9023972+3.5
 Parameter: YMAX <- "-52.4023972"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.9759185"
Evaluating: 52.9759185+3.5
 Parameter: ZMAX <- "56.4759185"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.8257872"
Evaluating: 14.8257872-3.5
 Parameter: XMIN <- "11.3257872"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-55.9023972"
Evaluating: -55.9023972-3.5
 Parameter: YMIN <- "-59.4023972"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.9759185"
Evaluating: 52.9759185-3.5
 Parameter: ZMIN <- "49.4759185"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.3257872"
 Parameter: XMIN -> "11.3257872"
 Parameter: YMAX -> "-52.4023972"
 Parameter: YMIN -> "-59.4023972"
 Parameter: ZMAX -> "56.4759185"
 Parameter: ZMIN -> "49.4759185"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "105"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "105" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "105" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "105"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.508913531"
Evaluating: 125.050557*(0.508913531-0.5)
 Parameter: XPOS <- "1.11464202"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.481285585"
Evaluating: 125.050557*(0.481285585-0.5)
 Parameter: YPOS <- "-2.34024802"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "6.628946831E-02"
Evaluating: 152.572525*(6.628946831E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-70.688165"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-70.688165" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.11464202"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.11464202-0
 Parameter: XTRAN <- "1.11464202"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.34024802"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.34024802-0
 Parameter: YTRAN <- "-2.34024802"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-70.688165"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -70.688165-0
 Parameter: ZTRAN <- "-70.688165"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.11464202"
 Parameter: YTRAN -> "-2.34024802"
 Parameter: ZTRAN -> "-70.688165"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     1.114642   -2.340248  -70.688165
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.326242868E-03"
Evaluating: 8.326242868E-03*360.0
 Parameter: XPHI <- "2.99744743"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.663589934"
Evaluating: 0.663589934*360.0
 Parameter: YPHI <- "238.892376"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.920601874"
Evaluating: 0.920601874*360.0
 Parameter: ZPHI <- "331.416675"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.11464202"
 Parameter: YPOS -> "-2.34024802"
 Parameter: ZPOS -> "-70.688165"
 Parameter: XPHI -> "2.99744743"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998632    0.052291
    0.000000   -0.052291    0.998632

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.11464202"
 Parameter: YPOS -> "-2.34024802"
 Parameter: ZPOS -> "-70.688165"
 Parameter: YPHI -> "238.892376"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.516647    0.000000    0.856198
    0.000000    1.000000    0.000000
   -0.856198    0.000000   -0.516647

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  121.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.11464202"
 Parameter: YPOS -> "-2.34024802"
 Parameter: ZPOS -> "-70.688165"
 Parameter: ZPHI -> "331.416675"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.878122   -0.478436    0.000000
    0.478436    0.878122    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.114642 XMAX =    1.114642 XAVE =    1.114642
    YMIN =   -2.340248 YMAX =   -2.340248 YAVE =   -2.340248
    ZMIN =  -70.688165 ZMAX =  -70.688165 ZAVE =  -70.688165
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.11464202"
Evaluating: 1.11464202+3.5
 Parameter: XMAX <- "4.61464202"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.34024802"
Evaluating: -2.34024802+3.5
 Parameter: YMAX <- "1.15975198"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-70.688165"
Evaluating: -70.688165+3.5
 Parameter: ZMAX <- "-67.188165"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.11464202"
Evaluating: 1.11464202-3.5
 Parameter: XMIN <- "-2.38535798"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.34024802"
Evaluating: -2.34024802-3.5
 Parameter: YMIN <- "-5.84024802"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-70.688165"
Evaluating: -70.688165-3.5
 Parameter: ZMIN <- "-74.188165"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.61464202"
 Parameter: XMIN -> "-2.38535798"
 Parameter: YMAX -> "1.15975198"
 Parameter: YMIN -> "-5.84024802"
 Parameter: ZMAX -> "-67.188165"
 Parameter: ZMIN -> "-74.188165"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "106"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "106" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "106" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "106"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.920616412"
Evaluating: 125.050557*(0.920616412-0.5)
 Parameter: XPOS <- "52.5983166"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.607425584"
Evaluating: 125.050557*(0.607425584-0.5)
 Parameter: YPOS <- "13.4336291"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.533297674"
Evaluating: 152.572525*(0.533297674-0.5)+-4.51585405
 Parameter: ZPOS <- "0.564456149"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.564456149" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.564456149" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "106" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "106"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.881165755"
Evaluating: 125.050557*(0.881165755-0.5)
 Parameter: XPOS <- "47.66499"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.855167666"
Evaluating: 125.050557*(0.855167666-0.5)
 Parameter: YPOS <- "44.4139145"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.678753795"
Evaluating: 152.572525*(0.678753795-0.5)+-4.51585405
 Parameter: ZPOS <- "22.7570638"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.7570638" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.7570638" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "47.66499"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 47.66499-0
 Parameter: XTRAN <- "47.66499"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.4139145"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.4139145-0
 Parameter: YTRAN <- "44.4139145"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.7570638"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.7570638-0
 Parameter: ZTRAN <- "22.7570638"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "47.66499"
 Parameter: YTRAN -> "44.4139145"
 Parameter: ZTRAN -> "22.7570638"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    47.664990   44.413914   22.757064
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.33997074"
Evaluating: 0.33997074*360.0
 Parameter: XPHI <- "122.389466"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.866686992"
Evaluating: 0.866686992*360.0
 Parameter: YPHI <- "312.007317"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.992065541"
Evaluating: 0.992065541*360.0
 Parameter: ZPHI <- "357.143595"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "47.66499"
 Parameter: YPOS -> "44.4139145"
 Parameter: ZPOS -> "22.7570638"
 Parameter: XPHI -> "122.389466"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.535672    0.844426
    0.000000   -0.844426   -0.535672

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  122.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "47.66499"
 Parameter: YPOS -> "44.4139145"
 Parameter: ZPOS -> "22.7570638"
 Parameter: YPHI -> "312.007317"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.669226    0.000000    0.743059
    0.000000    1.000000    0.000000
   -0.743059    0.000000    0.669226

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   47.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "47.66499"
 Parameter: YPOS -> "44.4139145"
 Parameter: ZPOS -> "22.7570638"
 Parameter: ZPHI -> "357.143595"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.998758   -0.049833    0.000000
    0.049833    0.998758    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    2.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.664990 XMAX =   47.664990 XAVE =   47.664990
    YMIN =   44.413914 YMAX =   44.413914 YAVE =   44.413914
    ZMIN =   22.757064 ZMAX =   22.757064 ZAVE =   22.757064
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "47.66499"
Evaluating: 47.66499+3.5
 Parameter: XMAX <- "51.16499"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.4139145"
Evaluating: 44.4139145+3.5
 Parameter: YMAX <- "47.9139145"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.7570638"
Evaluating: 22.7570638+3.5
 Parameter: ZMAX <- "26.2570638"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "47.66499"
Evaluating: 47.66499-3.5
 Parameter: XMIN <- "44.16499"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.4139145"
Evaluating: 44.4139145-3.5
 Parameter: YMIN <- "40.9139145"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.7570638"
Evaluating: 22.7570638-3.5
 Parameter: ZMIN <- "19.2570638"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "51.16499"
 Parameter: XMIN -> "44.16499"
 Parameter: YMAX -> "47.9139145"
 Parameter: YMIN -> "40.9139145"
 Parameter: ZMAX -> "26.2570638"
 Parameter: ZMIN -> "19.2570638"
 SELRPN>      9 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      5 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64521 POS      SOD      106      SOD     -**** MEMB     POPC     137      C11           3.6649
64521 POS      SOD      106      SOD     -**** MEMB     POPC     137      P             3.5626
64521 POS      SOD      106      SOD     -**** MEMB     POPC     137      O13           3.0364
64521 POS      SOD      106      SOD     -**** MEMB     POPC     137      O14           3.4700
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "106" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "106"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.917836102"
Evaluating: 125.050557*(0.917836102-0.5)
 Parameter: XPOS <- "52.2506373"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.122269506"
Evaluating: 125.050557*(0.122269506-0.5)
 Parameter: YPOS <- "-47.2354087"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.178720744"
Evaluating: 152.572525*(0.178720744-0.5)+-4.51585405
 Parameter: ZPOS <- "-53.5342414"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.5342414" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.664990 XMAX =   47.664990 XAVE =   47.664990
    YMIN =   44.413914 YMAX =   44.413914 YAVE =   44.413914
    ZMIN =   22.757064 ZMAX =   22.757064 ZAVE =   22.757064
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "52.2506373"
 RDCMND substituted energy or value "?XAVE" to "47.66499"
Evaluating: 52.2506373-47.66499
 Parameter: XTRAN <- "4.5856473"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.2354087"
 RDCMND substituted energy or value "?YAVE" to "44.4139145"
Evaluating: -47.2354087-44.4139145
 Parameter: YTRAN <- "-91.6493232"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.5342414"
 RDCMND substituted energy or value "?ZAVE" to "22.7570638"
Evaluating: -53.5342414-22.7570638
 Parameter: ZTRAN <- "-76.2913052"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.5856473"
 Parameter: YTRAN -> "-91.6493232"
 Parameter: ZTRAN -> "-76.2913052"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     4.585647  -91.649323  -76.291305
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.486995421"
Evaluating: 0.486995421*360.0
 Parameter: XPHI <- "175.318352"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.873161247"
Evaluating: 0.873161247*360.0
 Parameter: YPHI <- "314.338049"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.875663753"
Evaluating: 0.875663753*360.0
 Parameter: ZPHI <- "315.238951"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "52.2506373"
 Parameter: YPOS -> "-47.2354087"
 Parameter: ZPOS -> "-53.5342414"
 Parameter: XPHI -> "175.318352"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.996664    0.081619
    0.000000   -0.081619   -0.996664

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  175.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "52.2506373"
 Parameter: YPOS -> "-47.2354087"
 Parameter: ZPOS -> "-53.5342414"
 Parameter: YPHI -> "314.338049"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.698890    0.000000    0.715229
    0.000000    1.000000    0.000000
   -0.715229    0.000000    0.698890

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   45.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "52.2506373"
 Parameter: YPOS -> "-47.2354087"
 Parameter: ZPOS -> "-53.5342414"
 Parameter: ZPHI -> "315.238951"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.710050   -0.704152    0.000000
    0.704152    0.710050    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   44.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   52.250637 XMAX =   52.250637 XAVE =   52.250637
    YMIN =  -47.235409 YMAX =  -47.235409 YAVE =  -47.235409
    ZMIN =  -53.534241 ZMAX =  -53.534241 ZAVE =  -53.534241
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "52.2506373"
Evaluating: 52.2506373+3.5
 Parameter: XMAX <- "55.7506373"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.2354087"
Evaluating: -47.2354087+3.5
 Parameter: YMAX <- "-43.7354087"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.5342414"
Evaluating: -53.5342414+3.5
 Parameter: ZMAX <- "-50.0342414"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "52.2506373"
Evaluating: 52.2506373-3.5
 Parameter: XMIN <- "48.7506373"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.2354087"
Evaluating: -47.2354087-3.5
 Parameter: YMIN <- "-50.7354087"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.5342414"
Evaluating: -53.5342414-3.5
 Parameter: ZMIN <- "-57.0342414"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.7506373"
 Parameter: XMIN -> "48.7506373"
 Parameter: YMAX -> "-43.7354087"
 Parameter: YMIN -> "-50.7354087"
 Parameter: ZMAX -> "-50.0342414"
 Parameter: ZMIN -> "-57.0342414"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "107"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "107" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "107" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "107"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.454623737"
Evaluating: 125.050557*(0.454623737-0.5)
 Parameter: XPOS <- "-5.67432696"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.223402389"
Evaluating: 125.050557*(0.223402389-0.5)
 Parameter: YPOS <- "-34.5886853"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.996089717"
Evaluating: 152.572525*(0.996089717-0.5)+-4.51585405
 Parameter: ZPOS <- "71.1738067"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "71.1738067" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "71.1738067" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.67432696"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.67432696-0
 Parameter: XTRAN <- "-5.67432696"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.5886853"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.5886853-0
 Parameter: YTRAN <- "-34.5886853"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "71.1738067"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 71.1738067-0
 Parameter: ZTRAN <- "71.1738067"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.67432696"
 Parameter: YTRAN -> "-34.5886853"
 Parameter: ZTRAN -> "71.1738067"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -5.674327  -34.588685   71.173807
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.283148063"
Evaluating: 0.283148063*360.0
 Parameter: XPHI <- "101.933303"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.297219914"
Evaluating: 0.297219914*360.0
 Parameter: YPHI <- "106.999169"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.437327579"
Evaluating: 0.437327579*360.0
 Parameter: ZPHI <- "157.437928"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.67432696"
 Parameter: YPOS -> "-34.5886853"
 Parameter: ZPOS -> "71.1738067"
 Parameter: XPHI -> "101.933303"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.206773    0.978389
    0.000000   -0.978389   -0.206773

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  101.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.67432696"
 Parameter: YPOS -> "-34.5886853"
 Parameter: ZPOS -> "71.1738067"
 Parameter: YPHI -> "106.999169"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.292358    0.000000   -0.956309
    0.000000    1.000000    0.000000
    0.956309    0.000000   -0.292358

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  107.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.67432696"
 Parameter: YPOS -> "-34.5886853"
 Parameter: ZPOS -> "71.1738067"
 Parameter: ZPHI -> "157.437928"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.923464    0.383684    0.000000
   -0.383684   -0.923464    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  157.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.674327 XMAX =   -5.674327 XAVE =   -5.674327
    YMIN =  -34.588685 YMAX =  -34.588685 YAVE =  -34.588685
    ZMIN =   71.173807 ZMAX =   71.173807 ZAVE =   71.173807
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.67432696"
Evaluating: -5.67432696+3.5
 Parameter: XMAX <- "-2.17432696"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.5886853"
Evaluating: -34.5886853+3.5
 Parameter: YMAX <- "-31.0886853"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "71.1738067"
Evaluating: 71.1738067+3.5
 Parameter: ZMAX <- "74.6738067"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.67432696"
Evaluating: -5.67432696-3.5
 Parameter: XMIN <- "-9.17432696"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.5886853"
Evaluating: -34.5886853-3.5
 Parameter: YMIN <- "-38.0886853"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "71.1738067"
Evaluating: 71.1738067-3.5
 Parameter: ZMIN <- "67.6738067"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.17432696"
 Parameter: XMIN -> "-9.17432696"
 Parameter: YMAX -> "-31.0886853"
 Parameter: YMIN -> "-38.0886853"
 Parameter: ZMAX -> "74.6738067"
 Parameter: ZMIN -> "67.6738067"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "108"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "108" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "108"
Evaluating: 108
 Parameter: J <- "108"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "108" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "108"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.499791354"
Evaluating: 125.050557*(0.499791354-0.5)
 Parameter: XPOS <- "-2.609129852E-02"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.375681156"
Evaluating: 125.050557*(0.375681156-0.5)
 Parameter: YPOS <- "-15.5461407"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.875937852"
Evaluating: 152.572525*(0.875937852-0.5)+-4.51585405
 Parameter: ZPOS <- "52.8419333"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.8419333" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.8419333" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.609129852E-02"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.609129852E-02-0
 Parameter: XTRAN <- "-2.609129852E-02"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.5461407"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.5461407-0
 Parameter: YTRAN <- "-15.5461407"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.8419333"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 52.8419333-0
 Parameter: ZTRAN <- "52.8419333"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.609129852E-02"
 Parameter: YTRAN -> "-15.5461407"
 Parameter: ZTRAN -> "52.8419333"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -0.026091  -15.546141   52.841933
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.700440238"
Evaluating: 0.700440238*360.0
 Parameter: XPHI <- "252.158486"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.450879767"
Evaluating: 0.450879767*360.0
 Parameter: YPHI <- "162.316716"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.861674462"
Evaluating: 0.861674462*360.0
 Parameter: ZPHI <- "310.202806"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.609129852E-02"
 Parameter: YPOS -> "-15.5461407"
 Parameter: ZPOS -> "52.8419333"
 Parameter: XPHI -> "252.158486"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.306385   -0.951908
    0.000000    0.951908   -0.306385

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  107.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.609129852E-02"
 Parameter: YPOS -> "-15.5461407"
 Parameter: ZPOS -> "52.8419333"
 Parameter: YPHI -> "162.316716"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.952750    0.000000   -0.303755
    0.000000    1.000000    0.000000
    0.303755    0.000000   -0.952750

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  162.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.609129852E-02"
 Parameter: YPOS -> "-15.5461407"
 Parameter: ZPOS -> "52.8419333"
 Parameter: ZPHI -> "310.202806"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.645495   -0.763764    0.000000
    0.763764    0.645495    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   49.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.026091 XMAX =   -0.026091 XAVE =   -0.026091
    YMIN =  -15.546141 YMAX =  -15.546141 YAVE =  -15.546141
    ZMIN =   52.841933 ZMAX =   52.841933 ZAVE =   52.841933
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.609129852E-02"
Evaluating: -2.609129852E-02+3.5
 Parameter: XMAX <- "3.4739087"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.5461407"
Evaluating: -15.5461407+3.5
 Parameter: YMAX <- "-12.0461407"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.8419333"
Evaluating: 52.8419333+3.5
 Parameter: ZMAX <- "56.3419333"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.609129852E-02"
Evaluating: -2.609129852E-02-3.5
 Parameter: XMIN <- "-3.5260913"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.5461407"
Evaluating: -15.5461407-3.5
 Parameter: YMIN <- "-19.0461407"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.8419333"
Evaluating: 52.8419333-3.5
 Parameter: ZMIN <- "49.3419333"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.4739087"
 Parameter: XMIN -> "-3.5260913"
 Parameter: YMAX -> "-12.0461407"
 Parameter: YMIN -> "-19.0461407"
 Parameter: ZMAX -> "56.3419333"
 Parameter: ZMIN -> "49.3419333"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "109"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "109" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "109" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "109"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.691411492"
Evaluating: 125.050557*(0.691411492-0.5)
 Parameter: XPOS <- "23.9361137"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.811297195"
Evaluating: 125.050557*(0.811297195-0.5)
 Parameter: YPOS <- "38.9278876"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.877843946"
Evaluating: 152.572525*(0.877843946-0.5)+-4.51585405
 Parameter: ZPOS <- "53.1327508"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "53.1327508" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "53.1327508" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.9361137"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 23.9361137-0
 Parameter: XTRAN <- "23.9361137"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.9278876"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 38.9278876-0
 Parameter: YTRAN <- "38.9278876"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "53.1327508"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 53.1327508-0
 Parameter: ZTRAN <- "53.1327508"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.9361137"
 Parameter: YTRAN -> "38.9278876"
 Parameter: ZTRAN -> "53.1327508"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    23.936114   38.927888   53.132751
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.328325814"
Evaluating: 0.328325814*360.0
 Parameter: XPHI <- "118.197293"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.284137906"
Evaluating: 0.284137906*360.0
 Parameter: YPHI <- "102.289646"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.884573377E-02"
Evaluating: 5.884573377E-02*360.0
 Parameter: ZPHI <- "21.1844642"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.9361137"
 Parameter: YPOS -> "38.9278876"
 Parameter: ZPOS -> "53.1327508"
 Parameter: XPHI -> "118.197293"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.472509    0.881326
    0.000000   -0.881326   -0.472509

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  118.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.9361137"
 Parameter: YPOS -> "38.9278876"
 Parameter: ZPOS -> "53.1327508"
 Parameter: YPHI -> "102.289646"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.212854    0.000000   -0.977084
    0.000000    1.000000    0.000000
    0.977084    0.000000   -0.212854

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  102.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.9361137"
 Parameter: YPOS -> "38.9278876"
 Parameter: ZPOS -> "53.1327508"
 Parameter: ZPHI -> "21.1844642"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.932422    0.361372    0.000000
   -0.361372    0.932422    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   21.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.936114 XMAX =   23.936114 XAVE =   23.936114
    YMIN =   38.927888 YMAX =   38.927888 YAVE =   38.927888
    ZMIN =   53.132751 ZMAX =   53.132751 ZAVE =   53.132751
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.9361137"
Evaluating: 23.9361137+3.5
 Parameter: XMAX <- "27.4361137"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.9278876"
Evaluating: 38.9278876+3.5
 Parameter: YMAX <- "42.4278876"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "53.1327508"
Evaluating: 53.1327508+3.5
 Parameter: ZMAX <- "56.6327508"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.9361137"
Evaluating: 23.9361137-3.5
 Parameter: XMIN <- "20.4361137"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.9278876"
Evaluating: 38.9278876-3.5
 Parameter: YMIN <- "35.4278876"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "53.1327508"
Evaluating: 53.1327508-3.5
 Parameter: ZMIN <- "49.6327508"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.4361137"
 Parameter: XMIN -> "20.4361137"
 Parameter: YMAX -> "42.4278876"
 Parameter: YMIN -> "35.4278876"
 Parameter: ZMAX -> "56.6327508"
 Parameter: ZMIN -> "49.6327508"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "110"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "110" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "110" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "110"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.626202785"
Evaluating: 125.050557*(0.626202785-0.5)
 Parameter: XPOS <- "15.7817286"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.483482618"
Evaluating: 125.050557*(0.483482618-0.5)
 Parameter: YPOS <- "-2.06550782"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.175182092"
Evaluating: 152.572525*(0.175182092-0.5)+-4.51585405
 Parameter: ZPOS <- "-54.0741424"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.0741424" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.7817286"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.7817286-0
 Parameter: XTRAN <- "15.7817286"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.06550782"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.06550782-0
 Parameter: YTRAN <- "-2.06550782"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.0741424"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.0741424-0
 Parameter: ZTRAN <- "-54.0741424"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.7817286"
 Parameter: YTRAN -> "-2.06550782"
 Parameter: ZTRAN -> "-54.0741424"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    15.781729   -2.065508  -54.074142
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225077504"
Evaluating: 0.225077504*360.0
 Parameter: XPHI <- "81.0279014"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.305671586"
Evaluating: 0.305671586*360.0
 Parameter: YPHI <- "110.041771"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.210298505"
Evaluating: 0.210298505*360.0
 Parameter: ZPHI <- "75.7074618"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.7817286"
 Parameter: YPOS -> "-2.06550782"
 Parameter: ZPOS -> "-54.0741424"
 Parameter: XPHI -> "81.0279014"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.155953    0.987764
    0.000000   -0.987764    0.155953

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   81.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.7817286"
 Parameter: YPOS -> "-2.06550782"
 Parameter: ZPOS -> "-54.0741424"
 Parameter: YPHI -> "110.041771"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.342705    0.000000   -0.939443
    0.000000    1.000000    0.000000
    0.939443    0.000000   -0.342705

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  110.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.7817286"
 Parameter: YPOS -> "-2.06550782"
 Parameter: ZPOS -> "-54.0741424"
 Parameter: ZPHI -> "75.7074618"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.246873    0.969048    0.000000
   -0.969048    0.246873    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   75.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.781729 XMAX =   15.781729 XAVE =   15.781729
    YMIN =   -2.065508 YMAX =   -2.065508 YAVE =   -2.065508
    ZMIN =  -54.074142 ZMAX =  -54.074142 ZAVE =  -54.074142
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.7817286"
Evaluating: 15.7817286+3.5
 Parameter: XMAX <- "19.2817286"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.06550782"
Evaluating: -2.06550782+3.5
 Parameter: YMAX <- "1.43449218"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.0741424"
Evaluating: -54.0741424+3.5
 Parameter: ZMAX <- "-50.5741424"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.7817286"
Evaluating: 15.7817286-3.5
 Parameter: XMIN <- "12.2817286"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.06550782"
Evaluating: -2.06550782-3.5
 Parameter: YMIN <- "-5.56550782"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.0741424"
Evaluating: -54.0741424-3.5
 Parameter: ZMIN <- "-57.5741424"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.2817286"
 Parameter: XMIN -> "12.2817286"
 Parameter: YMAX -> "1.43449218"
 Parameter: YMIN -> "-5.56550782"
 Parameter: ZMAX -> "-50.5741424"
 Parameter: ZMIN -> "-57.5741424"
 SELRPN>     17 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     10 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64525 POS      SOD      110      SOD     -**** PROA     THR      1479     N             4.9119
64525 POS      SOD      110      SOD     -**** PROA     THR      1479     CA            3.6550
64525 POS      SOD      110      SOD     -**** PROA     THR      1479     C             3.0552
64525 POS      SOD      110      SOD     -**** PROA     THR      1479     O             3.9480
64525 POS      SOD      110      SOD     -**** PROA     GLU      1480     N             2.0214
64525 POS      SOD      110      SOD     -**** PROA     GLU      1480     CA            2.3618
64525 POS      SOD      110      SOD     -**** PROA     GLU      1480     CB            2.1312
64525 POS      SOD      110      SOD     -**** PROA     GLU      1480     CG            2.7443
64525 POS      SOD      110      SOD     -**** PROA     GLU      1480     C             3.7175
64525 POS      SOD      110      SOD     -**** PROA     GLU      1480     O             4.2250
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "110" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "110"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.702417225"
Evaluating: 125.050557*(0.702417225-0.5)
 Parameter: XPOS <- "25.3123867"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.526686506"
Evaluating: 125.050557*(0.526686506-0.5)
 Parameter: YPOS <- "3.33716244"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.985748815"
Evaluating: 152.572525*(0.985748815-0.5)+-4.51585405
 Parameter: ZPOS <- "69.5960692"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.5960692" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.5960692" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.781729 XMAX =   15.781729 XAVE =   15.781729
    YMIN =   -2.065508 YMAX =   -2.065508 YAVE =   -2.065508
    ZMIN =  -54.074142 ZMAX =  -54.074142 ZAVE =  -54.074142
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.3123867"
 RDCMND substituted energy or value "?XAVE" to "15.7817286"
Evaluating: 25.3123867-15.7817286
 Parameter: XTRAN <- "9.5306581"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.33716244"
 RDCMND substituted energy or value "?YAVE" to "-2.06550782"
Evaluating: 3.33716244--2.06550782
 Parameter: YTRAN <- "5.40267026"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.5960692"
 RDCMND substituted energy or value "?ZAVE" to "-54.0741424"
Evaluating: 69.5960692--54.0741424
 Parameter: ZTRAN <- "123.670212"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.5306581"
 Parameter: YTRAN -> "5.40267026"
 Parameter: ZTRAN -> "123.670212"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     9.530658    5.402670  123.670212
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.669666027"
Evaluating: 0.669666027*360.0
 Parameter: XPHI <- "241.07977"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.562144371"
Evaluating: 0.562144371*360.0
 Parameter: YPHI <- "202.371974"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.175240444"
Evaluating: 0.175240444*360.0
 Parameter: ZPHI <- "63.0865598"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.3123867"
 Parameter: YPOS -> "3.33716244"
 Parameter: ZPOS -> "69.5960692"
 Parameter: XPHI -> "241.07977"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.483591   -0.875294
    0.000000    0.875294   -0.483591

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.3123867"
 Parameter: YPOS -> "3.33716244"
 Parameter: ZPOS -> "69.5960692"
 Parameter: YPHI -> "202.371974"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.924732    0.000000    0.380618
    0.000000    1.000000    0.000000
   -0.380618    0.000000   -0.924732

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  157.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.3123867"
 Parameter: YPOS -> "3.33716244"
 Parameter: ZPOS -> "69.5960692"
 Parameter: ZPHI -> "63.0865598"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.452644    0.891691    0.000000
   -0.891691    0.452644    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   63.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.312386 XMAX =   25.312386 XAVE =   25.312386
    YMIN =    3.337162 YMAX =    3.337162 YAVE =    3.337162
    ZMIN =   69.596069 ZMAX =   69.596069 ZAVE =   69.596069
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.3123864"
Evaluating: 25.3123864+3.5
 Parameter: XMAX <- "28.8123864"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.33716235"
Evaluating: 3.33716235+3.5
 Parameter: YMAX <- "6.83716235"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.5960694"
Evaluating: 69.5960694+3.5
 Parameter: ZMAX <- "73.0960694"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.3123864"
Evaluating: 25.3123864-3.5
 Parameter: XMIN <- "21.8123864"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.33716235"
Evaluating: 3.33716235-3.5
 Parameter: YMIN <- "-0.16283765"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.5960694"
Evaluating: 69.5960694-3.5
 Parameter: ZMIN <- "66.0960694"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.8123864"
 Parameter: XMIN -> "21.8123864"
 Parameter: YMAX -> "6.83716235"
 Parameter: YMIN -> "-0.16283765"
 Parameter: ZMAX -> "73.0960694"
 Parameter: ZMIN -> "66.0960694"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "111"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "111" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "111" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "111"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.622734819"
Evaluating: 125.050557*(0.622734819-0.5)
 Parameter: XPOS <- "15.3480575"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.641523523"
Evaluating: 125.050557*(0.641523523-0.5)
 Parameter: YPOS <- "17.6975954"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.899370048"
Evaluating: 152.572525*(0.899370048-0.5)+-4.51585405
 Parameter: ZPOS <- "56.4170426"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.4170426" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.4170426" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.3480575"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.3480575-0
 Parameter: XTRAN <- "15.3480575"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.6975954"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.6975954-0
 Parameter: YTRAN <- "17.6975954"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.4170426"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 56.4170426-0
 Parameter: ZTRAN <- "56.4170426"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.3480575"
 Parameter: YTRAN -> "17.6975954"
 Parameter: ZTRAN -> "56.4170426"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    15.348057   17.697595   56.417043
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.261230689"
Evaluating: 0.261230689*360.0
 Parameter: XPHI <- "94.043048"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.945962359"
Evaluating: 0.945962359*360.0
 Parameter: YPHI <- "340.546449"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.832823879"
Evaluating: 0.832823879*360.0
 Parameter: ZPHI <- "299.816596"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.3480575"
 Parameter: YPOS -> "17.6975954"
 Parameter: ZPOS -> "56.4170426"
 Parameter: XPHI -> "94.043048"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.070506    0.997511
    0.000000   -0.997511   -0.070506

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   94.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.3480575"
 Parameter: YPOS -> "17.6975954"
 Parameter: ZPOS -> "56.4170426"
 Parameter: YPHI -> "340.546449"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.942912    0.000000    0.333043
    0.000000    1.000000    0.000000
   -0.333043    0.000000    0.942912

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   19.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.3480575"
 Parameter: YPOS -> "17.6975954"
 Parameter: ZPOS -> "56.4170426"
 Parameter: ZPHI -> "299.816596"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.497225   -0.867621    0.000000
    0.867621    0.497225    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.348057 XMAX =   15.348057 XAVE =   15.348057
    YMIN =   17.697595 YMAX =   17.697595 YAVE =   17.697595
    ZMIN =   56.417043 ZMAX =   56.417043 ZAVE =   56.417043
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.3480575"
Evaluating: 15.3480575+3.5
 Parameter: XMAX <- "18.8480575"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.6975954"
Evaluating: 17.6975954+3.5
 Parameter: YMAX <- "21.1975954"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.4170426"
Evaluating: 56.4170426+3.5
 Parameter: ZMAX <- "59.9170426"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.3480575"
Evaluating: 15.3480575-3.5
 Parameter: XMIN <- "11.8480575"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.6975954"
Evaluating: 17.6975954-3.5
 Parameter: YMIN <- "14.1975954"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.4170426"
Evaluating: 56.4170426-3.5
 Parameter: ZMIN <- "52.9170426"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.8480575"
 Parameter: XMIN -> "11.8480575"
 Parameter: YMAX -> "21.1975954"
 Parameter: YMIN -> "14.1975954"
 Parameter: ZMAX -> "59.9170426"
 Parameter: ZMIN -> "52.9170426"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "112"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "112" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "112"
Evaluating: 112
 Parameter: J <- "112"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "112" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "112"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.930330632"
Evaluating: 125.050557*(0.930330632-0.5)
 Parameter: XPOS <- "53.8130852"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.237636708"
Evaluating: 125.050557*(0.237636708-0.5)
 Parameter: YPOS <- "-32.8086758"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.89870122"
Evaluating: 152.572525*(0.89870122-0.5)+-4.51585405
 Parameter: ZPOS <- "56.3149978"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.3149978" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.3149978" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "53.8130852"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 53.8130852-0
 Parameter: XTRAN <- "53.8130852"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.8086758"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.8086758-0
 Parameter: YTRAN <- "-32.8086758"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.3149978"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 56.3149978-0
 Parameter: ZTRAN <- "56.3149978"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "53.8130852"
 Parameter: YTRAN -> "-32.8086758"
 Parameter: ZTRAN -> "56.3149978"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    53.813085  -32.808676   56.314998
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.902793204"
Evaluating: 0.902793204*360.0
 Parameter: XPHI <- "325.005553"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.754706472E-02"
Evaluating: 7.754706472E-02*360.0
 Parameter: YPHI <- "27.9169433"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.567920207"
Evaluating: 0.567920207*360.0
 Parameter: ZPHI <- "204.451275"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "53.8130852"
 Parameter: YPOS -> "-32.8086758"
 Parameter: ZPOS -> "56.3149978"
 Parameter: XPHI -> "325.005553"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.819208   -0.573497
    0.000000    0.573497    0.819208

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   34.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "53.8130852"
 Parameter: YPOS -> "-32.8086758"
 Parameter: ZPOS -> "56.3149978"
 Parameter: YPHI -> "27.9169433"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.883627    0.000000   -0.468191
    0.000000    1.000000    0.000000
    0.468191    0.000000    0.883627

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   27.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "53.8130852"
 Parameter: YPOS -> "-32.8086758"
 Parameter: ZPOS -> "56.3149978"
 Parameter: ZPHI -> "204.451275"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.910314   -0.413919    0.000000
    0.413919   -0.910314    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  155.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   53.813085 XMAX =   53.813085 XAVE =   53.813085
    YMIN =  -32.808676 YMAX =  -32.808676 YAVE =  -32.808676
    ZMIN =   56.314998 ZMAX =   56.314998 ZAVE =   56.314998
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "53.8130852"
Evaluating: 53.8130852+3.5
 Parameter: XMAX <- "57.3130852"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.8086758"
Evaluating: -32.8086758+3.5
 Parameter: YMAX <- "-29.3086758"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.3149978"
Evaluating: 56.3149978+3.5
 Parameter: ZMAX <- "59.8149978"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "53.8130852"
Evaluating: 53.8130852-3.5
 Parameter: XMIN <- "50.3130852"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.8086758"
Evaluating: -32.8086758-3.5
 Parameter: YMIN <- "-36.3086758"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.3149978"
Evaluating: 56.3149978-3.5
 Parameter: ZMIN <- "52.8149978"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.3130852"
 Parameter: XMIN -> "50.3130852"
 Parameter: YMAX -> "-29.3086758"
 Parameter: YMIN -> "-36.3086758"
 Parameter: ZMAX -> "59.8149978"
 Parameter: ZMIN -> "52.8149978"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "113"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "113" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "113"
Evaluating: 113
 Parameter: J <- "113"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "113" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "113"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.250407894"
Evaluating: 125.050557*(0.250407894-0.5)
 Parameter: XPOS <- "-31.2116319"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.318012878"
Evaluating: 125.050557*(0.318012878-0.5)
 Parameter: YPOS <- "-22.757591"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.769097161"
Evaluating: 152.572525*(0.769097161-0.5)+-4.51585405
 Parameter: ZPOS <- "36.5409793"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.5409793" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.5409793" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.2116319"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.2116319-0
 Parameter: XTRAN <- "-31.2116319"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.757591"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.757591-0
 Parameter: YTRAN <- "-22.757591"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.5409793"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.5409793-0
 Parameter: ZTRAN <- "36.5409793"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.2116319"
 Parameter: YTRAN -> "-22.757591"
 Parameter: ZTRAN -> "36.5409793"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -31.211632  -22.757591   36.540979
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.674788694"
Evaluating: 0.674788694*360.0
 Parameter: XPHI <- "242.92393"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.352192359"
Evaluating: 0.352192359*360.0
 Parameter: YPHI <- "126.789249"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.696784719"
Evaluating: 0.696784719*360.0
 Parameter: ZPHI <- "250.842499"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.2116319"
 Parameter: YPOS -> "-22.757591"
 Parameter: ZPOS -> "36.5409793"
 Parameter: XPHI -> "242.92393"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.455173   -0.890403
    0.000000    0.890403   -0.455173

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  117.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.2116319"
 Parameter: YPOS -> "-22.757591"
 Parameter: ZPOS -> "36.5409793"
 Parameter: YPHI -> "126.789249"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.598873    0.000000   -0.800844
    0.000000    1.000000    0.000000
    0.800844    0.000000   -0.598873

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  126.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.2116319"
 Parameter: YPOS -> "-22.757591"
 Parameter: ZPOS -> "36.5409793"
 Parameter: ZPHI -> "250.842499"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.328166   -0.944620    0.000000
    0.944620   -0.328166    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  109.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.211632 XMAX =  -31.211632 XAVE =  -31.211632
    YMIN =  -22.757591 YMAX =  -22.757591 YAVE =  -22.757591
    ZMIN =   36.540979 ZMAX =   36.540979 ZAVE =   36.540979
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.2116319"
Evaluating: -31.2116319+3.5
 Parameter: XMAX <- "-27.7116319"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.757591"
Evaluating: -22.757591+3.5
 Parameter: YMAX <- "-19.257591"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.5409793"
Evaluating: 36.5409793+3.5
 Parameter: ZMAX <- "40.0409793"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.2116319"
Evaluating: -31.2116319-3.5
 Parameter: XMIN <- "-34.7116319"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.757591"
Evaluating: -22.757591-3.5
 Parameter: YMIN <- "-26.257591"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.5409793"
Evaluating: 36.5409793-3.5
 Parameter: ZMIN <- "33.0409793"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.7116319"
 Parameter: XMIN -> "-34.7116319"
 Parameter: YMAX -> "-19.257591"
 Parameter: YMIN -> "-26.257591"
 Parameter: ZMAX -> "40.0409793"
 Parameter: ZMIN -> "33.0409793"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "114"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "114" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "114"
Evaluating: 114
 Parameter: J <- "114"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "114" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "114"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.491786902"
Evaluating: 125.050557*(0.491786902-0.5)
 Parameter: XPOS <- "-1.02705248"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.106282393"
Evaluating: 125.050557*(0.106282393-0.5)
 Parameter: YPOS <- "-49.2346061"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.629548431"
Evaluating: 152.572525*(0.629548431-0.5)+-4.51585405
 Parameter: ZPOS <- "15.2496772"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.2496772" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.2496772" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.02705248"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -1.02705248-0
 Parameter: XTRAN <- "-1.02705248"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.2346061"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -49.2346061-0
 Parameter: YTRAN <- "-49.2346061"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.2496772"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.2496772-0
 Parameter: ZTRAN <- "15.2496772"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-1.02705248"
 Parameter: YTRAN -> "-49.2346061"
 Parameter: ZTRAN -> "15.2496772"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -1.027052  -49.234606   15.249677
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.946796799"
Evaluating: 0.946796799*360.0
 Parameter: XPHI <- "340.846848"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.659337677"
Evaluating: 0.659337677*360.0
 Parameter: YPHI <- "237.361564"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.355021686"
Evaluating: 0.355021686*360.0
 Parameter: ZPHI <- "127.807807"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.02705248"
 Parameter: YPOS -> "-49.2346061"
 Parameter: ZPOS -> "15.2496772"
 Parameter: XPHI -> "340.846848"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.944645   -0.328094
    0.000000    0.328094    0.944645

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   19.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.02705248"
 Parameter: YPOS -> "-49.2346061"
 Parameter: ZPOS -> "15.2496772"
 Parameter: YPHI -> "237.361564"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.539336    0.000000    0.842091
    0.000000    1.000000    0.000000
   -0.842091    0.000000   -0.539336

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  122.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.02705248"
 Parameter: YPOS -> "-49.2346061"
 Parameter: ZPOS -> "15.2496772"
 Parameter: ZPHI -> "127.807807"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.613015    0.790071    0.000000
   -0.790071   -0.613015    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  127.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.027052 XMAX =   -1.027052 XAVE =   -1.027052
    YMIN =  -49.234606 YMAX =  -49.234606 YAVE =  -49.234606
    ZMIN =   15.249677 ZMAX =   15.249677 ZAVE =   15.249677
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.02705248"
Evaluating: -1.02705248+3.5
 Parameter: XMAX <- "2.47294752"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.2346061"
Evaluating: -49.2346061+3.5
 Parameter: YMAX <- "-45.7346061"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.2496772"
Evaluating: 15.2496772+3.5
 Parameter: ZMAX <- "18.7496772"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.02705248"
Evaluating: -1.02705248-3.5
 Parameter: XMIN <- "-4.52705248"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.2346061"
Evaluating: -49.2346061-3.5
 Parameter: YMIN <- "-52.7346061"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.2496772"
Evaluating: 15.2496772-3.5
 Parameter: ZMIN <- "11.7496772"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.47294752"
 Parameter: XMIN -> "-4.52705248"
 Parameter: YMAX -> "-45.7346061"
 Parameter: YMIN -> "-52.7346061"
 Parameter: ZMAX -> "18.7496772"
 Parameter: ZMIN -> "11.7496772"
 SELRPN>     29 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      9 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64529 POS      SOD      114      SOD     -1727 PROA     VAL      137      O             5.4549
64529 POS      SOD      114      SOD     -1781 PROA     GLN      141      N             4.2044
64529 POS      SOD      114      SOD     -1783 PROA     GLN      141      CA            2.9701
64529 POS      SOD      114      SOD     -1785 PROA     GLN      141      CB            2.4968
64529 POS      SOD      114      SOD     -1788 PROA     GLN      141      CG            1.7905
64529 POS      SOD      114      SOD     -1791 PROA     GLN      141      CD            2.6959
64529 POS      SOD      114      SOD     -1792 PROA     GLN      141      OE1           3.5383
64529 POS      SOD      114      SOD     -1793 PROA     GLN      141      NE2           3.2305
64529 POS      SOD      114      SOD     -1797 PROA     GLN      141      O             3.7173
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "114"
Evaluating: 114
 Parameter: J <- "114"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "114" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "114"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.456835085"
Evaluating: 125.050557*(0.456835085-0.5)
 Parameter: XPOS <- "-5.39779666"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.941140056"
Evaluating: 125.050557*(0.941140056-0.5)
 Parameter: YPOS <- "55.1648097"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.365428647"
Evaluating: 152.572525*(0.365428647-0.5)+-4.51585405
 Parameter: ZPOS <- "-25.0477452"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.0477452" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.027052 XMAX =   -1.027052 XAVE =   -1.027052
    YMIN =  -49.234606 YMAX =  -49.234606 YAVE =  -49.234606
    ZMIN =   15.249677 ZMAX =   15.249677 ZAVE =   15.249677
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.39779666"
 RDCMND substituted energy or value "?XAVE" to "-1.02705248"
Evaluating: -5.39779666--1.02705248
 Parameter: XTRAN <- "-4.37074418"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "55.1648097"
 RDCMND substituted energy or value "?YAVE" to "-49.2346061"
Evaluating: 55.1648097--49.2346061
 Parameter: YTRAN <- "104.399416"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.0477452"
 RDCMND substituted energy or value "?ZAVE" to "15.2496772"
Evaluating: -25.0477452-15.2496772
 Parameter: ZTRAN <- "-40.2974224"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.37074418"
 Parameter: YTRAN -> "104.399416"
 Parameter: ZTRAN -> "-40.2974224"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -4.370744  104.399416  -40.297422
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.770978669"
Evaluating: 0.770978669*360.0
 Parameter: XPHI <- "277.552321"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.480691106E-02"
Evaluating: 1.480691106E-02*360.0
 Parameter: YPHI <- "5.33048798"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.276411354"
Evaluating: 0.276411354*360.0
 Parameter: ZPHI <- "99.5080874"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.39779666"
 Parameter: YPOS -> "55.1648097"
 Parameter: ZPOS -> "-25.0477452"
 Parameter: XPHI -> "277.552321"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.131431   -0.991325
    0.000000    0.991325    0.131431

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   82.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.39779666"
 Parameter: YPOS -> "55.1648097"
 Parameter: ZPOS -> "-25.0477452"
 Parameter: YPHI -> "5.33048798"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.995675    0.000000   -0.092900
    0.000000    1.000000    0.000000
    0.092900    0.000000    0.995675

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    5.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.39779666"
 Parameter: YPOS -> "55.1648097"
 Parameter: ZPOS -> "-25.0477452"
 Parameter: ZPHI -> "99.5080874"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.165187    0.986262    0.000000
   -0.986262   -0.165187    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   99.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.397797 XMAX =   -5.397797 XAVE =   -5.397797
    YMIN =   55.164810 YMAX =   55.164810 YAVE =   55.164810
    ZMIN =  -25.047745 ZMAX =  -25.047745 ZAVE =  -25.047745
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.39779663"
Evaluating: -5.39779663+3.5
 Parameter: XMAX <- "-1.89779663"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "55.1648097"
Evaluating: 55.1648097+3.5
 Parameter: YMAX <- "58.6648097"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.047745"
Evaluating: -25.047745+3.5
 Parameter: ZMAX <- "-21.547745"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.39779663"
Evaluating: -5.39779663-3.5
 Parameter: XMIN <- "-8.89779663"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "55.1648097"
Evaluating: 55.1648097-3.5
 Parameter: YMIN <- "51.6648097"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.047745"
Evaluating: -25.047745-3.5
 Parameter: ZMIN <- "-28.547745"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.89779663"
 Parameter: XMIN -> "-8.89779663"
 Parameter: YMAX -> "58.6648097"
 Parameter: YMIN -> "51.6648097"
 Parameter: ZMAX -> "-21.547745"
 Parameter: ZMIN -> "-28.547745"
 SELRPN>      2 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "115"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "115" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "115"
Evaluating: 115
 Parameter: J <- "115"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "115" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "115"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.901799459"
Evaluating: 125.050557*(0.901799459-0.5)
 Parameter: XPOS <- "50.2452462"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.68414117"
Evaluating: 125.050557*(0.68414117-0.5)
 Parameter: YPOS <- "23.0269559"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.701776642"
Evaluating: 152.572525*(0.701776642-0.5)+-4.51585405
 Parameter: ZPOS <- "26.2697177"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.2697177" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.2697177" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.2452462"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 50.2452462-0
 Parameter: XTRAN <- "50.2452462"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.0269559"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.0269559-0
 Parameter: YTRAN <- "23.0269559"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.2697177"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.2697177-0
 Parameter: ZTRAN <- "26.2697177"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.2452462"
 Parameter: YTRAN -> "23.0269559"
 Parameter: ZTRAN -> "26.2697177"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    50.245246   23.026956   26.269718
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.577640639"
Evaluating: 0.577640639*360.0
 Parameter: XPHI <- "207.95063"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.837504295"
Evaluating: 0.837504295*360.0
 Parameter: YPHI <- "301.501546"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.507365502"
Evaluating: 0.507365502*360.0
 Parameter: ZPHI <- "182.651581"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.2452462"
 Parameter: YPOS -> "23.0269559"
 Parameter: ZPOS -> "26.2697177"
 Parameter: XPHI -> "207.95063"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.883352   -0.468711
    0.000000    0.468711   -0.883352

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  152.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.2452462"
 Parameter: YPOS -> "23.0269559"
 Parameter: ZPOS -> "26.2697177"
 Parameter: YPHI -> "301.501546"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.522522    0.000000    0.852626
    0.000000    1.000000    0.000000
   -0.852626    0.000000    0.522522

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   58.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.2452462"
 Parameter: YPOS -> "23.0269559"
 Parameter: ZPOS -> "26.2697177"
 Parameter: ZPHI -> "182.651581"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.998929   -0.046262    0.000000
    0.046262   -0.998929    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  177.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.245246 XMAX =   50.245246 XAVE =   50.245246
    YMIN =   23.026956 YMAX =   23.026956 YAVE =   23.026956
    ZMIN =   26.269718 ZMAX =   26.269718 ZAVE =   26.269718
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.2452462"
Evaluating: 50.2452462+3.5
 Parameter: XMAX <- "53.7452462"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.0269559"
Evaluating: 23.0269559+3.5
 Parameter: YMAX <- "26.5269559"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.2697177"
Evaluating: 26.2697177+3.5
 Parameter: ZMAX <- "29.7697177"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.2452462"
Evaluating: 50.2452462-3.5
 Parameter: XMIN <- "46.7452462"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.0269559"
Evaluating: 23.0269559-3.5
 Parameter: YMIN <- "19.5269559"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.2697177"
Evaluating: 26.2697177-3.5
 Parameter: ZMIN <- "22.7697177"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.7452462"
 Parameter: XMIN -> "46.7452462"
 Parameter: YMAX -> "26.5269559"
 Parameter: YMIN -> "19.5269559"
 Parameter: ZMAX -> "29.7697177"
 Parameter: ZMIN -> "22.7697177"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "116"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "116" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "116"
Evaluating: 116
 Parameter: J <- "116"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "116" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "116"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.835729092"
Evaluating: 125.050557*(0.835729092-0.5)
 Parameter: XPOS <- "41.98311"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.207316102"
Evaluating: 125.050557*(0.207316102-0.5)
 Parameter: YPOS <- "-36.6002845"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.162731206"
Evaluating: 152.572525*(0.162731206-0.5)+-4.51585405
 Parameter: ZPOS <- "-55.9738056"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.9738056" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.98311"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.98311-0
 Parameter: XTRAN <- "41.98311"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.6002845"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -36.6002845-0
 Parameter: YTRAN <- "-36.6002845"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.9738056"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.9738056-0
 Parameter: ZTRAN <- "-55.9738056"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.98311"
 Parameter: YTRAN -> "-36.6002845"
 Parameter: ZTRAN -> "-55.9738056"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    41.983110  -36.600285  -55.973806
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.968935564"
Evaluating: 0.968935564*360.0
 Parameter: XPHI <- "348.816803"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.271643328"
Evaluating: 0.271643328*360.0
 Parameter: YPHI <- "97.7915981"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.195494408E-02"
Evaluating: 7.195494408E-02*360.0
 Parameter: ZPHI <- "25.9037799"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.98311"
 Parameter: YPOS -> "-36.6002845"
 Parameter: ZPOS -> "-55.9738056"
 Parameter: XPHI -> "348.816803"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.981012   -0.193947
    0.000000    0.193947    0.981012

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   11.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.98311"
 Parameter: YPOS -> "-36.6002845"
 Parameter: ZPOS -> "-55.9738056"
 Parameter: YPHI -> "97.7915981"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.135570    0.000000   -0.990768
    0.000000    1.000000    0.000000
    0.990768    0.000000   -0.135570

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   97.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.98311"
 Parameter: YPOS -> "-36.6002845"
 Parameter: ZPOS -> "-55.9738056"
 Parameter: ZPHI -> "25.9037799"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.899529    0.436861    0.000000
   -0.436861    0.899529    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   25.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.983110 XMAX =   41.983110 XAVE =   41.983110
    YMIN =  -36.600285 YMAX =  -36.600285 YAVE =  -36.600285
    ZMIN =  -55.973806 ZMAX =  -55.973806 ZAVE =  -55.973806
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.98311"
Evaluating: 41.98311+3.5
 Parameter: XMAX <- "45.48311"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.6002845"
Evaluating: -36.6002845+3.5
 Parameter: YMAX <- "-33.1002845"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.9738056"
Evaluating: -55.9738056+3.5
 Parameter: ZMAX <- "-52.4738056"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.98311"
Evaluating: 41.98311-3.5
 Parameter: XMIN <- "38.48311"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.6002845"
Evaluating: -36.6002845-3.5
 Parameter: YMIN <- "-40.1002845"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.9738056"
Evaluating: -55.9738056-3.5
 Parameter: ZMIN <- "-59.4738056"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.48311"
 Parameter: XMIN -> "38.48311"
 Parameter: YMAX -> "-33.1002845"
 Parameter: YMIN -> "-40.1002845"
 Parameter: ZMAX -> "-52.4738056"
 Parameter: ZMIN -> "-59.4738056"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "117"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "117" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "117" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "117"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.999730761"
Evaluating: 125.050557*(0.999730761-0.5)
 Parameter: XPOS <- "62.49161"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.189719397"
Evaluating: 125.050557*(0.189719397-0.5)
 Parameter: YPOS <- "-38.8007622"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.428521977"
Evaluating: 152.572525*(0.428521977-0.5)+-4.51585405
 Parameter: ZPOS <- "-15.4214365"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.4214365" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "62.49161"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 62.49161-0
 Parameter: XTRAN <- "62.49161"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.8007622"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.8007622-0
 Parameter: YTRAN <- "-38.8007622"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.4214365"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.4214365-0
 Parameter: ZTRAN <- "-15.4214365"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "62.49161"
 Parameter: YTRAN -> "-38.8007622"
 Parameter: ZTRAN -> "-15.4214365"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    62.491610  -38.800762  -15.421437
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.746901529"
Evaluating: 0.746901529*360.0
 Parameter: XPHI <- "268.88455"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.207087772"
Evaluating: 0.207087772*360.0
 Parameter: YPHI <- "74.5515979"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.830666133"
Evaluating: 0.830666133*360.0
 Parameter: ZPHI <- "299.039808"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "62.49161"
 Parameter: YPOS -> "-38.8007622"
 Parameter: ZPOS -> "-15.4214365"
 Parameter: XPHI -> "268.88455"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.019467   -0.999810
    0.000000    0.999810   -0.019467

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   91.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "62.49161"
 Parameter: YPOS -> "-38.8007622"
 Parameter: ZPOS -> "-15.4214365"
 Parameter: YPHI -> "74.5515979"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.266370    0.000000   -0.963871
    0.000000    1.000000    0.000000
    0.963871    0.000000    0.266370

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   74.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "62.49161"
 Parameter: YPOS -> "-38.8007622"
 Parameter: ZPOS -> "-15.4214365"
 Parameter: ZPHI -> "299.039808"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.485417   -0.874283    0.000000
    0.874283    0.485417    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   62.491610 XMAX =   62.491610 XAVE =   62.491610
    YMIN =  -38.800762 YMAX =  -38.800762 YAVE =  -38.800762
    ZMIN =  -15.421437 ZMAX =  -15.421437 ZAVE =  -15.421437
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "62.49161"
Evaluating: 62.49161+3.5
 Parameter: XMAX <- "65.99161"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.8007622"
Evaluating: -38.8007622+3.5
 Parameter: YMAX <- "-35.3007622"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.4214365"
Evaluating: -15.4214365+3.5
 Parameter: ZMAX <- "-11.9214365"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "62.49161"
Evaluating: 62.49161-3.5
 Parameter: XMIN <- "58.99161"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.8007622"
Evaluating: -38.8007622-3.5
 Parameter: YMIN <- "-42.3007622"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.4214365"
Evaluating: -15.4214365-3.5
 Parameter: ZMIN <- "-18.9214365"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "65.99161"
 Parameter: XMIN -> "58.99161"
 Parameter: YMAX -> "-35.3007622"
 Parameter: YMIN -> "-42.3007622"
 Parameter: ZMAX -> "-11.9214365"
 Parameter: ZMIN -> "-18.9214365"
 SELRPN>     14 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      9 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64532 POS      SOD      117      SOD     -**** MEMB     POPC     305      O13           3.7162
64532 POS      SOD      117      SOD     -**** MEMB     POPC     305      O11           3.5261
64532 POS      SOD      117      SOD     -**** MEMB     POPC     305      C1            3.2862
64532 POS      SOD      117      SOD     -**** MEMB     POPC     305      O21           3.4207
64532 POS      SOD      117      SOD     -**** MEMB     POPC     305      C21           2.6886
64532 POS      SOD      117      SOD     -**** MEMB     POPC     305      O22           2.2591
64532 POS      SOD      117      SOD     -**** MEMB     POPC     305      C22           3.3882
64532 POS      SOD      117      SOD     -**** MEMB     POPC     305      C23           3.0208
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "117" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "117"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.374638232"
Evaluating: 125.050557*(0.374638232-0.5)
 Parameter: XPOS <- "-15.6765589"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.718264546"
Evaluating: 125.050557*(0.718264546-0.5)
 Parameter: YPOS <- "27.2941031"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.613915651"
Evaluating: 152.572525*(0.613915651-0.5)+-4.51585405
 Parameter: ZPOS <- "12.8645445"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.8645445" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.8645445" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "117" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "117"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.519381326"
Evaluating: 125.050557*(0.519381326-0.5)
 Parameter: XPOS <- "2.42364561"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.281163165"
Evaluating: 125.050557*(0.281163165-0.5)
 Parameter: YPOS <- "-27.3656681"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.544649896"
Evaluating: 152.572525*(0.544649896-0.5)+-4.51585405
 Parameter: ZPOS <- "2.29649332"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.29649332" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.29649332" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "117" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "117"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.409706646"
Evaluating: 125.050557*(0.409706646-0.5)
 Parameter: XPOS <- "-11.2912342"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.133121306"
Evaluating: 125.050557*(0.133121306-0.5)
 Parameter: YPOS <- "-45.878385"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.209486145"
Evaluating: 152.572525*(0.209486145-0.5)+-4.51585405
 Parameter: ZPOS <- "-48.8402865"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.8402865" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   62.491610 XMAX =   62.491610 XAVE =   62.491610
    YMIN =  -38.800762 YMAX =  -38.800762 YAVE =  -38.800762
    ZMIN =  -15.421437 ZMAX =  -15.421437 ZAVE =  -15.421437
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.2912342"
 RDCMND substituted energy or value "?XAVE" to "62.49161"
Evaluating: -11.2912342-62.49161
 Parameter: XTRAN <- "-73.7828442"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-45.878385"
 RDCMND substituted energy or value "?YAVE" to "-38.8007622"
Evaluating: -45.878385--38.8007622
 Parameter: YTRAN <- "-7.0776228"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.8402865"
 RDCMND substituted energy or value "?ZAVE" to "-15.4214365"
Evaluating: -48.8402865--15.4214365
 Parameter: ZTRAN <- "-33.41885"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-73.7828442"
 Parameter: YTRAN -> "-7.0776228"
 Parameter: ZTRAN -> "-33.41885"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -73.782844   -7.077623  -33.418850
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.274419763"
Evaluating: 0.274419763*360.0
 Parameter: XPHI <- "98.7911147"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.495845194"
Evaluating: 0.495845194*360.0
 Parameter: YPHI <- "178.50427"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.935977884"
Evaluating: 0.935977884*360.0
 Parameter: ZPHI <- "336.952038"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.2912342"
 Parameter: YPOS -> "-45.878385"
 Parameter: ZPOS -> "-48.8402865"
 Parameter: XPHI -> "98.7911147"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.152833    0.988252
    0.000000   -0.988252   -0.152833

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   98.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.2912342"
 Parameter: YPOS -> "-45.878385"
 Parameter: ZPOS -> "-48.8402865"
 Parameter: YPHI -> "178.50427"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.999659    0.000000   -0.026102
    0.000000    1.000000    0.000000
    0.026102    0.000000   -0.999659

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  178.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.2912342"
 Parameter: YPOS -> "-45.878385"
 Parameter: ZPOS -> "-48.8402865"
 Parameter: ZPHI -> "336.952038"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.920177   -0.391502    0.000000
    0.391502    0.920177    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   23.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.291234 XMAX =  -11.291234 XAVE =  -11.291234
    YMIN =  -45.878385 YMAX =  -45.878385 YAVE =  -45.878385
    ZMIN =  -48.840286 ZMAX =  -48.840286 ZAVE =  -48.840286
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.2912342"
Evaluating: -11.2912342+3.5
 Parameter: XMAX <- "-7.7912342"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-45.878385"
Evaluating: -45.878385+3.5
 Parameter: YMAX <- "-42.378385"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.8402865"
Evaluating: -48.8402865+3.5
 Parameter: ZMAX <- "-45.3402865"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.2912342"
Evaluating: -11.2912342-3.5
 Parameter: XMIN <- "-14.7912342"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-45.878385"
Evaluating: -45.878385-3.5
 Parameter: YMIN <- "-49.378385"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.8402865"
Evaluating: -48.8402865-3.5
 Parameter: ZMIN <- "-52.3402865"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.7912342"
 Parameter: XMIN -> "-14.7912342"
 Parameter: YMAX -> "-42.378385"
 Parameter: YMIN -> "-49.378385"
 Parameter: ZMAX -> "-45.3402865"
 Parameter: ZMIN -> "-52.3402865"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "118"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "118" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "118" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "118"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.304437372"
Evaluating: 125.050557*(0.304437372-0.5)
 Parameter: XPOS <- "-24.4552156"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.351220581"
Evaluating: 125.050557*(0.351220581-0.5)
 Parameter: YPOS <- "-18.6049492"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.812558666"
Evaluating: 152.572525*(0.812558666-0.5)+-4.51585405
 Parameter: ZPOS <- "43.1720108"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.1720108" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.1720108" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.4552156"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.4552156-0
 Parameter: XTRAN <- "-24.4552156"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.6049492"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.6049492-0
 Parameter: YTRAN <- "-18.6049492"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.1720108"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 43.1720108-0
 Parameter: ZTRAN <- "43.1720108"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.4552156"
 Parameter: YTRAN -> "-18.6049492"
 Parameter: ZTRAN -> "43.1720108"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -24.455216  -18.604949   43.172011
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.592530499"
Evaluating: 0.592530499*360.0
 Parameter: XPHI <- "213.31098"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.722825772"
Evaluating: 0.722825772*360.0
 Parameter: YPHI <- "260.217278"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.52262991E-02"
Evaluating: 6.52262991E-02*360.0
 Parameter: ZPHI <- "23.4814677"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.4552156"
 Parameter: YPOS -> "-18.6049492"
 Parameter: ZPOS -> "43.1720108"
 Parameter: XPHI -> "213.31098"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.835702   -0.549183
    0.000000    0.549183   -0.835702

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  146.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.4552156"
 Parameter: YPOS -> "-18.6049492"
 Parameter: ZPOS -> "43.1720108"
 Parameter: YPHI -> "260.217278"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.169912    0.000000    0.985459
    0.000000    1.000000    0.000000
   -0.985459    0.000000   -0.169912

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   99.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.4552156"
 Parameter: YPOS -> "-18.6049492"
 Parameter: ZPOS -> "43.1720108"
 Parameter: ZPHI -> "23.4814677"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.917189    0.398452    0.000000
   -0.398452    0.917189    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   23.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.455216 XMAX =  -24.455216 XAVE =  -24.455216
    YMIN =  -18.604949 YMAX =  -18.604949 YAVE =  -18.604949
    ZMIN =   43.172011 ZMAX =   43.172011 ZAVE =   43.172011
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.4552156"
Evaluating: -24.4552156+3.5
 Parameter: XMAX <- "-20.9552156"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.6049492"
Evaluating: -18.6049492+3.5
 Parameter: YMAX <- "-15.1049492"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.1720108"
Evaluating: 43.1720108+3.5
 Parameter: ZMAX <- "46.6720108"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.4552156"
Evaluating: -24.4552156-3.5
 Parameter: XMIN <- "-27.9552156"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.6049492"
Evaluating: -18.6049492-3.5
 Parameter: YMIN <- "-22.1049492"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.1720108"
Evaluating: 43.1720108-3.5
 Parameter: ZMIN <- "39.6720108"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.9552156"
 Parameter: XMIN -> "-27.9552156"
 Parameter: YMAX -> "-15.1049492"
 Parameter: YMIN -> "-22.1049492"
 Parameter: ZMAX -> "46.6720108"
 Parameter: ZMIN -> "39.6720108"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "119"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "119" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "119" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "119"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.402777876"
Evaluating: 125.050557*(0.402777876-0.5)
 Parameter: XPOS <- "-12.1576808"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.287501886"
Evaluating: 125.050557*(0.287501886-0.5)
 Parameter: YPOS <- "-26.5730075"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.352547151"
Evaluating: 152.572525*(0.352547151-0.5)+-4.51585405
 Parameter: ZPOS <- "-27.0131075"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.0131075" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.1576808"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.1576808-0
 Parameter: XTRAN <- "-12.1576808"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.5730075"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.5730075-0
 Parameter: YTRAN <- "-26.5730075"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.0131075"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.0131075-0
 Parameter: ZTRAN <- "-27.0131075"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.1576808"
 Parameter: YTRAN -> "-26.5730075"
 Parameter: ZTRAN -> "-27.0131075"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -12.157681  -26.573007  -27.013108
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.673842881"
Evaluating: 0.673842881*360.0
 Parameter: XPHI <- "242.583437"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.486999292"
Evaluating: 0.486999292*360.0
 Parameter: YPHI <- "175.319745"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.569486586"
Evaluating: 0.569486586*360.0
 Parameter: ZPHI <- "205.015171"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.1576808"
 Parameter: YPOS -> "-26.5730075"
 Parameter: ZPOS -> "-27.0131075"
 Parameter: XPHI -> "242.583437"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.460456   -0.887682
    0.000000    0.887682   -0.460456

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  117.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.1576808"
 Parameter: YPOS -> "-26.5730075"
 Parameter: ZPOS -> "-27.0131075"
 Parameter: YPHI -> "175.319745"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.996666    0.000000   -0.081595
    0.000000    1.000000    0.000000
    0.081595    0.000000   -0.996666

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  175.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.1576808"
 Parameter: YPOS -> "-26.5730075"
 Parameter: ZPOS -> "-27.0131075"
 Parameter: ZPHI -> "205.015171"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.906196   -0.422858    0.000000
    0.422858   -0.906196    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  154.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.157681 XMAX =  -12.157681 XAVE =  -12.157681
    YMIN =  -26.573007 YMAX =  -26.573007 YAVE =  -26.573007
    ZMIN =  -27.013108 ZMAX =  -27.013108 ZAVE =  -27.013108
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.1576808"
Evaluating: -12.1576808+3.5
 Parameter: XMAX <- "-8.6576808"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.5730075"
Evaluating: -26.5730075+3.5
 Parameter: YMAX <- "-23.0730075"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.0131075"
Evaluating: -27.0131075+3.5
 Parameter: ZMAX <- "-23.5131075"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.1576808"
Evaluating: -12.1576808-3.5
 Parameter: XMIN <- "-15.6576808"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.5730075"
Evaluating: -26.5730075-3.5
 Parameter: YMIN <- "-30.0730075"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.0131075"
Evaluating: -27.0131075-3.5
 Parameter: ZMIN <- "-30.5131075"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.6576808"
 Parameter: XMIN -> "-15.6576808"
 Parameter: YMAX -> "-23.0730075"
 Parameter: YMIN -> "-30.0730075"
 Parameter: ZMAX -> "-23.5131075"
 Parameter: ZMIN -> "-30.5131075"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "120"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "120" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "120"
Evaluating: 120
 Parameter: J <- "120"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "120" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "120"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.613647189"
Evaluating: 125.050557*(0.613647189-0.5)
 Parameter: XPOS <- "14.2116443"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.693925448"
Evaluating: 125.050557*(0.693925448-0.5)
 Parameter: YPOS <- "24.2504853"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.945577443"
Evaluating: 152.572525*(0.945577443-0.5)+-4.51585405
 Parameter: ZPOS <- "63.4670215"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.4670215" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.4670215" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.2116443"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.2116443-0
 Parameter: XTRAN <- "14.2116443"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.2504853"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.2504853-0
 Parameter: YTRAN <- "24.2504853"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.4670215"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 63.4670215-0
 Parameter: ZTRAN <- "63.4670215"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.2116443"
 Parameter: YTRAN -> "24.2504853"
 Parameter: ZTRAN -> "63.4670215"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    14.211644   24.250485   63.467022
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.610844963"
Evaluating: 0.610844963*360.0
 Parameter: XPHI <- "219.904187"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.280013335"
Evaluating: 0.280013335*360.0
 Parameter: YPHI <- "100.804801"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.793820704"
Evaluating: 0.793820704*360.0
 Parameter: ZPHI <- "285.775453"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.2116443"
 Parameter: YPOS -> "24.2504853"
 Parameter: ZPOS -> "63.4670215"
 Parameter: XPHI -> "219.904187"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.767118   -0.641506
    0.000000    0.641506   -0.767118

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  140.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.2116443"
 Parameter: YPOS -> "24.2504853"
 Parameter: ZPOS -> "63.4670215"
 Parameter: YPHI -> "100.804801"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.187464    0.000000   -0.982272
    0.000000    1.000000    0.000000
    0.982272    0.000000   -0.187464

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  100.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.2116443"
 Parameter: YPOS -> "24.2504853"
 Parameter: ZPOS -> "63.4670215"
 Parameter: ZPHI -> "285.775453"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.271868   -0.962335    0.000000
    0.962335    0.271868    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   74.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.211644 XMAX =   14.211644 XAVE =   14.211644
    YMIN =   24.250485 YMAX =   24.250485 YAVE =   24.250485
    ZMIN =   63.467022 ZMAX =   63.467022 ZAVE =   63.467022
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.2116443"
Evaluating: 14.2116443+3.5
 Parameter: XMAX <- "17.7116443"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.2504853"
Evaluating: 24.2504853+3.5
 Parameter: YMAX <- "27.7504853"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.4670215"
Evaluating: 63.4670215+3.5
 Parameter: ZMAX <- "66.9670215"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.2116443"
Evaluating: 14.2116443-3.5
 Parameter: XMIN <- "10.7116443"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.2504853"
Evaluating: 24.2504853-3.5
 Parameter: YMIN <- "20.7504853"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.4670215"
Evaluating: 63.4670215-3.5
 Parameter: ZMIN <- "59.9670215"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.7116443"
 Parameter: XMIN -> "10.7116443"
 Parameter: YMAX -> "27.7504853"
 Parameter: YMIN -> "20.7504853"
 Parameter: ZMAX -> "66.9670215"
 Parameter: ZMIN -> "59.9670215"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "121"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "121" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "121"
Evaluating: 121
 Parameter: J <- "121"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "121" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "121"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "4.995703049E-02"
Evaluating: 125.050557*(4.995703049E-02-0.5)
 Parameter: XPOS <- "-56.278124"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.647872666"
Evaluating: 125.050557*(0.647872666-0.5)
 Parameter: YPOS <- "18.4915592"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.279454458"
Evaluating: 152.572525*(0.279454458-0.5)+-4.51585405
 Parameter: ZPOS <- "-38.1650443"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.1650443" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-56.278124"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -56.278124-0
 Parameter: XTRAN <- "-56.278124"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.4915592"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 18.4915592-0
 Parameter: YTRAN <- "18.4915592"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.1650443"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.1650443-0
 Parameter: ZTRAN <- "-38.1650443"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-56.278124"
 Parameter: YTRAN -> "18.4915592"
 Parameter: ZTRAN -> "-38.1650443"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -56.278124   18.491559  -38.165044
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.749688254"
Evaluating: 0.749688254*360.0
 Parameter: XPHI <- "269.887771"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.345749091"
Evaluating: 0.345749091*360.0
 Parameter: YPHI <- "124.469673"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.110178607"
Evaluating: 0.110178607*360.0
 Parameter: ZPHI <- "39.6642985"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-56.278124"
 Parameter: YPOS -> "18.4915592"
 Parameter: ZPOS -> "-38.1650443"
 Parameter: XPHI -> "269.887771"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.001959   -0.999998
    0.000000    0.999998   -0.001959

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   90.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-56.278124"
 Parameter: YPOS -> "18.4915592"
 Parameter: ZPOS -> "-38.1650443"
 Parameter: YPHI -> "124.469673"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.565970    0.000000   -0.824426
    0.000000    1.000000    0.000000
    0.824426    0.000000   -0.565970

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  124.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-56.278124"
 Parameter: YPOS -> "18.4915592"
 Parameter: ZPOS -> "-38.1650443"
 Parameter: ZPHI -> "39.6642985"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.769797    0.638288    0.000000
   -0.638288    0.769797    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   39.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -56.278124 XMAX =  -56.278124 XAVE =  -56.278124
    YMIN =   18.491559 YMAX =   18.491559 YAVE =   18.491559
    ZMIN =  -38.165044 ZMAX =  -38.165044 ZAVE =  -38.165044
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-56.278124"
Evaluating: -56.278124+3.5
 Parameter: XMAX <- "-52.778124"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.4915592"
Evaluating: 18.4915592+3.5
 Parameter: YMAX <- "21.9915592"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.1650443"
Evaluating: -38.1650443+3.5
 Parameter: ZMAX <- "-34.6650443"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-56.278124"
Evaluating: -56.278124-3.5
 Parameter: XMIN <- "-59.778124"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.4915592"
Evaluating: 18.4915592-3.5
 Parameter: YMIN <- "14.9915592"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.1650443"
Evaluating: -38.1650443-3.5
 Parameter: ZMIN <- "-41.6650443"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-52.778124"
 Parameter: XMIN -> "-59.778124"
 Parameter: YMAX -> "21.9915592"
 Parameter: YMIN -> "14.9915592"
 Parameter: ZMAX -> "-34.6650443"
 Parameter: ZMIN -> "-41.6650443"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "122"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "122" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "122" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "122"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.89385087"
Evaluating: 125.050557*(0.89385087-0.5)
 Parameter: XPOS <- "49.2512707"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.101660817"
Evaluating: 125.050557*(0.101660817-0.5)
 Parameter: YPOS <- "-49.8125367"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.974844719"
Evaluating: 152.572525*(0.974844719-0.5)+-4.51585405
 Parameter: ZPOS <- "67.9324037"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "67.9324037" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "67.9324037" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.2512707"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.2512707-0
 Parameter: XTRAN <- "49.2512707"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.8125367"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -49.8125367-0
 Parameter: YTRAN <- "-49.8125367"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "67.9324037"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 67.9324037-0
 Parameter: ZTRAN <- "67.9324037"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.2512707"
 Parameter: YTRAN -> "-49.8125367"
 Parameter: ZTRAN -> "67.9324037"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    49.251271  -49.812537   67.932404
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.323571861"
Evaluating: 0.323571861*360.0
 Parameter: XPHI <- "116.48587"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.170133658"
Evaluating: 0.170133658*360.0
 Parameter: YPHI <- "61.2481169"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.921444306"
Evaluating: 0.921444306*360.0
 Parameter: ZPHI <- "331.71995"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.2512707"
 Parameter: YPOS -> "-49.8125367"
 Parameter: ZPOS -> "67.9324037"
 Parameter: XPHI -> "116.48587"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.445977    0.895044
    0.000000   -0.895044   -0.445977

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  116.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.2512707"
 Parameter: YPOS -> "-49.8125367"
 Parameter: ZPOS -> "67.9324037"
 Parameter: YPHI -> "61.2481169"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.481018    0.000000   -0.876711
    0.000000    1.000000    0.000000
    0.876711    0.000000    0.481018

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   61.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.2512707"
 Parameter: YPOS -> "-49.8125367"
 Parameter: ZPOS -> "67.9324037"
 Parameter: ZPHI -> "331.71995"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.880642   -0.473782    0.000000
    0.473782    0.880642    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.251271 XMAX =   49.251271 XAVE =   49.251271
    YMIN =  -49.812537 YMAX =  -49.812537 YAVE =  -49.812537
    ZMIN =   67.932404 ZMAX =   67.932404 ZAVE =   67.932404
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.2512707"
Evaluating: 49.2512707+3.5
 Parameter: XMAX <- "52.7512707"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.8125367"
Evaluating: -49.8125367+3.5
 Parameter: YMAX <- "-46.3125367"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "67.9324037"
Evaluating: 67.9324037+3.5
 Parameter: ZMAX <- "71.4324037"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.2512707"
Evaluating: 49.2512707-3.5
 Parameter: XMIN <- "45.7512707"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.8125367"
Evaluating: -49.8125367-3.5
 Parameter: YMIN <- "-53.3125367"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "67.9324037"
Evaluating: 67.9324037-3.5
 Parameter: ZMIN <- "64.4324037"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.7512707"
 Parameter: XMIN -> "45.7512707"
 Parameter: YMAX -> "-46.3125367"
 Parameter: YMIN -> "-53.3125367"
 Parameter: ZMAX -> "71.4324037"
 Parameter: ZMIN -> "64.4324037"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "123"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "123" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "123"
Evaluating: 123
 Parameter: J <- "123"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "123" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "123"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.532861083"
Evaluating: 125.050557*(0.532861083-0.5)
 Parameter: XPOS <- "4.10929673"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.776754213"
Evaluating: 125.050557*(0.776754213-0.5)
 Parameter: YPOS <- "34.6082685"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.707981239"
Evaluating: 152.572525*(0.707981239-0.5)+-4.51585405
 Parameter: ZPOS <- "27.2163687"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.2163687" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.2163687" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.10929673"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.10929673-0
 Parameter: XTRAN <- "4.10929673"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.6082685"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.6082685-0
 Parameter: YTRAN <- "34.6082685"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.2163687"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.2163687-0
 Parameter: ZTRAN <- "27.2163687"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.10929673"
 Parameter: YTRAN -> "34.6082685"
 Parameter: ZTRAN -> "27.2163687"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     4.109297   34.608269   27.216369
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.886059001"
Evaluating: 0.886059001*360.0
 Parameter: XPHI <- "318.98124"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.472169674"
Evaluating: 0.472169674*360.0
 Parameter: YPHI <- "169.981083"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.211211964E-02"
Evaluating: 1.211211964E-02*360.0
 Parameter: ZPHI <- "4.36036307"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.10929673"
 Parameter: YPOS -> "34.6082685"
 Parameter: ZPOS -> "27.2163687"
 Parameter: XPHI -> "318.98124"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.754495   -0.656306
    0.000000    0.656306    0.754495

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   41.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.10929673"
 Parameter: YPOS -> "34.6082685"
 Parameter: ZPOS -> "27.2163687"
 Parameter: YPHI -> "169.981083"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.984750    0.000000   -0.173973
    0.000000    1.000000    0.000000
    0.173973    0.000000   -0.984750

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  169.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.10929673"
 Parameter: YPOS -> "34.6082685"
 Parameter: ZPOS -> "27.2163687"
 Parameter: ZPHI -> "4.36036307"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.997106    0.076029    0.000000
   -0.076029    0.997106    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    4.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.109297 XMAX =    4.109297 XAVE =    4.109297
    YMIN =   34.608269 YMAX =   34.608269 YAVE =   34.608269
    ZMIN =   27.216369 ZMAX =   27.216369 ZAVE =   27.216369
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.10929673"
Evaluating: 4.10929673+3.5
 Parameter: XMAX <- "7.60929673"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.6082685"
Evaluating: 34.6082685+3.5
 Parameter: YMAX <- "38.1082685"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.2163687"
Evaluating: 27.2163687+3.5
 Parameter: ZMAX <- "30.7163687"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.10929673"
Evaluating: 4.10929673-3.5
 Parameter: XMIN <- "0.60929673"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.6082685"
Evaluating: 34.6082685-3.5
 Parameter: YMIN <- "31.1082685"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.2163687"
Evaluating: 27.2163687-3.5
 Parameter: ZMIN <- "23.7163687"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.60929673"
 Parameter: XMIN -> "0.60929673"
 Parameter: YMAX -> "38.1082685"
 Parameter: YMIN -> "31.1082685"
 Parameter: ZMAX -> "30.7163687"
 Parameter: ZMIN -> "23.7163687"
 SELRPN>     10 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      8 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64538 POS      SOD      123      SOD     -**** PROA     ASP      825      CG            4.0266
64538 POS      SOD      123      SOD     -**** PROA     ASP      825      OD1           3.9954
64538 POS      SOD      123      SOD     -**** PROA     ASP      825      OD2           3.4515
64538 POS      SOD      123      SOD     -**** PROA     ASP      1343     CA            3.7102
64538 POS      SOD      123      SOD     -**** PROA     ASP      1343     CB            2.1954
64538 POS      SOD      123      SOD     -**** PROA     ASP      1343     CG            2.3194
64538 POS      SOD      123      SOD     -**** PROA     ASP      1343     OD1           3.5771
64538 POS      SOD      123      SOD     -**** PROA     ASP      1343     OD2           1.8327
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "123"
Evaluating: 123
 Parameter: J <- "123"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "123" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "123"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.49672262"
Evaluating: 125.050557*(0.49672262-0.5)
 Parameter: XPOS <- "-0.409838195"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.230792795"
Evaluating: 125.050557*(0.230792795-0.5)
 Parameter: YPOS <- "-33.6645109"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.153337568"
Evaluating: 152.572525*(0.153337568-0.5)+-4.51585405
 Parameter: ZPOS <- "-57.4070166"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.4070166" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.109297 XMAX =    4.109297 XAVE =    4.109297
    YMIN =   34.608269 YMAX =   34.608269 YAVE =   34.608269
    ZMIN =   27.216369 ZMAX =   27.216369 ZAVE =   27.216369
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.409838195"
 RDCMND substituted energy or value "?XAVE" to "4.10929673"
Evaluating: -0.409838195-4.10929673
 Parameter: XTRAN <- "-4.51913492"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.6645109"
 RDCMND substituted energy or value "?YAVE" to "34.6082685"
Evaluating: -33.6645109-34.6082685
 Parameter: YTRAN <- "-68.2727794"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.4070166"
 RDCMND substituted energy or value "?ZAVE" to "27.2163687"
Evaluating: -57.4070166-27.2163687
 Parameter: ZTRAN <- "-84.6233853"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.51913492"
 Parameter: YTRAN -> "-68.2727794"
 Parameter: ZTRAN -> "-84.6233853"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -4.519135  -68.272779  -84.623385
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.471554501"
Evaluating: 0.471554501*360.0
 Parameter: XPHI <- "169.75962"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.473826568"
Evaluating: 0.473826568*360.0
 Parameter: YPHI <- "170.577564"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.969568302"
Evaluating: 0.969568302*360.0
 Parameter: ZPHI <- "349.044589"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.409838195"
 Parameter: YPOS -> "-33.6645109"
 Parameter: ZPOS -> "-57.4070166"
 Parameter: XPHI -> "169.75962"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.984071    0.177778
    0.000000   -0.177778   -0.984071

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  169.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.409838195"
 Parameter: YPOS -> "-33.6645109"
 Parameter: ZPOS -> "-57.4070166"
 Parameter: YPHI -> "170.577564"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.986508    0.000000   -0.163712
    0.000000    1.000000    0.000000
    0.163712    0.000000   -0.986508

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  170.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.409838195"
 Parameter: YPOS -> "-33.6645109"
 Parameter: ZPOS -> "-57.4070166"
 Parameter: ZPHI -> "349.044589"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.981775   -0.190045    0.000000
    0.190045    0.981775    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   10.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.409838 XMAX =   -0.409838 XAVE =   -0.409838
    YMIN =  -33.664511 YMAX =  -33.664511 YAVE =  -33.664511
    ZMIN =  -57.407017 ZMAX =  -57.407017 ZAVE =  -57.407017
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.4098382"
Evaluating: -0.4098382+3.5
 Parameter: XMAX <- "3.0901618"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.6645109"
Evaluating: -33.6645109+3.5
 Parameter: YMAX <- "-30.1645109"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.4070166"
Evaluating: -57.4070166+3.5
 Parameter: ZMAX <- "-53.9070166"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.4098382"
Evaluating: -0.4098382-3.5
 Parameter: XMIN <- "-3.9098382"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.6645109"
Evaluating: -33.6645109-3.5
 Parameter: YMIN <- "-37.1645109"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.4070166"
Evaluating: -57.4070166-3.5
 Parameter: ZMIN <- "-60.9070166"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.0901618"
 Parameter: XMIN -> "-3.9098382"
 Parameter: YMAX -> "-30.1645109"
 Parameter: YMIN -> "-37.1645109"
 Parameter: ZMAX -> "-53.9070166"
 Parameter: ZMIN -> "-60.9070166"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "124"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "124" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "124"
Evaluating: 124
 Parameter: J <- "124"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "124" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "124"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.371790856"
Evaluating: 125.050557*(0.371790856-0.5)
 Parameter: XPOS <- "-16.0326249"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.638201479"
Evaluating: 125.050557*(0.638201479-0.5)
 Parameter: YPOS <- "17.2821719"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.667004965"
Evaluating: 152.572525*(0.667004965-0.5)+-4.51585405
 Parameter: ZPOS <- "20.9645151"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.9645151" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.9645151" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.0326249"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.0326249-0
 Parameter: XTRAN <- "-16.0326249"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.2821719"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.2821719-0
 Parameter: YTRAN <- "17.2821719"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.9645151"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 20.9645151-0
 Parameter: ZTRAN <- "20.9645151"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.0326249"
 Parameter: YTRAN -> "17.2821719"
 Parameter: ZTRAN -> "20.9645151"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -16.032625   17.282172   20.964515
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.339639062"
Evaluating: 0.339639062*360.0
 Parameter: XPHI <- "122.270062"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.27405466"
Evaluating: 0.27405466*360.0
 Parameter: YPHI <- "98.6596776"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.541602103"
Evaluating: 0.541602103*360.0
 Parameter: ZPHI <- "194.976757"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.0326249"
 Parameter: YPOS -> "17.2821719"
 Parameter: ZPOS -> "20.9645151"
 Parameter: XPHI -> "122.270062"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.533911    0.845541
    0.000000   -0.845541   -0.533911

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  122.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.0326249"
 Parameter: YPOS -> "17.2821719"
 Parameter: ZPOS -> "20.9645151"
 Parameter: YPHI -> "98.6596776"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.150565    0.000000   -0.988600
    0.000000    1.000000    0.000000
    0.988600    0.000000   -0.150565

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   98.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.0326249"
 Parameter: YPOS -> "17.2821719"
 Parameter: ZPOS -> "20.9645151"
 Parameter: ZPHI -> "194.976757"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.966031   -0.258427    0.000000
    0.258427   -0.966031    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  165.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.032625 XMAX =  -16.032625 XAVE =  -16.032625
    YMIN =   17.282172 YMAX =   17.282172 YAVE =   17.282172
    ZMIN =   20.964515 ZMAX =   20.964515 ZAVE =   20.964515
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.0326249"
Evaluating: -16.0326249+3.5
 Parameter: XMAX <- "-12.5326249"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.2821719"
Evaluating: 17.2821719+3.5
 Parameter: YMAX <- "20.7821719"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.9645151"
Evaluating: 20.9645151+3.5
 Parameter: ZMAX <- "24.4645151"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.0326249"
Evaluating: -16.0326249-3.5
 Parameter: XMIN <- "-19.5326249"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.2821719"
Evaluating: 17.2821719-3.5
 Parameter: YMIN <- "13.7821719"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.9645151"
Evaluating: 20.9645151-3.5
 Parameter: ZMIN <- "17.4645151"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.5326249"
 Parameter: XMIN -> "-19.5326249"
 Parameter: YMAX -> "20.7821719"
 Parameter: YMIN -> "13.7821719"
 Parameter: ZMAX -> "24.4645151"
 Parameter: ZMIN -> "17.4645151"
 SELRPN>      3 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      3 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64539 POS      SOD      124      SOD     -**** MEMB     POPC     14       O13           3.8652
64539 POS      SOD      124      SOD     -**** MEMB     POPC     14       O14           3.9401
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "124"
Evaluating: 124
 Parameter: J <- "124"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "124" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "124"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.344166634"
Evaluating: 125.050557*(0.344166634-0.5)
 Parameter: XPOS <- "-19.4870492"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.512088136"
Evaluating: 125.050557*(0.512088136-0.5)
 Parameter: YPOS <- "1.51162814"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.292250301"
Evaluating: 152.572525*(0.292250301-0.5)+-4.51585405
 Parameter: ZPOS <- "-36.2127502"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.2127502" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.032625 XMAX =  -16.032625 XAVE =  -16.032625
    YMIN =   17.282172 YMAX =   17.282172 YAVE =   17.282172
    ZMIN =   20.964515 ZMAX =   20.964515 ZAVE =   20.964515
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.4870492"
 RDCMND substituted energy or value "?XAVE" to "-16.0326249"
Evaluating: -19.4870492--16.0326249
 Parameter: XTRAN <- "-3.4544243"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.51162814"
 RDCMND substituted energy or value "?YAVE" to "17.2821719"
Evaluating: 1.51162814-17.2821719
 Parameter: YTRAN <- "-15.7705438"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.2127502"
 RDCMND substituted energy or value "?ZAVE" to "20.9645151"
Evaluating: -36.2127502-20.9645151
 Parameter: ZTRAN <- "-57.1772653"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.4544243"
 Parameter: YTRAN -> "-15.7705438"
 Parameter: ZTRAN -> "-57.1772653"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -3.454424  -15.770544  -57.177265
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.302612613"
Evaluating: 0.302612613*360.0
 Parameter: XPHI <- "108.940541"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.548395671"
Evaluating: 0.548395671*360.0
 Parameter: YPHI <- "197.422442"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.667011774"
Evaluating: 0.667011774*360.0
 Parameter: ZPHI <- "240.124239"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.4870492"
 Parameter: YPOS -> "1.51162814"
 Parameter: ZPOS -> "-36.2127502"
 Parameter: XPHI -> "108.940541"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.324587    0.945856
    0.000000   -0.945856   -0.324587

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  108.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.4870492"
 Parameter: YPOS -> "1.51162814"
 Parameter: ZPOS -> "-36.2127502"
 Parameter: YPHI -> "197.422442"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.954123    0.000000    0.299415
    0.000000    1.000000    0.000000
   -0.299415    0.000000   -0.954123

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  162.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.4870492"
 Parameter: YPOS -> "1.51162814"
 Parameter: ZPOS -> "-36.2127502"
 Parameter: ZPHI -> "240.124239"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.498121   -0.867108    0.000000
    0.867108   -0.498121    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  119.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.487049 XMAX =  -19.487049 XAVE =  -19.487049
    YMIN =    1.511628 YMAX =    1.511628 YAVE =    1.511628
    ZMIN =  -36.212750 ZMAX =  -36.212750 ZAVE =  -36.212750
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.4870492"
Evaluating: -19.4870492+3.5
 Parameter: XMAX <- "-15.9870492"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.51162814"
Evaluating: 1.51162814+3.5
 Parameter: YMAX <- "5.01162814"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.2127502"
Evaluating: -36.2127502+3.5
 Parameter: ZMAX <- "-32.7127502"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.4870492"
Evaluating: -19.4870492-3.5
 Parameter: XMIN <- "-22.9870492"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.51162814"
Evaluating: 1.51162814-3.5
 Parameter: YMIN <- "-1.98837186"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.2127502"
Evaluating: -36.2127502-3.5
 Parameter: ZMIN <- "-39.7127502"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.9870492"
 Parameter: XMIN -> "-22.9870492"
 Parameter: YMAX -> "5.01162814"
 Parameter: YMIN -> "-1.98837186"
 Parameter: ZMAX -> "-32.7127502"
 Parameter: ZMIN -> "-39.7127502"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "125"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "125" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "125" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "125"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.158342054"
Evaluating: 125.050557*(0.158342054-0.5)
 Parameter: XPOS <- "-42.7245165"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.380244488"
Evaluating: 125.050557*(0.380244488-0.5)
 Parameter: YPOS <- "-14.9754935"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.560620571"
Evaluating: 152.572525*(0.560620571-0.5)+-4.51585405
 Parameter: ZPOS <- "4.73317953"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.73317953" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.73317953" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "125" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "125"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.88545108"
Evaluating: 125.050557*(0.88545108-0.5)
 Parameter: XPOS <- "48.2008723"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.962702562"
Evaluating: 125.050557*(0.962702562-0.5)
 Parameter: YPOS <- "57.8612131"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.628178289"
Evaluating: 152.572525*(0.628178289-0.5)+-4.51585405
 Parameter: ZPOS <- "15.0406312"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.0406312" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.0406312" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "48.2008723"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 48.2008723-0
 Parameter: XTRAN <- "48.2008723"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "57.8612131"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 57.8612131-0
 Parameter: YTRAN <- "57.8612131"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.0406312"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.0406312-0
 Parameter: ZTRAN <- "15.0406312"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "48.2008723"
 Parameter: YTRAN -> "57.8612131"
 Parameter: ZTRAN -> "15.0406312"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    48.200872   57.861213   15.040631
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.191633679E-03"
Evaluating: 2.191633679E-03*360.0
 Parameter: XPHI <- "0.788988124"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.538059906"
Evaluating: 0.538059906*360.0
 Parameter: YPHI <- "193.701566"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.841704822"
Evaluating: 0.841704822*360.0
 Parameter: ZPHI <- "303.013736"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "48.2008723"
 Parameter: YPOS -> "57.8612131"
 Parameter: ZPOS -> "15.0406312"
 Parameter: XPHI -> "0.788988124"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999905    0.013770
    0.000000   -0.013770    0.999905

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    0.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "48.2008723"
 Parameter: YPOS -> "57.8612131"
 Parameter: ZPOS -> "15.0406312"
 Parameter: YPHI -> "193.701566"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.971543    0.000000    0.236865
    0.000000    1.000000    0.000000
   -0.236865    0.000000   -0.971543

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "48.2008723"
 Parameter: YPOS -> "57.8612131"
 Parameter: ZPOS -> "15.0406312"
 Parameter: ZPHI -> "303.013736"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.544840   -0.838540    0.000000
    0.838540    0.544840    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   56.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   48.200872 XMAX =   48.200872 XAVE =   48.200872
    YMIN =   57.861213 YMAX =   57.861213 YAVE =   57.861213
    ZMIN =   15.040631 ZMAX =   15.040631 ZAVE =   15.040631
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "48.2008723"
Evaluating: 48.2008723+3.5
 Parameter: XMAX <- "51.7008723"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "57.8612131"
Evaluating: 57.8612131+3.5
 Parameter: YMAX <- "61.3612131"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.0406312"
Evaluating: 15.0406312+3.5
 Parameter: ZMAX <- "18.5406312"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "48.2008723"
Evaluating: 48.2008723-3.5
 Parameter: XMIN <- "44.7008723"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "57.8612131"
Evaluating: 57.8612131-3.5
 Parameter: YMIN <- "54.3612131"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.0406312"
Evaluating: 15.0406312-3.5
 Parameter: ZMIN <- "11.5406312"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "51.7008723"
 Parameter: XMIN -> "44.7008723"
 Parameter: YMAX -> "61.3612131"
 Parameter: YMIN -> "54.3612131"
 Parameter: ZMAX -> "18.5406312"
 Parameter: ZMIN -> "11.5406312"
 SELRPN>     13 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      7 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64540 POS      SOD      125      SOD     -**** MEMB     POPC     139      P             3.8622
64540 POS      SOD      125      SOD     -**** MEMB     POPC     139      O13           3.2936
64540 POS      SOD      125      SOD     -**** MEMB     POPC     139      O14           3.3655
64540 POS      SOD      125      SOD     -**** MEMB     POPC     139      C35           3.7353
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "125" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "125"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.637961854"
Evaluating: 125.050557*(0.637961854-0.5)
 Parameter: XPOS <- "17.2522067"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.256856343"
Evaluating: 125.050557*(0.256856343-0.5)
 Parameter: YPOS <- "-30.4052497"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "9.972652767E-02"
Evaluating: 152.572525*(9.972652767E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-65.5865884"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-65.5865884" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   48.200872 XMAX =   48.200872 XAVE =   48.200872
    YMIN =   57.861213 YMAX =   57.861213 YAVE =   57.861213
    ZMIN =   15.040631 ZMAX =   15.040631 ZAVE =   15.040631
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.2522067"
 RDCMND substituted energy or value "?XAVE" to "48.2008723"
Evaluating: 17.2522067-48.2008723
 Parameter: XTRAN <- "-30.9486656"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.4052497"
 RDCMND substituted energy or value "?YAVE" to "57.8612131"
Evaluating: -30.4052497-57.8612131
 Parameter: YTRAN <- "-88.2664628"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-65.5865884"
 RDCMND substituted energy or value "?ZAVE" to "15.0406312"
Evaluating: -65.5865884-15.0406312
 Parameter: ZTRAN <- "-80.6272196"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.9486656"
 Parameter: YTRAN -> "-88.2664628"
 Parameter: ZTRAN -> "-80.6272196"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -30.948666  -88.266463  -80.627220
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.83740289"
Evaluating: 0.83740289*360.0
 Parameter: XPHI <- "301.46504"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.530676162"
Evaluating: 0.530676162*360.0
 Parameter: YPHI <- "191.043418"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.742916963"
Evaluating: 0.742916963*360.0
 Parameter: ZPHI <- "267.450107"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.2522067"
 Parameter: YPOS -> "-30.4052497"
 Parameter: ZPOS -> "-65.5865884"
 Parameter: XPHI -> "301.46504"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.521978   -0.852959
    0.000000    0.852959    0.521978

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.2522067"
 Parameter: YPOS -> "-30.4052497"
 Parameter: ZPOS -> "-65.5865884"
 Parameter: YPHI -> "191.043418"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.981482    0.000000    0.191553
    0.000000    1.000000    0.000000
   -0.191553    0.000000   -0.981482

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  168.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.2522067"
 Parameter: YPOS -> "-30.4052497"
 Parameter: ZPOS -> "-65.5865884"
 Parameter: ZPHI -> "267.450107"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.044489   -0.999010    0.000000
    0.999010   -0.044489    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   92.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.252207 XMAX =   17.252207 XAVE =   17.252207
    YMIN =  -30.405250 YMAX =  -30.405250 YAVE =  -30.405250
    ZMIN =  -65.586588 ZMAX =  -65.586588 ZAVE =  -65.586588
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.2522067"
Evaluating: 17.2522067+3.5
 Parameter: XMAX <- "20.7522067"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.4052497"
Evaluating: -30.4052497+3.5
 Parameter: YMAX <- "-26.9052497"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-65.5865884"
Evaluating: -65.5865884+3.5
 Parameter: ZMAX <- "-62.0865884"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.2522067"
Evaluating: 17.2522067-3.5
 Parameter: XMIN <- "13.7522067"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.4052497"
Evaluating: -30.4052497-3.5
 Parameter: YMIN <- "-33.9052497"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-65.5865884"
Evaluating: -65.5865884-3.5
 Parameter: ZMIN <- "-69.0865884"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.7522067"
 Parameter: XMIN -> "13.7522067"
 Parameter: YMAX -> "-26.9052497"
 Parameter: YMIN -> "-33.9052497"
 Parameter: ZMAX -> "-62.0865884"
 Parameter: ZMIN -> "-69.0865884"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "126"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "126" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "126"
Evaluating: 126
 Parameter: J <- "126"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "126" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "126"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.180479396E-02"
Evaluating: 125.050557*(9.180479396E-02-0.5)
 Parameter: XPOS <- "-51.0450379"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.934219368"
Evaluating: 125.050557*(0.934219368-0.5)
 Parameter: YPOS <- "54.2993738"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.869899981"
Evaluating: 152.572525*(0.869899981-0.5)+-4.51585405
 Parameter: ZPOS <- "51.92072"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "51.92072" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "51.92072" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-51.0450379"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -51.0450379-0
 Parameter: XTRAN <- "-51.0450379"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "54.2993738"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 54.2993738-0
 Parameter: YTRAN <- "54.2993738"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "51.92072"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 51.92072-0
 Parameter: ZTRAN <- "51.92072"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-51.0450379"
 Parameter: YTRAN -> "54.2993738"
 Parameter: ZTRAN -> "51.92072"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -51.045038   54.299374   51.920720
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.762793038"
Evaluating: 0.762793038*360.0
 Parameter: XPHI <- "274.605494"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.301244516"
Evaluating: 0.301244516*360.0
 Parameter: YPHI <- "108.448026"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.306035906"
Evaluating: 0.306035906*360.0
 Parameter: ZPHI <- "110.172926"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-51.0450379"
 Parameter: YPOS -> "54.2993738"
 Parameter: ZPOS -> "51.92072"
 Parameter: XPHI -> "274.605494"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.080295   -0.996771
    0.000000    0.996771    0.080295

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   85.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-51.0450379"
 Parameter: YPOS -> "54.2993738"
 Parameter: ZPOS -> "51.92072"
 Parameter: YPHI -> "108.448026"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.316444    0.000000   -0.948611
    0.000000    1.000000    0.000000
    0.948611    0.000000   -0.316444

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  108.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-51.0450379"
 Parameter: YPOS -> "54.2993738"
 Parameter: ZPOS -> "51.92072"
 Parameter: ZPHI -> "110.172926"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.344855    0.938656    0.000000
   -0.938656   -0.344855    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  110.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.045038 XMAX =  -51.045038 XAVE =  -51.045038
    YMIN =   54.299374 YMAX =   54.299374 YAVE =   54.299374
    ZMIN =   51.920720 ZMAX =   51.920720 ZAVE =   51.920720
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-51.0450379"
Evaluating: -51.0450379+3.5
 Parameter: XMAX <- "-47.5450379"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "54.2993738"
Evaluating: 54.2993738+3.5
 Parameter: YMAX <- "57.7993738"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "51.92072"
Evaluating: 51.92072+3.5
 Parameter: ZMAX <- "55.42072"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-51.0450379"
Evaluating: -51.0450379-3.5
 Parameter: XMIN <- "-54.5450379"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "54.2993738"
Evaluating: 54.2993738-3.5
 Parameter: YMIN <- "50.7993738"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "51.92072"
Evaluating: 51.92072-3.5
 Parameter: ZMIN <- "48.42072"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-47.5450379"
 Parameter: XMIN -> "-54.5450379"
 Parameter: YMAX -> "57.7993738"
 Parameter: YMIN -> "50.7993738"
 Parameter: ZMAX -> "55.42072"
 Parameter: ZMIN -> "48.42072"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "127"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "127" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "127"
Evaluating: 127
 Parameter: J <- "127"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "127" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "127"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.302471699"
Evaluating: 125.050557*(0.302471699-0.5)
 Parameter: XPOS <- "-24.7010241"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.129038664"
Evaluating: 125.050557*(0.129038664-0.5)
 Parameter: YPOS <- "-46.3889217"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.823376288"
Evaluating: 152.572525*(0.823376288-0.5)+-4.51585405
 Parameter: ZPOS <- "44.8224827"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.8224827" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.8224827" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.7010241"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.7010241-0
 Parameter: XTRAN <- "-24.7010241"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.3889217"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.3889217-0
 Parameter: YTRAN <- "-46.3889217"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.8224827"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.8224827-0
 Parameter: ZTRAN <- "44.8224827"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.7010241"
 Parameter: YTRAN -> "-46.3889217"
 Parameter: ZTRAN -> "44.8224827"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -24.701024  -46.388922   44.822483
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.243132797"
Evaluating: 0.243132797*360.0
 Parameter: XPHI <- "87.5278069"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.212760336"
Evaluating: 0.212760336*360.0
 Parameter: YPHI <- "76.593721"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.610995301"
Evaluating: 0.610995301*360.0
 Parameter: ZPHI <- "219.958308"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.7010241"
 Parameter: YPOS -> "-46.3889217"
 Parameter: ZPOS -> "44.8224827"
 Parameter: XPHI -> "87.5278069"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.043135    0.999069
    0.000000   -0.999069    0.043135

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   87.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.7010241"
 Parameter: YPOS -> "-46.3889217"
 Parameter: ZPOS -> "44.8224827"
 Parameter: YPHI -> "76.593721"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.231855    0.000000   -0.972750
    0.000000    1.000000    0.000000
    0.972750    0.000000    0.231855

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   76.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.7010241"
 Parameter: YPOS -> "-46.3889217"
 Parameter: ZPOS -> "44.8224827"
 Parameter: ZPHI -> "219.958308"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.766512   -0.642230    0.000000
    0.642230   -0.766512    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  140.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.701024 XMAX =  -24.701024 XAVE =  -24.701024
    YMIN =  -46.388922 YMAX =  -46.388922 YAVE =  -46.388922
    ZMIN =   44.822483 ZMAX =   44.822483 ZAVE =   44.822483
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.7010241"
Evaluating: -24.7010241+3.5
 Parameter: XMAX <- "-21.2010241"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.3889217"
Evaluating: -46.3889217+3.5
 Parameter: YMAX <- "-42.8889217"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.8224827"
Evaluating: 44.8224827+3.5
 Parameter: ZMAX <- "48.3224827"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.7010241"
Evaluating: -24.7010241-3.5
 Parameter: XMIN <- "-28.2010241"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.3889217"
Evaluating: -46.3889217-3.5
 Parameter: YMIN <- "-49.8889217"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.8224827"
Evaluating: 44.8224827-3.5
 Parameter: ZMIN <- "41.3224827"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.2010241"
 Parameter: XMIN -> "-28.2010241"
 Parameter: YMAX -> "-42.8889217"
 Parameter: YMIN -> "-49.8889217"
 Parameter: ZMAX -> "48.3224827"
 Parameter: ZMIN -> "41.3224827"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "128"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "128" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "128"
Evaluating: 128
 Parameter: J <- "128"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "128" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "128"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.627106465"
Evaluating: 125.050557*(0.627106465-0.5)
 Parameter: XPOS <- "15.8947342"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.835519824"
Evaluating: 125.050557*(0.835519824-0.5)
 Parameter: YPOS <- "41.9569409"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.507971093"
Evaluating: 152.572525*(0.507971093-0.5)+-4.51585405
 Parameter: ZPOS <- "-3.29968426"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.29968426" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.29968426" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "128"
Evaluating: 128
 Parameter: J <- "128"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "128" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "128"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.8220541"
Evaluating: 125.050557*(0.8220541-0.5)
 Parameter: XPOS <- "40.2730446"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.48233371"
Evaluating: 125.050557*(0.48233371-0.5)
 Parameter: YPOS <- "-2.2091794"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.459581253"
Evaluating: 152.572525*(0.459581253-0.5)+-4.51585405
 Parameter: ZPOS <- "-10.6826443"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.6826443" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.6826443" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "128"
Evaluating: 128
 Parameter: J <- "128"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "128" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "128"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.771452926"
Evaluating: 125.050557*(0.771452926-0.5)
 Parameter: XPOS <- "33.9453396"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.141439552"
Evaluating: 125.050557*(0.141439552-0.5)
 Parameter: YPOS <- "-44.8381837"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.237074606"
Evaluating: 152.572525*(0.237074606-0.5)+-4.51585405
 Parameter: ZPOS <- "-44.6310453"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.6310453" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.9453396"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.9453396-0
 Parameter: XTRAN <- "33.9453396"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.8381837"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -44.8381837-0
 Parameter: YTRAN <- "-44.8381837"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.6310453"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -44.6310453-0
 Parameter: ZTRAN <- "-44.6310453"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.9453396"
 Parameter: YTRAN -> "-44.8381837"
 Parameter: ZTRAN -> "-44.6310453"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    33.945340  -44.838184  -44.631045
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.682905349"
Evaluating: 0.682905349*360.0
 Parameter: XPHI <- "245.845926"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.897695461"
Evaluating: 0.897695461*360.0
 Parameter: YPHI <- "323.170366"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.523296239"
Evaluating: 0.523296239*360.0
 Parameter: ZPHI <- "188.386646"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.9453396"
 Parameter: YPOS -> "-44.8381837"
 Parameter: ZPOS -> "-44.6310453"
 Parameter: XPHI -> "245.845926"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.409192   -0.912448
    0.000000    0.912448   -0.409192

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  114.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.9453396"
 Parameter: YPOS -> "-44.8381837"
 Parameter: ZPOS -> "-44.6310453"
 Parameter: YPHI -> "323.170366"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.800421    0.000000    0.599438
    0.000000    1.000000    0.000000
   -0.599438    0.000000    0.800421

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   36.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.9453396"
 Parameter: YPOS -> "-44.8381837"
 Parameter: ZPOS -> "-44.6310453"
 Parameter: ZPHI -> "188.386646"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.989306   -0.145852    0.000000
    0.145852   -0.989306    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  171.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.945340 XMAX =   33.945340 XAVE =   33.945340
    YMIN =  -44.838184 YMAX =  -44.838184 YAVE =  -44.838184
    ZMIN =  -44.631045 ZMAX =  -44.631045 ZAVE =  -44.631045
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.9453396"
Evaluating: 33.9453396+3.5
 Parameter: XMAX <- "37.4453396"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.8381837"
Evaluating: -44.8381837+3.5
 Parameter: YMAX <- "-41.3381837"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.6310453"
Evaluating: -44.6310453+3.5
 Parameter: ZMAX <- "-41.1310453"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.9453396"
Evaluating: 33.9453396-3.5
 Parameter: XMIN <- "30.4453396"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.8381837"
Evaluating: -44.8381837-3.5
 Parameter: YMIN <- "-48.3381837"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.6310453"
Evaluating: -44.6310453-3.5
 Parameter: ZMIN <- "-48.1310453"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.4453396"
 Parameter: XMIN -> "30.4453396"
 Parameter: YMAX -> "-41.3381837"
 Parameter: YMIN -> "-48.3381837"
 Parameter: ZMAX -> "-41.1310453"
 Parameter: ZMIN -> "-48.1310453"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "129"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "129" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "129"
Evaluating: 129
 Parameter: J <- "129"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "129" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "129"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.182949436"
Evaluating: 125.050557*(0.182949436-0.5)
 Parameter: XPOS <- "-39.6473496"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.660839302"
Evaluating: 125.050557*(0.660839302-0.5)
 Parameter: YPOS <- "20.1130443"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.785688723"
Evaluating: 152.572525*(0.785688723-0.5)+-4.51585405
 Parameter: ZPOS <- "39.0723958"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.0723958" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.0723958" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.6473496"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.6473496-0
 Parameter: XTRAN <- "-39.6473496"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.1130443"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 20.1130443-0
 Parameter: YTRAN <- "20.1130443"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.0723958"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.0723958-0
 Parameter: ZTRAN <- "39.0723958"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.6473496"
 Parameter: YTRAN -> "20.1130443"
 Parameter: ZTRAN -> "39.0723958"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -39.647350   20.113044   39.072396
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.105731941"
Evaluating: 0.105731941*360.0
 Parameter: XPHI <- "38.0634988"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.233777878E-02"
Evaluating: 4.233777878E-02*360.0
 Parameter: YPHI <- "15.2416004"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.906551452"
Evaluating: 0.906551452*360.0
 Parameter: ZPHI <- "326.358523"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.6473496"
 Parameter: YPOS -> "20.1130443"
 Parameter: ZPOS -> "39.0723958"
 Parameter: XPHI -> "38.0634988"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.787328    0.616534
    0.000000   -0.616534    0.787328

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   38.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.6473496"
 Parameter: YPOS -> "20.1130443"
 Parameter: ZPOS -> "39.0723958"
 Parameter: YPHI -> "15.2416004"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.964826    0.000000   -0.262890
    0.000000    1.000000    0.000000
    0.262890    0.000000    0.964826

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   15.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.6473496"
 Parameter: YPOS -> "20.1130443"
 Parameter: ZPOS -> "39.0723958"
 Parameter: ZPHI -> "326.358523"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.832520   -0.553994    0.000000
    0.553994    0.832520    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   33.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.647350 XMAX =  -39.647350 XAVE =  -39.647350
    YMIN =   20.113044 YMAX =   20.113044 YAVE =   20.113044
    ZMIN =   39.072396 ZMAX =   39.072396 ZAVE =   39.072396
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.6473496"
Evaluating: -39.6473496+3.5
 Parameter: XMAX <- "-36.1473496"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.1130443"
Evaluating: 20.1130443+3.5
 Parameter: YMAX <- "23.6130443"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.0723958"
Evaluating: 39.0723958+3.5
 Parameter: ZMAX <- "42.5723958"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.6473496"
Evaluating: -39.6473496-3.5
 Parameter: XMIN <- "-43.1473496"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.1130443"
Evaluating: 20.1130443-3.5
 Parameter: YMIN <- "16.6130443"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.0723958"
Evaluating: 39.0723958-3.5
 Parameter: ZMIN <- "35.5723958"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.1473496"
 Parameter: XMIN -> "-43.1473496"
 Parameter: YMAX -> "23.6130443"
 Parameter: YMIN -> "16.6130443"
 Parameter: ZMAX -> "42.5723958"
 Parameter: ZMIN -> "35.5723958"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "130"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "130" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "130" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "130"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.699091923"
Evaluating: 125.050557*(0.699091923-0.5)
 Parameter: XPOS <- "24.8965559"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.314316082"
Evaluating: 125.050557*(0.314316082-0.5)
 Parameter: YPOS <- "-23.2198774"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.604712982"
Evaluating: 152.572525*(0.604712982-0.5)+-4.51585405
 Parameter: ZPOS <- "11.46047"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.46047" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.46047" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "130" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "130"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.868096881"
Evaluating: 125.050557*(0.868096881-0.5)
 Parameter: XPOS <- "46.03072"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.566993089"
Evaluating: 125.050557*(0.566993089-0.5)
 Parameter: YPOS <- "8.37752309"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.487666953"
Evaluating: 152.572525*(0.487666953-0.5)+-4.51585405
 Parameter: ZPOS <- "-6.39753817"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.39753817" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.39753817" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "130" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "130"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.286355146"
Evaluating: 125.050557*(0.286355146-0.5)
 Parameter: XPOS <- "-26.716408"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.683814636"
Evaluating: 125.050557*(0.683814636-0.5)
 Parameter: YPOS <- "22.9861226"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.143792795"
Evaluating: 152.572525*(0.143792795-0.5)+-4.51585405
 Parameter: ZPOS <- "-58.8632867"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-58.8632867" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.716408"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -26.716408-0
 Parameter: XTRAN <- "-26.716408"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.9861226"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 22.9861226-0
 Parameter: YTRAN <- "22.9861226"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-58.8632867"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -58.8632867-0
 Parameter: ZTRAN <- "-58.8632867"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-26.716408"
 Parameter: YTRAN -> "22.9861226"
 Parameter: ZTRAN -> "-58.8632867"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -26.716408   22.986123  -58.863287
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.519681903"
Evaluating: 0.519681903*360.0
 Parameter: XPHI <- "187.085485"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.848528137"
Evaluating: 0.848528137*360.0
 Parameter: YPHI <- "305.470129"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.092234173E-02"
Evaluating: 8.092234173E-02*360.0
 Parameter: ZPHI <- "29.132043"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.716408"
 Parameter: YPOS -> "22.9861226"
 Parameter: ZPOS -> "-58.8632867"
 Parameter: XPHI -> "187.085485"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.992363   -0.123350
    0.000000    0.123350   -0.992363

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  172.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.716408"
 Parameter: YPOS -> "22.9861226"
 Parameter: ZPOS -> "-58.8632867"
 Parameter: YPHI -> "305.470129"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.580278    0.000000    0.814418
    0.000000    1.000000    0.000000
   -0.814418    0.000000    0.580278

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   54.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.716408"
 Parameter: YPOS -> "22.9861226"
 Parameter: ZPOS -> "-58.8632867"
 Parameter: ZPHI -> "29.132043"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.873500    0.486824    0.000000
   -0.486824    0.873500    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   29.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.716408 XMAX =  -26.716408 XAVE =  -26.716408
    YMIN =   22.986123 YMAX =   22.986123 YAVE =   22.986123
    ZMIN =  -58.863287 ZMAX =  -58.863287 ZAVE =  -58.863287
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.716408"
Evaluating: -26.716408+3.5
 Parameter: XMAX <- "-23.216408"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.9861226"
Evaluating: 22.9861226+3.5
 Parameter: YMAX <- "26.4861226"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-58.8632867"
Evaluating: -58.8632867+3.5
 Parameter: ZMAX <- "-55.3632867"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.716408"
Evaluating: -26.716408-3.5
 Parameter: XMIN <- "-30.216408"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.9861226"
Evaluating: 22.9861226-3.5
 Parameter: YMIN <- "19.4861226"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-58.8632867"
Evaluating: -58.8632867-3.5
 Parameter: ZMIN <- "-62.3632867"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.216408"
 Parameter: XMIN -> "-30.216408"
 Parameter: YMAX -> "26.4861226"
 Parameter: YMIN -> "19.4861226"
 Parameter: ZMAX -> "-55.3632867"
 Parameter: ZMIN -> "-62.3632867"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "131"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "131" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "131"
Evaluating: 131
 Parameter: J <- "131"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "131" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "131"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.150292889"
Evaluating: 125.050557*(0.150292889-0.5)
 Parameter: XPOS <- "-43.731069"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.812486834"
Evaluating: 125.050557*(0.812486834-0.5)
 Parameter: YPOS <- "39.0766526"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.865130655"
Evaluating: 152.572525*(0.865130655-0.5)+-4.51585405
 Parameter: ZPOS <- "51.1930519"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "51.1930519" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "51.1930519" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.731069"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.731069-0
 Parameter: XTRAN <- "-43.731069"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.0766526"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 39.0766526-0
 Parameter: YTRAN <- "39.0766526"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "51.1930519"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 51.1930519-0
 Parameter: ZTRAN <- "51.1930519"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.731069"
 Parameter: YTRAN -> "39.0766526"
 Parameter: ZTRAN -> "51.1930519"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -43.731069   39.076653   51.193052
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.767274063"
Evaluating: 0.767274063*360.0
 Parameter: XPHI <- "276.218663"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.878017523"
Evaluating: 0.878017523*360.0
 Parameter: YPHI <- "316.086308"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.7382657"
Evaluating: 0.7382657*360.0
 Parameter: ZPHI <- "265.775652"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.731069"
 Parameter: YPOS -> "39.0766526"
 Parameter: ZPOS -> "51.1930519"
 Parameter: XPHI -> "276.218663"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.108323   -0.994116
    0.000000    0.994116    0.108323

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   83.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.731069"
 Parameter: YPOS -> "39.0766526"
 Parameter: ZPOS -> "51.1930519"
 Parameter: YPHI -> "316.086308"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.720385    0.000000    0.693574
    0.000000    1.000000    0.000000
   -0.693574    0.000000    0.720385

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   43.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.731069"
 Parameter: YPOS -> "39.0766526"
 Parameter: ZPOS -> "51.1930519"
 Parameter: ZPHI -> "265.775652"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.073662   -0.997283    0.000000
    0.997283   -0.073662    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   94.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.731069 XMAX =  -43.731069 XAVE =  -43.731069
    YMIN =   39.076653 YMAX =   39.076653 YAVE =   39.076653
    ZMIN =   51.193052 ZMAX =   51.193052 ZAVE =   51.193052
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.731069"
Evaluating: -43.731069+3.5
 Parameter: XMAX <- "-40.231069"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.0766526"
Evaluating: 39.0766526+3.5
 Parameter: YMAX <- "42.5766526"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "51.1930519"
Evaluating: 51.1930519+3.5
 Parameter: ZMAX <- "54.6930519"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.731069"
Evaluating: -43.731069-3.5
 Parameter: XMIN <- "-47.231069"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.0766526"
Evaluating: 39.0766526-3.5
 Parameter: YMIN <- "35.5766526"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "51.1930519"
Evaluating: 51.1930519-3.5
 Parameter: ZMIN <- "47.6930519"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.231069"
 Parameter: XMIN -> "-47.231069"
 Parameter: YMAX -> "42.5766526"
 Parameter: YMIN -> "35.5766526"
 Parameter: ZMAX -> "54.6930519"
 Parameter: ZMIN -> "47.6930519"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "132"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "132" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "132"
Evaluating: 132
 Parameter: J <- "132"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "132" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "132"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.503630868"
Evaluating: 125.050557*(0.503630868-0.5)
 Parameter: XPOS <- "0.454042066"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.902621384"
Evaluating: 125.050557*(0.902621384-0.5)
 Parameter: YPOS <- "50.3480283"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.211575685"
Evaluating: 152.572525*(0.211575685-0.5)+-4.51585405
 Parameter: ZPOS <- "-48.5214801"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.5214801" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.454042066"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 0.454042066-0
 Parameter: XTRAN <- "0.454042066"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "50.3480283"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 50.3480283-0
 Parameter: YTRAN <- "50.3480283"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.5214801"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.5214801-0
 Parameter: ZTRAN <- "-48.5214801"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.454042066"
 Parameter: YTRAN -> "50.3480283"
 Parameter: ZTRAN -> "-48.5214801"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     0.454042   50.348028  -48.521480
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.115391829"
Evaluating: 0.115391829*360.0
 Parameter: XPHI <- "41.5410584"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.633849417"
Evaluating: 0.633849417*360.0
 Parameter: YPHI <- "228.18579"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.446488921"
Evaluating: 0.446488921*360.0
 Parameter: ZPHI <- "160.736012"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.454042066"
 Parameter: YPOS -> "50.3480283"
 Parameter: ZPOS -> "-48.5214801"
 Parameter: XPHI -> "41.5410584"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.748481    0.663157
    0.000000   -0.663157    0.748481

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   41.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.454042066"
 Parameter: YPOS -> "50.3480283"
 Parameter: ZPOS -> "-48.5214801"
 Parameter: YPHI -> "228.18579"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.666717    0.000000    0.745311
    0.000000    1.000000    0.000000
   -0.745311    0.000000   -0.666717

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  131.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.454042066"
 Parameter: YPOS -> "50.3480283"
 Parameter: ZPOS -> "-48.5214801"
 Parameter: ZPHI -> "160.736012"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.944009    0.329921    0.000000
   -0.329921   -0.944009    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  160.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.454042 XMAX =    0.454042 XAVE =    0.454042
    YMIN =   50.348028 YMAX =   50.348028 YAVE =   50.348028
    ZMIN =  -48.521480 ZMAX =  -48.521480 ZAVE =  -48.521480
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.454042066"
Evaluating: 0.454042066+3.5
 Parameter: XMAX <- "3.95404207"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "50.3480283"
Evaluating: 50.3480283+3.5
 Parameter: YMAX <- "53.8480283"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.5214801"
Evaluating: -48.5214801+3.5
 Parameter: ZMAX <- "-45.0214801"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.454042066"
Evaluating: 0.454042066-3.5
 Parameter: XMIN <- "-3.04595793"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "50.3480283"
Evaluating: 50.3480283-3.5
 Parameter: YMIN <- "46.8480283"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.5214801"
Evaluating: -48.5214801-3.5
 Parameter: ZMIN <- "-52.0214801"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.95404207"
 Parameter: XMIN -> "-3.04595793"
 Parameter: YMAX -> "53.8480283"
 Parameter: YMIN -> "46.8480283"
 Parameter: ZMAX -> "-45.0214801"
 Parameter: ZMIN -> "-52.0214801"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "133"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "133" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "133" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "133"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.190400362"
Evaluating: 125.050557*(0.190400362-0.5)
 Parameter: XPOS <- "-38.7156072"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.539859483"
Evaluating: 125.050557*(0.539859483-0.5)
 Parameter: YPOS <- "4.98445055"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.970401738"
Evaluating: 152.572525*(0.970401738-0.5)+-4.51585405
 Parameter: ZPOS <- "67.2545269"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "67.2545269" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "67.2545269" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.7156072"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.7156072-0
 Parameter: XTRAN <- "-38.7156072"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.98445055"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 4.98445055-0
 Parameter: YTRAN <- "4.98445055"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "67.2545269"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 67.2545269-0
 Parameter: ZTRAN <- "67.2545269"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.7156072"
 Parameter: YTRAN -> "4.98445055"
 Parameter: ZTRAN -> "67.2545269"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -38.715607    4.984451   67.254527
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.613573949"
Evaluating: 0.613573949*360.0
 Parameter: XPHI <- "220.886622"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.986966847"
Evaluating: 0.986966847*360.0
 Parameter: YPHI <- "355.308065"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.170434386"
Evaluating: 0.170434386*360.0
 Parameter: ZPHI <- "61.356379"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.7156072"
 Parameter: YPOS -> "4.98445055"
 Parameter: ZPOS -> "67.2545269"
 Parameter: XPHI -> "220.886622"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.756006   -0.654564
    0.000000    0.654564   -0.756006

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  139.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.7156072"
 Parameter: YPOS -> "4.98445055"
 Parameter: ZPOS -> "67.2545269"
 Parameter: YPHI -> "355.308065"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.996649    0.000000    0.081798
    0.000000    1.000000    0.000000
   -0.081798    0.000000    0.996649

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    4.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.7156072"
 Parameter: YPOS -> "4.98445055"
 Parameter: ZPOS -> "67.2545269"
 Parameter: ZPHI -> "61.356379"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.479360    0.877618    0.000000
   -0.877618    0.479360    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   61.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.715607 XMAX =  -38.715607 XAVE =  -38.715607
    YMIN =    4.984451 YMAX =    4.984451 YAVE =    4.984451
    ZMIN =   67.254527 ZMAX =   67.254527 ZAVE =   67.254527
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.7156072"
Evaluating: -38.7156072+3.5
 Parameter: XMAX <- "-35.2156072"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.98445055"
Evaluating: 4.98445055+3.5
 Parameter: YMAX <- "8.48445055"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "67.2545269"
Evaluating: 67.2545269+3.5
 Parameter: ZMAX <- "70.7545269"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.7156072"
Evaluating: -38.7156072-3.5
 Parameter: XMIN <- "-42.2156072"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.98445055"
Evaluating: 4.98445055-3.5
 Parameter: YMIN <- "1.48445055"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "67.2545269"
Evaluating: 67.2545269-3.5
 Parameter: ZMIN <- "63.7545269"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.2156072"
 Parameter: XMIN -> "-42.2156072"
 Parameter: YMAX -> "8.48445055"
 Parameter: YMIN -> "1.48445055"
 Parameter: ZMAX -> "70.7545269"
 Parameter: ZMIN -> "63.7545269"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "134"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "134" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "134" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "134"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.34442908"
Evaluating: 125.050557*(0.34442908-0.5)
 Parameter: XPOS <- "-19.4542302"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.514692012"
Evaluating: 125.050557*(0.514692012-0.5)
 Parameter: YPOS <- "1.83724428"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.518069972"
Evaluating: 152.572525*(0.518069972-0.5)+-4.51585405
 Parameter: ZPOS <- "-1.7588728"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.7588728" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.7588728" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "134" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "134"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.357288439"
Evaluating: 125.050557*(0.357288439-0.5)
 Parameter: XPOS <- "-17.8461602"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "7.212055001E-02"
Evaluating: 125.050557*(7.212055001E-02-0.5)
 Parameter: YPOS <- "-53.5065636"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.675017111"
Evaluating: 152.572525*(0.675017111-0.5)+-4.51585405
 Parameter: ZPOS <- "22.1869485"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.1869485" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.1869485" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.8461602"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.8461602-0
 Parameter: XTRAN <- "-17.8461602"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-53.5065636"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -53.5065636-0
 Parameter: YTRAN <- "-53.5065636"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.1869485"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.1869485-0
 Parameter: ZTRAN <- "22.1869485"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.8461602"
 Parameter: YTRAN -> "-53.5065636"
 Parameter: ZTRAN -> "22.1869485"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -17.846160  -53.506564   22.186948
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.886727103"
Evaluating: 0.886727103*360.0
 Parameter: XPHI <- "319.221757"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.442297276"
Evaluating: 0.442297276*360.0
 Parameter: YPHI <- "159.227019"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.19047728"
Evaluating: 0.19047728*360.0
 Parameter: ZPHI <- "68.5718208"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.8461602"
 Parameter: YPOS -> "-53.5065636"
 Parameter: ZPOS -> "22.1869485"
 Parameter: XPHI -> "319.221757"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.757243   -0.653133
    0.000000    0.653133    0.757243

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   40.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.8461602"
 Parameter: YPOS -> "-53.5065636"
 Parameter: ZPOS -> "22.1869485"
 Parameter: YPHI -> "159.227019"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.934993    0.000000   -0.354666
    0.000000    1.000000    0.000000
    0.354666    0.000000   -0.934993

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  159.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.8461602"
 Parameter: YPOS -> "-53.5065636"
 Parameter: ZPOS -> "22.1869485"
 Parameter: ZPHI -> "68.5718208"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.365335    0.930876    0.000000
   -0.930876    0.365335    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   68.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.846160 XMAX =  -17.846160 XAVE =  -17.846160
    YMIN =  -53.506564 YMAX =  -53.506564 YAVE =  -53.506564
    ZMIN =   22.186948 ZMAX =   22.186948 ZAVE =   22.186948
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.8461602"
Evaluating: -17.8461602+3.5
 Parameter: XMAX <- "-14.3461602"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-53.5065636"
Evaluating: -53.5065636+3.5
 Parameter: YMAX <- "-50.0065636"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.1869485"
Evaluating: 22.1869485+3.5
 Parameter: ZMAX <- "25.6869485"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.8461602"
Evaluating: -17.8461602-3.5
 Parameter: XMIN <- "-21.3461602"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-53.5065636"
Evaluating: -53.5065636-3.5
 Parameter: YMIN <- "-57.0065636"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.1869485"
Evaluating: 22.1869485-3.5
 Parameter: ZMIN <- "18.6869485"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.3461602"
 Parameter: XMIN -> "-21.3461602"
 Parameter: YMAX -> "-50.0065636"
 Parameter: YMIN -> "-57.0065636"
 Parameter: ZMAX -> "25.6869485"
 Parameter: ZMIN -> "18.6869485"
 SELRPN>      7 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      3 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64549 POS      SOD      134      SOD     -**** MEMB     POPC     50       C13           3.2483
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "134" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "134"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.356710952"
Evaluating: 125.050557*(0.356710952-0.5)
 Parameter: XPOS <- "-17.9183753"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.103341307"
Evaluating: 125.050557*(0.103341307-0.5)
 Parameter: YPOS <- "-49.6023905"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.205066715"
Evaluating: 152.572525*(0.205066715-0.5)+-4.51585405
 Parameter: ZPOS <- "-49.51457"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-49.51457" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.846160 XMAX =  -17.846160 XAVE =  -17.846160
    YMIN =  -53.506564 YMAX =  -53.506564 YAVE =  -53.506564
    ZMIN =   22.186948 ZMAX =   22.186948 ZAVE =   22.186948
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.9183753"
 RDCMND substituted energy or value "?XAVE" to "-17.8461602"
Evaluating: -17.9183753--17.8461602
 Parameter: XTRAN <- "-7.22151E-02"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.6023905"
 RDCMND substituted energy or value "?YAVE" to "-53.5065636"
Evaluating: -49.6023905--53.5065636
 Parameter: YTRAN <- "3.9041731"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-49.51457"
 RDCMND substituted energy or value "?ZAVE" to "22.1869485"
Evaluating: -49.51457-22.1869485
 Parameter: ZTRAN <- "-71.7015185"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.22151E-02"
 Parameter: YTRAN -> "3.9041731"
 Parameter: ZTRAN -> "-71.7015185"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -0.072215    3.904173  -71.701519
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126949738"
Evaluating: 0.126949738*360.0
 Parameter: XPHI <- "45.7019057"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.802420932"
Evaluating: 0.802420932*360.0
 Parameter: YPHI <- "288.871536"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.543558016"
Evaluating: 0.543558016*360.0
 Parameter: ZPHI <- "195.680886"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.9183753"
 Parameter: YPOS -> "-49.6023905"
 Parameter: ZPOS -> "-49.51457"
 Parameter: XPHI -> "45.7019057"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.698391    0.715716
    0.000000   -0.715716    0.698391

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   45.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.9183753"
 Parameter: YPOS -> "-49.6023905"
 Parameter: ZPOS -> "-49.51457"
 Parameter: YPHI -> "288.871536"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.323447    0.000000    0.946246
    0.000000    1.000000    0.000000
   -0.946246    0.000000    0.323447

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.9183753"
 Parameter: YPOS -> "-49.6023905"
 Parameter: ZPOS -> "-49.51457"
 Parameter: ZPHI -> "195.680886"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.962782   -0.270279    0.000000
    0.270279   -0.962782    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  164.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.918375 XMAX =  -17.918375 XAVE =  -17.918375
    YMIN =  -49.602390 YMAX =  -49.602390 YAVE =  -49.602390
    ZMIN =  -49.514570 ZMAX =  -49.514570 ZAVE =  -49.514570
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.9183753"
Evaluating: -17.9183753+3.5
 Parameter: XMAX <- "-14.4183753"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.6023905"
Evaluating: -49.6023905+3.5
 Parameter: YMAX <- "-46.1023905"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-49.51457"
Evaluating: -49.51457+3.5
 Parameter: ZMAX <- "-46.01457"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.9183753"
Evaluating: -17.9183753-3.5
 Parameter: XMIN <- "-21.4183753"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.6023905"
Evaluating: -49.6023905-3.5
 Parameter: YMIN <- "-53.1023905"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-49.51457"
Evaluating: -49.51457-3.5
 Parameter: ZMIN <- "-53.01457"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.4183753"
 Parameter: XMIN -> "-21.4183753"
 Parameter: YMAX -> "-46.1023905"
 Parameter: YMIN -> "-53.1023905"
 Parameter: ZMAX -> "-46.01457"
 Parameter: ZMIN -> "-53.01457"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "135"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "135" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "135"
Evaluating: 135
 Parameter: J <- "135"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "135" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "135"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.19413423"
Evaluating: 125.050557*(0.19413423-0.5)
 Parameter: XPOS <- "-38.2486849"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.187717254E-02"
Evaluating: 125.050557*(1.187717254E-02-0.5)
 Parameter: YPOS <- "-61.0400315"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.188323551"
Evaluating: 152.572525*(0.188323551-0.5)+-4.51585405
 Parameter: ZPOS <- "-52.0691169"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-52.0691169" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.2486849"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.2486849-0
 Parameter: XTRAN <- "-38.2486849"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-61.0400315"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -61.0400315-0
 Parameter: YTRAN <- "-61.0400315"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-52.0691169"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -52.0691169-0
 Parameter: ZTRAN <- "-52.0691169"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.2486849"
 Parameter: YTRAN -> "-61.0400315"
 Parameter: ZTRAN -> "-52.0691169"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -38.248685  -61.040031  -52.069117
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.91132534"
Evaluating: 0.91132534*360.0
 Parameter: XPHI <- "328.077122"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.171270407"
Evaluating: 0.171270407*360.0
 Parameter: YPHI <- "61.6573465"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.437249656"
Evaluating: 0.437249656*360.0
 Parameter: ZPHI <- "157.409876"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.2486849"
 Parameter: YPOS -> "-61.0400315"
 Parameter: ZPOS -> "-52.0691169"
 Parameter: XPHI -> "328.077122"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.848761   -0.528777
    0.000000    0.528777    0.848761

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   31.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.2486849"
 Parameter: YPOS -> "-61.0400315"
 Parameter: ZPOS -> "-52.0691169"
 Parameter: YPHI -> "61.6573465"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.474744    0.000000   -0.880124
    0.000000    1.000000    0.000000
    0.880124    0.000000    0.474744

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   61.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.2486849"
 Parameter: YPOS -> "-61.0400315"
 Parameter: ZPOS -> "-52.0691169"
 Parameter: ZPHI -> "157.409876"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.923276    0.384136    0.000000
   -0.384136   -0.923276    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  157.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.248685 XMAX =  -38.248685 XAVE =  -38.248685
    YMIN =  -61.040031 YMAX =  -61.040031 YAVE =  -61.040031
    ZMIN =  -52.069117 ZMAX =  -52.069117 ZAVE =  -52.069117
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.2486849"
Evaluating: -38.2486849+3.5
 Parameter: XMAX <- "-34.7486849"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-61.0400315"
Evaluating: -61.0400315+3.5
 Parameter: YMAX <- "-57.5400315"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-52.0691169"
Evaluating: -52.0691169+3.5
 Parameter: ZMAX <- "-48.5691169"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.2486849"
Evaluating: -38.2486849-3.5
 Parameter: XMIN <- "-41.7486849"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-61.0400315"
Evaluating: -61.0400315-3.5
 Parameter: YMIN <- "-64.5400315"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-52.0691169"
Evaluating: -52.0691169-3.5
 Parameter: ZMIN <- "-55.5691169"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.7486849"
 Parameter: XMIN -> "-41.7486849"
 Parameter: YMAX -> "-57.5400315"
 Parameter: YMIN -> "-64.5400315"
 Parameter: ZMAX -> "-48.5691169"
 Parameter: ZMIN -> "-55.5691169"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "136"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "136" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "136" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.962676663"
Evaluating: 125.050557*(0.962676663-0.5)
 Parameter: XPOS <- "57.8579744"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.509376147"
Evaluating: 125.050557*(0.509376147-0.5)
 Parameter: YPOS <- "1.1724924"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.554978492"
Evaluating: 152.572525*(0.554978492-0.5)+-4.51585405
 Parameter: ZPOS <- "3.8723533"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.8723533" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.8723533" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "136" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.711864381"
Evaluating: 125.050557*(0.711864381-0.5)
 Parameter: XPOS <- "26.4937589"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.591218206"
Evaluating: 125.050557*(0.591218206-0.5)
 Parameter: YPOS <- "11.4068875"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.63860155"
Evaluating: 152.572525*(0.63860155-0.5)+-4.51585405
 Parameter: ZPOS <- "16.6309344"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.6309344" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.6309344" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.4937589"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.4937589-0
 Parameter: XTRAN <- "26.4937589"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.4068875"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 11.4068875-0
 Parameter: YTRAN <- "11.4068875"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.6309344"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.6309344-0
 Parameter: ZTRAN <- "16.6309344"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.4937589"
 Parameter: YTRAN -> "11.4068875"
 Parameter: ZTRAN -> "16.6309344"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    26.493759   11.406887   16.630934
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.773408261"
Evaluating: 0.773408261*360.0
 Parameter: XPHI <- "278.426974"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.291812575"
Evaluating: 0.291812575*360.0
 Parameter: YPHI <- "105.052527"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.874954376E-02"
Evaluating: 2.874954376E-02*360.0
 Parameter: ZPHI <- "10.3498358"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.4937589"
 Parameter: YPOS -> "11.4068875"
 Parameter: ZPOS -> "16.6309344"
 Parameter: XPHI -> "278.426974"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.146549   -0.989203
    0.000000    0.989203    0.146549

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   81.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.4937589"
 Parameter: YPOS -> "11.4068875"
 Parameter: ZPOS -> "16.6309344"
 Parameter: YPHI -> "105.052527"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.259704    0.000000   -0.965688
    0.000000    1.000000    0.000000
    0.965688    0.000000   -0.259704

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  105.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.4937589"
 Parameter: YPOS -> "11.4068875"
 Parameter: ZPOS -> "16.6309344"
 Parameter: ZPHI -> "10.3498358"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.983729    0.179658    0.000000
   -0.179658    0.983729    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   10.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.493759 XMAX =   26.493759 XAVE =   26.493759
    YMIN =   11.406887 YMAX =   11.406887 YAVE =   11.406887
    ZMIN =   16.630934 ZMAX =   16.630934 ZAVE =   16.630934
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.4937589"
Evaluating: 26.4937589+3.5
 Parameter: XMAX <- "29.9937589"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.4068875"
Evaluating: 11.4068875+3.5
 Parameter: YMAX <- "14.9068875"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.6309344"
Evaluating: 16.6309344+3.5
 Parameter: ZMAX <- "20.1309344"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.4937589"
Evaluating: 26.4937589-3.5
 Parameter: XMIN <- "22.9937589"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.4068875"
Evaluating: 11.4068875-3.5
 Parameter: YMIN <- "7.9068875"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.6309344"
Evaluating: 16.6309344-3.5
 Parameter: ZMIN <- "13.1309344"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.9937589"
 Parameter: XMIN -> "22.9937589"
 Parameter: YMAX -> "14.9068875"
 Parameter: YMIN -> "7.9068875"
 Parameter: ZMAX -> "20.1309344"
 Parameter: ZMIN -> "13.1309344"
 SELRPN>     20 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     12 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64551 POS      SOD      136      SOD     -4381 PROA     GLU      308      CG            3.8345
64551 POS      SOD      136      SOD     -4384 PROA     GLU      308      CD            4.8773
64551 POS      SOD      136      SOD     -4393 PROA     TRP      309      CB            3.2745
64551 POS      SOD      136      SOD     -4396 PROA     TRP      309      CG            1.9450
64551 POS      SOD      136      SOD     -4397 PROA     TRP      309      CD1           1.0209
64551 POS      SOD      136      SOD     -4399 PROA     TRP      309      NE1           1.0125
64551 POS      SOD      136      SOD     -4401 PROA     TRP      309      CE2           1.9348
64551 POS      SOD      136      SOD     -4402 PROA     TRP      309      CD2           2.3437
64551 POS      SOD      136      SOD     -4403 PROA     TRP      309      CE3           3.6630
64551 POS      SOD      136      SOD     -4405 PROA     TRP      309      CZ3           4.3944
64551 POS      SOD      136      SOD     -4407 PROA     TRP      309      CZ2           3.1433
64551 POS      SOD      136      SOD     -4409 PROA     TRP      309      CH2           4.1957
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "136" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.896931257"
Evaluating: 125.050557*(0.896931257-0.5)
 Parameter: XPOS <- "49.6364748"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.856182079"
Evaluating: 125.050557*(0.856182079-0.5)
 Parameter: YPOS <- "44.5407674"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.244655719"
Evaluating: 152.572525*(0.244655719-0.5)+-4.51585405
 Parameter: ZPOS <- "-43.4743757"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.4743757" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.493759 XMAX =   26.493759 XAVE =   26.493759
    YMIN =   11.406887 YMAX =   11.406887 YAVE =   11.406887
    ZMIN =   16.630934 ZMAX =   16.630934 ZAVE =   16.630934
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.6364748"
 RDCMND substituted energy or value "?XAVE" to "26.4937589"
Evaluating: 49.6364748-26.4937589
 Parameter: XTRAN <- "23.1427159"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.5407674"
 RDCMND substituted energy or value "?YAVE" to "11.4068875"
Evaluating: 44.5407674-11.4068875
 Parameter: YTRAN <- "33.1338799"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.4743757"
 RDCMND substituted energy or value "?ZAVE" to "16.6309344"
Evaluating: -43.4743757-16.6309344
 Parameter: ZTRAN <- "-60.1053101"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.1427159"
 Parameter: YTRAN -> "33.1338799"
 Parameter: ZTRAN -> "-60.1053101"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    23.142716   33.133880  -60.105310
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.145456811"
Evaluating: 0.145456811*360.0
 Parameter: XPHI <- "52.364452"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.971515868"
Evaluating: 0.971515868*360.0
 Parameter: YPHI <- "349.745712"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.944545937E-02"
Evaluating: 4.944545937E-02*360.0
 Parameter: ZPHI <- "17.8003654"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.6364748"
 Parameter: YPOS -> "44.5407674"
 Parameter: ZPOS -> "-43.4743757"
 Parameter: XPHI -> "52.364452"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.610637    0.791911
    0.000000   -0.791911    0.610637

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   52.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.6364748"
 Parameter: YPOS -> "44.5407674"
 Parameter: ZPOS -> "-43.4743757"
 Parameter: YPHI -> "349.745712"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.984027    0.000000    0.178017
    0.000000    1.000000    0.000000
   -0.178017    0.000000    0.984027

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   10.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.6364748"
 Parameter: YPOS -> "44.5407674"
 Parameter: ZPOS -> "-43.4743757"
 Parameter: ZPHI -> "17.8003654"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.952127    0.305701    0.000000
   -0.305701    0.952127    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.636475 XMAX =   49.636475 XAVE =   49.636475
    YMIN =   44.540767 YMAX =   44.540767 YAVE =   44.540767
    ZMIN =  -43.474376 ZMAX =  -43.474376 ZAVE =  -43.474376
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.6364748"
Evaluating: 49.6364748+3.5
 Parameter: XMAX <- "53.1364748"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.5407674"
Evaluating: 44.5407674+3.5
 Parameter: YMAX <- "48.0407674"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.4743757"
Evaluating: -43.4743757+3.5
 Parameter: ZMAX <- "-39.9743757"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.6364748"
Evaluating: 49.6364748-3.5
 Parameter: XMIN <- "46.1364748"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.5407674"
Evaluating: 44.5407674-3.5
 Parameter: YMIN <- "41.0407674"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.4743757"
Evaluating: -43.4743757-3.5
 Parameter: ZMIN <- "-46.9743757"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.1364748"
 Parameter: XMIN -> "46.1364748"
 Parameter: YMAX -> "48.0407674"
 Parameter: YMIN -> "41.0407674"
 Parameter: ZMAX -> "-39.9743757"
 Parameter: ZMIN -> "-46.9743757"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "137"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "137" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "137" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "137"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.697992624"
Evaluating: 125.050557*(0.697992624-0.5)
 Parameter: XPOS <- "24.7590879"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.174277659"
Evaluating: 125.050557*(0.174277659-0.5)
 Parameter: YPOS <- "-40.7317602"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.679434209"
Evaluating: 152.572525*(0.679434209-0.5)+-4.51585405
 Parameter: ZPOS <- "22.8608763"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.8608763" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.8608763" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.7590879"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.7590879-0
 Parameter: XTRAN <- "24.7590879"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.7317602"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.7317602-0
 Parameter: YTRAN <- "-40.7317602"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.8608763"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.8608763-0
 Parameter: ZTRAN <- "22.8608763"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.7590879"
 Parameter: YTRAN -> "-40.7317602"
 Parameter: ZTRAN -> "22.8608763"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    24.759088  -40.731760   22.860876
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.3908223"
Evaluating: 0.3908223*360.0
 Parameter: XPHI <- "140.696028"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.878524283"
Evaluating: 0.878524283*360.0
 Parameter: YPHI <- "316.268742"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.693053097"
Evaluating: 0.693053097*360.0
 Parameter: ZPHI <- "249.499115"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.7590879"
 Parameter: YPOS -> "-40.7317602"
 Parameter: ZPOS -> "22.8608763"
 Parameter: XPHI -> "140.696028"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.773796    0.633435
    0.000000   -0.633435   -0.773796

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  140.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.7590879"
 Parameter: YPOS -> "-40.7317602"
 Parameter: ZPOS -> "22.8608763"
 Parameter: YPHI -> "316.268742"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.722590    0.000000    0.691277
    0.000000    1.000000    0.000000
   -0.691277    0.000000    0.722590

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   43.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.7590879"
 Parameter: YPOS -> "-40.7317602"
 Parameter: ZPOS -> "22.8608763"
 Parameter: ZPHI -> "249.499115"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.350222   -0.936667    0.000000
    0.936667   -0.350222    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  110.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.759088 XMAX =   24.759088 XAVE =   24.759088
    YMIN =  -40.731760 YMAX =  -40.731760 YAVE =  -40.731760
    ZMIN =   22.860876 ZMAX =   22.860876 ZAVE =   22.860876
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.7590879"
Evaluating: 24.7590879+3.5
 Parameter: XMAX <- "28.2590879"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.7317602"
Evaluating: -40.7317602+3.5
 Parameter: YMAX <- "-37.2317602"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.8608763"
Evaluating: 22.8608763+3.5
 Parameter: ZMAX <- "26.3608763"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.7590879"
Evaluating: 24.7590879-3.5
 Parameter: XMIN <- "21.2590879"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.7317602"
Evaluating: -40.7317602-3.5
 Parameter: YMIN <- "-44.2317602"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.8608763"
Evaluating: 22.8608763-3.5
 Parameter: ZMIN <- "19.3608763"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.2590879"
 Parameter: XMIN -> "21.2590879"
 Parameter: YMAX -> "-37.2317602"
 Parameter: YMIN -> "-44.2317602"
 Parameter: ZMAX -> "26.3608763"
 Parameter: ZMIN -> "19.3608763"
 SELRPN>     21 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      8 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64552 POS      SOD      137      SOD     -**** MEMB     POPC     64       N             3.0265
64552 POS      SOD      137      SOD     -**** MEMB     POPC     64       C12           3.9540
64552 POS      SOD      137      SOD     -**** MEMB     POPC     64       C13           1.6151
64552 POS      SOD      137      SOD     -**** MEMB     POPC     64       C14           3.4584
64552 POS      SOD      137      SOD     -**** MEMB     POPC     64       C15           3.7906
64552 POS      SOD      137      SOD     -**** MEMB     POPC     103      C13           3.7937
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "137" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "137"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.74059134"
Evaluating: 125.050557*(0.74059134-0.5)
 Parameter: XPOS <- "30.0860811"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.178784299"
Evaluating: 125.050557*(0.178784299-0.5)
 Parameter: YPOS <- "-40.1682023"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.332417339"
Evaluating: 152.572525*(0.332417339-0.5)+-4.51585405
 Parameter: ZPOS <- "-30.0843638"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.0843638" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.759088 XMAX =   24.759088 XAVE =   24.759088
    YMIN =  -40.731760 YMAX =  -40.731760 YAVE =  -40.731760
    ZMIN =   22.860876 ZMAX =   22.860876 ZAVE =   22.860876
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.0860811"
 RDCMND substituted energy or value "?XAVE" to "24.7590879"
Evaluating: 30.0860811-24.7590879
 Parameter: XTRAN <- "5.3269932"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.1682023"
 RDCMND substituted energy or value "?YAVE" to "-40.7317602"
Evaluating: -40.1682023--40.7317602
 Parameter: YTRAN <- "0.5635579"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.0843638"
 RDCMND substituted energy or value "?ZAVE" to "22.8608763"
Evaluating: -30.0843638-22.8608763
 Parameter: ZTRAN <- "-52.9452401"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.3269932"
 Parameter: YTRAN -> "0.5635579"
 Parameter: ZTRAN -> "-52.9452401"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     5.326993    0.563558  -52.945240
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.843904877E-02"
Evaluating: 7.843904877E-02*360.0
 Parameter: XPHI <- "28.2380576"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.473586103"
Evaluating: 0.473586103*360.0
 Parameter: YPHI <- "170.490997"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.293724367"
Evaluating: 0.293724367*360.0
 Parameter: ZPHI <- "105.740772"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.0860811"
 Parameter: YPOS -> "-40.1682023"
 Parameter: ZPOS -> "-30.0843638"
 Parameter: XPHI -> "28.2380576"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.880989    0.473136
    0.000000   -0.473136    0.880989

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   28.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.0860811"
 Parameter: YPOS -> "-40.1682023"
 Parameter: ZPOS -> "-30.0843638"
 Parameter: YPHI -> "170.490997"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.986260    0.000000   -0.165203
    0.000000    1.000000    0.000000
    0.165203    0.000000   -0.986260

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  170.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.0860811"
 Parameter: YPOS -> "-40.1682023"
 Parameter: ZPOS -> "-30.0843638"
 Parameter: ZPHI -> "105.740772"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.271285    0.962499    0.000000
   -0.962499   -0.271285    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  105.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.086081 XMAX =   30.086081 XAVE =   30.086081
    YMIN =  -40.168202 YMAX =  -40.168202 YAVE =  -40.168202
    ZMIN =  -30.084364 ZMAX =  -30.084364 ZAVE =  -30.084364
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.0860811"
Evaluating: 30.0860811+3.5
 Parameter: XMAX <- "33.5860811"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.1682023"
Evaluating: -40.1682023+3.5
 Parameter: YMAX <- "-36.6682023"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.0843638"
Evaluating: -30.0843638+3.5
 Parameter: ZMAX <- "-26.5843638"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.0860811"
Evaluating: 30.0860811-3.5
 Parameter: XMIN <- "26.5860811"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.1682023"
Evaluating: -40.1682023-3.5
 Parameter: YMIN <- "-43.6682023"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.0843638"
Evaluating: -30.0843638-3.5
 Parameter: ZMIN <- "-33.5843638"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.5860811"
 Parameter: XMIN -> "26.5860811"
 Parameter: YMAX -> "-36.6682023"
 Parameter: YMIN -> "-43.6682023"
 Parameter: ZMAX -> "-26.5843638"
 Parameter: ZMIN -> "-33.5843638"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "138"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "138" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "138" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "138"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.62790703"
Evaluating: 125.050557*(0.62790703-0.5)
 Parameter: XPOS <- "15.9948453"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.463738182"
Evaluating: 125.050557*(0.463738182-0.5)
 Parameter: YPOS <- "-4.53456054"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.451191147"
Evaluating: 152.572525*(0.451191147-0.5)+-4.51585405
 Parameter: ZPOS <- "-11.962744"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.962744" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.962744" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "138" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "138"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.845968257"
Evaluating: 125.050557*(0.845968257-0.5)
 Parameter: XPOS <- "43.2635232"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.520983376"
Evaluating: 125.050557*(0.520983376-0.5)
 Parameter: YPOS <- "2.62398286"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.183745581"
Evaluating: 152.572525*(0.183745581-0.5)+-4.51585405
 Parameter: ZPOS <- "-52.7675893"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-52.7675893" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.2635232"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 43.2635232-0
 Parameter: XTRAN <- "43.2635232"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.62398286"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.62398286-0
 Parameter: YTRAN <- "2.62398286"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-52.7675893"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -52.7675893-0
 Parameter: ZTRAN <- "-52.7675893"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "43.2635232"
 Parameter: YTRAN -> "2.62398286"
 Parameter: ZTRAN -> "-52.7675893"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    43.263523    2.623983  -52.767589
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.99874585"
Evaluating: 0.99874585*360.0
 Parameter: XPHI <- "359.548506"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.283217371"
Evaluating: 0.283217371*360.0
 Parameter: YPHI <- "101.958254"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.998799673"
Evaluating: 0.998799673*360.0
 Parameter: ZPHI <- "359.567882"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.2635232"
 Parameter: YPOS -> "2.62398286"
 Parameter: ZPOS -> "-52.7675893"
 Parameter: XPHI -> "359.548506"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999969   -0.007880
    0.000000    0.007880    0.999969

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    0.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.2635232"
 Parameter: YPOS -> "2.62398286"
 Parameter: ZPOS -> "-52.7675893"
 Parameter: YPHI -> "101.958254"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.207199    0.000000   -0.978299
    0.000000    1.000000    0.000000
    0.978299    0.000000   -0.207199

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  101.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.2635232"
 Parameter: YPOS -> "2.62398286"
 Parameter: ZPOS -> "-52.7675893"
 Parameter: ZPHI -> "359.567882"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999972   -0.007542    0.000000
    0.007542    0.999972    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    0.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.263523 XMAX =   43.263523 XAVE =   43.263523
    YMIN =    2.623983 YMAX =    2.623983 YAVE =    2.623983
    ZMIN =  -52.767589 ZMAX =  -52.767589 ZAVE =  -52.767589
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.2635232"
Evaluating: 43.2635232+3.5
 Parameter: XMAX <- "46.7635232"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.62398286"
Evaluating: 2.62398286+3.5
 Parameter: YMAX <- "6.12398286"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-52.7675893"
Evaluating: -52.7675893+3.5
 Parameter: ZMAX <- "-49.2675893"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.2635232"
Evaluating: 43.2635232-3.5
 Parameter: XMIN <- "39.7635232"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.62398286"
Evaluating: 2.62398286-3.5
 Parameter: YMIN <- "-0.87601714"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-52.7675893"
Evaluating: -52.7675893-3.5
 Parameter: ZMIN <- "-56.2675893"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.7635232"
 Parameter: XMIN -> "39.7635232"
 Parameter: YMAX -> "6.12398286"
 Parameter: YMIN -> "-0.87601714"
 Parameter: ZMAX -> "-49.2675893"
 Parameter: ZMIN -> "-56.2675893"
 SELRPN>      2 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64553 POS      SOD      138      SOD     -**** PROA     ASP      1458     OD2           3.4238
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "138" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "138"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.270937816"
Evaluating: 125.050557*(0.270937816-0.5)
 Parameter: XPOS <- "-28.6443537"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.929888779"
Evaluating: 125.050557*(0.929888779-0.5)
 Parameter: YPOS <- "53.7578313"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.608578291"
Evaluating: 152.572525*(0.608578291-0.5)+-4.51585405
 Parameter: ZPOS <- "12.05021"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.05021" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.05021" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "138" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "138"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.957672271"
Evaluating: 125.050557*(0.957672271-0.5)
 Parameter: XPOS <- "57.2321724"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.729302389"
Evaluating: 125.050557*(0.729302389-0.5)
 Parameter: YPOS <- "28.6743915"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "9.197865148E-02"
Evaluating: 152.572525*(9.197865148E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-66.7687014"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-66.7687014" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.263523 XMAX =   43.263523 XAVE =   43.263523
    YMIN =    2.623983 YMAX =    2.623983 YAVE =    2.623983
    ZMIN =  -52.767589 ZMAX =  -52.767589 ZAVE =  -52.767589
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "57.2321724"
 RDCMND substituted energy or value "?XAVE" to "43.2635232"
Evaluating: 57.2321724-43.2635232
 Parameter: XTRAN <- "13.9686492"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.6743915"
 RDCMND substituted energy or value "?YAVE" to "2.62398286"
Evaluating: 28.6743915-2.62398286
 Parameter: YTRAN <- "26.0504086"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-66.7687014"
 RDCMND substituted energy or value "?ZAVE" to "-52.7675893"
Evaluating: -66.7687014--52.7675893
 Parameter: ZTRAN <- "-14.0011121"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.9686492"
 Parameter: YTRAN -> "26.0504086"
 Parameter: ZTRAN -> "-14.0011121"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    13.968649   26.050409  -14.001112
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.995780319"
Evaluating: 0.995780319*360.0
 Parameter: XPHI <- "358.480915"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.118021156"
Evaluating: 0.118021156*360.0
 Parameter: YPHI <- "42.4876162"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.334346429"
Evaluating: 0.334346429*360.0
 Parameter: ZPHI <- "120.364714"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "57.2321724"
 Parameter: YPOS -> "28.6743915"
 Parameter: ZPOS -> "-66.7687014"
 Parameter: XPHI -> "358.480915"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999649   -0.026510
    0.000000    0.026510    0.999649

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    1.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "57.2321724"
 Parameter: YPOS -> "28.6743915"
 Parameter: ZPOS -> "-66.7687014"
 Parameter: YPHI -> "42.4876162"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.737423    0.000000   -0.675431
    0.000000    1.000000    0.000000
    0.675431    0.000000    0.737423

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   42.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "57.2321724"
 Parameter: YPOS -> "28.6743915"
 Parameter: ZPOS -> "-66.7687014"
 Parameter: ZPHI -> "120.364714"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.505502    0.862825    0.000000
   -0.862825   -0.505502    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  120.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   57.232172 XMAX =   57.232172 XAVE =   57.232172
    YMIN =   28.674392 YMAX =   28.674392 YAVE =   28.674392
    ZMIN =  -66.768701 ZMAX =  -66.768701 ZAVE =  -66.768701
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "57.2321724"
Evaluating: 57.2321724+3.5
 Parameter: XMAX <- "60.7321724"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.6743915"
Evaluating: 28.6743915+3.5
 Parameter: YMAX <- "32.1743915"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-66.7687014"
Evaluating: -66.7687014+3.5
 Parameter: ZMAX <- "-63.2687014"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "57.2321724"
Evaluating: 57.2321724-3.5
 Parameter: XMIN <- "53.7321724"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.6743915"
Evaluating: 28.6743915-3.5
 Parameter: YMIN <- "25.1743915"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-66.7687014"
Evaluating: -66.7687014-3.5
 Parameter: ZMIN <- "-70.2687014"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "60.7321724"
 Parameter: XMIN -> "53.7321724"
 Parameter: YMAX -> "32.1743915"
 Parameter: YMIN -> "25.1743915"
 Parameter: ZMAX -> "-63.2687014"
 Parameter: ZMIN -> "-70.2687014"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "139"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "139" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "139"
Evaluating: 139
 Parameter: J <- "139"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "139" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "139"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.930134822"
Evaluating: 125.050557*(0.930134822-0.5)
 Parameter: XPOS <- "53.7885991"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.144168667"
Evaluating: 125.050557*(0.144168667-0.5)
 Parameter: YPOS <- "-44.4969064"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.751283122"
Evaluating: 152.572525*(0.751283122-0.5)+-4.51585405
 Parameter: ZPOS <- "33.8230464"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.8230464" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.8230464" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "53.7885991"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 53.7885991-0
 Parameter: XTRAN <- "53.7885991"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.4969064"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -44.4969064-0
 Parameter: YTRAN <- "-44.4969064"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.8230464"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.8230464-0
 Parameter: ZTRAN <- "33.8230464"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "53.7885991"
 Parameter: YTRAN -> "-44.4969064"
 Parameter: ZTRAN -> "33.8230464"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    53.788599  -44.496906   33.823046
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.751631613"
Evaluating: 0.751631613*360.0
 Parameter: XPHI <- "270.587381"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.863008922"
Evaluating: 0.863008922*360.0
 Parameter: YPHI <- "310.683212"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.629033828E-02"
Evaluating: 5.629033828E-02*360.0
 Parameter: ZPHI <- "20.2645218"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "53.7885991"
 Parameter: YPOS -> "-44.4969064"
 Parameter: ZPOS -> "33.8230464"
 Parameter: XPHI -> "270.587381"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.010252   -0.999947
    0.000000    0.999947    0.010252

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   89.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "53.7885991"
 Parameter: YPOS -> "-44.4969064"
 Parameter: ZPOS -> "33.8230464"
 Parameter: YPHI -> "310.683212"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.651876    0.000000    0.758325
    0.000000    1.000000    0.000000
   -0.758325    0.000000    0.651876

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   49.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "53.7885991"
 Parameter: YPOS -> "-44.4969064"
 Parameter: ZPOS -> "33.8230464"
 Parameter: ZPHI -> "20.2645218"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.938104    0.346355    0.000000
   -0.346355    0.938104    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   20.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   53.788599 XMAX =   53.788599 XAVE =   53.788599
    YMIN =  -44.496906 YMAX =  -44.496906 YAVE =  -44.496906
    ZMIN =   33.823046 ZMAX =   33.823046 ZAVE =   33.823046
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "53.7885991"
Evaluating: 53.7885991+3.5
 Parameter: XMAX <- "57.2885991"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.4969064"
Evaluating: -44.4969064+3.5
 Parameter: YMAX <- "-40.9969064"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.8230464"
Evaluating: 33.8230464+3.5
 Parameter: ZMAX <- "37.3230464"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "53.7885991"
Evaluating: 53.7885991-3.5
 Parameter: XMIN <- "50.2885991"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.4969064"
Evaluating: -44.4969064-3.5
 Parameter: YMIN <- "-47.9969064"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.8230464"
Evaluating: 33.8230464-3.5
 Parameter: ZMIN <- "30.3230464"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.2885991"
 Parameter: XMIN -> "50.2885991"
 Parameter: YMAX -> "-40.9969064"
 Parameter: YMIN -> "-47.9969064"
 Parameter: ZMAX -> "37.3230464"
 Parameter: ZMIN -> "30.3230464"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "140"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "140" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "140" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "140"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.132014891"
Evaluating: 125.050557*(0.132014891-0.5)
 Parameter: XPOS <- "-46.0167428"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.984526301"
Evaluating: 125.050557*(0.984526301-0.5)
 Parameter: YPOS <- "60.5902838"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.399318747"
Evaluating: 152.572525*(0.399318747-0.5)+-4.51585405
 Parameter: ZPOS <- "-19.877047"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.877047" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-46.0167428"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -46.0167428-0
 Parameter: XTRAN <- "-46.0167428"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "60.5902838"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 60.5902838-0
 Parameter: YTRAN <- "60.5902838"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.877047"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.877047-0
 Parameter: ZTRAN <- "-19.877047"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.0167428"
 Parameter: YTRAN -> "60.5902838"
 Parameter: ZTRAN -> "-19.877047"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -46.016743   60.590284  -19.877047
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.760145613"
Evaluating: 0.760145613*360.0
 Parameter: XPHI <- "273.652421"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.358686941"
Evaluating: 0.358686941*360.0
 Parameter: YPHI <- "129.127299"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.49055582"
Evaluating: 0.49055582*360.0
 Parameter: ZPHI <- "176.600095"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-46.0167428"
 Parameter: YPOS -> "60.5902838"
 Parameter: ZPOS -> "-19.877047"
 Parameter: XPHI -> "273.652421"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.063704   -0.997969
    0.000000    0.997969    0.063704

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   86.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-46.0167428"
 Parameter: YPOS -> "60.5902838"
 Parameter: ZPOS -> "-19.877047"
 Parameter: YPHI -> "129.127299"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.631045    0.000000   -0.775746
    0.000000    1.000000    0.000000
    0.775746    0.000000   -0.631045

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  129.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-46.0167428"
 Parameter: YPOS -> "60.5902838"
 Parameter: ZPOS -> "-19.877047"
 Parameter: ZPHI -> "176.600095"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.998240    0.059305    0.000000
   -0.059305   -0.998240    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.016743 XMAX =  -46.016743 XAVE =  -46.016743
    YMIN =   60.590284 YMAX =   60.590284 YAVE =   60.590284
    ZMIN =  -19.877047 ZMAX =  -19.877047 ZAVE =  -19.877047
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-46.0167428"
Evaluating: -46.0167428+3.5
 Parameter: XMAX <- "-42.5167428"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "60.5902838"
Evaluating: 60.5902838+3.5
 Parameter: YMAX <- "64.0902838"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.877047"
Evaluating: -19.877047+3.5
 Parameter: ZMAX <- "-16.377047"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-46.0167428"
Evaluating: -46.0167428-3.5
 Parameter: XMIN <- "-49.5167428"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "60.5902838"
Evaluating: 60.5902838-3.5
 Parameter: YMIN <- "57.0902838"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.877047"
Evaluating: -19.877047-3.5
 Parameter: ZMIN <- "-23.377047"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.5167428"
 Parameter: XMIN -> "-49.5167428"
 Parameter: YMAX -> "64.0902838"
 Parameter: YMIN -> "57.0902838"
 Parameter: ZMAX -> "-16.377047"
 Parameter: ZMIN -> "-23.377047"
 SELRPN>     19 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      9 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64555 POS      SOD      140      SOD     -**** MEMB     POPC     290      P             3.4683
64555 POS      SOD      140      SOD     -**** MEMB     POPC     290      O13           2.4199
64555 POS      SOD      140      SOD     -**** MEMB     POPC     290      O14           3.9180
64555 POS      SOD      140      SOD     -**** MEMB     POPC     290      C1            3.5564
64555 POS      SOD      140      SOD     -**** MEMB     POPC     306      N             3.4391
64555 POS      SOD      140      SOD     -**** MEMB     POPC     306      C12           3.2237
64555 POS      SOD      140      SOD     -**** MEMB     POPC     306      C14           2.3470
64555 POS      SOD      140      SOD     -**** MEMB     POPC     306      C11           2.9655
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "140" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "140"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.962037728"
Evaluating: 125.050557*(0.962037728-0.5)
 Parameter: XPOS <- "57.7780752"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.430719006"
Evaluating: 125.050557*(0.430719006-0.5)
 Parameter: YPOS <- "-8.66362689"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.580269065"
Evaluating: 152.572525*(0.580269065-0.5)+-4.51585405
 Parameter: ZPOS <- "7.73099988"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.73099988" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.73099988" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "140" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "140"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.163914757"
Evaluating: 125.050557*(0.163914757-0.5)
 Parameter: XPOS <- "-42.0276468"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.186846902"
Evaluating: 125.050557*(0.186846902-0.5)
 Parameter: YPOS <- "-39.1599693"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.404102042"
Evaluating: 152.572525*(0.404102042-0.5)+-4.51585405
 Parameter: ZPOS <- "-19.1472476"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.1472476" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -46.016743 XMAX =  -46.016743 XAVE =  -46.016743
    YMIN =   60.590284 YMAX =   60.590284 YAVE =   60.590284
    ZMIN =  -19.877047 ZMAX =  -19.877047 ZAVE =  -19.877047
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.0276468"
 RDCMND substituted energy or value "?XAVE" to "-46.0167428"
Evaluating: -42.0276468--46.0167428
 Parameter: XTRAN <- "3.989096"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.1599693"
 RDCMND substituted energy or value "?YAVE" to "60.5902838"
Evaluating: -39.1599693-60.5902838
 Parameter: YTRAN <- "-99.7502531"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.1472476"
 RDCMND substituted energy or value "?ZAVE" to "-19.877047"
Evaluating: -19.1472476--19.877047
 Parameter: ZTRAN <- "0.7297994"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.989096"
 Parameter: YTRAN -> "-99.7502531"
 Parameter: ZTRAN -> "0.7297994"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     3.989096  -99.750253    0.729799
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.592556715"
Evaluating: 0.592556715*360.0
 Parameter: XPHI <- "213.320417"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.160305703"
Evaluating: 0.160305703*360.0
 Parameter: YPHI <- "57.7100531"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.592235276"
Evaluating: 0.592235276*360.0
 Parameter: ZPHI <- "213.204699"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.0276468"
 Parameter: YPOS -> "-39.1599693"
 Parameter: ZPOS -> "-19.1472476"
 Parameter: XPHI -> "213.320417"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.835612   -0.549321
    0.000000    0.549321   -0.835612

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  146.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.0276468"
 Parameter: YPOS -> "-39.1599693"
 Parameter: ZPOS -> "-19.1472476"
 Parameter: YPHI -> "57.7100531"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.534204    0.000000   -0.845356
    0.000000    1.000000    0.000000
    0.845356    0.000000    0.534204

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   57.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.0276468"
 Parameter: YPOS -> "-39.1599693"
 Parameter: ZPOS -> "-19.1472476"
 Parameter: ZPHI -> "213.204699"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.836719   -0.547632    0.000000
    0.547632   -0.836719    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  146.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.027647 XMAX =  -42.027647 XAVE =  -42.027647
    YMIN =  -39.159969 YMAX =  -39.159969 YAVE =  -39.159969
    ZMIN =  -19.147248 ZMAX =  -19.147248 ZAVE =  -19.147248
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.0276468"
Evaluating: -42.0276468+3.5
 Parameter: XMAX <- "-38.5276468"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.1599693"
Evaluating: -39.1599693+3.5
 Parameter: YMAX <- "-35.6599693"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.1472476"
Evaluating: -19.1472476+3.5
 Parameter: ZMAX <- "-15.6472476"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.0276468"
Evaluating: -42.0276468-3.5
 Parameter: XMIN <- "-45.5276468"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.1599693"
Evaluating: -39.1599693-3.5
 Parameter: YMIN <- "-42.6599693"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.1472476"
Evaluating: -19.1472476-3.5
 Parameter: ZMIN <- "-22.6472476"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.5276468"
 Parameter: XMIN -> "-45.5276468"
 Parameter: YMAX -> "-35.6599693"
 Parameter: YMIN -> "-42.6599693"
 Parameter: ZMAX -> "-15.6472476"
 Parameter: ZMIN -> "-22.6472476"
 SELRPN>     16 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      9 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64555 POS      SOD      140      SOD     -**** MEMB     POPC     266      C13           3.8181
64555 POS      SOD      140      SOD     -**** MEMB     POPC     266      C11           3.3878
64555 POS      SOD      140      SOD     -**** MEMB     POPC     266      P             1.2064
64555 POS      SOD      140      SOD     -**** MEMB     POPC     266      O13           0.5453
64555 POS      SOD      140      SOD     -**** MEMB     POPC     266      O14           2.1917
64555 POS      SOD      140      SOD     -**** MEMB     POPC     266      O12           2.4916
64555 POS      SOD      140      SOD     -**** MEMB     POPC     266      O11           2.0466
64555 POS      SOD      140      SOD     -**** MEMB     POPC     266      C1            3.3360
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "140" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "140"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.872384028"
Evaluating: 125.050557*(0.872384028-0.5)
 Parameter: XPOS <- "46.5668301"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.501945479"
Evaluating: 125.050557*(0.501945479-0.5)
 Parameter: YPOS <- "0.243283233"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.422893936"
Evaluating: 152.572525*(0.422893936-0.5)+-4.51585405
 Parameter: ZPOS <- "-16.2801209"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.2801209" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.027647 XMAX =  -42.027647 XAVE =  -42.027647
    YMIN =  -39.159969 YMAX =  -39.159969 YAVE =  -39.159969
    ZMIN =  -19.147248 ZMAX =  -19.147248 ZAVE =  -19.147248
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.5668301"
 RDCMND substituted energy or value "?XAVE" to "-42.0276468"
Evaluating: 46.5668301--42.0276468
 Parameter: XTRAN <- "88.5944769"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.243283233"
 RDCMND substituted energy or value "?YAVE" to "-39.1599693"
Evaluating: 0.243283233--39.1599693
 Parameter: YTRAN <- "39.4032525"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.2801209"
 RDCMND substituted energy or value "?ZAVE" to "-19.1472476"
Evaluating: -16.2801209--19.1472476
 Parameter: ZTRAN <- "2.8671267"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "88.5944769"
 Parameter: YTRAN -> "39.4032525"
 Parameter: ZTRAN -> "2.8671267"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    88.594477   39.403253    2.867127
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.553570372"
Evaluating: 0.553570372*360.0
 Parameter: XPHI <- "199.285334"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.569555146"
Evaluating: 0.569555146*360.0
 Parameter: YPHI <- "205.039853"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.464059395"
Evaluating: 0.464059395*360.0
 Parameter: ZPHI <- "167.061382"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.5668301"
 Parameter: YPOS -> "0.243283233"
 Parameter: ZPOS -> "-16.2801209"
 Parameter: XPHI -> "199.285334"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.943886   -0.330273
    0.000000    0.330273   -0.943886

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  160.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.5668301"
 Parameter: YPOS -> "0.243283233"
 Parameter: ZPOS -> "-16.2801209"
 Parameter: YPHI -> "205.039853"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.906014    0.000000    0.423249
    0.000000    1.000000    0.000000
   -0.423249    0.000000   -0.906014

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  154.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.5668301"
 Parameter: YPOS -> "0.243283233"
 Parameter: ZPOS -> "-16.2801209"
 Parameter: ZPHI -> "167.061382"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.974610    0.223907    0.000000
   -0.223907   -0.974610    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  167.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.566830 XMAX =   46.566830 XAVE =   46.566830
    YMIN =    0.243283 YMAX =    0.243283 YAVE =    0.243283
    ZMIN =  -16.280121 ZMAX =  -16.280121 ZAVE =  -16.280121
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.5668301"
Evaluating: 46.5668301+3.5
 Parameter: XMAX <- "50.0668301"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.243283204"
Evaluating: 0.243283204+3.5
 Parameter: YMAX <- "3.7432832"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.2801209"
Evaluating: -16.2801209+3.5
 Parameter: ZMAX <- "-12.7801209"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.5668301"
Evaluating: 46.5668301-3.5
 Parameter: XMIN <- "43.0668301"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.243283204"
Evaluating: 0.243283204-3.5
 Parameter: YMIN <- "-3.2567168"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.2801209"
Evaluating: -16.2801209-3.5
 Parameter: ZMIN <- "-19.7801209"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.0668301"
 Parameter: XMIN -> "43.0668301"
 Parameter: YMAX -> "3.7432832"
 Parameter: YMIN -> "-3.2567168"
 Parameter: ZMAX -> "-12.7801209"
 Parameter: ZMIN -> "-19.7801209"
 SELRPN>     37 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     16 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64555 POS      SOD      140      SOD     -**** PROA     VAL      1111     CA            3.9648
64555 POS      SOD      140      SOD     -**** PROA     VAL      1111     CB            3.5408
64555 POS      SOD      140      SOD     -**** PROA     VAL      1111     CG2           3.6208
64555 POS      SOD      140      SOD     -**** PROA     VAL      1111     C             3.1936
64555 POS      SOD      140      SOD     -**** PROA     VAL      1111     O             2.7048
64555 POS      SOD      140      SOD     -**** PROA     TRP      1112     N             3.7410
64555 POS      SOD      140      SOD     -**** PROA     VAL      1115     CB            3.4713
64555 POS      SOD      140      SOD     -**** PROA     VAL      1115     CG2           2.4778
64555 POS      SOD      140      SOD     -**** PROA     LEU      1167     CG            3.8440
64555 POS      SOD      140      SOD     -**** PROA     LEU      1167     CD1           4.4622
64555 POS      SOD      140      SOD     -**** PROA     LEU      1167     CD2           2.4455
64555 POS      SOD      140      SOD     -**** PROA     LEU      1167     C             3.7427
64555 POS      SOD      140      SOD     -**** PROA     LEU      1167     O             2.8111
64555 POS      SOD      140      SOD     -**** PROA     LYS      1168     CA            4.6621
64555 POS      SOD      140      SOD     -**** PROA     ALA      1171     CA            3.7976
64555 POS      SOD      140      SOD     -**** PROA     ALA      1171     CB            2.4557
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        16
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "16"
 Comparing "16" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "140" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "140"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.371877182"
Evaluating: 125.050557*(0.371877182-0.5)
 Parameter: XPOS <- "-16.0218298"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.475977562"
Evaluating: 125.050557*(0.475977562-0.5)
 Parameter: YPOS <- "-3.00401925"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.36032657"
Evaluating: 152.572525*(0.36032657-0.5)+-4.51585405
 Parameter: ZPOS <- "-25.8261819"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.8261819" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.566830 XMAX =   46.566830 XAVE =   46.566830
    YMIN =    0.243283 YMAX =    0.243283 YAVE =    0.243283
    ZMIN =  -16.280121 ZMAX =  -16.280121 ZAVE =  -16.280121
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.0218298"
 RDCMND substituted energy or value "?XAVE" to "46.5668301"
Evaluating: -16.0218298-46.5668301
 Parameter: XTRAN <- "-62.5886599"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.00401925"
 RDCMND substituted energy or value "?YAVE" to "0.243283204"
Evaluating: -3.00401925-0.243283204
 Parameter: YTRAN <- "-3.24730245"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.8261819"
 RDCMND substituted energy or value "?ZAVE" to "-16.2801209"
Evaluating: -25.8261819--16.2801209
 Parameter: ZTRAN <- "-9.546061"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.5886599"
 Parameter: YTRAN -> "-3.24730245"
 Parameter: ZTRAN -> "-9.546061"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -62.588660   -3.247302   -9.546061
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.642482394"
Evaluating: 0.642482394*360.0
 Parameter: XPHI <- "231.293662"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.756106833"
Evaluating: 0.756106833*360.0
 Parameter: YPHI <- "272.19846"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.178789651"
Evaluating: 0.178789651*360.0
 Parameter: ZPHI <- "64.3642744"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.0218298"
 Parameter: YPOS -> "-3.00401925"
 Parameter: ZPOS -> "-25.8261819"
 Parameter: XPHI -> "231.293662"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.625329   -0.780361
    0.000000    0.780361   -0.625329

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.0218298"
 Parameter: YPOS -> "-3.00401925"
 Parameter: ZPOS -> "-25.8261819"
 Parameter: YPHI -> "272.19846"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.038361    0.000000    0.999264
    0.000000    1.000000    0.000000
   -0.999264    0.000000    0.038361

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   87.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.0218298"
 Parameter: YPOS -> "-3.00401925"
 Parameter: ZPOS -> "-25.8261819"
 Parameter: ZPHI -> "64.3642744"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.432648    0.901563    0.000000
   -0.901563    0.432648    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   64.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.021830 XMAX =  -16.021830 XAVE =  -16.021830
    YMIN =   -3.004019 YMAX =   -3.004019 YAVE =   -3.004019
    ZMIN =  -25.826182 ZMAX =  -25.826182 ZAVE =  -25.826182
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.0218298"
Evaluating: -16.0218298+3.5
 Parameter: XMAX <- "-12.5218298"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.00401925"
Evaluating: -3.00401925+3.5
 Parameter: YMAX <- "0.49598075"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.8261819"
Evaluating: -25.8261819+3.5
 Parameter: ZMAX <- "-22.3261819"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.0218298"
Evaluating: -16.0218298-3.5
 Parameter: XMIN <- "-19.5218298"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.00401925"
Evaluating: -3.00401925-3.5
 Parameter: YMIN <- "-6.50401925"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.8261819"
Evaluating: -25.8261819-3.5
 Parameter: ZMIN <- "-29.3261819"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.5218298"
 Parameter: XMIN -> "-19.5218298"
 Parameter: YMAX -> "0.49598075"
 Parameter: YMIN -> "-6.50401925"
 Parameter: ZMAX -> "-22.3261819"
 Parameter: ZMIN -> "-29.3261819"
 SELRPN>     26 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      8 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64555 POS      SOD      140      SOD     -5088 PROA     PHE      350      CZ            4.2469
64555 POS      SOD      140      SOD     -5158 PROA     ARG      354      CB            4.8451
64555 POS      SOD      140      SOD     -9663 PROA     LEU      670      N             4.0588
64555 POS      SOD      140      SOD     -9665 PROA     LEU      670      CA            3.4760
64555 POS      SOD      140      SOD     -9667 PROA     LEU      670      CB            3.3181
64555 POS      SOD      140      SOD     -9670 PROA     LEU      670      CG            2.2559
64555 POS      SOD      140      SOD     -9672 PROA     LEU      670      CD1           2.3742
64555 POS      SOD      140      SOD     -9676 PROA     LEU      670      CD2           3.3092
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "140" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "140"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.968192094"
Evaluating: 125.050557*(0.968192094-0.5)
 Parameter: XPOS <- "58.5476821"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.608511065"
Evaluating: 125.050557*(0.608511065-0.5)
 Parameter: YPOS <- "13.5693691"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.785786269"
Evaluating: 152.572525*(0.785786269-0.5)+-4.51585405
 Parameter: ZPOS <- "39.0872786"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.0872786" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.0872786" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.021830 XMAX =  -16.021830 XAVE =  -16.021830
    YMIN =   -3.004019 YMAX =   -3.004019 YAVE =   -3.004019
    ZMIN =  -25.826182 ZMAX =  -25.826182 ZAVE =  -25.826182
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "58.5476821"
 RDCMND substituted energy or value "?XAVE" to "-16.0218298"
Evaluating: 58.5476821--16.0218298
 Parameter: XTRAN <- "74.5695119"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.5693691"
 RDCMND substituted energy or value "?YAVE" to "-3.00401925"
Evaluating: 13.5693691--3.00401925
 Parameter: YTRAN <- "16.5733883"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.0872786"
 RDCMND substituted energy or value "?ZAVE" to "-25.8261819"
Evaluating: 39.0872786--25.8261819
 Parameter: ZTRAN <- "64.9134605"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "74.5695119"
 Parameter: YTRAN -> "16.5733883"
 Parameter: ZTRAN -> "64.9134605"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    74.569512   16.573388   64.913460
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.110533368"
Evaluating: 0.110533368*360.0
 Parameter: XPHI <- "39.7920125"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.837534099"
Evaluating: 0.837534099*360.0
 Parameter: YPHI <- "301.512276"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.42824365"
Evaluating: 0.42824365*360.0
 Parameter: ZPHI <- "154.167714"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "58.5476821"
 Parameter: YPOS -> "13.5693691"
 Parameter: ZPOS -> "39.0872786"
 Parameter: XPHI -> "39.7920125"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.768373    0.640003
    0.000000   -0.640003    0.768373

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   39.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "58.5476821"
 Parameter: YPOS -> "13.5693691"
 Parameter: ZPOS -> "39.0872786"
 Parameter: YPHI -> "301.512276"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.522681    0.000000    0.852528
    0.000000    1.000000    0.000000
   -0.852528    0.000000    0.522681

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   58.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "58.5476821"
 Parameter: YPOS -> "13.5693691"
 Parameter: ZPOS -> "39.0872786"
 Parameter: ZPHI -> "154.167714"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.900073    0.435738    0.000000
   -0.435738   -0.900073    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  154.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.547682 XMAX =   58.547682 XAVE =   58.547682
    YMIN =   13.569369 YMAX =   13.569369 YAVE =   13.569369
    ZMIN =   39.087279 ZMAX =   39.087279 ZAVE =   39.087279
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "58.5476821"
Evaluating: 58.5476821+3.5
 Parameter: XMAX <- "62.0476821"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.5693691"
Evaluating: 13.5693691+3.5
 Parameter: YMAX <- "17.0693691"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.0872786"
Evaluating: 39.0872786+3.5
 Parameter: ZMAX <- "42.5872786"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "58.5476821"
Evaluating: 58.5476821-3.5
 Parameter: XMIN <- "55.0476821"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.5693691"
Evaluating: 13.5693691-3.5
 Parameter: YMIN <- "10.0693691"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.0872786"
Evaluating: 39.0872786-3.5
 Parameter: ZMIN <- "35.5872786"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "62.0476821"
 Parameter: XMIN -> "55.0476821"
 Parameter: YMAX -> "17.0693691"
 Parameter: YMIN -> "10.0693691"
 Parameter: ZMAX -> "42.5872786"
 Parameter: ZMIN -> "35.5872786"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "141"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "141" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "141" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "141"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.467291445"
Evaluating: 125.050557*(0.467291445-0.5)
 Parameter: XPOS <- "-4.09022302"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.435460596"
Evaluating: 125.050557*(0.435460596-0.5)
 Parameter: YPOS <- "-8.07068842"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.839887267"
Evaluating: 152.572525*(0.839887267-0.5)+-4.51585405
 Parameter: ZPOS <- "47.3416045"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.3416045" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.3416045" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.09022302"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.09022302-0
 Parameter: XTRAN <- "-4.09022302"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.07068842"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.07068842-0
 Parameter: YTRAN <- "-8.07068842"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.3416045"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.3416045-0
 Parameter: ZTRAN <- "47.3416045"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.09022302"
 Parameter: YTRAN -> "-8.07068842"
 Parameter: ZTRAN -> "47.3416045"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -4.090223   -8.070688   47.341605
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.171877627"
Evaluating: 0.171877627*360.0
 Parameter: XPHI <- "61.8759457"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.218254672"
Evaluating: 0.218254672*360.0
 Parameter: YPHI <- "78.5716819"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.494803073"
Evaluating: 0.494803073*360.0
 Parameter: ZPHI <- "178.129106"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.09022302"
 Parameter: YPOS -> "-8.07068842"
 Parameter: ZPOS -> "47.3416045"
 Parameter: XPHI -> "61.8759457"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.471382    0.881929
    0.000000   -0.881929    0.471382

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   61.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.09022302"
 Parameter: YPOS -> "-8.07068842"
 Parameter: ZPOS -> "47.3416045"
 Parameter: YPHI -> "78.5716819"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.198142    0.000000   -0.980173
    0.000000    1.000000    0.000000
    0.980173    0.000000    0.198142

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   78.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.09022302"
 Parameter: YPOS -> "-8.07068842"
 Parameter: ZPOS -> "47.3416045"
 Parameter: ZPHI -> "178.129106"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.999467    0.032647    0.000000
   -0.032647   -0.999467    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  178.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.090223 XMAX =   -4.090223 XAVE =   -4.090223
    YMIN =   -8.070688 YMAX =   -8.070688 YAVE =   -8.070688
    ZMIN =   47.341605 ZMAX =   47.341605 ZAVE =   47.341605
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.09022302"
Evaluating: -4.09022302+3.5
 Parameter: XMAX <- "-0.59022302"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.07068842"
Evaluating: -8.07068842+3.5
 Parameter: YMAX <- "-4.57068842"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.3416045"
Evaluating: 47.3416045+3.5
 Parameter: ZMAX <- "50.8416045"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.09022302"
Evaluating: -4.09022302-3.5
 Parameter: XMIN <- "-7.59022302"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.07068842"
Evaluating: -8.07068842-3.5
 Parameter: YMIN <- "-11.5706884"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.3416045"
Evaluating: 47.3416045-3.5
 Parameter: ZMIN <- "43.8416045"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.59022302"
 Parameter: XMIN -> "-7.59022302"
 Parameter: YMAX -> "-4.57068842"
 Parameter: YMIN -> "-11.5706884"
 Parameter: ZMAX -> "50.8416045"
 Parameter: ZMIN -> "43.8416045"
 SELRPN>     16 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      6 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64556 POS      SOD      141      SOD     -**** PROA     TYR      975      OH            3.0348
64556 POS      SOD      141      SOD     -**** PROA     ILE      983      CA            5.6078
64556 POS      SOD      141      SOD     -**** PROA     ILE      983      CB            4.2209
64556 POS      SOD      141      SOD     -**** PROA     ILE      983      CG2           4.5852
64556 POS      SOD      141      SOD     -**** PROA     ILE      983      CG1           3.9769
64556 POS      SOD      141      SOD     -**** PROA     ILE      983      CD            2.7215
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "141" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "141"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.495101925"
Evaluating: 125.050557*(0.495101925-0.5)
 Parameter: XPOS <- "-0.612507007"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.625198402"
Evaluating: 125.050557*(0.625198402-0.5)
 Parameter: YPOS <- "15.6561299"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.307478783"
Evaluating: 152.572525*(0.307478783-0.5)+-4.51585405
 Parameter: ZPOS <- "-33.8893022"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.8893022" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.090223 XMAX =   -4.090223 XAVE =   -4.090223
    YMIN =   -8.070688 YMAX =   -8.070688 YAVE =   -8.070688
    ZMIN =   47.341605 ZMAX =   47.341605 ZAVE =   47.341605
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.612507007"
 RDCMND substituted energy or value "?XAVE" to "-4.09022302"
Evaluating: -0.612507007--4.09022302
 Parameter: XTRAN <- "3.47771601"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.6561299"
 RDCMND substituted energy or value "?YAVE" to "-8.07068842"
Evaluating: 15.6561299--8.07068842
 Parameter: YTRAN <- "23.7268183"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.8893022"
 RDCMND substituted energy or value "?ZAVE" to "47.3416045"
Evaluating: -33.8893022-47.3416045
 Parameter: ZTRAN <- "-81.2309067"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.47771601"
 Parameter: YTRAN -> "23.7268183"
 Parameter: ZTRAN -> "-81.2309067"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     3.477716   23.726818  -81.230907
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.636435209"
Evaluating: 0.636435209*360.0
 Parameter: XPHI <- "229.116675"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.3311915"
Evaluating: 0.3311915*360.0
 Parameter: YPHI <- "119.22894"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.525735222E-02"
Evaluating: 7.525735222E-02*360.0
 Parameter: ZPHI <- "27.0926468"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.612507007"
 Parameter: YPOS -> "15.6561299"
 Parameter: ZPOS -> "-33.8893022"
 Parameter: XPHI -> "229.116675"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.654521   -0.756044
    0.000000    0.756044   -0.654521

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  130.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.612507007"
 Parameter: YPOS -> "15.6561299"
 Parameter: ZPOS -> "-33.8893022"
 Parameter: YPHI -> "119.22894"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.488301    0.000000   -0.872676
    0.000000    1.000000    0.000000
    0.872676    0.000000   -0.488301

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  119.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.612507007"
 Parameter: YPOS -> "15.6561299"
 Parameter: ZPOS -> "-33.8893022"
 Parameter: ZPHI -> "27.0926468"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.890271    0.455431    0.000000
   -0.455431    0.890271    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   27.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.612507 XMAX =   -0.612507 XAVE =   -0.612507
    YMIN =   15.656130 YMAX =   15.656130 YAVE =   15.656130
    ZMIN =  -33.889302 ZMAX =  -33.889302 ZAVE =  -33.889302
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.612506988"
Evaluating: -0.612506988+3.5
 Parameter: XMAX <- "2.88749301"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.6561299"
Evaluating: 15.6561299+3.5
 Parameter: YMAX <- "19.1561299"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.8893022"
Evaluating: -33.8893022+3.5
 Parameter: ZMAX <- "-30.3893022"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.612506988"
Evaluating: -0.612506988-3.5
 Parameter: XMIN <- "-4.11250699"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.6561299"
Evaluating: 15.6561299-3.5
 Parameter: YMIN <- "12.1561299"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.8893022"
Evaluating: -33.8893022-3.5
 Parameter: ZMIN <- "-37.3893022"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.88749301"
 Parameter: XMIN -> "-4.11250699"
 Parameter: YMAX -> "19.1561299"
 Parameter: YMIN -> "12.1561299"
 Parameter: ZMAX -> "-30.3893022"
 Parameter: ZMIN -> "-37.3893022"
 SELRPN>      2 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64556 POS      SOD      141      SOD     -**** PROA     GLU      1075     OE1           3.6143
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "141" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "141"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.331088799"
Evaluating: 125.050557*(0.331088799-0.5)
 Parameter: XPOS <- "-21.1224398"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.539384576"
Evaluating: 125.050557*(0.539384576-0.5)
 Parameter: YPOS <- "4.92506317"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.336138579"
Evaluating: 152.572525*(0.336138579-0.5)+-4.51585405
 Parameter: ZPOS <- "-29.5166048"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.5166048" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.612507 XMAX =   -0.612507 XAVE =   -0.612507
    YMIN =   15.656130 YMAX =   15.656130 YAVE =   15.656130
    ZMIN =  -33.889302 ZMAX =  -33.889302 ZAVE =  -33.889302
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.1224398"
 RDCMND substituted energy or value "?XAVE" to "-0.612506988"
Evaluating: -21.1224398--0.612506988
 Parameter: XTRAN <- "-20.5099328"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.92506317"
 RDCMND substituted energy or value "?YAVE" to "15.6561299"
Evaluating: 4.92506317-15.6561299
 Parameter: YTRAN <- "-10.7310667"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.5166048"
 RDCMND substituted energy or value "?ZAVE" to "-33.8893022"
Evaluating: -29.5166048--33.8893022
 Parameter: ZTRAN <- "4.3726974"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.5099328"
 Parameter: YTRAN -> "-10.7310667"
 Parameter: ZTRAN -> "4.3726974"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -20.509933  -10.731067    4.372697
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.464145729"
Evaluating: 0.464145729*360.0
 Parameter: XPHI <- "167.092462"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.377959001"
Evaluating: 0.377959001*360.0
 Parameter: YPHI <- "136.06524"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.610294462E-02"
Evaluating: 6.610294462E-02*360.0
 Parameter: ZPHI <- "23.7970601"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.1224398"
 Parameter: YPOS -> "4.92506317"
 Parameter: ZPOS -> "-29.5166048"
 Parameter: XPHI -> "167.092462"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.974732    0.223378
    0.000000   -0.223378   -0.974732

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  167.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.1224398"
 Parameter: YPOS -> "4.92506317"
 Parameter: ZPOS -> "-29.5166048"
 Parameter: YPHI -> "136.06524"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.720130    0.000000   -0.693839
    0.000000    1.000000    0.000000
    0.693839    0.000000   -0.720130

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  136.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.1224398"
 Parameter: YPOS -> "4.92506317"
 Parameter: ZPOS -> "-29.5166048"
 Parameter: ZPHI -> "23.7970601"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.914980    0.403498    0.000000
   -0.403498    0.914980    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   23.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.122440 XMAX =  -21.122440 XAVE =  -21.122440
    YMIN =    4.925063 YMAX =    4.925063 YAVE =    4.925063
    ZMIN =  -29.516605 ZMAX =  -29.516605 ZAVE =  -29.516605
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.1224398"
Evaluating: -21.1224398+3.5
 Parameter: XMAX <- "-17.6224398"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.92506314"
Evaluating: 4.92506314+3.5
 Parameter: YMAX <- "8.42506314"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.5166048"
Evaluating: -29.5166048+3.5
 Parameter: ZMAX <- "-26.0166048"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.1224398"
Evaluating: -21.1224398-3.5
 Parameter: XMIN <- "-24.6224398"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.92506314"
Evaluating: 4.92506314-3.5
 Parameter: YMIN <- "1.42506314"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.5166048"
Evaluating: -29.5166048-3.5
 Parameter: ZMIN <- "-33.0166048"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.6224398"
 Parameter: XMIN -> "-24.6224398"
 Parameter: YMAX -> "8.42506314"
 Parameter: YMIN -> "1.42506314"
 Parameter: ZMAX -> "-26.0166048"
 Parameter: ZMIN -> "-33.0166048"
 SELRPN>     34 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     20 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64556 POS      SOD      141      SOD     -9717 PROA     GLN      674      N             4.4022
64556 POS      SOD      141      SOD     -9719 PROA     GLN      674      CA            3.2735
64556 POS      SOD      141      SOD     -9732 PROA     GLN      674      C             2.5928
64556 POS      SOD      141      SOD     -9733 PROA     GLN      674      O             1.4896
64556 POS      SOD      141      SOD     -9734 PROA     LYS      675      N             3.6954
64556 POS      SOD      141      SOD     -9736 PROA     LYS      675      CA            3.9526
64556 POS      SOD      141      SOD     -9754 PROA     LYS      675      C             3.7931
64556 POS      SOD      141      SOD     -9755 PROA     LYS      675      O             3.8522
64556 POS      SOD      141      SOD     -9764 PROA     ALA      676      C             4.0147
64556 POS      SOD      141      SOD     -9766 PROA     LYS      677      N             2.9475
64556 POS      SOD      141      SOD     -9768 PROA     LYS      677      CA            2.6122
64556 POS      SOD      141      SOD     -9770 PROA     LYS      677      CB            2.2284
64556 POS      SOD      141      SOD     -9773 PROA     LYS      677      CG            3.5455
64556 POS      SOD      141      SOD     -9782 PROA     LYS      677      NZ            3.8604
64556 POS      SOD      141      SOD     -9786 PROA     LYS      677      C             2.3976
64556 POS      SOD      141      SOD     -9787 PROA     LYS      677      O             3.3868
64556 POS      SOD      141      SOD     -9788 PROA     ALA      678      N             1.9343
64556 POS      SOD      141      SOD     -9790 PROA     ALA      678      CA            2.8194
64556 POS      SOD      141      SOD     -9792 PROA     ALA      678      CB            3.2866
64556 POS      SOD      141      SOD     -9796 PROA     ALA      678      C             4.2277
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        20
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "20"
 Comparing "20" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "141" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "141"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.493481031"
Evaluating: 125.050557*(0.493481031-0.5)
 Parameter: XPOS <- "-0.815200705"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.213158255"
Evaluating: 125.050557*(0.213158255-0.5)
 Parameter: YPOS <- "-35.86972"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.542229382"
Evaluating: 152.572525*(0.542229382-0.5)+-4.51585405
 Parameter: ZPOS <- "1.92718939"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.92718939" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.92718939" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "141" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "141"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.803425366"
Evaluating: 125.050557*(0.803425366-0.5)
 Parameter: XPOS <- "37.943511"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.460448251"
Evaluating: 125.050557*(0.460448251-0.5)
 Parameter: YPOS <- "-4.94596824"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.828466285"
Evaluating: 152.572525*(0.828466285-0.5)+-4.51585405
 Parameter: ZPOS <- "45.5990764"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.5990764" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.5990764" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.122440 XMAX =  -21.122440 XAVE =  -21.122440
    YMIN =    4.925063 YMAX =    4.925063 YAVE =    4.925063
    ZMIN =  -29.516605 ZMAX =  -29.516605 ZAVE =  -29.516605
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.943511"
 RDCMND substituted energy or value "?XAVE" to "-21.1224398"
Evaluating: 37.943511--21.1224398
 Parameter: XTRAN <- "59.0659508"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.94596824"
 RDCMND substituted energy or value "?YAVE" to "4.92506314"
Evaluating: -4.94596824-4.92506314
 Parameter: YTRAN <- "-9.87103138"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.5990764"
 RDCMND substituted energy or value "?ZAVE" to "-29.5166048"
Evaluating: 45.5990764--29.5166048
 Parameter: ZTRAN <- "75.1156812"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "59.0659508"
 Parameter: YTRAN -> "-9.87103138"
 Parameter: ZTRAN -> "75.1156812"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    59.065951   -9.871031   75.115681
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.216206149"
Evaluating: 0.216206149*360.0
 Parameter: XPHI <- "77.8342136"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.947183719"
Evaluating: 0.947183719*360.0
 Parameter: YPHI <- "340.986139"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318402347"
Evaluating: 0.318402347*360.0
 Parameter: ZPHI <- "114.624845"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.943511"
 Parameter: YPOS -> "-4.94596824"
 Parameter: ZPOS -> "45.5990764"
 Parameter: XPHI -> "77.8342136"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.210741    0.977542
    0.000000   -0.977542    0.210741

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   77.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.943511"
 Parameter: YPOS -> "-4.94596824"
 Parameter: ZPOS -> "45.5990764"
 Parameter: YPHI -> "340.986139"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.945440    0.000000    0.325797
    0.000000    1.000000    0.000000
   -0.325797    0.000000    0.945440

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   19.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.943511"
 Parameter: YPOS -> "-4.94596824"
 Parameter: ZPOS -> "45.5990764"
 Parameter: ZPHI -> "114.624845"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.416675    0.909056    0.000000
   -0.909056   -0.416675    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.943511 XMAX =   37.943511 XAVE =   37.943511
    YMIN =   -4.945968 YMAX =   -4.945968 YAVE =   -4.945968
    ZMIN =   45.599076 ZMAX =   45.599076 ZAVE =   45.599076
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.943511"
Evaluating: 37.943511+3.5
 Parameter: XMAX <- "41.443511"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.94596824"
Evaluating: -4.94596824+3.5
 Parameter: YMAX <- "-1.44596824"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.5990764"
Evaluating: 45.5990764+3.5
 Parameter: ZMAX <- "49.0990764"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.943511"
Evaluating: 37.943511-3.5
 Parameter: XMIN <- "34.443511"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.94596824"
Evaluating: -4.94596824-3.5
 Parameter: YMIN <- "-8.44596824"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.5990764"
Evaluating: 45.5990764-3.5
 Parameter: ZMIN <- "42.0990764"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.443511"
 Parameter: XMIN -> "34.443511"
 Parameter: YMAX -> "-1.44596824"
 Parameter: YMIN -> "-8.44596824"
 Parameter: ZMAX -> "49.0990764"
 Parameter: ZMIN -> "42.0990764"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "142"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "142" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "142"
Evaluating: 142
 Parameter: J <- "142"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "142" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "142"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.246746264E-02"
Evaluating: 125.050557*(9.246746264E-02-0.5)
 Parameter: XPOS <- "-50.9621708"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.637243828"
Evaluating: 125.050557*(0.637243828-0.5)
 Parameter: YPOS <- "17.1624171"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.446533125"
Evaluating: 152.572525*(0.446533125-0.5)+-4.51585405
 Parameter: ZPOS <- "-12.6734302"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.6734302" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.6734302" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "142"
Evaluating: 142
 Parameter: J <- "142"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "142" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "142"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.467062552"
Evaluating: 125.050557*(0.467062552-0.5)
 Parameter: XPOS <- "-4.11884622"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.784309214"
Evaluating: 125.050557*(0.784309214-0.5)
 Parameter: YPOS <- "35.5530256"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.22025698"
Evaluating: 152.572525*(0.22025698-0.5)+-4.51585405
 Parameter: ZPOS <- "-47.196953"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-47.196953" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.11884622"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.11884622-0
 Parameter: XTRAN <- "-4.11884622"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.5530256"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.5530256-0
 Parameter: YTRAN <- "35.5530256"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-47.196953"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -47.196953-0
 Parameter: ZTRAN <- "-47.196953"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.11884622"
 Parameter: YTRAN -> "35.5530256"
 Parameter: ZTRAN -> "-47.196953"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -4.118846   35.553026  -47.196953
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.825135797"
Evaluating: 0.825135797*360.0
 Parameter: XPHI <- "297.048887"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.813759898"
Evaluating: 0.813759898*360.0
 Parameter: YPHI <- "292.953563"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.631705181"
Evaluating: 0.631705181*360.0
 Parameter: ZPHI <- "227.413865"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.11884622"
 Parameter: YPOS -> "35.5530256"
 Parameter: ZPOS -> "-47.196953"
 Parameter: XPHI -> "297.048887"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.454751   -0.890619
    0.000000    0.890619    0.454751

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   62.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.11884622"
 Parameter: YPOS -> "35.5530256"
 Parameter: ZPOS -> "-47.196953"
 Parameter: YPHI -> "292.953563"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.389985    0.000000    0.920821
    0.000000    1.000000    0.000000
   -0.920821    0.000000    0.389985

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   67.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.11884622"
 Parameter: YPOS -> "35.5530256"
 Parameter: ZPOS -> "-47.196953"
 Parameter: ZPHI -> "227.413865"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.676698   -0.736261    0.000000
    0.736261   -0.676698    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  132.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.118846 XMAX =   -4.118846 XAVE =   -4.118846
    YMIN =   35.553026 YMAX =   35.553026 YAVE =   35.553026
    ZMIN =  -47.196953 ZMAX =  -47.196953 ZAVE =  -47.196953
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.11884622"
Evaluating: -4.11884622+3.5
 Parameter: XMAX <- "-0.61884622"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.5530256"
Evaluating: 35.5530256+3.5
 Parameter: YMAX <- "39.0530256"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-47.196953"
Evaluating: -47.196953+3.5
 Parameter: ZMAX <- "-43.696953"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.11884622"
Evaluating: -4.11884622-3.5
 Parameter: XMIN <- "-7.61884622"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.5530256"
Evaluating: 35.5530256-3.5
 Parameter: YMIN <- "32.0530256"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-47.196953"
Evaluating: -47.196953-3.5
 Parameter: ZMIN <- "-50.696953"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.61884622"
 Parameter: XMIN -> "-7.61884622"
 Parameter: YMAX -> "39.0530256"
 Parameter: YMIN -> "32.0530256"
 Parameter: ZMAX -> "-43.696953"
 Parameter: ZMIN -> "-50.696953"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "143"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "143" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "143"
Evaluating: 143
 Parameter: J <- "143"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "143" and "143".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "143"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.554218204"
Evaluating: 125.050557*(0.554218204-0.5)
 Parameter: XPOS <- "6.78001661"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.162920146"
Evaluating: 125.050557*(0.162920146-0.5)
 Parameter: YPOS <- "-42.1520235"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.30492929"
Evaluating: 152.572525*(0.30492929-0.5)+-4.51585405
 Parameter: ZPOS <- "-34.2782848"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.2782848" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.78001661"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.78001661-0
 Parameter: XTRAN <- "6.78001661"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.1520235"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -42.1520235-0
 Parameter: YTRAN <- "-42.1520235"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.2782848"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.2782848-0
 Parameter: ZTRAN <- "-34.2782848"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.78001661"
 Parameter: YTRAN -> "-42.1520235"
 Parameter: ZTRAN -> "-34.2782848"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     6.780017  -42.152023  -34.278285
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.977349105"
Evaluating: 0.977349105*360.0
 Parameter: XPHI <- "351.845678"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.477854083"
Evaluating: 0.477854083*360.0
 Parameter: YPHI <- "172.02747"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.760257513"
Evaluating: 0.760257513*360.0
 Parameter: ZPHI <- "273.692705"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.78001661"
 Parameter: YPOS -> "-42.1520235"
 Parameter: ZPOS -> "-34.2782848"
 Parameter: XPHI -> "351.845678"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.989890   -0.141840
    0.000000    0.141840    0.989890

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    8.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.78001661"
 Parameter: YPOS -> "-42.1520235"
 Parameter: ZPOS -> "-34.2782848"
 Parameter: YPHI -> "172.02747"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.990335    0.000000   -0.138698
    0.000000    1.000000    0.000000
    0.138698    0.000000   -0.990335

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  172.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.78001661"
 Parameter: YPOS -> "-42.1520235"
 Parameter: ZPOS -> "-34.2782848"
 Parameter: ZPHI -> "273.692705"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.064405   -0.997924    0.000000
    0.997924    0.064405    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   86.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.780017 XMAX =    6.780017 XAVE =    6.780017
    YMIN =  -42.152023 YMAX =  -42.152023 YAVE =  -42.152023
    ZMIN =  -34.278285 ZMAX =  -34.278285 ZAVE =  -34.278285
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.78001661"
Evaluating: 6.78001661+3.5
 Parameter: XMAX <- "10.2800166"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.1520235"
Evaluating: -42.1520235+3.5
 Parameter: YMAX <- "-38.6520235"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.2782848"
Evaluating: -34.2782848+3.5
 Parameter: ZMAX <- "-30.7782848"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.78001661"
Evaluating: 6.78001661-3.5
 Parameter: XMIN <- "3.28001661"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.1520235"
Evaluating: -42.1520235-3.5
 Parameter: YMIN <- "-45.6520235"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.2782848"
Evaluating: -34.2782848-3.5
 Parameter: ZMIN <- "-37.7782848"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.2800166"
 Parameter: XMIN -> "3.28001661"
 Parameter: YMAX -> "-38.6520235"
 Parameter: YMIN -> "-45.6520235"
 Parameter: ZMAX -> "-30.7782848"
 Parameter: ZMIN -> "-37.7782848"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "144"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "144" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "144"
Evaluating: 144
 Parameter: J <- "144"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "144" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "144"
 Parameter: NPOS -> "143"
Evaluating: 144-143
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "6.286478298E-02"
Evaluating: 125.050557*(6.286478298E-02-0.5)
 Parameter: XPOS <- "-54.6640024"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.708905911"
Evaluating: 125.050557*(0.708905911-0.5)
 Parameter: YPOS <- "26.1238005"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.902253525"
Evaluating: 152.572525*(0.902253525-0.5)+-4.51585405
 Parameter: ZPOS <- "56.8569819"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.8569819" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.8569819" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-54.6640024"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -54.6640024-0
 Parameter: XTRAN <- "-54.6640024"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.1238005"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 26.1238005-0
 Parameter: YTRAN <- "26.1238005"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.8569819"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 56.8569819-0
 Parameter: ZTRAN <- "56.8569819"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-54.6640024"
 Parameter: YTRAN -> "26.1238005"
 Parameter: ZTRAN -> "56.8569819"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -54.664002   26.123801   56.856982
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.889525015"
Evaluating: 0.889525015*360.0
 Parameter: XPHI <- "320.229005"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.551387753"
Evaluating: 0.551387753*360.0
 Parameter: YPHI <- "198.499591"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314605889"
Evaluating: 0.314605889*360.0
 Parameter: ZPHI <- "113.25812"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-54.6640024"
 Parameter: YPOS -> "26.1238005"
 Parameter: ZPOS -> "56.8569819"
 Parameter: XPHI -> "320.229005"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.768607   -0.639721
    0.000000    0.639721    0.768607

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   39.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-54.6640024"
 Parameter: YPOS -> "26.1238005"
 Parameter: ZPOS -> "56.8569819"
 Parameter: YPHI -> "198.499591"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.948326    0.000000    0.317298
    0.000000    1.000000    0.000000
   -0.317298    0.000000   -0.948326

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  161.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-54.6640024"
 Parameter: YPOS -> "26.1238005"
 Parameter: ZPOS -> "56.8569819"
 Parameter: ZPHI -> "113.25812"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.394874    0.918735    0.000000
   -0.918735   -0.394874    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  113.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -54.664002 XMAX =  -54.664002 XAVE =  -54.664002
    YMIN =   26.123801 YMAX =   26.123801 YAVE =   26.123801
    ZMIN =   56.856982 ZMAX =   56.856982 ZAVE =   56.856982
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-54.6640024"
Evaluating: -54.6640024+3.5
 Parameter: XMAX <- "-51.1640024"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.1238005"
Evaluating: 26.1238005+3.5
 Parameter: YMAX <- "29.6238005"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.8569819"
Evaluating: 56.8569819+3.5
 Parameter: ZMAX <- "60.3569819"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-54.6640024"
Evaluating: -54.6640024-3.5
 Parameter: XMIN <- "-58.1640024"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.1238005"
Evaluating: 26.1238005-3.5
 Parameter: YMIN <- "22.6238005"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.8569819"
Evaluating: 56.8569819-3.5
 Parameter: ZMIN <- "53.3569819"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-51.1640024"
 Parameter: XMIN -> "-58.1640024"
 Parameter: YMAX -> "29.6238005"
 Parameter: YMIN -> "22.6238005"
 Parameter: ZMAX -> "60.3569819"
 Parameter: ZMIN -> "53.3569819"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "145"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "145" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "145" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "143"
Evaluating: 145-143
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.818329627"
Evaluating: 125.050557*(0.818329627-0.5)
 Parameter: XPOS <- "39.8072972"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.961708003"
Evaluating: 125.050557*(0.961708003-0.5)
 Parameter: YPOS <- "57.7368429"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "2.377552968E-02"
Evaluating: 152.572525*(2.377552968E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-77.174624"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-77.174624" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.8072972"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.8072972-0
 Parameter: XTRAN <- "39.8072972"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "57.7368429"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 57.7368429-0
 Parameter: YTRAN <- "57.7368429"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-77.174624"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -77.174624-0
 Parameter: ZTRAN <- "-77.174624"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.8072972"
 Parameter: YTRAN -> "57.7368429"
 Parameter: ZTRAN -> "-77.174624"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    39.807297   57.736843  -77.174624
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.725882379E-02"
Evaluating: 4.725882379E-02*360.0
 Parameter: XPHI <- "17.0131766"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.665749664"
Evaluating: 0.665749664*360.0
 Parameter: YPHI <- "239.669879"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.855042614"
Evaluating: 0.855042614*360.0
 Parameter: ZPHI <- "307.815341"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.8072972"
 Parameter: YPOS -> "57.7368429"
 Parameter: ZPOS -> "-77.174624"
 Parameter: XPHI -> "17.0131766"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.956237    0.292592
    0.000000   -0.292592    0.956237

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   17.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.8072972"
 Parameter: YPOS -> "57.7368429"
 Parameter: ZPOS -> "-77.174624"
 Parameter: YPHI -> "239.669879"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.504981    0.000000    0.863130
    0.000000    1.000000    0.000000
   -0.863130    0.000000   -0.504981

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  120.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.8072972"
 Parameter: YPOS -> "57.7368429"
 Parameter: ZPOS -> "-77.174624"
 Parameter: ZPHI -> "307.815341"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.613119   -0.789991    0.000000
    0.789991    0.613119    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   52.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.807297 XMAX =   39.807297 XAVE =   39.807297
    YMIN =   57.736843 YMAX =   57.736843 YAVE =   57.736843
    ZMIN =  -77.174624 ZMAX =  -77.174624 ZAVE =  -77.174624
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.8072972"
Evaluating: 39.8072972+3.5
 Parameter: XMAX <- "43.3072972"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "57.7368429"
Evaluating: 57.7368429+3.5
 Parameter: YMAX <- "61.2368429"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-77.174624"
Evaluating: -77.174624+3.5
 Parameter: ZMAX <- "-73.674624"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.8072972"
Evaluating: 39.8072972-3.5
 Parameter: XMIN <- "36.3072972"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "57.7368429"
Evaluating: 57.7368429-3.5
 Parameter: YMIN <- "54.2368429"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-77.174624"
Evaluating: -77.174624-3.5
 Parameter: ZMIN <- "-80.674624"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.3072972"
 Parameter: XMIN -> "36.3072972"
 Parameter: YMAX -> "61.2368429"
 Parameter: YMIN -> "54.2368429"
 Parameter: ZMAX -> "-73.674624"
 Parameter: ZMIN -> "-80.674624"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "146"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "146" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "146" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "143"
Evaluating: 146-143
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "4.046616755E-03"
Evaluating: 125.050557*(4.046616755E-03-0.5)
 Parameter: XPOS <- "-62.0192468"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.449525969"
Evaluating: 125.050557*(0.449525969-0.5)
 Parameter: YPOS <- "-6.31180569"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.245300493"
Evaluating: 152.572525*(0.245300493-0.5)+-4.51585405
 Parameter: ZPOS <- "-43.3760009"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.3760009" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-62.0192468"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -62.0192468-0
 Parameter: XTRAN <- "-62.0192468"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.31180569"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.31180569-0
 Parameter: YTRAN <- "-6.31180569"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.3760009"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.3760009-0
 Parameter: ZTRAN <- "-43.3760009"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.0192468"
 Parameter: YTRAN -> "-6.31180569"
 Parameter: ZTRAN -> "-43.3760009"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -62.019247   -6.311806  -43.376001
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.381851489"
Evaluating: 0.381851489*360.0
 Parameter: XPHI <- "137.466536"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.804488819"
Evaluating: 0.804488819*360.0
 Parameter: YPHI <- "289.615975"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313532369"
Evaluating: 0.313532369*360.0
 Parameter: ZPHI <- "112.871653"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-62.0192468"
 Parameter: YPOS -> "-6.31180569"
 Parameter: ZPOS -> "-43.3760009"
 Parameter: XPHI -> "137.466536"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.736883    0.676021
    0.000000   -0.676021   -0.736883

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  137.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-62.0192468"
 Parameter: YPOS -> "-6.31180569"
 Parameter: ZPOS -> "-43.3760009"
 Parameter: YPHI -> "289.615975"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.335714    0.000000    0.941964
    0.000000    1.000000    0.000000
   -0.941964    0.000000    0.335714

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   70.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-62.0192468"
 Parameter: YPOS -> "-6.31180569"
 Parameter: ZPOS -> "-43.3760009"
 Parameter: ZPHI -> "112.871653"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.388668    0.921378    0.000000
   -0.921378   -0.388668    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  112.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -62.019247 XMAX =  -62.019247 XAVE =  -62.019247
    YMIN =   -6.311806 YMAX =   -6.311806 YAVE =   -6.311806
    ZMIN =  -43.376001 ZMAX =  -43.376001 ZAVE =  -43.376001
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-62.0192468"
Evaluating: -62.0192468+3.5
 Parameter: XMAX <- "-58.5192468"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.31180569"
Evaluating: -6.31180569+3.5
 Parameter: YMAX <- "-2.81180569"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.3760009"
Evaluating: -43.3760009+3.5
 Parameter: ZMAX <- "-39.8760009"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-62.0192468"
Evaluating: -62.0192468-3.5
 Parameter: XMIN <- "-65.5192468"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.31180569"
Evaluating: -6.31180569-3.5
 Parameter: YMIN <- "-9.81180569"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.3760009"
Evaluating: -43.3760009-3.5
 Parameter: ZMIN <- "-46.8760009"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-58.5192468"
 Parameter: XMIN -> "-65.5192468"
 Parameter: YMAX -> "-2.81180569"
 Parameter: YMIN -> "-9.81180569"
 Parameter: ZMAX -> "-39.8760009"
 Parameter: ZMIN -> "-46.8760009"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "147"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "147" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "147"
Evaluating: 147
 Parameter: J <- "147"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "147" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "147"
 Parameter: NPOS -> "143"
Evaluating: 147-143
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.602749597"
Evaluating: 125.050557*(0.602749597-0.5)
 Parameter: XPOS <- "12.8488943"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.420108832"
Evaluating: 125.050557*(0.420108832-0.5)
 Parameter: YPOS <- "-9.99043506"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.4251715"
Evaluating: 152.572525*(0.4251715-0.5)+-4.51585405
 Parameter: ZPOS <- "-15.9326272"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.9326272" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.8488943"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.8488943-0
 Parameter: XTRAN <- "12.8488943"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.99043506"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.99043506-0
 Parameter: YTRAN <- "-9.99043506"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.9326272"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.9326272-0
 Parameter: ZTRAN <- "-15.9326272"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.8488943"
 Parameter: YTRAN -> "-9.99043506"
 Parameter: ZTRAN -> "-15.9326272"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    12.848894   -9.990435  -15.932627
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.411665549"
Evaluating: 0.411665549*360.0
 Parameter: XPHI <- "148.199598"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.452255648E-02"
Evaluating: 8.452255648E-02*360.0
 Parameter: YPHI <- "30.4281203"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.416446157"
Evaluating: 0.416446157*360.0
 Parameter: ZPHI <- "149.920617"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.8488943"
 Parameter: YPOS -> "-9.99043506"
 Parameter: ZPOS -> "-15.9326272"
 Parameter: XPHI -> "148.199598"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.849889    0.526962
    0.000000   -0.526962   -0.849889

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  148.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.8488943"
 Parameter: YPOS -> "-9.99043506"
 Parameter: ZPOS -> "-15.9326272"
 Parameter: YPHI -> "30.4281203"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.862265    0.000000   -0.506457
    0.000000    1.000000    0.000000
    0.506457    0.000000    0.862265

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   30.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.8488943"
 Parameter: YPOS -> "-9.99043506"
 Parameter: ZPOS -> "-15.9326272"
 Parameter: ZPHI -> "149.920617"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.865332    0.501199    0.000000
   -0.501199   -0.865332    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  149.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.848894 XMAX =   12.848894 XAVE =   12.848894
    YMIN =   -9.990435 YMAX =   -9.990435 YAVE =   -9.990435
    ZMIN =  -15.932627 ZMAX =  -15.932627 ZAVE =  -15.932627
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.8488943"
Evaluating: 12.8488943+3.5
 Parameter: XMAX <- "16.3488943"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.99043506"
Evaluating: -9.99043506+3.5
 Parameter: YMAX <- "-6.49043506"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.9326272"
Evaluating: -15.9326272+3.5
 Parameter: ZMAX <- "-12.4326272"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.8488943"
Evaluating: 12.8488943-3.5
 Parameter: XMIN <- "9.3488943"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.99043506"
Evaluating: -9.99043506-3.5
 Parameter: YMIN <- "-13.4904351"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.9326272"
Evaluating: -15.9326272-3.5
 Parameter: ZMIN <- "-19.4326272"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.3488943"
 Parameter: XMIN -> "9.3488943"
 Parameter: YMAX -> "-6.49043506"
 Parameter: YMIN -> "-13.4904351"
 Parameter: ZMAX -> "-12.4326272"
 Parameter: ZMIN -> "-19.4326272"
 SELRPN>     13 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      8 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64562 NEG      CLA      4        CLA     -2634 PROA     LEU      194      C             3.1409
64562 NEG      CLA      4        CLA     -2635 PROA     LEU      194      O             2.7244
64562 NEG      CLA      4        CLA     -2636 PROA     PRO      195      N             3.0651
64562 NEG      CLA      4        CLA     -2640 PROA     PRO      195      CA            2.4522
64562 NEG      CLA      4        CLA     -2642 PROA     PRO      195      CB            3.4478
64562 NEG      CLA      4        CLA     -2648 PROA     PRO      195      C             3.1856
64562 NEG      CLA      4        CLA     -2649 PROA     PRO      195      O             3.2175
64562 NEG      CLA      4        CLA     -2696 PROA     HSD      198      ND1           3.9166
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "147"
Evaluating: 147
 Parameter: J <- "147"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "147" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "147"
 Parameter: NPOS -> "143"
Evaluating: 147-143
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.442837508"
Evaluating: 125.050557*(0.442837508-0.5)
 Parameter: XPOS <- "-7.14820146"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.287567183"
Evaluating: 125.050557*(0.287567183-0.5)
 Parameter: YPOS <- "-26.5648421"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.907424212"
Evaluating: 152.572525*(0.907424212-0.5)+-4.51585405
 Parameter: ZPOS <- "57.6458867"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.6458867" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.6458867" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.848894 XMAX =   12.848894 XAVE =   12.848894
    YMIN =   -9.990435 YMAX =   -9.990435 YAVE =   -9.990435
    ZMIN =  -15.932627 ZMAX =  -15.932627 ZAVE =  -15.932627
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.14820146"
 RDCMND substituted energy or value "?XAVE" to "12.8488943"
Evaluating: -7.14820146-12.8488943
 Parameter: XTRAN <- "-19.9970958"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.5648421"
 RDCMND substituted energy or value "?YAVE" to "-9.99043506"
Evaluating: -26.5648421--9.99043506
 Parameter: YTRAN <- "-16.574407"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.6458867"
 RDCMND substituted energy or value "?ZAVE" to "-15.9326272"
Evaluating: 57.6458867--15.9326272
 Parameter: ZTRAN <- "73.5785139"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-19.9970958"
 Parameter: YTRAN -> "-16.574407"
 Parameter: ZTRAN -> "73.5785139"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -19.997096  -16.574407   73.578514
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179168637"
Evaluating: 0.179168637*360.0
 Parameter: XPHI <- "64.5007093"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.873199437"
Evaluating: 0.873199437*360.0
 Parameter: YPHI <- "314.351797"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.413310839"
Evaluating: 0.413310839*360.0
 Parameter: ZPHI <- "148.791902"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.14820146"
 Parameter: YPOS -> "-26.5648421"
 Parameter: ZPOS -> "57.6458867"
 Parameter: XPHI -> "64.5007093"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.430500    0.902591
    0.000000   -0.902591    0.430500

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.14820146"
 Parameter: YPOS -> "-26.5648421"
 Parameter: ZPOS -> "57.6458867"
 Parameter: YPHI -> "314.351797"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.699062    0.000000    0.715061
    0.000000    1.000000    0.000000
   -0.715061    0.000000    0.699062

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   45.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.14820146"
 Parameter: YPOS -> "-26.5648421"
 Parameter: ZPOS -> "57.6458867"
 Parameter: ZPHI -> "148.791902"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.855291    0.518148    0.000000
   -0.518148   -0.855291    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  148.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.148201 XMAX =   -7.148201 XAVE =   -7.148201
    YMIN =  -26.564842 YMAX =  -26.564842 YAVE =  -26.564842
    ZMIN =   57.645887 ZMAX =   57.645887 ZAVE =   57.645887
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.14820141"
Evaluating: -7.14820141+3.5
 Parameter: XMAX <- "-3.64820141"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.5648421"
Evaluating: -26.5648421+3.5
 Parameter: YMAX <- "-23.0648421"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.6458867"
Evaluating: 57.6458867+3.5
 Parameter: ZMAX <- "61.1458867"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.14820141"
Evaluating: -7.14820141-3.5
 Parameter: XMIN <- "-10.6482014"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.5648421"
Evaluating: -26.5648421-3.5
 Parameter: YMIN <- "-30.0648421"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.6458867"
Evaluating: 57.6458867-3.5
 Parameter: ZMIN <- "54.1458867"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.64820141"
 Parameter: XMIN -> "-10.6482014"
 Parameter: YMAX -> "-23.0648421"
 Parameter: YMIN -> "-30.0648421"
 Parameter: ZMAX -> "61.1458867"
 Parameter: ZMIN -> "54.1458867"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "148"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "148" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "148"
Evaluating: 148
 Parameter: J <- "148"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "148" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "148"
 Parameter: NPOS -> "143"
Evaluating: 148-143
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.74803297"
Evaluating: 125.050557*(0.74803297-0.5)
 Parameter: XPOS <- "31.0166611"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.739727313"
Evaluating: 125.050557*(0.739727313-0.5)
 Parameter: YPOS <- "29.978034"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.977678808"
Evaluating: 152.572525*(0.977678808-0.5)+-4.51585405
 Parameter: ZPOS <- "68.3648078"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "68.3648078" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "68.3648078" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.0166611"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.0166611-0
 Parameter: XTRAN <- "31.0166611"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.978034"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.978034-0
 Parameter: YTRAN <- "29.978034"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "68.3648078"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 68.3648078-0
 Parameter: ZTRAN <- "68.3648078"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.0166611"
 Parameter: YTRAN -> "29.978034"
 Parameter: ZTRAN -> "68.3648078"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    31.016661   29.978034   68.364808
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.887212967E-02"
Evaluating: 6.887212967E-02*360.0
 Parameter: XPHI <- "24.7939667"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.312732431"
Evaluating: 0.312732431*360.0
 Parameter: YPHI <- "112.583675"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.384398403"
Evaluating: 0.384398403*360.0
 Parameter: ZPHI <- "138.383425"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.0166611"
 Parameter: YPOS -> "29.978034"
 Parameter: ZPOS -> "68.3648078"
 Parameter: XPHI -> "24.7939667"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.907822    0.419356
    0.000000   -0.419356    0.907822

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   24.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.0166611"
 Parameter: YPOS -> "29.978034"
 Parameter: ZPOS -> "68.3648078"
 Parameter: YPHI -> "112.583675"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.384032    0.000000   -0.923320
    0.000000    1.000000    0.000000
    0.923320    0.000000   -0.384032

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  112.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.0166611"
 Parameter: YPOS -> "29.978034"
 Parameter: ZPOS -> "68.3648078"
 Parameter: ZPHI -> "138.383425"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.747606    0.664143    0.000000
   -0.664143   -0.747606    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  138.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.016661 XMAX =   31.016661 XAVE =   31.016661
    YMIN =   29.978034 YMAX =   29.978034 YAVE =   29.978034
    ZMIN =   68.364808 ZMAX =   68.364808 ZAVE =   68.364808
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.0166611"
Evaluating: 31.0166611+3.5
 Parameter: XMAX <- "34.5166611"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.978034"
Evaluating: 29.978034+3.5
 Parameter: YMAX <- "33.478034"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "68.3648078"
Evaluating: 68.3648078+3.5
 Parameter: ZMAX <- "71.8648078"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.0166611"
Evaluating: 31.0166611-3.5
 Parameter: XMIN <- "27.5166611"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.978034"
Evaluating: 29.978034-3.5
 Parameter: YMIN <- "26.478034"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "68.3648078"
Evaluating: 68.3648078-3.5
 Parameter: ZMIN <- "64.8648078"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.5166611"
 Parameter: XMIN -> "27.5166611"
 Parameter: YMAX -> "33.478034"
 Parameter: YMIN -> "26.478034"
 Parameter: ZMAX -> "71.8648078"
 Parameter: ZMIN -> "64.8648078"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "149"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "149" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "149"
Evaluating: 149
 Parameter: J <- "149"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "149" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "149"
 Parameter: NPOS -> "143"
Evaluating: 149-143
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.601267978"
Evaluating: 125.050557*(0.601267978-0.5)
 Parameter: XPOS <- "12.6636171"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.407419926"
Evaluating: 125.050557*(0.407419926-0.5)
 Parameter: YPOS <- "-11.5771898"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.830394016"
Evaluating: 152.572525*(0.830394016-0.5)+-4.51585405
 Parameter: ZPOS <- "45.8931952"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.8931952" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.8931952" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.6636171"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.6636171-0
 Parameter: XTRAN <- "12.6636171"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.5771898"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.5771898-0
 Parameter: YTRAN <- "-11.5771898"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.8931952"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.8931952-0
 Parameter: ZTRAN <- "45.8931952"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.6636171"
 Parameter: YTRAN -> "-11.5771898"
 Parameter: ZTRAN -> "45.8931952"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    12.663617  -11.577190   45.893195
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.960188548"
Evaluating: 0.960188548*360.0
 Parameter: XPHI <- "345.667877"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.163659713E-02"
Evaluating: 9.163659713E-02*360.0
 Parameter: YPHI <- "32.989175"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336127032"
Evaluating: 0.336127032*360.0
 Parameter: ZPHI <- "121.005732"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.6636171"
 Parameter: YPOS -> "-11.5771898"
 Parameter: ZPOS -> "45.8931952"
 Parameter: XPHI -> "345.667877"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.968877   -0.247542
    0.000000    0.247542    0.968877

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   14.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.6636171"
 Parameter: YPOS -> "-11.5771898"
 Parameter: ZPOS -> "45.8931952"
 Parameter: YPHI -> "32.989175"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.838773    0.000000   -0.544481
    0.000000    1.000000    0.000000
    0.544481    0.000000    0.838773

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   32.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.6636171"
 Parameter: YPOS -> "-11.5771898"
 Parameter: ZPOS -> "45.8931952"
 Parameter: ZPHI -> "121.005732"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.515124    0.857116    0.000000
   -0.857116   -0.515124    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  121.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.663617 XMAX =   12.663617 XAVE =   12.663617
    YMIN =  -11.577190 YMAX =  -11.577190 YAVE =  -11.577190
    ZMIN =   45.893195 ZMAX =   45.893195 ZAVE =   45.893195
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.6636171"
Evaluating: 12.6636171+3.5
 Parameter: XMAX <- "16.1636171"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.5771898"
Evaluating: -11.5771898+3.5
 Parameter: YMAX <- "-8.0771898"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.8931952"
Evaluating: 45.8931952+3.5
 Parameter: ZMAX <- "49.3931952"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.6636171"
Evaluating: 12.6636171-3.5
 Parameter: XMIN <- "9.1636171"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.5771898"
Evaluating: -11.5771898-3.5
 Parameter: YMIN <- "-15.0771898"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.8931952"
Evaluating: 45.8931952-3.5
 Parameter: ZMIN <- "42.3931952"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.1636171"
 Parameter: XMIN -> "9.1636171"
 Parameter: YMAX -> "-8.0771898"
 Parameter: YMIN -> "-15.0771898"
 Parameter: ZMAX -> "49.3931952"
 Parameter: ZMIN -> "42.3931952"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "150"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "150" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "150"
Evaluating: 150
 Parameter: J <- "150"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "150" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "150"
 Parameter: NPOS -> "143"
Evaluating: 150-143
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.464275928"
Evaluating: 125.050557*(0.464275928-0.5)
 Parameter: XPOS <- "-4.4673151"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.984539603"
Evaluating: 125.050557*(0.984539603-0.5)
 Parameter: YPOS <- "60.5919472"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.587366917"
Evaluating: 152.572525*(0.587366917-0.5)+-4.51585405
 Parameter: ZPOS <- "8.81393708"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.81393708" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.81393708" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "150"
Evaluating: 150
 Parameter: J <- "150"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "150" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "150"
 Parameter: NPOS -> "143"
Evaluating: 150-143
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.612253986"
Evaluating: 125.050557*(0.612253986-0.5)
 Parameter: XPOS <- "14.0374235"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.328916525"
Evaluating: 125.050557*(0.328916525-0.5)
 Parameter: YPOS <- "-21.3940838"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.76569985"
Evaluating: 152.572525*(0.76569985-0.5)+-4.51585405
 Parameter: ZPOS <- "36.022643"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.022643" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.022643" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.0374235"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.0374235-0
 Parameter: XTRAN <- "14.0374235"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.3940838"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.3940838-0
 Parameter: YTRAN <- "-21.3940838"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.022643"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.022643-0
 Parameter: ZTRAN <- "36.022643"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.0374235"
 Parameter: YTRAN -> "-21.3940838"
 Parameter: ZTRAN -> "36.022643"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    14.037423  -21.394084   36.022643
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.741673693"
Evaluating: 0.741673693*360.0
 Parameter: XPHI <- "267.002529"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.666697761"
Evaluating: 0.666697761*360.0
 Parameter: YPHI <- "240.011194"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.642031311"
Evaluating: 0.642031311*360.0
 Parameter: ZPHI <- "231.131272"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.0374235"
 Parameter: YPOS -> "-21.3940838"
 Parameter: ZPOS -> "36.022643"
 Parameter: XPHI -> "267.002529"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.052292   -0.998632
    0.000000    0.998632   -0.052292

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   93.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.0374235"
 Parameter: YPOS -> "-21.3940838"
 Parameter: ZPOS -> "36.022643"
 Parameter: YPHI -> "240.011194"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.499831    0.000000    0.866123
    0.000000    1.000000    0.000000
   -0.866123    0.000000   -0.499831

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  119.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.0374235"
 Parameter: YPOS -> "-21.3940838"
 Parameter: ZPOS -> "36.022643"
 Parameter: ZPHI -> "231.131272"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.627538   -0.778586    0.000000
    0.778586   -0.627538    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.037423 XMAX =   14.037423 XAVE =   14.037423
    YMIN =  -21.394084 YMAX =  -21.394084 YAVE =  -21.394084
    ZMIN =   36.022643 ZMAX =   36.022643 ZAVE =   36.022643
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.0374235"
Evaluating: 14.0374235+3.5
 Parameter: XMAX <- "17.5374235"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.3940838"
Evaluating: -21.3940838+3.5
 Parameter: YMAX <- "-17.8940838"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.022643"
Evaluating: 36.022643+3.5
 Parameter: ZMAX <- "39.522643"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.0374235"
Evaluating: 14.0374235-3.5
 Parameter: XMIN <- "10.5374235"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.3940838"
Evaluating: -21.3940838-3.5
 Parameter: YMIN <- "-24.8940838"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.022643"
Evaluating: 36.022643-3.5
 Parameter: ZMIN <- "32.522643"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.5374235"
 Parameter: XMIN -> "10.5374235"
 Parameter: YMAX -> "-17.8940838"
 Parameter: YMIN -> "-24.8940838"
 Parameter: ZMAX -> "39.522643"
 Parameter: ZMIN -> "32.522643"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "151"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "151" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "151"
Evaluating: 151
 Parameter: J <- "151"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "151" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "151"
 Parameter: NPOS -> "143"
Evaluating: 151-143
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.705264932"
Evaluating: 125.050557*(0.705264932-0.5)
 Parameter: XPOS <- "25.6684941"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.760953167"
Evaluating: 125.050557*(0.760953167-0.5)
 Parameter: YPOS <- "32.6323389"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.26253324"
Evaluating: 152.572525*(0.26253324-0.5)+-4.51585405
 Parameter: ZPOS <- "-40.7467572"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.7467572" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.6684941"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.6684941-0
 Parameter: XTRAN <- "25.6684941"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.6323389"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.6323389-0
 Parameter: YTRAN <- "32.6323389"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.7467572"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.7467572-0
 Parameter: ZTRAN <- "-40.7467572"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.6684941"
 Parameter: YTRAN -> "32.6323389"
 Parameter: ZTRAN -> "-40.7467572"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    25.668494   32.632339  -40.746757
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.219624951"
Evaluating: 0.219624951*360.0
 Parameter: XPHI <- "79.0649824"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.119571076"
Evaluating: 0.119571076*360.0
 Parameter: YPHI <- "43.0455874"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.317767551"
Evaluating: 0.317767551*360.0
 Parameter: ZPHI <- "114.396318"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.6684941"
 Parameter: YPOS -> "32.6323389"
 Parameter: ZPOS -> "-40.7467572"
 Parameter: XPHI -> "79.0649824"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.189696    0.981843
    0.000000   -0.981843    0.189696

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   79.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.6684941"
 Parameter: YPOS -> "32.6323389"
 Parameter: ZPOS -> "-40.7467572"
 Parameter: YPHI -> "43.0455874"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.730811    0.000000   -0.682580
    0.000000    1.000000    0.000000
    0.682580    0.000000    0.730811

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   43.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.6684941"
 Parameter: YPOS -> "32.6323389"
 Parameter: ZPOS -> "-40.7467572"
 Parameter: ZPHI -> "114.396318"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.413046    0.910710    0.000000
   -0.910710   -0.413046    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.668494 XMAX =   25.668494 XAVE =   25.668494
    YMIN =   32.632339 YMAX =   32.632339 YAVE =   32.632339
    ZMIN =  -40.746757 ZMAX =  -40.746757 ZAVE =  -40.746757
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.6684941"
Evaluating: 25.6684941+3.5
 Parameter: XMAX <- "29.1684941"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.6323389"
Evaluating: 32.6323389+3.5
 Parameter: YMAX <- "36.1323389"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.7467572"
Evaluating: -40.7467572+3.5
 Parameter: ZMAX <- "-37.2467572"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.6684941"
Evaluating: 25.6684941-3.5
 Parameter: XMIN <- "22.1684941"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.6323389"
Evaluating: 32.6323389-3.5
 Parameter: YMIN <- "29.1323389"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.7467572"
Evaluating: -40.7467572-3.5
 Parameter: ZMIN <- "-44.2467572"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.1684941"
 Parameter: XMIN -> "22.1684941"
 Parameter: YMAX -> "36.1323389"
 Parameter: YMIN -> "29.1323389"
 Parameter: ZMAX -> "-37.2467572"
 Parameter: ZMIN -> "-44.2467572"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "152"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "152" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "152"
Evaluating: 152
 Parameter: J <- "152"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "152" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "152"
 Parameter: NPOS -> "143"
Evaluating: 152-143
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.796831782"
Evaluating: 125.050557*(0.796831782-0.5)
 Parameter: XPOS <- "37.1189797"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.407341001"
Evaluating: 125.050557*(0.407341001-0.5)
 Parameter: YPOS <- "-11.5870594"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.759564343"
Evaluating: 152.572525*(0.759564343-0.5)+-4.51585405
 Parameter: ZPOS <- "35.0865332"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.0865332" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.0865332" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.1189797"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 37.1189797-0
 Parameter: XTRAN <- "37.1189797"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.5870594"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.5870594-0
 Parameter: YTRAN <- "-11.5870594"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.0865332"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.0865332-0
 Parameter: ZTRAN <- "35.0865332"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.1189797"
 Parameter: YTRAN -> "-11.5870594"
 Parameter: ZTRAN -> "35.0865332"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    37.118980  -11.587059   35.086533
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.1331763"
Evaluating: 0.1331763*360.0
 Parameter: XPHI <- "47.943468"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.778692106"
Evaluating: 0.778692106*360.0
 Parameter: YPHI <- "280.329158"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.756459105"
Evaluating: 0.756459105*360.0
 Parameter: ZPHI <- "272.325278"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.1189797"
 Parameter: YPOS -> "-11.5870594"
 Parameter: ZPOS -> "35.0865332"
 Parameter: XPHI -> "47.943468"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.669864    0.742484
    0.000000   -0.742484    0.669864

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   47.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.1189797"
 Parameter: YPOS -> "-11.5870594"
 Parameter: ZPOS -> "35.0865332"
 Parameter: YPHI -> "280.329158"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.179303    0.000000    0.983794
    0.000000    1.000000    0.000000
   -0.983794    0.000000    0.179303

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   79.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.1189797"
 Parameter: YPOS -> "-11.5870594"
 Parameter: ZPOS -> "35.0865332"
 Parameter: ZPHI -> "272.325278"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.040573   -0.999177    0.000000
    0.999177    0.040573    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   87.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.118980 XMAX =   37.118980 XAVE =   37.118980
    YMIN =  -11.587059 YMAX =  -11.587059 YAVE =  -11.587059
    ZMIN =   35.086533 ZMAX =   35.086533 ZAVE =   35.086533
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.1189797"
Evaluating: 37.1189797+3.5
 Parameter: XMAX <- "40.6189797"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.5870594"
Evaluating: -11.5870594+3.5
 Parameter: YMAX <- "-8.0870594"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.0865332"
Evaluating: 35.0865332+3.5
 Parameter: ZMAX <- "38.5865332"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.1189797"
Evaluating: 37.1189797-3.5
 Parameter: XMIN <- "33.6189797"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.5870594"
Evaluating: -11.5870594-3.5
 Parameter: YMIN <- "-15.0870594"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.0865332"
Evaluating: 35.0865332-3.5
 Parameter: ZMIN <- "31.5865332"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.6189797"
 Parameter: XMIN -> "33.6189797"
 Parameter: YMAX -> "-8.0870594"
 Parameter: YMIN -> "-15.0870594"
 Parameter: ZMAX -> "38.5865332"
 Parameter: ZMIN -> "31.5865332"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "153"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "153" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "153"
Evaluating: 153
 Parameter: J <- "153"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "153" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "153"
 Parameter: NPOS -> "143"
Evaluating: 153-143
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.34672848"
Evaluating: 125.050557*(0.34672848-0.5)
 Parameter: XPOS <- "-19.1666889"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.843270414"
Evaluating: 125.050557*(0.843270414-0.5)
 Parameter: YPOS <- "42.9261565"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.452889731"
Evaluating: 152.572525*(0.452889731-0.5)+-4.51585405
 Parameter: ZPOS <- "-11.7035867"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.7035867" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.7035867" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "153"
Evaluating: 153
 Parameter: J <- "153"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "153" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "153"
 Parameter: NPOS -> "143"
Evaluating: 153-143
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.922872099"
Evaluating: 125.050557*(0.922872099-0.5)
 Parameter: XPOS <- "52.8803915"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.295057167"
Evaluating: 125.050557*(0.295057167-0.5)
 Parameter: YPOS <- "-25.6282154"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.476932883"
Evaluating: 152.572525*(0.476932883-0.5)+-4.51585405
 Parameter: ZPOS <- "-8.03526234"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.03526234" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.03526234" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "153"
Evaluating: 153
 Parameter: J <- "153"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "153" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "153"
 Parameter: NPOS -> "143"
Evaluating: 153-143
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.429133822"
Evaluating: 125.050557*(0.429133822-0.5)
 Parameter: XPOS <- "-8.86185503"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.709966069"
Evaluating: 125.050557*(0.709966069-0.5)
 Parameter: YPOS <- "26.2563739"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.36032383"
Evaluating: 152.572525*(0.36032383-0.5)+-4.51585405
 Parameter: ZPOS <- "-25.8266"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.8266" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.86185503"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.86185503-0
 Parameter: XTRAN <- "-8.86185503"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.2563739"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 26.2563739-0
 Parameter: YTRAN <- "26.2563739"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.8266"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.8266-0
 Parameter: ZTRAN <- "-25.8266"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.86185503"
 Parameter: YTRAN -> "26.2563739"
 Parameter: ZTRAN -> "-25.8266"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -8.861855   26.256374  -25.826600
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.727955995"
Evaluating: 0.727955995*360.0
 Parameter: XPHI <- "262.064158"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.357330303"
Evaluating: 0.357330303*360.0
 Parameter: YPHI <- "128.638909"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.432289302"
Evaluating: 0.432289302*360.0
 Parameter: ZPHI <- "155.624149"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.86185503"
 Parameter: YPOS -> "26.2563739"
 Parameter: ZPOS -> "-25.8266"
 Parameter: XPHI -> "262.064158"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.138064   -0.990423
    0.000000    0.990423   -0.138064

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   97.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.86185503"
 Parameter: YPOS -> "26.2563739"
 Parameter: ZPOS -> "-25.8266"
 Parameter: YPHI -> "128.638909"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.624410    0.000000   -0.781097
    0.000000    1.000000    0.000000
    0.781097    0.000000   -0.624410

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  128.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.86185503"
 Parameter: YPOS -> "26.2563739"
 Parameter: ZPOS -> "-25.8266"
 Parameter: ZPHI -> "155.624149"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.910858    0.412721    0.000000
   -0.412721   -0.910858    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  155.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.861855 XMAX =   -8.861855 XAVE =   -8.861855
    YMIN =   26.256374 YMAX =   26.256374 YAVE =   26.256374
    ZMIN =  -25.826600 ZMAX =  -25.826600 ZAVE =  -25.826600
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.86185503"
Evaluating: -8.86185503+3.5
 Parameter: XMAX <- "-5.36185503"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.2563739"
Evaluating: 26.2563739+3.5
 Parameter: YMAX <- "29.7563739"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.8266"
Evaluating: -25.8266+3.5
 Parameter: ZMAX <- "-22.3266"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.86185503"
Evaluating: -8.86185503-3.5
 Parameter: XMIN <- "-12.361855"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.2563739"
Evaluating: 26.2563739-3.5
 Parameter: YMIN <- "22.7563739"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.8266"
Evaluating: -25.8266-3.5
 Parameter: ZMIN <- "-29.3266"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.36185503"
 Parameter: XMIN -> "-12.361855"
 Parameter: YMAX -> "29.7563739"
 Parameter: YMIN -> "22.7563739"
 Parameter: ZMAX -> "-22.3266"
 Parameter: ZMIN -> "-29.3266"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "154"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "154" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "154"
Evaluating: 154
 Parameter: J <- "154"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "154" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "154"
 Parameter: NPOS -> "143"
Evaluating: 154-143
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "6.80744083E-02"
Evaluating: 125.050557*(6.80744083E-02-0.5)
 Parameter: XPOS <- "-54.0125358"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.66142438"
Evaluating: 125.050557*(0.66142438-0.5)
 Parameter: YPOS <- "20.1862086"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.187018387"
Evaluating: 152.572525*(0.187018387-0.5)+-4.51585405
 Parameter: ZPOS <- "-52.268249"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-52.268249" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-54.0125358"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -54.0125358-0
 Parameter: XTRAN <- "-54.0125358"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.1862086"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 20.1862086-0
 Parameter: YTRAN <- "20.1862086"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-52.268249"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -52.268249-0
 Parameter: ZTRAN <- "-52.268249"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-54.0125358"
 Parameter: YTRAN -> "20.1862086"
 Parameter: ZTRAN -> "-52.268249"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -54.012536   20.186209  -52.268249
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.752581967"
Evaluating: 0.752581967*360.0
 Parameter: XPHI <- "270.929508"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.676183363"
Evaluating: 0.676183363*360.0
 Parameter: YPHI <- "243.426011"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.180890618"
Evaluating: 0.180890618*360.0
 Parameter: ZPHI <- "65.1206225"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-54.0125358"
 Parameter: YPOS -> "20.1862086"
 Parameter: ZPOS -> "-52.268249"
 Parameter: XPHI -> "270.929508"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.016222   -0.999868
    0.000000    0.999868    0.016222

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   89.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-54.0125358"
 Parameter: YPOS -> "20.1862086"
 Parameter: ZPOS -> "-52.268249"
 Parameter: YPHI -> "243.426011"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.447353    0.000000    0.894357
    0.000000    1.000000    0.000000
   -0.894357    0.000000   -0.447353

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  116.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-54.0125358"
 Parameter: YPOS -> "20.1862086"
 Parameter: ZPOS -> "-52.268249"
 Parameter: ZPHI -> "65.1206225"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.420709    0.907195    0.000000
   -0.907195    0.420709    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   65.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -54.012536 XMAX =  -54.012536 XAVE =  -54.012536
    YMIN =   20.186209 YMAX =   20.186209 YAVE =   20.186209
    ZMIN =  -52.268249 ZMAX =  -52.268249 ZAVE =  -52.268249
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-54.0125358"
Evaluating: -54.0125358+3.5
 Parameter: XMAX <- "-50.5125358"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.1862086"
Evaluating: 20.1862086+3.5
 Parameter: YMAX <- "23.6862086"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-52.268249"
Evaluating: -52.268249+3.5
 Parameter: ZMAX <- "-48.768249"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-54.0125358"
Evaluating: -54.0125358-3.5
 Parameter: XMIN <- "-57.5125358"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.1862086"
Evaluating: 20.1862086-3.5
 Parameter: YMIN <- "16.6862086"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-52.268249"
Evaluating: -52.268249-3.5
 Parameter: ZMIN <- "-55.768249"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-50.5125358"
 Parameter: XMIN -> "-57.5125358"
 Parameter: YMAX -> "23.6862086"
 Parameter: YMIN -> "16.6862086"
 Parameter: ZMAX -> "-48.768249"
 Parameter: ZMIN -> "-55.768249"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "155"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "155" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "155"
Evaluating: 155
 Parameter: J <- "155"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "155" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "155"
 Parameter: NPOS -> "143"
Evaluating: 155-143
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "4.703791037E-02"
Evaluating: 125.050557*(4.703791037E-02-0.5)
 Parameter: XPOS <- "-56.6431616"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.493639371"
Evaluating: 125.050557*(0.493639371-0.5)
 Parameter: YPOS <- "-0.795400199"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.931659276"
Evaluating: 152.572525*(0.931659276-0.5)+-4.51585405
 Parameter: ZPOS <- "61.3434916"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "61.3434916" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "61.3434916" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-56.6431616"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -56.6431616-0
 Parameter: XTRAN <- "-56.6431616"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.795400199"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.795400199-0
 Parameter: YTRAN <- "-0.795400199"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.3434916"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 61.3434916-0
 Parameter: ZTRAN <- "61.3434916"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-56.6431616"
 Parameter: YTRAN -> "-0.795400199"
 Parameter: ZTRAN -> "61.3434916"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -56.643162   -0.795400   61.343492
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.657308439"
Evaluating: 0.657308439*360.0
 Parameter: XPHI <- "236.631038"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.955025139"
Evaluating: 0.955025139*360.0
 Parameter: YPHI <- "343.80905"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.813086072"
Evaluating: 0.813086072*360.0
 Parameter: ZPHI <- "292.710986"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-56.6431616"
 Parameter: YPOS -> "-0.795400199"
 Parameter: ZPOS -> "61.3434916"
 Parameter: XPHI -> "236.631038"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.550028   -0.835146
    0.000000    0.835146   -0.550028

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  123.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-56.6431616"
 Parameter: YPOS -> "-0.795400199"
 Parameter: ZPOS -> "61.3434916"
 Parameter: YPHI -> "343.80905"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.960338    0.000000    0.278839
    0.000000    1.000000    0.000000
   -0.278839    0.000000    0.960338

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   16.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-56.6431616"
 Parameter: YPOS -> "-0.795400199"
 Parameter: ZPOS -> "61.3434916"
 Parameter: ZPHI -> "292.710986"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.386083   -0.922464    0.000000
    0.922464    0.386083    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   67.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -56.643162 XMAX =  -56.643162 XAVE =  -56.643162
    YMIN =   -0.795400 YMAX =   -0.795400 YAVE =   -0.795400
    ZMIN =   61.343492 ZMAX =   61.343492 ZAVE =   61.343492
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-56.6431616"
Evaluating: -56.6431616+3.5
 Parameter: XMAX <- "-53.1431616"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.795400199"
Evaluating: -0.795400199+3.5
 Parameter: YMAX <- "2.7045998"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.3434916"
Evaluating: 61.3434916+3.5
 Parameter: ZMAX <- "64.8434916"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-56.6431616"
Evaluating: -56.6431616-3.5
 Parameter: XMIN <- "-60.1431616"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.795400199"
Evaluating: -0.795400199-3.5
 Parameter: YMIN <- "-4.2954002"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.3434916"
Evaluating: 61.3434916-3.5
 Parameter: ZMIN <- "57.8434916"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-53.1431616"
 Parameter: XMIN -> "-60.1431616"
 Parameter: YMAX -> "2.7045998"
 Parameter: YMIN -> "-4.2954002"
 Parameter: ZMAX -> "64.8434916"
 Parameter: ZMIN -> "57.8434916"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "156"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "156" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "156"
Evaluating: 156
 Parameter: J <- "156"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "156" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "156"
 Parameter: NPOS -> "143"
Evaluating: 156-143
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.455396888"
Evaluating: 125.050557*(0.455396888-0.5)
 Parameter: XPOS <- "-5.577644"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "5.21945748E-03"
Evaluating: 125.050557*(5.21945748E-03-0.5)
 Parameter: YPOS <- "-61.8725824"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.315549195"
Evaluating: 152.572525*(0.315549195-0.5)+-4.51585405
 Parameter: ZPOS <- "-32.6579791"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.6579791" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.577644"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.577644-0
 Parameter: XTRAN <- "-5.577644"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-61.8725824"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -61.8725824-0
 Parameter: YTRAN <- "-61.8725824"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.6579791"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.6579791-0
 Parameter: ZTRAN <- "-32.6579791"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.577644"
 Parameter: YTRAN -> "-61.8725824"
 Parameter: ZTRAN -> "-32.6579791"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -5.577644  -61.872582  -32.657979
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.277449226E-02"
Evaluating: 4.277449226E-02*360.0
 Parameter: XPHI <- "15.3988172"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.897670317"
Evaluating: 0.897670317*360.0
 Parameter: YPHI <- "323.161314"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.224058601"
Evaluating: 0.224058601*360.0
 Parameter: ZPHI <- "80.6610964"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.577644"
 Parameter: YPOS -> "-61.8725824"
 Parameter: ZPOS -> "-32.6579791"
 Parameter: XPHI -> "15.3988172"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.964101    0.265536
    0.000000   -0.265536    0.964101

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   15.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.577644"
 Parameter: YPOS -> "-61.8725824"
 Parameter: ZPOS -> "-32.6579791"
 Parameter: YPHI -> "323.161314"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.800327    0.000000    0.599564
    0.000000    1.000000    0.000000
   -0.599564    0.000000    0.800327

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   36.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.577644"
 Parameter: YPOS -> "-61.8725824"
 Parameter: ZPOS -> "-32.6579791"
 Parameter: ZPHI -> "80.6610964"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.162274    0.986746    0.000000
   -0.986746    0.162274    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   80.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.577644 XMAX =   -5.577644 XAVE =   -5.577644
    YMIN =  -61.872582 YMAX =  -61.872582 YAVE =  -61.872582
    ZMIN =  -32.657979 ZMAX =  -32.657979 ZAVE =  -32.657979
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.577644"
Evaluating: -5.577644+3.5
 Parameter: XMAX <- "-2.077644"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-61.8725824"
Evaluating: -61.8725824+3.5
 Parameter: YMAX <- "-58.3725824"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.6579791"
Evaluating: -32.6579791+3.5
 Parameter: ZMAX <- "-29.1579791"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.577644"
Evaluating: -5.577644-3.5
 Parameter: XMIN <- "-9.077644"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-61.8725824"
Evaluating: -61.8725824-3.5
 Parameter: YMIN <- "-65.3725824"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.6579791"
Evaluating: -32.6579791-3.5
 Parameter: ZMIN <- "-36.1579791"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.077644"
 Parameter: XMIN -> "-9.077644"
 Parameter: YMAX -> "-58.3725824"
 Parameter: YMIN -> "-65.3725824"
 Parameter: ZMAX -> "-29.1579791"
 Parameter: ZMIN -> "-36.1579791"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "157"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "157" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "157"
Evaluating: 157
 Parameter: J <- "157"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "157" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "157"
 Parameter: NPOS -> "143"
Evaluating: 157-143
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.67159421"
Evaluating: 125.050557*(0.67159421-0.5)
 Parameter: XPOS <- "21.4579515"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.565220018"
Evaluating: 125.050557*(0.565220018-0.5)
 Parameter: YPOS <- "8.15579958"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.211173757"
Evaluating: 152.572525*(0.211173757-0.5)+-4.51585405
 Parameter: ZPOS <- "-48.5828032"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.5828032" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.4579515"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.4579515-0
 Parameter: XTRAN <- "21.4579515"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.15579958"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.15579958-0
 Parameter: YTRAN <- "8.15579958"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.5828032"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.5828032-0
 Parameter: ZTRAN <- "-48.5828032"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.4579515"
 Parameter: YTRAN -> "8.15579958"
 Parameter: ZTRAN -> "-48.5828032"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    21.457952    8.155800  -48.582803
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.885562703"
Evaluating: 0.885562703*360.0
 Parameter: XPHI <- "318.802573"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.793610304"
Evaluating: 0.793610304*360.0
 Parameter: YPHI <- "285.699709"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.186282974"
Evaluating: 0.186282974*360.0
 Parameter: ZPHI <- "67.0618706"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.4579515"
 Parameter: YPOS -> "8.15579958"
 Parameter: ZPOS -> "-48.5828032"
 Parameter: XPHI -> "318.802573"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.752444   -0.658656
    0.000000    0.658656    0.752444

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   41.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.4579515"
 Parameter: YPOS -> "8.15579958"
 Parameter: ZPOS -> "-48.5828032"
 Parameter: YPHI -> "285.699709"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.270596    0.000000    0.962693
    0.000000    1.000000    0.000000
   -0.962693    0.000000    0.270596

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   74.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.4579515"
 Parameter: YPOS -> "8.15579958"
 Parameter: ZPOS -> "-48.5828032"
 Parameter: ZPHI -> "67.0618706"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.389737    0.920926    0.000000
   -0.920926    0.389737    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   67.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.457952 XMAX =   21.457952 XAVE =   21.457952
    YMIN =    8.155800 YMAX =    8.155800 YAVE =    8.155800
    ZMIN =  -48.582803 ZMAX =  -48.582803 ZAVE =  -48.582803
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.4579515"
Evaluating: 21.4579515+3.5
 Parameter: XMAX <- "24.9579515"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.15579958"
Evaluating: 8.15579958+3.5
 Parameter: YMAX <- "11.6557996"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.5828032"
Evaluating: -48.5828032+3.5
 Parameter: ZMAX <- "-45.0828032"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.4579515"
Evaluating: 21.4579515-3.5
 Parameter: XMIN <- "17.9579515"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.15579958"
Evaluating: 8.15579958-3.5
 Parameter: YMIN <- "4.65579958"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.5828032"
Evaluating: -48.5828032-3.5
 Parameter: ZMIN <- "-52.0828032"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.9579515"
 Parameter: XMIN -> "17.9579515"
 Parameter: YMAX -> "11.6557996"
 Parameter: YMIN -> "4.65579958"
 Parameter: ZMAX -> "-45.0828032"
 Parameter: ZMIN -> "-52.0828032"
 SELRPN>     36 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     18 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64572 NEG      CLA      14       CLA     -**** PROA     PHE      1483     CG            4.9155
64572 NEG      CLA      14       CLA     -**** PROA     PHE      1483     CZ            3.4340
64572 NEG      CLA      14       CLA     -**** PROA     PHE      1483     CD2           3.6943
64572 NEG      CLA      14       CLA     -**** PROA     PHE      1483     CE2           2.7352
64572 NEG      CLA      14       CLA     -**** PROA     MET      1503     O             4.2465
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1505     N             3.8718
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1505     CA            3.2851
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1505     CB            4.1628
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1505     C             1.8143
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1505     O             1.7415
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1506     N             1.5532
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1506     CA            1.1579
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1506     CB            2.6904
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1506     CG            3.5905
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1506     CD2           3.6874
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1506     C             1.6167
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1506     OT1           2.1938
64572 NEG      CLA      14       CLA     -**** PROA     LEU      1506     OT2           2.6388
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        18
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "18"
 Comparing "18" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "157"
Evaluating: 157
 Parameter: J <- "157"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "157" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "157"
 Parameter: NPOS -> "143"
Evaluating: 157-143
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.640245032"
Evaluating: 125.050557*(0.640245032-0.5)
 Parameter: XPOS <- "17.5377194"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.184900409"
Evaluating: 125.050557*(0.184900409-0.5)
 Parameter: YPOS <- "-39.4033794"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.862308224"
Evaluating: 152.572525*(0.862308224-0.5)+-4.51585405
 Parameter: ZPOS <- "50.7624265"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.7624265" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.7624265" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.457952 XMAX =   21.457952 XAVE =   21.457952
    YMIN =    8.155800 YMAX =    8.155800 YAVE =    8.155800
    ZMIN =  -48.582803 ZMAX =  -48.582803 ZAVE =  -48.582803
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.5377194"
 RDCMND substituted energy or value "?XAVE" to "21.4579515"
Evaluating: 17.5377194-21.4579515
 Parameter: XTRAN <- "-3.9202321"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.4033794"
 RDCMND substituted energy or value "?YAVE" to "8.15579958"
Evaluating: -39.4033794-8.15579958
 Parameter: YTRAN <- "-47.559179"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.7624265"
 RDCMND substituted energy or value "?ZAVE" to "-48.5828032"
Evaluating: 50.7624265--48.5828032
 Parameter: ZTRAN <- "99.3452297"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.9202321"
 Parameter: YTRAN -> "-47.559179"
 Parameter: ZTRAN -> "99.3452297"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -3.920232  -47.559179   99.345230
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.447779387"
Evaluating: 0.447779387*360.0
 Parameter: XPHI <- "161.200579"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.013984682E-02"
Evaluating: 5.013984682E-02*360.0
 Parameter: YPHI <- "18.0503449"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.310035449"
Evaluating: 0.310035449*360.0
 Parameter: ZPHI <- "111.612762"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.5377194"
 Parameter: YPOS -> "-39.4033794"
 Parameter: ZPOS -> "50.7624265"
 Parameter: XPHI -> "161.200579"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.946653    0.322256
    0.000000   -0.322256   -0.946653

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  161.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.5377194"
 Parameter: YPOS -> "-39.4033794"
 Parameter: ZPOS -> "50.7624265"
 Parameter: YPHI -> "18.0503449"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.950785    0.000000   -0.309853
    0.000000    1.000000    0.000000
    0.309853    0.000000    0.950785

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   18.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.5377194"
 Parameter: YPOS -> "-39.4033794"
 Parameter: ZPOS -> "50.7624265"
 Parameter: ZPHI -> "111.612762"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.368332    0.929694    0.000000
   -0.929694   -0.368332    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  111.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.537719 XMAX =   17.537719 XAVE =   17.537719
    YMIN =  -39.403379 YMAX =  -39.403379 YAVE =  -39.403379
    ZMIN =   50.762427 ZMAX =   50.762427 ZAVE =   50.762427
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.5377194"
Evaluating: 17.5377194+3.5
 Parameter: XMAX <- "21.0377194"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.4033794"
Evaluating: -39.4033794+3.5
 Parameter: YMAX <- "-35.9033794"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.7624265"
Evaluating: 50.7624265+3.5
 Parameter: ZMAX <- "54.2624265"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.5377194"
Evaluating: 17.5377194-3.5
 Parameter: XMIN <- "14.0377194"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.4033794"
Evaluating: -39.4033794-3.5
 Parameter: YMIN <- "-42.9033794"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.7624265"
Evaluating: 50.7624265-3.5
 Parameter: ZMIN <- "47.2624265"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.0377194"
 Parameter: XMIN -> "14.0377194"
 Parameter: YMAX -> "-35.9033794"
 Parameter: YMIN -> "-42.9033794"
 Parameter: ZMAX -> "54.2624265"
 Parameter: ZMIN -> "47.2624265"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "158"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "158" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "158"
Evaluating: 158
 Parameter: J <- "158"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "158" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "158"
 Parameter: NPOS -> "143"
Evaluating: 158-143
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.291481392"
Evaluating: 125.050557*(0.291481392-0.5)
 Parameter: XPOS <- "-26.0753681"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.365961075"
Evaluating: 125.050557*(0.365961075-0.5)
 Parameter: YPOS <- "-16.7616422"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "2.139502352E-02"
Evaluating: 152.572525*(2.139502352E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-77.5378238"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-77.5378238" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.0753681"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -26.0753681-0
 Parameter: XTRAN <- "-26.0753681"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.7616422"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -16.7616422-0
 Parameter: YTRAN <- "-16.7616422"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-77.5378238"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -77.5378238-0
 Parameter: ZTRAN <- "-77.5378238"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-26.0753681"
 Parameter: YTRAN -> "-16.7616422"
 Parameter: ZTRAN -> "-77.5378238"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -26.075368  -16.761642  -77.537824
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671425531"
Evaluating: 0.671425531*360.0
 Parameter: XPHI <- "241.713191"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313427515"
Evaluating: 0.313427515*360.0
 Parameter: YPHI <- "112.833905"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.462734794"
Evaluating: 0.462734794*360.0
 Parameter: ZPHI <- "166.584526"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.0753681"
 Parameter: YPOS -> "-16.7616422"
 Parameter: ZPOS -> "-77.5378238"
 Parameter: XPHI -> "241.713191"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.473885   -0.880586
    0.000000    0.880586   -0.473885

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.0753681"
 Parameter: YPOS -> "-16.7616422"
 Parameter: ZPOS -> "-77.5378238"
 Parameter: YPHI -> "112.833905"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.388061    0.000000   -0.921634
    0.000000    1.000000    0.000000
    0.921634    0.000000   -0.388061

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  112.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.0753681"
 Parameter: YPOS -> "-16.7616422"
 Parameter: ZPOS -> "-77.5378238"
 Parameter: ZPHI -> "166.584526"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.972713    0.232011    0.000000
   -0.232011   -0.972713    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  166.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.075368 XMAX =  -26.075368 XAVE =  -26.075368
    YMIN =  -16.761642 YMAX =  -16.761642 YAVE =  -16.761642
    ZMIN =  -77.537824 ZMAX =  -77.537824 ZAVE =  -77.537824
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.0753681"
Evaluating: -26.0753681+3.5
 Parameter: XMAX <- "-22.5753681"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.7616422"
Evaluating: -16.7616422+3.5
 Parameter: YMAX <- "-13.2616422"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-77.5378238"
Evaluating: -77.5378238+3.5
 Parameter: ZMAX <- "-74.0378238"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.0753681"
Evaluating: -26.0753681-3.5
 Parameter: XMIN <- "-29.5753681"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.7616422"
Evaluating: -16.7616422-3.5
 Parameter: YMIN <- "-20.2616422"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-77.5378238"
Evaluating: -77.5378238-3.5
 Parameter: ZMIN <- "-81.0378238"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-22.5753681"
 Parameter: XMIN -> "-29.5753681"
 Parameter: YMAX -> "-13.2616422"
 Parameter: YMIN -> "-20.2616422"
 Parameter: ZMAX -> "-74.0378238"
 Parameter: ZMIN -> "-81.0378238"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "159"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "159" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "159"
Evaluating: 159
 Parameter: J <- "159"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "159" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "159"
 Parameter: NPOS -> "143"
Evaluating: 159-143
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.891914464"
Evaluating: 125.050557*(0.891914464-0.5)
 Parameter: XPOS <- "49.009122"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.670392877"
Evaluating: 125.050557*(0.670392877-0.5)
 Parameter: YPOS <- "21.3077242"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.741828774"
Evaluating: 152.572525*(0.741828774-0.5)+-4.51585405
 Parameter: ZPOS <- "32.3805726"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.3805726" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.3805726" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.009122"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.009122-0
 Parameter: XTRAN <- "49.009122"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.3077242"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.3077242-0
 Parameter: YTRAN <- "21.3077242"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.3805726"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.3805726-0
 Parameter: ZTRAN <- "32.3805726"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.009122"
 Parameter: YTRAN -> "21.3077242"
 Parameter: ZTRAN -> "32.3805726"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    49.009122   21.307724   32.380573
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.507703363"
Evaluating: 0.507703363*360.0
 Parameter: XPHI <- "182.773211"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.312657423"
Evaluating: 0.312657423*360.0
 Parameter: YPHI <- "112.556672"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.132432695"
Evaluating: 0.132432695*360.0
 Parameter: ZPHI <- "47.6757702"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.009122"
 Parameter: YPOS -> "21.3077242"
 Parameter: ZPOS -> "32.3805726"
 Parameter: XPHI -> "182.773211"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.998829   -0.048383
    0.000000    0.048383   -0.998829

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  177.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.009122"
 Parameter: YPOS -> "21.3077242"
 Parameter: ZPOS -> "32.3805726"
 Parameter: YPHI -> "112.556672"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.383597    0.000000   -0.923501
    0.000000    1.000000    0.000000
    0.923501    0.000000   -0.383597

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  112.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.009122"
 Parameter: YPOS -> "21.3077242"
 Parameter: ZPOS -> "32.3805726"
 Parameter: ZPHI -> "47.6757702"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.673325    0.739346    0.000000
   -0.739346    0.673325    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   47.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.009122 XMAX =   49.009122 XAVE =   49.009122
    YMIN =   21.307724 YMAX =   21.307724 YAVE =   21.307724
    ZMIN =   32.380573 ZMAX =   32.380573 ZAVE =   32.380573
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.009122"
Evaluating: 49.009122+3.5
 Parameter: XMAX <- "52.509122"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.3077242"
Evaluating: 21.3077242+3.5
 Parameter: YMAX <- "24.8077242"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.3805726"
Evaluating: 32.3805726+3.5
 Parameter: ZMAX <- "35.8805726"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.009122"
Evaluating: 49.009122-3.5
 Parameter: XMIN <- "45.509122"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.3077242"
Evaluating: 21.3077242-3.5
 Parameter: YMIN <- "17.8077242"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.3805726"
Evaluating: 32.3805726-3.5
 Parameter: ZMIN <- "28.8805726"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.509122"
 Parameter: XMIN -> "45.509122"
 Parameter: YMAX -> "24.8077242"
 Parameter: YMIN -> "17.8077242"
 Parameter: ZMAX -> "35.8805726"
 Parameter: ZMIN -> "28.8805726"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "160"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "160" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "160"
Evaluating: 160
 Parameter: J <- "160"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "160" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "160"
 Parameter: NPOS -> "143"
Evaluating: 160-143
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.773599625"
Evaluating: 125.050557*(0.773599625-0.5)
 Parameter: XPOS <- "34.2137855"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.564417031"
Evaluating: 125.050557*(0.564417031-0.5)
 Parameter: YPOS <- "8.05538561"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "5.062748236E-02"
Evaluating: 152.572525*(5.062748236E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-73.0777537"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-73.0777537" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.2137855"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.2137855-0
 Parameter: XTRAN <- "34.2137855"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.05538561"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.05538561-0
 Parameter: YTRAN <- "8.05538561"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-73.0777537"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -73.0777537-0
 Parameter: ZTRAN <- "-73.0777537"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.2137855"
 Parameter: YTRAN -> "8.05538561"
 Parameter: ZTRAN -> "-73.0777537"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    34.213786    8.055386  -73.077754
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.575295835"
Evaluating: 0.575295835*360.0
 Parameter: XPHI <- "207.106501"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.400095183"
Evaluating: 0.400095183*360.0
 Parameter: YPHI <- "144.034266"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.986269004"
Evaluating: 0.986269004*360.0
 Parameter: ZPHI <- "355.056841"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.2137855"
 Parameter: YPOS -> "8.05538561"
 Parameter: ZPOS -> "-73.0777537"
 Parameter: XPHI -> "207.106501"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.890161   -0.455646
    0.000000    0.455646   -0.890161

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  152.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.2137855"
 Parameter: YPOS -> "8.05538561"
 Parameter: ZPOS -> "-73.0777537"
 Parameter: YPHI -> "144.034266"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.809368    0.000000   -0.587301
    0.000000    1.000000    0.000000
    0.587301    0.000000   -0.809368

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  144.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.2137855"
 Parameter: YPOS -> "8.05538561"
 Parameter: ZPOS -> "-73.0777537"
 Parameter: ZPHI -> "355.056841"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.996281   -0.086167    0.000000
    0.086167    0.996281    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    4.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.213786 XMAX =   34.213786 XAVE =   34.213786
    YMIN =    8.055386 YMAX =    8.055386 YAVE =    8.055386
    ZMIN =  -73.077754 ZMAX =  -73.077754 ZAVE =  -73.077754
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.2137855"
Evaluating: 34.2137855+3.5
 Parameter: XMAX <- "37.7137855"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.05538561"
Evaluating: 8.05538561+3.5
 Parameter: YMAX <- "11.5553856"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-73.0777537"
Evaluating: -73.0777537+3.5
 Parameter: ZMAX <- "-69.5777537"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.2137855"
Evaluating: 34.2137855-3.5
 Parameter: XMIN <- "30.7137855"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.05538561"
Evaluating: 8.05538561-3.5
 Parameter: YMIN <- "4.55538561"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-73.0777537"
Evaluating: -73.0777537-3.5
 Parameter: ZMIN <- "-76.5777537"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.7137855"
 Parameter: XMIN -> "30.7137855"
 Parameter: YMAX -> "11.5553856"
 Parameter: YMIN -> "4.55538561"
 Parameter: ZMAX -> "-69.5777537"
 Parameter: ZMIN -> "-76.5777537"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "161"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "161" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "161"
Evaluating: 161
 Parameter: J <- "161"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "161" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "161"
 Parameter: NPOS -> "143"
Evaluating: 161-143
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.406183794"
Evaluating: 125.050557*(0.406183794-0.5)
 Parameter: XPOS <- "-11.7317688"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.560910745"
Evaluating: 125.050557*(0.560910745-0.5)
 Parameter: YPOS <- "7.61692259"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.657755565"
Evaluating: 152.572525*(0.657755565-0.5)+-4.51585405
 Parameter: ZPOS <- "19.5533108"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.5533108" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.5533108" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.7317688"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -11.7317688-0
 Parameter: XTRAN <- "-11.7317688"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.61692259"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.61692259-0
 Parameter: YTRAN <- "7.61692259"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.5533108"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.5533108-0
 Parameter: ZTRAN <- "19.5533108"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.7317688"
 Parameter: YTRAN -> "7.61692259"
 Parameter: ZTRAN -> "19.5533108"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -11.731769    7.616923   19.553311
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.218280357"
Evaluating: 0.218280357*360.0
 Parameter: XPHI <- "78.5809285"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.749005085"
Evaluating: 0.749005085*360.0
 Parameter: YPHI <- "269.641831"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.932726475"
Evaluating: 0.932726475*360.0
 Parameter: ZPHI <- "335.781531"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.7317688"
 Parameter: YPOS -> "7.61692259"
 Parameter: ZPOS -> "19.5533108"
 Parameter: XPHI -> "78.5809285"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.197984    0.980205
    0.000000   -0.980205    0.197984

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   78.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.7317688"
 Parameter: YPOS -> "7.61692259"
 Parameter: ZPOS -> "19.5533108"
 Parameter: YPHI -> "269.641831"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.006251    0.000000    0.999980
    0.000000    1.000000    0.000000
   -0.999980    0.000000   -0.006251

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   90.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.7317688"
 Parameter: YPOS -> "7.61692259"
 Parameter: ZPOS -> "19.5533108"
 Parameter: ZPHI -> "335.781531"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.911988   -0.410217    0.000000
    0.410217    0.911988    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   24.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.731769 XMAX =  -11.731769 XAVE =  -11.731769
    YMIN =    7.616923 YMAX =    7.616923 YAVE =    7.616923
    ZMIN =   19.553311 ZMAX =   19.553311 ZAVE =   19.553311
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.7317688"
Evaluating: -11.7317688+3.5
 Parameter: XMAX <- "-8.2317688"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.61692259"
Evaluating: 7.61692259+3.5
 Parameter: YMAX <- "11.1169226"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.5533108"
Evaluating: 19.5533108+3.5
 Parameter: ZMAX <- "23.0533108"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.7317688"
Evaluating: -11.7317688-3.5
 Parameter: XMIN <- "-15.2317688"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.61692259"
Evaluating: 7.61692259-3.5
 Parameter: YMIN <- "4.11692259"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.5533108"
Evaluating: 19.5533108-3.5
 Parameter: ZMIN <- "16.0533108"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.2317688"
 Parameter: XMIN -> "-15.2317688"
 Parameter: YMAX -> "11.1169226"
 Parameter: YMIN -> "4.11692259"
 Parameter: ZMAX -> "23.0533108"
 Parameter: ZMIN -> "16.0533108"
 SELRPN>     27 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     17 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64576 NEG      CLA      18       CLA     -**** PROA     SER      993      C             4.1782
64576 NEG      CLA      18       CLA     -**** PROA     SER      993      O             4.0050
64576 NEG      CLA      18       CLA     -**** PROA     ASP      994      N             3.4868
64576 NEG      CLA      18       CLA     -**** PROA     ASP      994      CA            2.1691
64576 NEG      CLA      18       CLA     -**** PROA     ASP      994      CB            2.6642
64576 NEG      CLA      18       CLA     -**** PROA     ASP      994      CG            3.8722
64576 NEG      CLA      18       CLA     -**** PROA     ASP      994      C             1.4501
64576 NEG      CLA      18       CLA     -**** PROA     ASP      994      O             0.7614
64576 NEG      CLA      18       CLA     -**** PROA     PHE      995      N             2.6358
64576 NEG      CLA      18       CLA     -**** PROA     PHE      995      CA            3.2792
64576 NEG      CLA      18       CLA     -**** PROA     PHE      995      CB            4.2179
64576 NEG      CLA      18       CLA     -**** PROA     PHE      995      CG            3.8009
64576 NEG      CLA      18       CLA     -**** PROA     PHE      995      CZ            4.4794
64576 NEG      CLA      18       CLA     -**** PROA     PHE      995      CD2           4.0568
64576 NEG      CLA      18       CLA     -**** PROA     PHE      995      CE2           4.3898
64576 NEG      CLA      18       CLA     -**** PROA     HSD      996      N             4.9301
64576 NEG      CLA      18       CLA     -**** PROA     LEU      1330     CD1           4.1505
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        17
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "17"
 Comparing "17" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "161"
Evaluating: 161
 Parameter: J <- "161"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "161" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "161"
 Parameter: NPOS -> "143"
Evaluating: 161-143
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.33359409"
Evaluating: 125.050557*(0.33359409-0.5)
 Parameter: XPOS <- "-20.8091517"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "7.378704461E-02"
Evaluating: 125.050557*(7.378704461E-02-0.5)
 Parameter: YPOS <- "-53.2981675"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.67421837"
Evaluating: 152.572525*(0.67421837-0.5)+-4.51585405
 Parameter: ZPOS <- "22.0650826"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.0650826" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.0650826" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.731769 XMAX =  -11.731769 XAVE =  -11.731769
    YMIN =    7.616923 YMAX =    7.616923 YAVE =    7.616923
    ZMIN =   19.553311 ZMAX =   19.553311 ZAVE =   19.553311
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.8091517"
 RDCMND substituted energy or value "?XAVE" to "-11.7317688"
Evaluating: -20.8091517--11.7317688
 Parameter: XTRAN <- "-9.0773829"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-53.2981675"
 RDCMND substituted energy or value "?YAVE" to "7.61692259"
Evaluating: -53.2981675-7.61692259
 Parameter: YTRAN <- "-60.9150901"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.0650826"
 RDCMND substituted energy or value "?ZAVE" to "19.5533108"
Evaluating: 22.0650826-19.5533108
 Parameter: ZTRAN <- "2.5117718"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.0773829"
 Parameter: YTRAN -> "-60.9150901"
 Parameter: ZTRAN -> "2.5117718"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -9.077383  -60.915090    2.511772
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.250669532"
Evaluating: 0.250669532*360.0
 Parameter: XPHI <- "90.2410315"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.795783899"
Evaluating: 0.795783899*360.0
 Parameter: YPHI <- "286.482204"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.708900138"
Evaluating: 0.708900138*360.0
 Parameter: ZPHI <- "255.20405"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.8091517"
 Parameter: YPOS -> "-53.2981675"
 Parameter: ZPOS -> "22.0650826"
 Parameter: XPHI -> "90.2410315"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.004207    0.999991
    0.000000   -0.999991   -0.004207

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   90.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.8091517"
 Parameter: YPOS -> "-53.2981675"
 Parameter: ZPOS -> "22.0650826"
 Parameter: YPHI -> "286.482204"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.283718    0.000000    0.958908
    0.000000    1.000000    0.000000
   -0.958908    0.000000    0.283718

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   73.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.8091517"
 Parameter: YPOS -> "-53.2981675"
 Parameter: ZPOS -> "22.0650826"
 Parameter: ZPHI -> "255.20405"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.255377   -0.966841    0.000000
    0.966841   -0.255377    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  104.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.809152 XMAX =  -20.809152 XAVE =  -20.809152
    YMIN =  -53.298167 YMAX =  -53.298167 YAVE =  -53.298167
    ZMIN =   22.065083 ZMAX =   22.065083 ZAVE =   22.065083
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.8091517"
Evaluating: -20.8091517+3.5
 Parameter: XMAX <- "-17.3091517"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-53.2981675"
Evaluating: -53.2981675+3.5
 Parameter: YMAX <- "-49.7981675"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.0650826"
Evaluating: 22.0650826+3.5
 Parameter: ZMAX <- "25.5650826"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.8091517"
Evaluating: -20.8091517-3.5
 Parameter: XMIN <- "-24.3091517"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-53.2981675"
Evaluating: -53.2981675-3.5
 Parameter: YMIN <- "-56.7981675"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.0650826"
Evaluating: 22.0650826-3.5
 Parameter: ZMIN <- "18.5650826"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.3091517"
 Parameter: XMIN -> "-24.3091517"
 Parameter: YMAX -> "-49.7981675"
 Parameter: YMIN -> "-56.7981675"
 Parameter: ZMAX -> "25.5650826"
 Parameter: ZMIN -> "18.5650826"
 SELRPN>      5 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "162"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "162" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "162"
Evaluating: 162
 Parameter: J <- "162"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "162" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "162"
 Parameter: NPOS -> "143"
Evaluating: 162-143
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.438575381"
Evaluating: 125.050557*(0.438575381-0.5)
 Parameter: XPOS <- "-7.68118282"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.480212878"
Evaluating: 125.050557*(0.480212878-0.5)
 Parameter: YPOS <- "-2.47439063"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.133955682"
Evaluating: 152.572525*(0.133955682-0.5)+-4.51585405
 Parameter: ZPOS <- "-60.3641599"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-60.3641599" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.68118282"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.68118282-0
 Parameter: XTRAN <- "-7.68118282"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.47439063"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.47439063-0
 Parameter: YTRAN <- "-2.47439063"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-60.3641599"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -60.3641599-0
 Parameter: ZTRAN <- "-60.3641599"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.68118282"
 Parameter: YTRAN -> "-2.47439063"
 Parameter: ZTRAN -> "-60.3641599"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -7.681183   -2.474391  -60.364160
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.26018002"
Evaluating: 0.26018002*360.0
 Parameter: XPHI <- "93.6648072"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.506273694"
Evaluating: 0.506273694*360.0
 Parameter: YPHI <- "182.25853"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.694230012"
Evaluating: 0.694230012*360.0
 Parameter: ZPHI <- "249.922804"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.68118282"
 Parameter: YPOS -> "-2.47439063"
 Parameter: ZPOS -> "-60.3641599"
 Parameter: XPHI -> "93.6648072"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.063919    0.997955
    0.000000   -0.997955   -0.063919

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   93.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.68118282"
 Parameter: YPOS -> "-2.47439063"
 Parameter: ZPOS -> "-60.3641599"
 Parameter: YPHI -> "182.25853"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.999223    0.000000    0.039409
    0.000000    1.000000    0.000000
   -0.039409    0.000000   -0.999223

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  177.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.68118282"
 Parameter: YPOS -> "-2.47439063"
 Parameter: ZPOS -> "-60.3641599"
 Parameter: ZPHI -> "249.922804"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.343286   -0.939231    0.000000
    0.939231   -0.343286    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  110.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.681183 XMAX =   -7.681183 XAVE =   -7.681183
    YMIN =   -2.474391 YMAX =   -2.474391 YAVE =   -2.474391
    ZMIN =  -60.364160 ZMAX =  -60.364160 ZAVE =  -60.364160
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.68118282"
Evaluating: -7.68118282+3.5
 Parameter: XMAX <- "-4.18118282"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.47439063"
Evaluating: -2.47439063+3.5
 Parameter: YMAX <- "1.02560937"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-60.3641599"
Evaluating: -60.3641599+3.5
 Parameter: ZMAX <- "-56.8641599"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.68118282"
Evaluating: -7.68118282-3.5
 Parameter: XMIN <- "-11.1811828"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.47439063"
Evaluating: -2.47439063-3.5
 Parameter: YMIN <- "-5.97439063"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-60.3641599"
Evaluating: -60.3641599-3.5
 Parameter: ZMIN <- "-63.8641599"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.18118282"
 Parameter: XMIN -> "-11.1811828"
 Parameter: YMAX -> "1.02560937"
 Parameter: YMIN -> "-5.97439063"
 Parameter: ZMAX -> "-56.8641599"
 Parameter: ZMIN -> "-63.8641599"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "163"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "163" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "163"
Evaluating: 163
 Parameter: J <- "163"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "163" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "163"
 Parameter: NPOS -> "143"
Evaluating: 163-143
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.508064084"
Evaluating: 125.050557*(0.508064084-0.5)
 Parameter: XPOS <- "1.0084182"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.402752842"
Evaluating: 125.050557*(0.402752842-0.5)
 Parameter: YPOS <- "-12.1608113"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.958257207"
Evaluating: 152.572525*(0.958257207-0.5)+-4.51585405
 Parameter: ZPOS <- "65.4016051"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "65.4016051" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "65.4016051" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.0084182"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.0084182-0
 Parameter: XTRAN <- "1.0084182"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.1608113"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.1608113-0
 Parameter: YTRAN <- "-12.1608113"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "65.4016051"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 65.4016051-0
 Parameter: ZTRAN <- "65.4016051"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.0084182"
 Parameter: YTRAN -> "-12.1608113"
 Parameter: ZTRAN -> "65.4016051"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     1.008418  -12.160811   65.401605
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.326440905"
Evaluating: 0.326440905*360.0
 Parameter: XPHI <- "117.518726"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.464003822"
Evaluating: 0.464003822*360.0
 Parameter: YPHI <- "167.041376"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.460921233"
Evaluating: 0.460921233*360.0
 Parameter: ZPHI <- "165.931644"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.0084182"
 Parameter: YPOS -> "-12.1608113"
 Parameter: ZPOS -> "65.4016051"
 Parameter: XPHI -> "117.518726"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.462038    0.886860
    0.000000   -0.886860   -0.462038

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  117.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.0084182"
 Parameter: YPOS -> "-12.1608113"
 Parameter: ZPOS -> "65.4016051"
 Parameter: YPHI -> "167.041376"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.974532    0.000000   -0.224247
    0.000000    1.000000    0.000000
    0.224247    0.000000   -0.974532

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  167.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.0084182"
 Parameter: YPOS -> "-12.1608113"
 Parameter: ZPOS -> "65.4016051"
 Parameter: ZPHI -> "165.931644"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.970006    0.243079    0.000000
   -0.243079   -0.970006    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  165.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.008418 XMAX =    1.008418 XAVE =    1.008418
    YMIN =  -12.160811 YMAX =  -12.160811 YAVE =  -12.160811
    ZMIN =   65.401605 ZMAX =   65.401605 ZAVE =   65.401605
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.0084182"
Evaluating: 1.0084182+3.5
 Parameter: XMAX <- "4.5084182"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.1608113"
Evaluating: -12.1608113+3.5
 Parameter: YMAX <- "-8.6608113"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "65.4016051"
Evaluating: 65.4016051+3.5
 Parameter: ZMAX <- "68.9016051"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.0084182"
Evaluating: 1.0084182-3.5
 Parameter: XMIN <- "-2.4915818"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.1608113"
Evaluating: -12.1608113-3.5
 Parameter: YMIN <- "-15.6608113"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "65.4016051"
Evaluating: 65.4016051-3.5
 Parameter: ZMIN <- "61.9016051"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.5084182"
 Parameter: XMIN -> "-2.4915818"
 Parameter: YMAX -> "-8.6608113"
 Parameter: YMIN -> "-15.6608113"
 Parameter: ZMAX -> "68.9016051"
 Parameter: ZMIN -> "61.9016051"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "164"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "164" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "164"
Evaluating: 164
 Parameter: J <- "164"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "164" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "164"
 Parameter: NPOS -> "143"
Evaluating: 164-143
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "7.572548838E-03"
Evaluating: 125.050557*(7.572548838E-03-0.5)
 Parameter: XPOS <- "-61.578327"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.252604926"
Evaluating: 125.050557*(0.252604926-0.5)
 Parameter: YPOS <- "-30.9368918"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.241094295"
Evaluating: 152.572525*(0.241094295-0.5)+-4.51585405
 Parameter: ZPOS <- "-44.0177512"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.0177512" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-61.578327"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -61.578327-0
 Parameter: XTRAN <- "-61.578327"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.9368918"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.9368918-0
 Parameter: YTRAN <- "-30.9368918"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.0177512"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -44.0177512-0
 Parameter: ZTRAN <- "-44.0177512"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-61.578327"
 Parameter: YTRAN -> "-30.9368918"
 Parameter: ZTRAN -> "-44.0177512"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -61.578327  -30.936892  -44.017751
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.380754349"
Evaluating: 0.380754349*360.0
 Parameter: XPHI <- "137.071566"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.178204091"
Evaluating: 0.178204091*360.0
 Parameter: YPHI <- "64.1534728"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.554585676"
Evaluating: 0.554585676*360.0
 Parameter: ZPHI <- "199.650843"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-61.578327"
 Parameter: YPOS -> "-30.9368918"
 Parameter: ZPOS -> "-44.0177512"
 Parameter: XPHI -> "137.071566"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.732205    0.681084
    0.000000   -0.681084   -0.732205

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  137.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-61.578327"
 Parameter: YPOS -> "-30.9368918"
 Parameter: ZPOS -> "-44.0177512"
 Parameter: YPHI -> "64.1534728"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.435962    0.000000   -0.899965
    0.000000    1.000000    0.000000
    0.899965    0.000000    0.435962

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   64.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-61.578327"
 Parameter: YPOS -> "-30.9368918"
 Parameter: ZPOS -> "-44.0177512"
 Parameter: ZPHI -> "199.650843"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.941759   -0.336287    0.000000
    0.336287   -0.941759    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  160.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -61.578327 XMAX =  -61.578327 XAVE =  -61.578327
    YMIN =  -30.936892 YMAX =  -30.936892 YAVE =  -30.936892
    ZMIN =  -44.017751 ZMAX =  -44.017751 ZAVE =  -44.017751
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-61.578327"
Evaluating: -61.578327+3.5
 Parameter: XMAX <- "-58.078327"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.9368918"
Evaluating: -30.9368918+3.5
 Parameter: YMAX <- "-27.4368918"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.0177512"
Evaluating: -44.0177512+3.5
 Parameter: ZMAX <- "-40.5177512"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-61.578327"
Evaluating: -61.578327-3.5
 Parameter: XMIN <- "-65.078327"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.9368918"
Evaluating: -30.9368918-3.5
 Parameter: YMIN <- "-34.4368918"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.0177512"
Evaluating: -44.0177512-3.5
 Parameter: ZMIN <- "-47.5177512"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-58.078327"
 Parameter: XMIN -> "-65.078327"
 Parameter: YMAX -> "-27.4368918"
 Parameter: YMIN -> "-34.4368918"
 Parameter: ZMAX -> "-40.5177512"
 Parameter: ZMIN -> "-47.5177512"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "165"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "165" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "165"
Evaluating: 165
 Parameter: J <- "165"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "165" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "165"
 Parameter: NPOS -> "143"
Evaluating: 165-143
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.829692965"
Evaluating: 125.050557*(0.829692965-0.5)
 Parameter: XPOS <- "41.2282889"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.214261282"
Evaluating: 125.050557*(0.214261282-0.5)
 Parameter: YPOS <- "-35.7317858"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.507212752"
Evaluating: 152.572525*(0.507212752-0.5)+-4.51585405
 Parameter: ZPOS <- "-3.41538627"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.41538627" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.41538627" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "165"
Evaluating: 165
 Parameter: J <- "165"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "165" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "165"
 Parameter: NPOS -> "143"
Evaluating: 165-143
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.73054824"
Evaluating: 125.050557*(0.73054824-0.5)
 Parameter: XPOS <- "28.8301858"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.431991889E-02"
Evaluating: 125.050557*(1.431991889E-02-0.5)
 Parameter: YPOS <- "-60.7345647"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.170580043"
Evaluating: 152.572525*(0.170580043-0.5)+-4.51585405
 Parameter: ZPOS <- "-54.7762887"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.7762887" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.8301858"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.8301858-0
 Parameter: XTRAN <- "28.8301858"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-60.7345647"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -60.7345647-0
 Parameter: YTRAN <- "-60.7345647"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.7762887"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.7762887-0
 Parameter: ZTRAN <- "-54.7762887"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.8301858"
 Parameter: YTRAN -> "-60.7345647"
 Parameter: ZTRAN -> "-54.7762887"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    28.830186  -60.734565  -54.776289
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.480881444"
Evaluating: 0.480881444*360.0
 Parameter: XPHI <- "173.11732"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.77252465"
Evaluating: 0.77252465*360.0
 Parameter: YPHI <- "278.108874"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.848533471"
Evaluating: 0.848533471*360.0
 Parameter: ZPHI <- "305.47205"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.8301858"
 Parameter: YPOS -> "-60.7345647"
 Parameter: ZPOS -> "-54.7762887"
 Parameter: XPHI -> "173.11732"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.992794    0.119837
    0.000000   -0.119837   -0.992794

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  173.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.8301858"
 Parameter: YPOS -> "-60.7345647"
 Parameter: ZPOS -> "-54.7762887"
 Parameter: YPHI -> "278.108874"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.141055    0.000000    0.990002
    0.000000    1.000000    0.000000
   -0.990002    0.000000    0.141055

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   81.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.8301858"
 Parameter: YPOS -> "-60.7345647"
 Parameter: ZPOS -> "-54.7762887"
 Parameter: ZPHI -> "305.47205"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.580306   -0.814399    0.000000
    0.814399    0.580306    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   54.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.830186 XMAX =   28.830186 XAVE =   28.830186
    YMIN =  -60.734565 YMAX =  -60.734565 YAVE =  -60.734565
    ZMIN =  -54.776289 ZMAX =  -54.776289 ZAVE =  -54.776289
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.8301858"
Evaluating: 28.8301858+3.5
 Parameter: XMAX <- "32.3301858"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-60.7345647"
Evaluating: -60.7345647+3.5
 Parameter: YMAX <- "-57.2345647"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.7762887"
Evaluating: -54.7762887+3.5
 Parameter: ZMAX <- "-51.2762887"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.8301858"
Evaluating: 28.8301858-3.5
 Parameter: XMIN <- "25.3301858"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-60.7345647"
Evaluating: -60.7345647-3.5
 Parameter: YMIN <- "-64.2345647"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.7762887"
Evaluating: -54.7762887-3.5
 Parameter: ZMIN <- "-58.2762887"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.3301858"
 Parameter: XMIN -> "25.3301858"
 Parameter: YMAX -> "-57.2345647"
 Parameter: YMIN -> "-64.2345647"
 Parameter: ZMAX -> "-51.2762887"
 Parameter: ZMIN -> "-58.2762887"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "166"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "166" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "166"
Evaluating: 166
 Parameter: J <- "166"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "166" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "166"
 Parameter: NPOS -> "143"
Evaluating: 166-143
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.577503605"
Evaluating: 125.050557*(0.577503605-0.5)
 Parameter: XPOS <- "9.69186897"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.481955946"
Evaluating: 125.050557*(0.481955946-0.5)
 Parameter: YPOS <- "-2.256419"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "6.997951448E-03"
Evaluating: 152.572525*(6.997951448E-03-0.5)+-4.51585405
 Parameter: ZPOS <- "-79.7344214"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-79.7344214" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.69186897"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 9.69186897-0
 Parameter: XTRAN <- "9.69186897"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.256419"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.256419-0
 Parameter: YTRAN <- "-2.256419"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-79.7344214"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -79.7344214-0
 Parameter: ZTRAN <- "-79.7344214"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.69186897"
 Parameter: YTRAN -> "-2.256419"
 Parameter: ZTRAN -> "-79.7344214"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     9.691869   -2.256419  -79.734421
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.889654636"
Evaluating: 0.889654636*360.0
 Parameter: XPHI <- "320.275669"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.975387951"
Evaluating: 0.975387951*360.0
 Parameter: YPHI <- "351.139662"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.591173011"
Evaluating: 0.591173011*360.0
 Parameter: ZPHI <- "212.822284"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.69186897"
 Parameter: YPOS -> "-2.256419"
 Parameter: ZPOS -> "-79.7344214"
 Parameter: XPHI -> "320.275669"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.769128   -0.639094
    0.000000    0.639094    0.769128

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   39.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.69186897"
 Parameter: YPOS -> "-2.256419"
 Parameter: ZPOS -> "-79.7344214"
 Parameter: YPHI -> "351.139662"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.988067    0.000000    0.154026
    0.000000    1.000000    0.000000
   -0.154026    0.000000    0.988067

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    8.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.69186897"
 Parameter: YPOS -> "-2.256419"
 Parameter: ZPOS -> "-79.7344214"
 Parameter: ZPHI -> "212.822284"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.840356   -0.542035    0.000000
    0.542035   -0.840356    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  147.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.691869 XMAX =    9.691869 XAVE =    9.691869
    YMIN =   -2.256419 YMAX =   -2.256419 YAVE =   -2.256419
    ZMIN =  -79.734421 ZMAX =  -79.734421 ZAVE =  -79.734421
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.69186897"
Evaluating: 9.69186897+3.5
 Parameter: XMAX <- "13.191869"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.256419"
Evaluating: -2.256419+3.5
 Parameter: YMAX <- "1.243581"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-79.7344214"
Evaluating: -79.7344214+3.5
 Parameter: ZMAX <- "-76.2344214"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.69186897"
Evaluating: 9.69186897-3.5
 Parameter: XMIN <- "6.19186897"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.256419"
Evaluating: -2.256419-3.5
 Parameter: YMIN <- "-5.756419"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-79.7344214"
Evaluating: -79.7344214-3.5
 Parameter: ZMIN <- "-83.2344214"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.191869"
 Parameter: XMIN -> "6.19186897"
 Parameter: YMAX -> "1.243581"
 Parameter: YMIN -> "-5.756419"
 Parameter: ZMAX -> "-76.2344214"
 Parameter: ZMIN -> "-83.2344214"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "167"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "167" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "167"
Evaluating: 167
 Parameter: J <- "167"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "167" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "167"
 Parameter: NPOS -> "143"
Evaluating: 167-143
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.486562992"
Evaluating: 125.050557*(0.486562992-0.5)
 Parameter: XPOS <- "-1.68030533"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.853653246"
Evaluating: 125.050557*(0.853653246-0.5)
 Parameter: YPOS <- "44.2245354"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "1.469022479E-03"
Evaluating: 152.572525*(1.469022479E-03-0.5)+-4.51585405
 Parameter: ZPOS <- "-80.5779841"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-80.5779841" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.68030533"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -1.68030533-0
 Parameter: XTRAN <- "-1.68030533"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.2245354"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.2245354-0
 Parameter: YTRAN <- "44.2245354"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-80.5779841"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -80.5779841-0
 Parameter: ZTRAN <- "-80.5779841"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-1.68030533"
 Parameter: YTRAN -> "44.2245354"
 Parameter: ZTRAN -> "-80.5779841"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -1.680305   44.224535  -80.577984
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.210234953E-02"
Evaluating: 2.210234953E-02*360.0
 Parameter: XPHI <- "7.95684583"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.170795169"
Evaluating: 0.170795169*360.0
 Parameter: YPHI <- "61.4862608"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.631831508"
Evaluating: 0.631831508*360.0
 Parameter: ZPHI <- "227.459343"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.68030533"
 Parameter: YPOS -> "44.2245354"
 Parameter: ZPOS -> "-80.5779841"
 Parameter: XPHI -> "7.95684583"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.990373    0.138427
    0.000000   -0.138427    0.990373

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    7.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.68030533"
 Parameter: YPOS -> "44.2245354"
 Parameter: ZPOS -> "-80.5779841"
 Parameter: YPHI -> "61.4862608"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.477369    0.000000   -0.878703
    0.000000    1.000000    0.000000
    0.878703    0.000000    0.477369

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   61.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.68030533"
 Parameter: YPOS -> "44.2245354"
 Parameter: ZPOS -> "-80.5779841"
 Parameter: ZPHI -> "227.459343"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.676113   -0.736798    0.000000
    0.736798   -0.676113    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  132.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.680305 XMAX =   -1.680305 XAVE =   -1.680305
    YMIN =   44.224535 YMAX =   44.224535 YAVE =   44.224535
    ZMIN =  -80.577984 ZMAX =  -80.577984 ZAVE =  -80.577984
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.68030533"
Evaluating: -1.68030533+3.5
 Parameter: XMAX <- "1.81969467"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.2245354"
Evaluating: 44.2245354+3.5
 Parameter: YMAX <- "47.7245354"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-80.5779841"
Evaluating: -80.5779841+3.5
 Parameter: ZMAX <- "-77.0779841"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.68030533"
Evaluating: -1.68030533-3.5
 Parameter: XMIN <- "-5.18030533"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.2245354"
Evaluating: 44.2245354-3.5
 Parameter: YMIN <- "40.7245354"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-80.5779841"
Evaluating: -80.5779841-3.5
 Parameter: ZMIN <- "-84.0779841"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.81969467"
 Parameter: XMIN -> "-5.18030533"
 Parameter: YMAX -> "47.7245354"
 Parameter: YMIN -> "40.7245354"
 Parameter: ZMAX -> "-77.0779841"
 Parameter: ZMIN -> "-84.0779841"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "168"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "168" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "168"
Evaluating: 168
 Parameter: J <- "168"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "168" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "168"
 Parameter: NPOS -> "143"
Evaluating: 168-143
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.413239476"
Evaluating: 125.050557*(0.413239476-0.5)
 Parameter: XPOS <- "-10.8494519"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.784778194"
Evaluating: 125.050557*(0.784778194-0.5)
 Parameter: YPOS <- "35.6116718"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.482503556"
Evaluating: 152.572525*(0.482503556-0.5)+-4.51585405
 Parameter: ZPOS <- "-7.18533069"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.18533069" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.18533069" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "168"
Evaluating: 168
 Parameter: J <- "168"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "168" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "168"
 Parameter: NPOS -> "143"
Evaluating: 168-143
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.82096366"
Evaluating: 125.050557*(0.82096366-0.5)
 Parameter: XPOS <- "40.1366845"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.289802927"
Evaluating: 125.050557*(0.289802927-0.5)
 Parameter: YPOS <- "-26.2852611"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.229393497"
Evaluating: 152.572525*(0.229393497-0.5)+-4.51585405
 Parameter: ZPOS <- "-45.8029715"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-45.8029715" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.1366845"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.1366845-0
 Parameter: XTRAN <- "40.1366845"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.2852611"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.2852611-0
 Parameter: YTRAN <- "-26.2852611"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-45.8029715"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -45.8029715-0
 Parameter: ZTRAN <- "-45.8029715"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.1366845"
 Parameter: YTRAN -> "-26.2852611"
 Parameter: ZTRAN -> "-45.8029715"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    40.136685  -26.285261  -45.802971
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.557734642"
Evaluating: 0.557734642*360.0
 Parameter: XPHI <- "200.784471"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.294716053"
Evaluating: 0.294716053*360.0
 Parameter: YPHI <- "106.097779"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.279159067"
Evaluating: 0.279159067*360.0
 Parameter: ZPHI <- "100.497264"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.1366845"
 Parameter: YPOS -> "-26.2852611"
 Parameter: ZPOS -> "-45.8029715"
 Parameter: XPHI -> "200.784471"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.934922   -0.354854
    0.000000    0.354854   -0.934922

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  159.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.1366845"
 Parameter: YPOS -> "-26.2852611"
 Parameter: ZPOS -> "-45.8029715"
 Parameter: YPHI -> "106.097779"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.277277    0.000000   -0.960790
    0.000000    1.000000    0.000000
    0.960790    0.000000   -0.277277

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  106.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.1366845"
 Parameter: YPOS -> "-26.2852611"
 Parameter: ZPOS -> "-45.8029715"
 Parameter: ZPHI -> "100.497264"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.182189    0.983264    0.000000
   -0.983264   -0.182189    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  100.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.136685 XMAX =   40.136685 XAVE =   40.136685
    YMIN =  -26.285261 YMAX =  -26.285261 YAVE =  -26.285261
    ZMIN =  -45.802971 ZMAX =  -45.802971 ZAVE =  -45.802971
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.1366845"
Evaluating: 40.1366845+3.5
 Parameter: XMAX <- "43.6366845"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.2852611"
Evaluating: -26.2852611+3.5
 Parameter: YMAX <- "-22.7852611"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-45.8029715"
Evaluating: -45.8029715+3.5
 Parameter: ZMAX <- "-42.3029715"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.1366845"
Evaluating: 40.1366845-3.5
 Parameter: XMIN <- "36.6366845"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.2852611"
Evaluating: -26.2852611-3.5
 Parameter: YMIN <- "-29.7852611"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-45.8029715"
Evaluating: -45.8029715-3.5
 Parameter: ZMIN <- "-49.3029715"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.6366845"
 Parameter: XMIN -> "36.6366845"
 Parameter: YMAX -> "-22.7852611"
 Parameter: YMIN -> "-29.7852611"
 Parameter: ZMAX -> "-42.3029715"
 Parameter: ZMIN -> "-49.3029715"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "169"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "169" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "169"
Evaluating: 169
 Parameter: J <- "169"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "169" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "169"
 Parameter: NPOS -> "143"
Evaluating: 169-143
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.191312974"
Evaluating: 125.050557*(0.191312974-0.5)
 Parameter: XPOS <- "-38.6014845"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.886170215"
Evaluating: 125.050557*(0.886170215-0.5)
 Parameter: YPOS <- "48.2908005"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.568168277"
Evaluating: 152.572525*(0.568168277-0.5)+-4.51585405
 Parameter: ZPOS <- "5.8847521"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.8847521" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.8847521" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "169"
Evaluating: 169
 Parameter: J <- "169"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "169" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "169"
 Parameter: NPOS -> "143"
Evaluating: 169-143
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.84357557"
Evaluating: 125.050557*(0.84357557-0.5)
 Parameter: XPOS <- "42.9643164"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.446588424"
Evaluating: 125.050557*(0.446588424-0.5)
 Parameter: YPOS <- "-6.67914733"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.304153424"
Evaluating: 152.572525*(0.304153424-0.5)+-4.51585405
 Parameter: ZPOS <- "-34.3966607"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.3966607" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.9643164"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 42.9643164-0
 Parameter: XTRAN <- "42.9643164"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.67914733"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.67914733-0
 Parameter: YTRAN <- "-6.67914733"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.3966607"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.3966607-0
 Parameter: ZTRAN <- "-34.3966607"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.9643164"
 Parameter: YTRAN -> "-6.67914733"
 Parameter: ZTRAN -> "-34.3966607"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    42.964316   -6.679147  -34.396661
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.798805686"
Evaluating: 0.798805686*360.0
 Parameter: XPHI <- "287.570047"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.306321004"
Evaluating: 0.306321004*360.0
 Parameter: YPHI <- "110.275561"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.861440048E-02"
Evaluating: 6.861440048E-02*360.0
 Parameter: ZPHI <- "24.7011842"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.9643164"
 Parameter: YPOS -> "-6.67914733"
 Parameter: ZPOS -> "-34.3966607"
 Parameter: XPHI -> "287.570047"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.301872   -0.953349
    0.000000    0.953349    0.301872

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   72.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.9643164"
 Parameter: YPOS -> "-6.67914733"
 Parameter: ZPOS -> "-34.3966607"
 Parameter: YPHI -> "110.275561"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.346536    0.000000   -0.938037
    0.000000    1.000000    0.000000
    0.938037    0.000000   -0.346536

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  110.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.9643164"
 Parameter: YPOS -> "-6.67914733"
 Parameter: ZPOS -> "-34.3966607"
 Parameter: ZPHI -> "24.7011842"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.908500    0.417886    0.000000
   -0.417886    0.908500    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   24.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.964316 XMAX =   42.964316 XAVE =   42.964316
    YMIN =   -6.679147 YMAX =   -6.679147 YAVE =   -6.679147
    ZMIN =  -34.396661 ZMAX =  -34.396661 ZAVE =  -34.396661
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.9643164"
Evaluating: 42.9643164+3.5
 Parameter: XMAX <- "46.4643164"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.67914733"
Evaluating: -6.67914733+3.5
 Parameter: YMAX <- "-3.17914733"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.3966607"
Evaluating: -34.3966607+3.5
 Parameter: ZMAX <- "-30.8966607"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.9643164"
Evaluating: 42.9643164-3.5
 Parameter: XMIN <- "39.4643164"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.67914733"
Evaluating: -6.67914733-3.5
 Parameter: YMIN <- "-10.1791473"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.3966607"
Evaluating: -34.3966607-3.5
 Parameter: ZMIN <- "-37.8966607"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.4643164"
 Parameter: XMIN -> "39.4643164"
 Parameter: YMAX -> "-3.17914733"
 Parameter: YMIN -> "-10.1791473"
 Parameter: ZMAX -> "-30.8966607"
 Parameter: ZMIN -> "-37.8966607"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "170"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "170" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "170"
Evaluating: 170
 Parameter: J <- "170"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "170" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "170"
 Parameter: NPOS -> "143"
Evaluating: 170-143
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.232648215"
Evaluating: 125.050557*(0.232648215-0.5)
 Parameter: XPOS <- "-33.4324896"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.435104539"
Evaluating: 125.050557*(0.435104539-0.5)
 Parameter: YPOS <- "-8.11521354"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.320426726"
Evaluating: 152.572525*(0.320426726-0.5)+-4.51585405
 Parameter: ZPOS <- "-31.9138019"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.9138019" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.4324896"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.4324896-0
 Parameter: XTRAN <- "-33.4324896"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.11521354"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.11521354-0
 Parameter: YTRAN <- "-8.11521354"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.9138019"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.9138019-0
 Parameter: ZTRAN <- "-31.9138019"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.4324896"
 Parameter: YTRAN -> "-8.11521354"
 Parameter: ZTRAN -> "-31.9138019"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -33.432490   -8.115214  -31.913802
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.639003931"
Evaluating: 0.639003931*360.0
 Parameter: XPHI <- "230.041415"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.204251579"
Evaluating: 0.204251579*360.0
 Parameter: YPHI <- "73.5305684"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.156683284E-03"
Evaluating: 6.156683284E-03*360.0
 Parameter: ZPHI <- "2.21640598"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.4324896"
 Parameter: YPOS -> "-8.11521354"
 Parameter: ZPOS -> "-31.9138019"
 Parameter: XPHI -> "230.041415"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.642234   -0.766509
    0.000000    0.766509   -0.642234

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.4324896"
 Parameter: YPOS -> "-8.11521354"
 Parameter: ZPOS -> "-31.9138019"
 Parameter: YPHI -> "73.5305684"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.283504    0.000000   -0.958971
    0.000000    1.000000    0.000000
    0.958971    0.000000    0.283504

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   73.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.4324896"
 Parameter: YPOS -> "-8.11521354"
 Parameter: ZPOS -> "-31.9138019"
 Parameter: ZPHI -> "2.21640598"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999252    0.038674    0.000000
   -0.038674    0.999252    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    2.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.432490 XMAX =  -33.432490 XAVE =  -33.432490
    YMIN =   -8.115214 YMAX =   -8.115214 YAVE =   -8.115214
    ZMIN =  -31.913802 ZMAX =  -31.913802 ZAVE =  -31.913802
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.4324896"
Evaluating: -33.4324896+3.5
 Parameter: XMAX <- "-29.9324896"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.11521354"
Evaluating: -8.11521354+3.5
 Parameter: YMAX <- "-4.61521354"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.9138019"
Evaluating: -31.9138019+3.5
 Parameter: ZMAX <- "-28.4138019"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.4324896"
Evaluating: -33.4324896-3.5
 Parameter: XMIN <- "-36.9324896"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.11521354"
Evaluating: -8.11521354-3.5
 Parameter: YMIN <- "-11.6152135"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.9138019"
Evaluating: -31.9138019-3.5
 Parameter: ZMIN <- "-35.4138019"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.9324896"
 Parameter: XMIN -> "-36.9324896"
 Parameter: YMAX -> "-4.61521354"
 Parameter: YMIN -> "-11.6152135"
 Parameter: ZMAX -> "-28.4138019"
 Parameter: ZMIN -> "-35.4138019"
 SELRPN>     22 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     13 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64585 NEG      CLA      27       CLA     -5305 PROA     ASP      362      C             4.6886
64585 NEG      CLA      27       CLA     -5306 PROA     ASP      362      O             4.0524
64585 NEG      CLA      27       CLA     -5357 PROA     TYR      366      N             4.3136
64585 NEG      CLA      27       CLA     -5359 PROA     TYR      366      CA            3.6950
64585 NEG      CLA      27       CLA     -5361 PROA     TYR      366      CB            2.3683
64585 NEG      CLA      27       CLA     -5364 PROA     TYR      366      CG            1.3561
64585 NEG      CLA      27       CLA     -5365 PROA     TYR      366      CD1           1.9787
64585 NEG      CLA      27       CLA     -5367 PROA     TYR      366      CE1           2.5093
64585 NEG      CLA      27       CLA     -5369 PROA     TYR      366      CZ            2.5619
64585 NEG      CLA      27       CLA     -5370 PROA     TYR      366      OH            3.8585
64585 NEG      CLA      27       CLA     -5372 PROA     TYR      366      CD2           1.4088
64585 NEG      CLA      27       CLA     -5374 PROA     TYR      366      CE2           2.0925
64585 NEG      CLA      27       CLA     -5376 PROA     TYR      366      C             4.8020
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        13
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "13"
 Comparing "13" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "170"
Evaluating: 170
 Parameter: J <- "170"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "170" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "170"
 Parameter: NPOS -> "143"
Evaluating: 170-143
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.265159867"
Evaluating: 125.050557*(0.265159867-0.5)
 Parameter: XPOS <- "-29.3668894"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.762439932"
Evaluating: 125.050557*(0.762439932-0.5)
 Parameter: YPOS <- "32.8182597"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.548546051"
Evaluating: 152.572525*(0.548546051-0.5)+-4.51585405
 Parameter: ZPOS <- "2.89093953"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.89093953" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.89093953" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "170"
Evaluating: 170
 Parameter: J <- "170"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "170" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "170"
 Parameter: NPOS -> "143"
Evaluating: 170-143
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.282604336"
Evaluating: 125.050557*(0.282604336-0.5)
 Parameter: XPOS <- "-27.1854489"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.464205254"
Evaluating: 125.050557*(0.464205254-0.5)
 Parameter: YPOS <- "-4.47615292"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.723317161"
Evaluating: 152.572525*(0.723317161-0.5)+-4.51585405
 Parameter: ZPOS <- "29.5562091"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.5562091" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.5562091" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.432490 XMAX =  -33.432490 XAVE =  -33.432490
    YMIN =   -8.115214 YMAX =   -8.115214 YAVE =   -8.115214
    ZMIN =  -31.913802 ZMAX =  -31.913802 ZAVE =  -31.913802
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.1854489"
 RDCMND substituted energy or value "?XAVE" to "-33.4324896"
Evaluating: -27.1854489--33.4324896
 Parameter: XTRAN <- "6.2470407"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.47615292"
 RDCMND substituted energy or value "?YAVE" to "-8.11521354"
Evaluating: -4.47615292--8.11521354
 Parameter: YTRAN <- "3.63906062"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.5562091"
 RDCMND substituted energy or value "?ZAVE" to "-31.9138019"
Evaluating: 29.5562091--31.9138019
 Parameter: ZTRAN <- "61.470011"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.2470407"
 Parameter: YTRAN -> "3.63906062"
 Parameter: ZTRAN -> "61.470011"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     6.247041    3.639061   61.470011
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.935029146E-02"
Evaluating: 1.935029146E-02*360.0
 Parameter: XPHI <- "6.96610493"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.272242395"
Evaluating: 0.272242395*360.0
 Parameter: YPHI <- "98.0072622"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.590308171"
Evaluating: 0.590308171*360.0
 Parameter: ZPHI <- "212.510942"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.1854489"
 Parameter: YPOS -> "-4.47615292"
 Parameter: ZPOS -> "29.5562091"
 Parameter: XPHI -> "6.96610493"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.992618    0.121282
    0.000000   -0.121282    0.992618

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    6.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.1854489"
 Parameter: YPOS -> "-4.47615292"
 Parameter: ZPOS -> "29.5562091"
 Parameter: YPHI -> "98.0072622"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.139299    0.000000   -0.990250
    0.000000    1.000000    0.000000
    0.990250    0.000000   -0.139299

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   98.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.1854489"
 Parameter: YPOS -> "-4.47615292"
 Parameter: ZPOS -> "29.5562091"
 Parameter: ZPHI -> "212.510942"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.843289   -0.537461    0.000000
    0.537461   -0.843289    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  147.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.185449 XMAX =  -27.185449 XAVE =  -27.185449
    YMIN =   -4.476153 YMAX =   -4.476153 YAVE =   -4.476153
    ZMIN =   29.556209 ZMAX =   29.556209 ZAVE =   29.556209
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.1854489"
Evaluating: -27.1854489+3.5
 Parameter: XMAX <- "-23.6854489"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.47615292"
Evaluating: -4.47615292+3.5
 Parameter: YMAX <- "-0.97615292"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.5562091"
Evaluating: 29.5562091+3.5
 Parameter: ZMAX <- "33.0562091"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.1854489"
Evaluating: -27.1854489-3.5
 Parameter: XMIN <- "-30.6854489"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.47615292"
Evaluating: -4.47615292-3.5
 Parameter: YMIN <- "-7.97615292"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.5562091"
Evaluating: 29.5562091-3.5
 Parameter: ZMIN <- "26.0562091"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.6854489"
 Parameter: XMIN -> "-30.6854489"
 Parameter: YMAX -> "-0.97615292"
 Parameter: YMIN -> "-7.97615292"
 Parameter: ZMAX -> "33.0562091"
 Parameter: ZMIN -> "26.0562091"
 SELRPN>     10 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      5 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64585 NEG      CLA      27       CLA     -**** PROA     ALA      1028     CB            4.1517
64585 NEG      CLA      27       CLA     -**** PROA     ASP      1030     N             4.1621
64585 NEG      CLA      27       CLA     -**** PROA     ASP      1030     CA            4.7713
64585 NEG      CLA      27       CLA     -**** PROA     ASP      1030     C             4.3397
64585 NEG      CLA      27       CLA     -**** PROA     ASP      1030     O             4.0301
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "170"
Evaluating: 170
 Parameter: J <- "170"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "170" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "170"
 Parameter: NPOS -> "143"
Evaluating: 170-143
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.752156277"
Evaluating: 125.050557*(0.752156277-0.5)
 Parameter: XPOS <- "31.5322829"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.628463007"
Evaluating: 125.050557*(0.628463007-0.5)
 Parameter: YPOS <- "16.0643706"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.189951877"
Evaluating: 152.572525*(0.189951877-0.5)+-4.51585405
 Parameter: ZPOS <- "-51.820679"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.820679" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.185449 XMAX =  -27.185449 XAVE =  -27.185449
    YMIN =   -4.476153 YMAX =   -4.476153 YAVE =   -4.476153
    ZMIN =   29.556209 ZMAX =   29.556209 ZAVE =   29.556209
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.5322829"
 RDCMND substituted energy or value "?XAVE" to "-27.1854489"
Evaluating: 31.5322829--27.1854489
 Parameter: XTRAN <- "58.7177318"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.0643706"
 RDCMND substituted energy or value "?YAVE" to "-4.47615292"
Evaluating: 16.0643706--4.47615292
 Parameter: YTRAN <- "20.5405235"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.820679"
 RDCMND substituted energy or value "?ZAVE" to "29.5562091"
Evaluating: -51.820679-29.5562091
 Parameter: ZTRAN <- "-81.3768881"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "58.7177318"
 Parameter: YTRAN -> "20.5405235"
 Parameter: ZTRAN -> "-81.3768881"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    58.717732   20.540523  -81.376888
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.942562104"
Evaluating: 0.942562104*360.0
 Parameter: XPHI <- "339.322357"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.102780016"
Evaluating: 0.102780016*360.0
 Parameter: YPHI <- "37.0008058"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.405575586"
Evaluating: 0.405575586*360.0
 Parameter: ZPHI <- "146.007211"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.5322829"
 Parameter: YPOS -> "16.0643706"
 Parameter: ZPOS -> "-51.820679"
 Parameter: XPHI -> "339.322357"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.935582   -0.353110
    0.000000    0.353110    0.935582

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   20.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.5322829"
 Parameter: YPOS -> "16.0643706"
 Parameter: ZPOS -> "-51.820679"
 Parameter: YPHI -> "37.0008058"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.798627    0.000000   -0.601826
    0.000000    1.000000    0.000000
    0.601826    0.000000    0.798627

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   37.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.5322829"
 Parameter: YPOS -> "16.0643706"
 Parameter: ZPOS -> "-51.820679"
 Parameter: ZPHI -> "146.007211"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.829108    0.559089    0.000000
   -0.559089   -0.829108    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  146.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.532283 XMAX =   31.532283 XAVE =   31.532283
    YMIN =   16.064371 YMAX =   16.064371 YAVE =   16.064371
    ZMIN =  -51.820679 ZMAX =  -51.820679 ZAVE =  -51.820679
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.5322829"
Evaluating: 31.5322829+3.5
 Parameter: XMAX <- "35.0322829"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.0643706"
Evaluating: 16.0643706+3.5
 Parameter: YMAX <- "19.5643706"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.820679"
Evaluating: -51.820679+3.5
 Parameter: ZMAX <- "-48.320679"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.5322829"
Evaluating: 31.5322829-3.5
 Parameter: XMIN <- "28.0322829"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.0643706"
Evaluating: 16.0643706-3.5
 Parameter: YMIN <- "12.5643706"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.820679"
Evaluating: -51.820679-3.5
 Parameter: ZMIN <- "-55.320679"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.0322829"
 Parameter: XMIN -> "28.0322829"
 Parameter: YMAX -> "19.5643706"
 Parameter: YMIN -> "12.5643706"
 Parameter: ZMAX -> "-48.320679"
 Parameter: ZMIN -> "-55.320679"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "171"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "171" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "171"
Evaluating: 171
 Parameter: J <- "171"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "171" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "171"
 Parameter: NPOS -> "143"
Evaluating: 171-143
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.540127213"
Evaluating: 125.050557*(0.540127213-0.5)
 Parameter: XPOS <- "5.01793034"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.492630239"
Evaluating: 125.050557*(0.492630239-0.5)
 Parameter: YPOS <- "-0.921592718"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.826323269"
Evaluating: 152.572525*(0.826323269-0.5)+-4.51585405
 Parameter: ZPOS <- "45.2721111"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.2721111" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.2721111" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.01793034"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.01793034-0
 Parameter: XTRAN <- "5.01793034"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.921592718"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.921592718-0
 Parameter: YTRAN <- "-0.921592718"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.2721111"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.2721111-0
 Parameter: ZTRAN <- "45.2721111"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.01793034"
 Parameter: YTRAN -> "-0.921592718"
 Parameter: ZTRAN -> "45.2721111"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     5.017930   -0.921593   45.272111
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.556437595"
Evaluating: 0.556437595*360.0
 Parameter: XPHI <- "200.317534"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.88373806"
Evaluating: 0.88373806*360.0
 Parameter: YPHI <- "318.145702"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.651595809"
Evaluating: 0.651595809*360.0
 Parameter: ZPHI <- "234.574491"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.01793034"
 Parameter: YPOS -> "-0.921592718"
 Parameter: ZPOS -> "45.2721111"
 Parameter: XPHI -> "200.317534"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.937783   -0.347223
    0.000000    0.347223   -0.937783

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  159.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.01793034"
 Parameter: YPOS -> "-0.921592718"
 Parameter: ZPOS -> "45.2721111"
 Parameter: YPHI -> "318.145702"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.744844    0.000000    0.667239
    0.000000    1.000000    0.000000
   -0.667239    0.000000    0.744844

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   41.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.01793034"
 Parameter: YPOS -> "-0.921592718"
 Parameter: ZPOS -> "45.2721111"
 Parameter: ZPHI -> "234.574491"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.579644   -0.814870    0.000000
    0.814870   -0.579644    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  125.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.017930 XMAX =    5.017930 XAVE =    5.017930
    YMIN =   -0.921593 YMAX =   -0.921593 YAVE =   -0.921593
    ZMIN =   45.272111 ZMAX =   45.272111 ZAVE =   45.272111
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.01793034"
Evaluating: 5.01793034+3.5
 Parameter: XMAX <- "8.51793034"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.921592718"
Evaluating: -0.921592718+3.5
 Parameter: YMAX <- "2.57840728"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.2721111"
Evaluating: 45.2721111+3.5
 Parameter: ZMAX <- "48.7721111"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.01793034"
Evaluating: 5.01793034-3.5
 Parameter: XMIN <- "1.51793034"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.921592718"
Evaluating: -0.921592718-3.5
 Parameter: YMIN <- "-4.42159272"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.2721111"
Evaluating: 45.2721111-3.5
 Parameter: ZMIN <- "41.7721111"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.51793034"
 Parameter: XMIN -> "1.51793034"
 Parameter: YMAX -> "2.57840728"
 Parameter: YMIN -> "-4.42159272"
 Parameter: ZMAX -> "48.7721111"
 Parameter: ZMIN -> "41.7721111"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64586 NEG      CLA      28       CLA     -**** PROA     GLU      984      OE1           4.9814
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "171"
Evaluating: 171
 Parameter: J <- "171"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "171" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "171"
 Parameter: NPOS -> "143"
Evaluating: 171-143
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.519934677"
Evaluating: 125.050557*(0.519934677-0.5)
 Parameter: XPOS <- "2.49284246"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.165975004"
Evaluating: 125.050557*(0.165975004-0.5)
 Parameter: YPOS <- "-41.7700118"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.336784396"
Evaluating: 152.572525*(0.336784396-0.5)+-4.51585405
 Parameter: ZPOS <- "-29.4180709"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.4180709" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.017930 XMAX =    5.017930 XAVE =    5.017930
    YMIN =   -0.921593 YMAX =   -0.921593 YAVE =   -0.921593
    ZMIN =   45.272111 ZMAX =   45.272111 ZAVE =   45.272111
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.49284246"
 RDCMND substituted energy or value "?XAVE" to "5.01793034"
Evaluating: 2.49284246-5.01793034
 Parameter: XTRAN <- "-2.52508788"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.7700118"
 RDCMND substituted energy or value "?YAVE" to "-0.921592718"
Evaluating: -41.7700118--0.921592718
 Parameter: YTRAN <- "-40.8484191"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.4180709"
 RDCMND substituted energy or value "?ZAVE" to "45.2721111"
Evaluating: -29.4180709-45.2721111
 Parameter: ZTRAN <- "-74.690182"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.52508788"
 Parameter: YTRAN -> "-40.8484191"
 Parameter: ZTRAN -> "-74.690182"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -2.525088  -40.848419  -74.690182
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.555405724"
Evaluating: 0.555405724*360.0
 Parameter: XPHI <- "199.946061"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.979592335"
Evaluating: 0.979592335*360.0
 Parameter: YPHI <- "352.653241"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.657920146"
Evaluating: 0.657920146*360.0
 Parameter: ZPHI <- "236.851253"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.49284246"
 Parameter: YPOS -> "-41.7700118"
 Parameter: ZPOS -> "-29.4180709"
 Parameter: XPHI -> "199.946061"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.940014   -0.341135
    0.000000    0.341135   -0.940014

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  160.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.49284246"
 Parameter: YPOS -> "-41.7700118"
 Parameter: ZPOS -> "-29.4180709"
 Parameter: YPHI -> "352.653241"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.991790    0.000000    0.127874
    0.000000    1.000000    0.000000
   -0.127874    0.000000    0.991790

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    7.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.49284246"
 Parameter: YPOS -> "-41.7700118"
 Parameter: ZPOS -> "-29.4180709"
 Parameter: ZPHI -> "236.851253"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.546814   -0.837254    0.000000
    0.837254   -0.546814    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  123.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.492842 XMAX =    2.492842 XAVE =    2.492842
    YMIN =  -41.770012 YMAX =  -41.770012 YAVE =  -41.770012
    ZMIN =  -29.418071 ZMAX =  -29.418071 ZAVE =  -29.418071
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.49284245"
Evaluating: 2.49284245+3.5
 Parameter: XMAX <- "5.99284245"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.7700118"
Evaluating: -41.7700118+3.5
 Parameter: YMAX <- "-38.2700118"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.4180709"
Evaluating: -29.4180709+3.5
 Parameter: ZMAX <- "-25.9180709"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.49284245"
Evaluating: 2.49284245-3.5
 Parameter: XMIN <- "-1.00715755"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.7700118"
Evaluating: -41.7700118-3.5
 Parameter: YMIN <- "-45.2700118"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.4180709"
Evaluating: -29.4180709-3.5
 Parameter: ZMIN <- "-32.9180709"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.99284245"
 Parameter: XMIN -> "-1.00715755"
 Parameter: YMAX -> "-38.2700118"
 Parameter: YMIN -> "-45.2700118"
 Parameter: ZMAX -> "-25.9180709"
 Parameter: ZMIN -> "-32.9180709"
 SELRPN>      5 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      2 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64586 NEG      CLA      28       CLA     -  26 PROA     CYS      33       CB            3.1393
64586 NEG      CLA      28       CLA     -  29 PROA     CYS      33       SG            3.2094
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "171"
Evaluating: 171
 Parameter: J <- "171"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "171" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "171"
 Parameter: NPOS -> "143"
Evaluating: 171-143
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.842526038"
Evaluating: 125.050557*(0.842526038-0.5)
 Parameter: XPOS <- "42.8330718"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.947837617"
Evaluating: 125.050557*(0.947837617-0.5)
 Parameter: YPOS <- "56.0023435"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.6551788"
Evaluating: 152.572525*(0.6551788-0.5)+-4.51585405
 Parameter: ZPOS <- "19.1601673"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.1601673" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.1601673" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.492842 XMAX =    2.492842 XAVE =    2.492842
    YMIN =  -41.770012 YMAX =  -41.770012 YAVE =  -41.770012
    ZMIN =  -29.418071 ZMAX =  -29.418071 ZAVE =  -29.418071
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.8330718"
 RDCMND substituted energy or value "?XAVE" to "2.49284245"
Evaluating: 42.8330718-2.49284245
 Parameter: XTRAN <- "40.3402294"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "56.0023435"
 RDCMND substituted energy or value "?YAVE" to "-41.7700118"
Evaluating: 56.0023435--41.7700118
 Parameter: YTRAN <- "97.7723553"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.1601673"
 RDCMND substituted energy or value "?ZAVE" to "-29.4180709"
Evaluating: 19.1601673--29.4180709
 Parameter: ZTRAN <- "48.5782382"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.3402294"
 Parameter: YTRAN -> "97.7723553"
 Parameter: ZTRAN -> "48.5782382"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    40.340229   97.772355   48.578238
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.032253667E-03"
Evaluating: 3.032253667E-03*360.0
 Parameter: XPHI <- "1.09161132"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.338809026"
Evaluating: 0.338809026*360.0
 Parameter: YPHI <- "121.971249"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.572302048"
Evaluating: 0.572302048*360.0
 Parameter: ZPHI <- "206.028737"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.8330718"
 Parameter: YPOS -> "56.0023435"
 Parameter: ZPOS -> "19.1601673"
 Parameter: XPHI -> "1.09161132"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999819    0.019051
    0.000000   -0.019051    0.999819

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    1.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.8330718"
 Parameter: YPOS -> "56.0023435"
 Parameter: ZPOS -> "19.1601673"
 Parameter: YPHI -> "121.971249"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.529494    0.000000   -0.848314
    0.000000    1.000000    0.000000
    0.848314    0.000000   -0.529494

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  121.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.8330718"
 Parameter: YPOS -> "56.0023435"
 Parameter: ZPOS -> "19.1601673"
 Parameter: ZPHI -> "206.028737"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.898574   -0.438822    0.000000
    0.438822   -0.898574    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  153.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.833072 XMAX =   42.833072 XAVE =   42.833072
    YMIN =   56.002344 YMAX =   56.002344 YAVE =   56.002344
    ZMIN =   19.160167 ZMAX =   19.160167 ZAVE =   19.160167
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.8330718"
Evaluating: 42.8330718+3.5
 Parameter: XMAX <- "46.3330718"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "56.0023435"
Evaluating: 56.0023435+3.5
 Parameter: YMAX <- "59.5023435"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.1601673"
Evaluating: 19.1601673+3.5
 Parameter: ZMAX <- "22.6601673"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.8330718"
Evaluating: 42.8330718-3.5
 Parameter: XMIN <- "39.3330718"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "56.0023435"
Evaluating: 56.0023435-3.5
 Parameter: YMIN <- "52.5023435"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.1601673"
Evaluating: 19.1601673-3.5
 Parameter: ZMIN <- "15.6601673"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.3330718"
 Parameter: XMIN -> "39.3330718"
 Parameter: YMAX -> "59.5023435"
 Parameter: YMIN -> "52.5023435"
 Parameter: ZMAX -> "22.6601673"
 Parameter: ZMIN -> "15.6601673"
 SELRPN>     31 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     15 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64586 NEG      CLA      28       CLA     -**** MEMB     POPC     132      C15           3.2230
64586 NEG      CLA      28       CLA     -**** MEMB     POPC     139      N             3.3371
64586 NEG      CLA      28       CLA     -**** MEMB     POPC     139      C12           2.5915
64586 NEG      CLA      28       CLA     -**** MEMB     POPC     139      C14           2.9270
64586 NEG      CLA      28       CLA     -**** MEMB     POPC     139      C11           2.4411
64586 NEG      CLA      28       CLA     -**** MEMB     POPC     139      P             3.2544
64586 NEG      CLA      28       CLA     -**** MEMB     POPC     139      O14           3.8693
64586 NEG      CLA      28       CLA     -**** MEMB     POPC     139      O12           2.3091
64586 NEG      CLA      28       CLA     -**** MEMB     POPC     139      O11           2.9881
64586 NEG      CLA      28       CLA     -**** MEMB     POPC     139      C1            3.2877
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "171"
Evaluating: 171
 Parameter: J <- "171"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "171" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "171"
 Parameter: NPOS -> "143"
Evaluating: 171-143
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "5.998359547E-02"
Evaluating: 125.050557*(5.998359547E-02-0.5)
 Parameter: XPOS <- "-55.0242965"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.216007031"
Evaluating: 125.050557*(0.216007031-0.5)
 Parameter: YPOS <- "-35.513479"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.166816068"
Evaluating: 152.572525*(0.166816068-0.5)+-4.51585405
 Parameter: ZPOS <- "-55.3505678"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.3505678" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.833072 XMAX =   42.833072 XAVE =   42.833072
    YMIN =   56.002344 YMAX =   56.002344 YAVE =   56.002344
    ZMIN =   19.160167 ZMAX =   19.160167 ZAVE =   19.160167
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-55.0242965"
 RDCMND substituted energy or value "?XAVE" to "42.8330718"
Evaluating: -55.0242965-42.8330718
 Parameter: XTRAN <- "-97.8573683"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.513479"
 RDCMND substituted energy or value "?YAVE" to "56.0023435"
Evaluating: -35.513479-56.0023435
 Parameter: YTRAN <- "-91.5158225"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.3505678"
 RDCMND substituted energy or value "?ZAVE" to "19.1601673"
Evaluating: -55.3505678-19.1601673
 Parameter: ZTRAN <- "-74.5107351"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-97.8573683"
 Parameter: YTRAN -> "-91.5158225"
 Parameter: ZTRAN -> "-74.5107351"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -97.857368  -91.515822  -74.510735
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.645688391"
Evaluating: 0.645688391*360.0
 Parameter: XPHI <- "232.447821"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.947085989"
Evaluating: 0.947085989*360.0
 Parameter: YPHI <- "340.950956"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.208699143"
Evaluating: 0.208699143*360.0
 Parameter: ZPHI <- "75.1316915"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-55.0242965"
 Parameter: YPOS -> "-35.513479"
 Parameter: ZPOS -> "-55.3505678"
 Parameter: XPHI -> "232.447821"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.609484   -0.792799
    0.000000    0.792799   -0.609484

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  127.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-55.0242965"
 Parameter: YPOS -> "-35.513479"
 Parameter: ZPOS -> "-55.3505678"
 Parameter: YPHI -> "340.950956"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.945240    0.000000    0.326377
    0.000000    1.000000    0.000000
   -0.326377    0.000000    0.945240

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   19.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-55.0242965"
 Parameter: YPOS -> "-35.513479"
 Parameter: ZPOS -> "-55.3505678"
 Parameter: ZPHI -> "75.1316915"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.256598    0.966518    0.000000
   -0.966518    0.256598    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   75.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -55.024297 XMAX =  -55.024297 XAVE =  -55.024297
    YMIN =  -35.513479 YMAX =  -35.513479 YAVE =  -35.513479
    ZMIN =  -55.350568 ZMAX =  -55.350568 ZAVE =  -55.350568
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-55.0242965"
Evaluating: -55.0242965+3.5
 Parameter: XMAX <- "-51.5242965"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.513479"
Evaluating: -35.513479+3.5
 Parameter: YMAX <- "-32.013479"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.3505678"
Evaluating: -55.3505678+3.5
 Parameter: ZMAX <- "-51.8505678"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-55.0242965"
Evaluating: -55.0242965-3.5
 Parameter: XMIN <- "-58.5242965"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.513479"
Evaluating: -35.513479-3.5
 Parameter: YMIN <- "-39.013479"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.3505678"
Evaluating: -55.3505678-3.5
 Parameter: ZMIN <- "-58.8505678"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-51.5242965"
 Parameter: XMIN -> "-58.5242965"
 Parameter: YMAX -> "-32.013479"
 Parameter: YMIN -> "-39.013479"
 Parameter: ZMAX -> "-51.8505678"
 Parameter: ZMIN -> "-58.8505678"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "172"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "172" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "172"
Evaluating: 172
 Parameter: J <- "172"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "172" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "172"
 Parameter: NPOS -> "143"
Evaluating: 172-143
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.809150052"
Evaluating: 125.050557*(0.809150052-0.5)
 Parameter: XPOS <- "38.6593862"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.61711392"
Evaluating: 125.050557*(0.61711392-0.5)
 Parameter: YPOS <- "14.6451609"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.379384568"
Evaluating: 152.572525*(0.379384568-0.5)+-4.51585405
 Parameter: ZPOS <- "-22.9184551"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.9184551" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.6593862"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.6593862-0
 Parameter: XTRAN <- "38.6593862"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.6451609"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.6451609-0
 Parameter: YTRAN <- "14.6451609"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.9184551"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.9184551-0
 Parameter: ZTRAN <- "-22.9184551"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.6593862"
 Parameter: YTRAN -> "14.6451609"
 Parameter: ZTRAN -> "-22.9184551"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    38.659386   14.645161  -22.918455
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.98543317"
Evaluating: 0.98543317*360.0
 Parameter: XPHI <- "354.755941"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.561057836"
Evaluating: 0.561057836*360.0
 Parameter: YPHI <- "201.980821"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.19930355"
Evaluating: 0.19930355*360.0
 Parameter: ZPHI <- "71.749278"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.6593862"
 Parameter: YPOS -> "14.6451609"
 Parameter: ZPOS -> "-22.9184551"
 Parameter: XPHI -> "354.755941"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.995814   -0.091398
    0.000000    0.091398    0.995814

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    5.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.6593862"
 Parameter: YPOS -> "14.6451609"
 Parameter: ZPOS -> "-22.9184551"
 Parameter: YPHI -> "201.980821"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.927309    0.000000    0.374296
    0.000000    1.000000    0.000000
   -0.374296    0.000000   -0.927309

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  158.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.6593862"
 Parameter: YPOS -> "14.6451609"
 Parameter: ZPOS -> "-22.9184551"
 Parameter: ZPHI -> "71.749278"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.313176    0.949695    0.000000
   -0.949695    0.313176    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   71.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.659386 XMAX =   38.659386 XAVE =   38.659386
    YMIN =   14.645161 YMAX =   14.645161 YAVE =   14.645161
    ZMIN =  -22.918455 ZMAX =  -22.918455 ZAVE =  -22.918455
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.6593862"
Evaluating: 38.6593862+3.5
 Parameter: XMAX <- "42.1593862"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.6451609"
Evaluating: 14.6451609+3.5
 Parameter: YMAX <- "18.1451609"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.9184551"
Evaluating: -22.9184551+3.5
 Parameter: ZMAX <- "-19.4184551"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.6593862"
Evaluating: 38.6593862-3.5
 Parameter: XMIN <- "35.1593862"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.6451609"
Evaluating: 14.6451609-3.5
 Parameter: YMIN <- "11.1451609"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.9184551"
Evaluating: -22.9184551-3.5
 Parameter: ZMIN <- "-26.4184551"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.1593862"
 Parameter: XMIN -> "35.1593862"
 Parameter: YMAX -> "18.1451609"
 Parameter: YMIN -> "11.1451609"
 Parameter: ZMAX -> "-19.4184551"
 Parameter: ZMIN -> "-26.4184551"
 SELRPN>     15 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      2 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64587 NEG      CLA      29       CLA     -**** PROA     TYR      1101     OH            3.3511
64587 NEG      CLA      29       CLA     -**** PROA     ARG      1175     NH2           4.2810
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "172"
Evaluating: 172
 Parameter: J <- "172"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "172" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "172"
 Parameter: NPOS -> "143"
Evaluating: 172-143
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.174112078"
Evaluating: 125.050557*(0.174112078-0.5)
 Parameter: XPOS <- "-40.7524662"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.141869636"
Evaluating: 125.050557*(0.141869636-0.5)
 Parameter: YPOS <- "-44.7844015"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.852391186"
Evaluating: 152.572525*(0.852391186-0.5)+-4.51585405
 Parameter: ZPOS <- "49.249359"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.249359" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.249359" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.659386 XMAX =   38.659386 XAVE =   38.659386
    YMIN =   14.645161 YMAX =   14.645161 YAVE =   14.645161
    ZMIN =  -22.918455 ZMAX =  -22.918455 ZAVE =  -22.918455
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.7524662"
 RDCMND substituted energy or value "?XAVE" to "38.6593862"
Evaluating: -40.7524662-38.6593862
 Parameter: XTRAN <- "-79.4118524"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.7844015"
 RDCMND substituted energy or value "?YAVE" to "14.6451609"
Evaluating: -44.7844015-14.6451609
 Parameter: YTRAN <- "-59.4295624"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.249359"
 RDCMND substituted energy or value "?ZAVE" to "-22.9184551"
Evaluating: 49.249359--22.9184551
 Parameter: ZTRAN <- "72.1678141"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-79.4118524"
 Parameter: YTRAN -> "-59.4295624"
 Parameter: ZTRAN -> "72.1678141"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -79.411852  -59.429562   72.167814
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193996729"
Evaluating: 0.193996729*360.0
 Parameter: XPHI <- "69.8388224"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.191943485"
Evaluating: 0.191943485*360.0
 Parameter: YPHI <- "69.0996546"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864907263"
Evaluating: 0.864907263*360.0
 Parameter: ZPHI <- "311.366615"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.7524662"
 Parameter: YPOS -> "-44.7844015"
 Parameter: ZPOS -> "49.249359"
 Parameter: XPHI -> "69.8388224"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.344662    0.938727
    0.000000   -0.938727    0.344662

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   69.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.7524662"
 Parameter: YPOS -> "-44.7844015"
 Parameter: ZPOS -> "49.249359"
 Parameter: YPHI -> "69.0996546"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.356744    0.000000   -0.934202
    0.000000    1.000000    0.000000
    0.934202    0.000000    0.356744

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   69.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.7524662"
 Parameter: YPOS -> "-44.7844015"
 Parameter: ZPOS -> "49.249359"
 Parameter: ZPHI -> "311.366615"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.660875   -0.750496    0.000000
    0.750496    0.660875    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   48.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.752466 XMAX =  -40.752466 XAVE =  -40.752466
    YMIN =  -44.784402 YMAX =  -44.784402 YAVE =  -44.784402
    ZMIN =   49.249359 ZMAX =   49.249359 ZAVE =   49.249359
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.7524662"
Evaluating: -40.7524662+3.5
 Parameter: XMAX <- "-37.2524662"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.7844015"
Evaluating: -44.7844015+3.5
 Parameter: YMAX <- "-41.2844015"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.249359"
Evaluating: 49.249359+3.5
 Parameter: ZMAX <- "52.749359"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.7524662"
Evaluating: -40.7524662-3.5
 Parameter: XMIN <- "-44.2524662"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.7844015"
Evaluating: -44.7844015-3.5
 Parameter: YMIN <- "-48.2844015"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.249359"
Evaluating: 49.249359-3.5
 Parameter: ZMIN <- "45.749359"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.2524662"
 Parameter: XMIN -> "-44.2524662"
 Parameter: YMAX -> "-41.2844015"
 Parameter: YMIN -> "-48.2844015"
 Parameter: ZMAX -> "52.749359"
 Parameter: ZMIN -> "45.749359"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "173"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "173" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "173"
Evaluating: 173
 Parameter: J <- "173"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "173" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "173"
 Parameter: NPOS -> "143"
Evaluating: 173-143
 Parameter: J <- "30"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.27155316"
Evaluating: 125.050557*(0.27155316-0.5)
 Parameter: XPOS <- "-28.5674046"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.998356689"
Evaluating: 125.050557*(0.998356689-0.5)
 Parameter: YPOS <- "62.3197815"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.240253544"
Evaluating: 152.572525*(0.240253544-0.5)+-4.51585405
 Parameter: ZPOS <- "-44.1460267"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.1460267" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.5674046"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.5674046-0
 Parameter: XTRAN <- "-28.5674046"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "62.3197815"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 62.3197815-0
 Parameter: YTRAN <- "62.3197815"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.1460267"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -44.1460267-0
 Parameter: ZTRAN <- "-44.1460267"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.5674046"
 Parameter: YTRAN -> "62.3197815"
 Parameter: ZTRAN -> "-44.1460267"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -28.567405   62.319781  -44.146027
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.367717721"
Evaluating: 0.367717721*360.0
 Parameter: XPHI <- "132.37838"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.550585448"
Evaluating: 0.550585448*360.0
 Parameter: YPHI <- "198.210761"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.984334962E-02"
Evaluating: 6.984334962E-02*360.0
 Parameter: ZPHI <- "25.1436059"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.5674046"
 Parameter: YPOS -> "62.3197815"
 Parameter: ZPOS -> "-44.1460267"
 Parameter: XPHI -> "132.37838"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.674024    0.738710
    0.000000   -0.738710   -0.674024

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.5674046"
 Parameter: YPOS -> "62.3197815"
 Parameter: ZPOS -> "-44.1460267"
 Parameter: YPHI -> "198.210761"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.949913    0.000000    0.312513
    0.000000    1.000000    0.000000
   -0.312513    0.000000   -0.949913

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  161.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.5674046"
 Parameter: YPOS -> "62.3197815"
 Parameter: ZPOS -> "-44.1460267"
 Parameter: ZPHI -> "25.1436059"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.905246    0.424888    0.000000
   -0.424888    0.905246    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   25.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.567405 XMAX =  -28.567405 XAVE =  -28.567405
    YMIN =   62.319781 YMAX =   62.319781 YAVE =   62.319781
    ZMIN =  -44.146027 ZMAX =  -44.146027 ZAVE =  -44.146027
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.5674046"
Evaluating: -28.5674046+3.5
 Parameter: XMAX <- "-25.0674046"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "62.3197815"
Evaluating: 62.3197815+3.5
 Parameter: YMAX <- "65.8197815"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.1460267"
Evaluating: -44.1460267+3.5
 Parameter: ZMAX <- "-40.6460267"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.5674046"
Evaluating: -28.5674046-3.5
 Parameter: XMIN <- "-32.0674046"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "62.3197815"
Evaluating: 62.3197815-3.5
 Parameter: YMIN <- "58.8197815"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.1460267"
Evaluating: -44.1460267-3.5
 Parameter: ZMIN <- "-47.6460267"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.0674046"
 Parameter: XMIN -> "-32.0674046"
 Parameter: YMAX -> "65.8197815"
 Parameter: YMIN -> "58.8197815"
 Parameter: ZMAX -> "-40.6460267"
 Parameter: ZMIN -> "-47.6460267"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "174"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "174" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "174"
Evaluating: 174
 Parameter: J <- "174"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "174" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "174"
 Parameter: NPOS -> "143"
Evaluating: 174-143
 Parameter: J <- "31"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.863508535"
Evaluating: 125.050557*(0.863508535-0.5)
 Parameter: XPOS <- "45.4569448"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.653815436"
Evaluating: 125.050557*(0.653815436-0.5)
 Parameter: YPOS <- "19.2347059"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.780163813"
Evaluating: 152.572525*(0.780163813-0.5)+-4.51585405
 Parameter: ZPOS <- "38.2294463"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.2294463" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.2294463" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.4569448"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.4569448-0
 Parameter: XTRAN <- "45.4569448"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.2347059"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.2347059-0
 Parameter: YTRAN <- "19.2347059"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.2294463"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.2294463-0
 Parameter: ZTRAN <- "38.2294463"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.4569448"
 Parameter: YTRAN -> "19.2347059"
 Parameter: ZTRAN -> "38.2294463"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    45.456945   19.234706   38.229446
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.716394685"
Evaluating: 0.716394685*360.0
 Parameter: XPHI <- "257.902087"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.710105929"
Evaluating: 0.710105929*360.0
 Parameter: YPHI <- "255.638134"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.607456017"
Evaluating: 0.607456017*360.0
 Parameter: ZPHI <- "218.684166"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.4569448"
 Parameter: YPOS -> "19.2347059"
 Parameter: ZPOS -> "38.2294463"
 Parameter: XPHI -> "257.902087"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.209583   -0.977791
    0.000000    0.977791   -0.209583

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  102.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.4569448"
 Parameter: YPOS -> "19.2347059"
 Parameter: ZPOS -> "38.2294463"
 Parameter: YPHI -> "255.638134"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.248045    0.000000    0.968748
    0.000000    1.000000    0.000000
   -0.968748    0.000000   -0.248045

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  104.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.4569448"
 Parameter: YPOS -> "19.2347059"
 Parameter: ZPOS -> "38.2294463"
 Parameter: ZPHI -> "218.684166"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.780603   -0.625027    0.000000
    0.625027   -0.780603    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  141.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.456945 XMAX =   45.456945 XAVE =   45.456945
    YMIN =   19.234706 YMAX =   19.234706 YAVE =   19.234706
    ZMIN =   38.229446 ZMAX =   38.229446 ZAVE =   38.229446
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.4569448"
Evaluating: 45.4569448+3.5
 Parameter: XMAX <- "48.9569448"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.2347059"
Evaluating: 19.2347059+3.5
 Parameter: YMAX <- "22.7347059"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.2294463"
Evaluating: 38.2294463+3.5
 Parameter: ZMAX <- "41.7294463"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.4569448"
Evaluating: 45.4569448-3.5
 Parameter: XMIN <- "41.9569448"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.2347059"
Evaluating: 19.2347059-3.5
 Parameter: YMIN <- "15.7347059"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.2294463"
Evaluating: 38.2294463-3.5
 Parameter: ZMIN <- "34.7294463"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "48.9569448"
 Parameter: XMIN -> "41.9569448"
 Parameter: YMAX -> "22.7347059"
 Parameter: YMIN -> "15.7347059"
 Parameter: ZMAX -> "41.7294463"
 Parameter: ZMIN -> "34.7294463"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "175"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "175" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "175"
Evaluating: 175
 Parameter: J <- "175"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "175" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "175"
 Parameter: NPOS -> "143"
Evaluating: 175-143
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.773253"
Evaluating: 125.050557*(0.773253-0.5)
 Parameter: XPOS <- "34.1704399"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.885439726"
Evaluating: 125.050557*(0.885439726-0.5)
 Parameter: YPOS <- "48.1994524"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.742088614"
Evaluating: 152.572525*(0.742088614-0.5)+-4.51585405
 Parameter: ZPOS <- "32.4202171"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.4202171" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.4202171" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.1704399"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.1704399-0
 Parameter: XTRAN <- "34.1704399"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "48.1994524"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 48.1994524-0
 Parameter: YTRAN <- "48.1994524"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.4202171"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.4202171-0
 Parameter: ZTRAN <- "32.4202171"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.1704399"
 Parameter: YTRAN -> "48.1994524"
 Parameter: ZTRAN -> "32.4202171"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    34.170440   48.199452   32.420217
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.540489362"
Evaluating: 0.540489362*360.0
 Parameter: XPHI <- "194.57617"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.439177847"
Evaluating: 0.439177847*360.0
 Parameter: YPHI <- "158.104025"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.484702554"
Evaluating: 0.484702554*360.0
 Parameter: ZPHI <- "174.492919"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.1704399"
 Parameter: YPOS -> "48.1994524"
 Parameter: ZPOS -> "32.4202171"
 Parameter: XPHI -> "194.57617"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.967814   -0.251667
    0.000000    0.251667   -0.967814

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  165.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.1704399"
 Parameter: YPOS -> "48.1994524"
 Parameter: ZPOS -> "32.4202171"
 Parameter: YPHI -> "158.104025"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.927862    0.000000   -0.372923
    0.000000    1.000000    0.000000
    0.372923    0.000000   -0.927862

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  158.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.1704399"
 Parameter: YPOS -> "48.1994524"
 Parameter: ZPOS -> "32.4202171"
 Parameter: ZPHI -> "174.492919"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.995384    0.095969    0.000000
   -0.095969   -0.995384    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  174.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.170440 XMAX =   34.170440 XAVE =   34.170440
    YMIN =   48.199452 YMAX =   48.199452 YAVE =   48.199452
    ZMIN =   32.420217 ZMAX =   32.420217 ZAVE =   32.420217
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.1704399"
Evaluating: 34.1704399+3.5
 Parameter: XMAX <- "37.6704399"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "48.1994524"
Evaluating: 48.1994524+3.5
 Parameter: YMAX <- "51.6994524"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.4202171"
Evaluating: 32.4202171+3.5
 Parameter: ZMAX <- "35.9202171"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.1704399"
Evaluating: 34.1704399-3.5
 Parameter: XMIN <- "30.6704399"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "48.1994524"
Evaluating: 48.1994524-3.5
 Parameter: YMIN <- "44.6994524"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.4202171"
Evaluating: 32.4202171-3.5
 Parameter: ZMIN <- "28.9202171"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.6704399"
 Parameter: XMIN -> "30.6704399"
 Parameter: YMAX -> "51.6994524"
 Parameter: YMIN -> "44.6994524"
 Parameter: ZMAX -> "35.9202171"
 Parameter: ZMIN -> "28.9202171"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "176"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "176" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "176"
Evaluating: 176
 Parameter: J <- "176"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "176" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "176"
 Parameter: NPOS -> "143"
Evaluating: 176-143
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.667320796"
Evaluating: 125.050557*(0.667320796-0.5)
 Parameter: XPOS <- "20.9235587"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.976000265E-02"
Evaluating: 125.050557*(9.976000265E-02-0.5)
 Parameter: YPOS <- "-50.0502346"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.875747425"
Evaluating: 152.572525*(0.875747425-0.5)+-4.51585405
 Parameter: ZPOS <- "52.8128793"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.8128793" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.8128793" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.9235587"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.9235587-0
 Parameter: XTRAN <- "20.9235587"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.0502346"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -50.0502346-0
 Parameter: YTRAN <- "-50.0502346"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.8128793"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 52.8128793-0
 Parameter: ZTRAN <- "52.8128793"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.9235587"
 Parameter: YTRAN -> "-50.0502346"
 Parameter: ZTRAN -> "52.8128793"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    20.923559  -50.050235   52.812879
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.190117966"
Evaluating: 0.190117966*360.0
 Parameter: XPHI <- "68.4424678"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.581651038"
Evaluating: 0.581651038*360.0
 Parameter: YPHI <- "209.394374"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.409370924"
Evaluating: 0.409370924*360.0
 Parameter: ZPHI <- "147.373533"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.9235587"
 Parameter: YPOS -> "-50.0502346"
 Parameter: ZPOS -> "52.8128793"
 Parameter: XPHI -> "68.4424678"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.367435    0.930049
    0.000000   -0.930049    0.367435

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   68.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.9235587"
 Parameter: YPOS -> "-50.0502346"
 Parameter: ZPOS -> "52.8128793"
 Parameter: YPHI -> "209.394374"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.871262    0.000000    0.490818
    0.000000    1.000000    0.000000
   -0.490818    0.000000   -0.871262

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  150.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.9235587"
 Parameter: YPOS -> "-50.0502346"
 Parameter: ZPOS -> "52.8128793"
 Parameter: ZPHI -> "147.373533"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.842203    0.539160    0.000000
   -0.539160   -0.842203    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  147.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.923559 XMAX =   20.923559 XAVE =   20.923559
    YMIN =  -50.050235 YMAX =  -50.050235 YAVE =  -50.050235
    ZMIN =   52.812879 ZMAX =   52.812879 ZAVE =   52.812879
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.9235587"
Evaluating: 20.9235587+3.5
 Parameter: XMAX <- "24.4235587"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.0502346"
Evaluating: -50.0502346+3.5
 Parameter: YMAX <- "-46.5502346"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.8128793"
Evaluating: 52.8128793+3.5
 Parameter: ZMAX <- "56.3128793"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.9235587"
Evaluating: 20.9235587-3.5
 Parameter: XMIN <- "17.4235587"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.0502346"
Evaluating: -50.0502346-3.5
 Parameter: YMIN <- "-53.5502346"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.8128793"
Evaluating: 52.8128793-3.5
 Parameter: ZMIN <- "49.3128793"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.4235587"
 Parameter: XMIN -> "17.4235587"
 Parameter: YMAX -> "-46.5502346"
 Parameter: YMIN -> "-53.5502346"
 Parameter: ZMAX -> "56.3128793"
 Parameter: ZMIN -> "49.3128793"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "177"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "177" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "177"
Evaluating: 177
 Parameter: J <- "177"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "177" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "177"
 Parameter: NPOS -> "143"
Evaluating: 177-143
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.256929578"
Evaluating: 125.050557*(0.256929578-0.5)
 Parameter: XPOS <- "-30.3960917"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.521593992"
Evaluating: 125.050557*(0.521593992-0.5)
 Parameter: YPOS <- "2.70034073"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.565401933"
Evaluating: 152.572525*(0.565401933-0.5)+-4.51585405
 Parameter: ZPOS <- "5.46268401"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.46268401" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.46268401" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "177"
Evaluating: 177
 Parameter: J <- "177"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "177" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "177"
 Parameter: NPOS -> "143"
Evaluating: 177-143
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.677008471"
Evaluating: 125.050557*(0.677008471-0.5)
 Parameter: XPOS <- "22.1350079"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.923507157"
Evaluating: 125.050557*(0.923507157-0.5)
 Parameter: YPOS <- "52.9598059"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.357193576"
Evaluating: 152.572525*(0.357193576-0.5)+-4.51585405
 Parameter: ZPOS <- "-26.3041907"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.3041907" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.1350079"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 22.1350079-0
 Parameter: XTRAN <- "22.1350079"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "52.9598059"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 52.9598059-0
 Parameter: YTRAN <- "52.9598059"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.3041907"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.3041907-0
 Parameter: ZTRAN <- "-26.3041907"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.1350079"
 Parameter: YTRAN -> "52.9598059"
 Parameter: ZTRAN -> "-26.3041907"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    22.135008   52.959806  -26.304191
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.812754653"
Evaluating: 0.812754653*360.0
 Parameter: XPHI <- "292.591675"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.831810518"
Evaluating: 0.831810518*360.0
 Parameter: YPHI <- "299.451786"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.799214116"
Evaluating: 0.799214116*360.0
 Parameter: ZPHI <- "287.717082"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.1350079"
 Parameter: YPOS -> "52.9598059"
 Parameter: ZPOS -> "-26.3041907"
 Parameter: XPHI -> "292.591675"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.384161   -0.923266
    0.000000    0.923266    0.384161

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   67.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.1350079"
 Parameter: YPOS -> "52.9598059"
 Parameter: ZPOS -> "-26.3041907"
 Parameter: YPHI -> "299.451786"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.491691    0.000000    0.870770
    0.000000    1.000000    0.000000
   -0.870770    0.000000    0.491691

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   60.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.1350079"
 Parameter: YPOS -> "52.9598059"
 Parameter: ZPOS -> "-26.3041907"
 Parameter: ZPHI -> "287.717082"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.304317   -0.952571    0.000000
    0.952571    0.304317    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   72.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.135008 XMAX =   22.135008 XAVE =   22.135008
    YMIN =   52.959806 YMAX =   52.959806 YAVE =   52.959806
    ZMIN =  -26.304191 ZMAX =  -26.304191 ZAVE =  -26.304191
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.1350079"
Evaluating: 22.1350079+3.5
 Parameter: XMAX <- "25.6350079"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "52.9598059"
Evaluating: 52.9598059+3.5
 Parameter: YMAX <- "56.4598059"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.3041907"
Evaluating: -26.3041907+3.5
 Parameter: ZMAX <- "-22.8041907"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.1350079"
Evaluating: 22.1350079-3.5
 Parameter: XMIN <- "18.6350079"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "52.9598059"
Evaluating: 52.9598059-3.5
 Parameter: YMIN <- "49.4598059"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.3041907"
Evaluating: -26.3041907-3.5
 Parameter: ZMIN <- "-29.8041907"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.6350079"
 Parameter: XMIN -> "18.6350079"
 Parameter: YMAX -> "56.4598059"
 Parameter: YMIN -> "49.4598059"
 Parameter: ZMAX -> "-22.8041907"
 Parameter: ZMIN -> "-29.8041907"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "178"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "178" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "178"
Evaluating: 178
 Parameter: J <- "178"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "178" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "178"
 Parameter: NPOS -> "143"
Evaluating: 178-143
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.282764144"
Evaluating: 125.050557*(0.282764144-0.5)
 Parameter: XPOS <- "-27.1654648"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "3.083062649E-02"
Evaluating: 125.050557*(3.083062649E-02-0.5)
 Parameter: YPOS <- "-58.6698915"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.200658044"
Evaluating: 152.572525*(0.200658044-0.5)+-4.51585405
 Parameter: ZPOS <- "-50.1872121"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.1872121" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.1654648"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.1654648-0
 Parameter: XTRAN <- "-27.1654648"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-58.6698915"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -58.6698915-0
 Parameter: YTRAN <- "-58.6698915"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.1872121"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.1872121-0
 Parameter: ZTRAN <- "-50.1872121"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.1654648"
 Parameter: YTRAN -> "-58.6698915"
 Parameter: ZTRAN -> "-50.1872121"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -27.165465  -58.669891  -50.187212
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.531642318"
Evaluating: 0.531642318*360.0
 Parameter: XPHI <- "191.391234"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.371318153"
Evaluating: 0.371318153*360.0
 Parameter: YPHI <- "133.674535"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.805864231"
Evaluating: 0.805864231*360.0
 Parameter: ZPHI <- "290.111123"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.1654648"
 Parameter: YPOS -> "-58.6698915"
 Parameter: ZPOS -> "-50.1872121"
 Parameter: XPHI -> "191.391234"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.980301   -0.197507
    0.000000    0.197507   -0.980301

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  168.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.1654648"
 Parameter: YPOS -> "-58.6698915"
 Parameter: ZPOS -> "-50.1872121"
 Parameter: YPHI -> "133.674535"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.690561    0.000000   -0.723274
    0.000000    1.000000    0.000000
    0.723274    0.000000   -0.690561

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  133.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.1654648"
 Parameter: YPOS -> "-58.6698915"
 Parameter: ZPOS -> "-50.1872121"
 Parameter: ZPHI -> "290.111123"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.343842   -0.939028    0.000000
    0.939028    0.343842    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   69.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.165465 XMAX =  -27.165465 XAVE =  -27.165465
    YMIN =  -58.669891 YMAX =  -58.669891 YAVE =  -58.669891
    ZMIN =  -50.187212 ZMAX =  -50.187212 ZAVE =  -50.187212
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.1654648"
Evaluating: -27.1654648+3.5
 Parameter: XMAX <- "-23.6654648"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-58.6698915"
Evaluating: -58.6698915+3.5
 Parameter: YMAX <- "-55.1698915"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.1872121"
Evaluating: -50.1872121+3.5
 Parameter: ZMAX <- "-46.6872121"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.1654648"
Evaluating: -27.1654648-3.5
 Parameter: XMIN <- "-30.6654648"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-58.6698915"
Evaluating: -58.6698915-3.5
 Parameter: YMIN <- "-62.1698915"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.1872121"
Evaluating: -50.1872121-3.5
 Parameter: ZMIN <- "-53.6872121"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.6654648"
 Parameter: XMIN -> "-30.6654648"
 Parameter: YMAX -> "-55.1698915"
 Parameter: YMIN -> "-62.1698915"
 Parameter: ZMAX -> "-46.6872121"
 Parameter: ZMIN -> "-53.6872121"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "179"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "179" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "179"
Evaluating: 179
 Parameter: J <- "179"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "179" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "179"
 Parameter: NPOS -> "143"
Evaluating: 179-143
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "7.2410935E-02"
Evaluating: 125.050557*(7.2410935E-02-0.5)
 Parameter: XPOS <- "-53.4702507"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.790607153"
Evaluating: 125.050557*(0.790607153-0.5)
 Parameter: YPOS <- "36.3405864"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.299541749"
Evaluating: 152.572525*(0.299541749-0.5)+-4.51585405
 Parameter: ZPOS <- "-35.1002756"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.1002756" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-53.4702507"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -53.4702507-0
 Parameter: XTRAN <- "-53.4702507"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.3405864"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 36.3405864-0
 Parameter: YTRAN <- "36.3405864"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.1002756"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -35.1002756-0
 Parameter: ZTRAN <- "-35.1002756"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-53.4702507"
 Parameter: YTRAN -> "36.3405864"
 Parameter: ZTRAN -> "-35.1002756"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -53.470251   36.340586  -35.100276
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.414091438E-02"
Evaluating: 3.414091438E-02*360.0
 Parameter: XPHI <- "12.2907292"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.576076651"
Evaluating: 0.576076651*360.0
 Parameter: YPHI <- "207.387594"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.555487802"
Evaluating: 0.555487802*360.0
 Parameter: ZPHI <- "199.975609"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-53.4702507"
 Parameter: YPOS -> "36.3405864"
 Parameter: ZPOS -> "-35.1002756"
 Parameter: XPHI -> "12.2907292"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.977080    0.212872
    0.000000   -0.212872    0.977080

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   12.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-53.4702507"
 Parameter: YPOS -> "36.3405864"
 Parameter: ZPOS -> "-35.1002756"
 Parameter: YPHI -> "207.387594"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.887915    0.000000    0.460008
    0.000000    1.000000    0.000000
   -0.460008    0.000000   -0.887915

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  152.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-53.4702507"
 Parameter: YPOS -> "36.3405864"
 Parameter: ZPOS -> "-35.1002756"
 Parameter: ZPHI -> "199.975609"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.939838   -0.341620    0.000000
    0.341620   -0.939838    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  160.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -53.470251 XMAX =  -53.470251 XAVE =  -53.470251
    YMIN =   36.340586 YMAX =   36.340586 YAVE =   36.340586
    ZMIN =  -35.100276 ZMAX =  -35.100276 ZAVE =  -35.100276
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-53.4702507"
Evaluating: -53.4702507+3.5
 Parameter: XMAX <- "-49.9702507"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.3405864"
Evaluating: 36.3405864+3.5
 Parameter: YMAX <- "39.8405864"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.1002756"
Evaluating: -35.1002756+3.5
 Parameter: ZMAX <- "-31.6002756"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-53.4702507"
Evaluating: -53.4702507-3.5
 Parameter: XMIN <- "-56.9702507"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.3405864"
Evaluating: 36.3405864-3.5
 Parameter: YMIN <- "32.8405864"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.1002756"
Evaluating: -35.1002756-3.5
 Parameter: ZMIN <- "-38.6002756"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-49.9702507"
 Parameter: XMIN -> "-56.9702507"
 Parameter: YMAX -> "39.8405864"
 Parameter: YMIN -> "32.8405864"
 Parameter: ZMAX -> "-31.6002756"
 Parameter: ZMIN -> "-38.6002756"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "180"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "180" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "180"
Evaluating: 180
 Parameter: J <- "180"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "180" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "180"
 Parameter: NPOS -> "143"
Evaluating: 180-143
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.18610049"
Evaluating: 125.050557*(0.18610049-0.5)
 Parameter: XPOS <- "-39.2533086"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.29411946"
Evaluating: 125.050557*(0.29411946-0.5)
 Parameter: YPOS <- "-25.7454762"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.852262054"
Evaluating: 152.572525*(0.852262054-0.5)+-4.51585405
 Parameter: ZPOS <- "49.229657"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.229657" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.229657" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.2533086"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.2533086-0
 Parameter: XTRAN <- "-39.2533086"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.7454762"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.7454762-0
 Parameter: YTRAN <- "-25.7454762"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.229657"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.229657-0
 Parameter: ZTRAN <- "49.229657"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.2533086"
 Parameter: YTRAN -> "-25.7454762"
 Parameter: ZTRAN -> "49.229657"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -39.253309  -25.745476   49.229657
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.110118528"
Evaluating: 0.110118528*360.0
 Parameter: XPHI <- "39.6426701"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.876834049"
Evaluating: 0.876834049*360.0
 Parameter: YPHI <- "315.660258"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.160557091"
Evaluating: 0.160557091*360.0
 Parameter: ZPHI <- "57.8005528"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.2533086"
 Parameter: YPOS -> "-25.7454762"
 Parameter: ZPOS -> "49.229657"
 Parameter: XPHI -> "39.6426701"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.770038    0.637998
    0.000000   -0.637998    0.770038

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   39.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.2533086"
 Parameter: YPOS -> "-25.7454762"
 Parameter: ZPOS -> "49.229657"
 Parameter: YPHI -> "315.660258"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.715208    0.000000    0.698912
    0.000000    1.000000    0.000000
   -0.698912    0.000000    0.715208

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   44.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.2533086"
 Parameter: YPOS -> "-25.7454762"
 Parameter: ZPOS -> "49.229657"
 Parameter: ZPHI -> "57.8005528"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.532868    0.846198    0.000000
   -0.846198    0.532868    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   57.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.253309 XMAX =  -39.253309 XAVE =  -39.253309
    YMIN =  -25.745476 YMAX =  -25.745476 YAVE =  -25.745476
    ZMIN =   49.229657 ZMAX =   49.229657 ZAVE =   49.229657
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.2533086"
Evaluating: -39.2533086+3.5
 Parameter: XMAX <- "-35.7533086"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.7454762"
Evaluating: -25.7454762+3.5
 Parameter: YMAX <- "-22.2454762"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.229657"
Evaluating: 49.229657+3.5
 Parameter: ZMAX <- "52.729657"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.2533086"
Evaluating: -39.2533086-3.5
 Parameter: XMIN <- "-42.7533086"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.7454762"
Evaluating: -25.7454762-3.5
 Parameter: YMIN <- "-29.2454762"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.229657"
Evaluating: 49.229657-3.5
 Parameter: ZMIN <- "45.729657"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.7533086"
 Parameter: XMIN -> "-42.7533086"
 Parameter: YMAX -> "-22.2454762"
 Parameter: YMIN -> "-29.2454762"
 Parameter: ZMAX -> "52.729657"
 Parameter: ZMIN -> "45.729657"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "181"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "181" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "181"
Evaluating: 181
 Parameter: J <- "181"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "181" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "181"
 Parameter: NPOS -> "143"
Evaluating: 181-143
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "2.507787595E-02"
Evaluating: 125.050557*(2.507787595E-02-0.5)
 Parameter: XPOS <- "-59.3892761"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.894466185"
Evaluating: 125.050557*(0.894466185-0.5)
 Parameter: YPOS <- "49.3282162"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.566104132"
Evaluating: 152.572525*(0.566104132-0.5)+-4.51585405
 Parameter: ZPOS <- "5.56982028"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.56982028" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.56982028" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "181"
Evaluating: 181
 Parameter: J <- "181"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "181" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "181"
 Parameter: NPOS -> "143"
Evaluating: 181-143
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.957043883"
Evaluating: 125.050557*(0.957043883-0.5)
 Parameter: XPOS <- "57.1535921"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.488148384"
Evaluating: 125.050557*(0.488148384-0.5)
 Parameter: YPOS <- "-1.48205118"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.688821992"
Evaluating: 152.572525*(0.688821992-0.5)+-4.51585405
 Parameter: ZPOS <- "24.293194"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.293194" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.293194" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "57.1535921"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 57.1535921-0
 Parameter: XTRAN <- "57.1535921"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.48205118"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.48205118-0
 Parameter: YTRAN <- "-1.48205118"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.293194"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.293194-0
 Parameter: ZTRAN <- "24.293194"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "57.1535921"
 Parameter: YTRAN -> "-1.48205118"
 Parameter: ZTRAN -> "24.293194"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    57.153592   -1.482051   24.293194
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.990239032"
Evaluating: 0.990239032*360.0
 Parameter: XPHI <- "356.486052"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.932460229"
Evaluating: 0.932460229*360.0
 Parameter: YPHI <- "335.685682"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.970303688"
Evaluating: 0.970303688*360.0
 Parameter: ZPHI <- "349.309328"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "57.1535921"
 Parameter: YPOS -> "-1.48205118"
 Parameter: ZPOS -> "24.293194"
 Parameter: XPHI -> "356.486052"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998120   -0.061292
    0.000000    0.061292    0.998120

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    3.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "57.1535921"
 Parameter: YPOS -> "-1.48205118"
 Parameter: ZPOS -> "24.293194"
 Parameter: YPHI -> "335.685682"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.911300    0.000000    0.411742
    0.000000    1.000000    0.000000
   -0.411742    0.000000    0.911300

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   24.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "57.1535921"
 Parameter: YPOS -> "-1.48205118"
 Parameter: ZPOS -> "24.293194"
 Parameter: ZPHI -> "349.309328"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.982643   -0.185507    0.000000
    0.185507    0.982643    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   10.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   57.153592 XMAX =   57.153592 XAVE =   57.153592
    YMIN =   -1.482051 YMAX =   -1.482051 YAVE =   -1.482051
    ZMIN =   24.293194 ZMAX =   24.293194 ZAVE =   24.293194
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "57.1535921"
Evaluating: 57.1535921+3.5
 Parameter: XMAX <- "60.6535921"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.48205118"
Evaluating: -1.48205118+3.5
 Parameter: YMAX <- "2.01794882"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.293194"
Evaluating: 24.293194+3.5
 Parameter: ZMAX <- "27.793194"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "57.1535921"
Evaluating: 57.1535921-3.5
 Parameter: XMIN <- "53.6535921"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.48205118"
Evaluating: -1.48205118-3.5
 Parameter: YMIN <- "-4.98205118"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.293194"
Evaluating: 24.293194-3.5
 Parameter: ZMIN <- "20.793194"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "60.6535921"
 Parameter: XMIN -> "53.6535921"
 Parameter: YMAX -> "2.01794882"
 Parameter: YMIN -> "-4.98205118"
 Parameter: ZMAX -> "27.793194"
 Parameter: ZMIN -> "20.793194"
 SELRPN>     12 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      3 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64596 NEG      CLA      38       CLA     -**** MEMB     POPC     38       N             3.5476
64596 NEG      CLA      38       CLA     -**** MEMB     POPC     38       C14           2.3389
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "181"
Evaluating: 181
 Parameter: J <- "181"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "181" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "181"
 Parameter: NPOS -> "143"
Evaluating: 181-143
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.913896478"
Evaluating: 125.050557*(0.913896478-0.5)
 Parameter: XPOS <- "51.7579851"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.443741502"
Evaluating: 125.050557*(0.443741502-0.5)
 Parameter: YPOS <- "-7.03515651"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.371524765"
Evaluating: 152.572525*(0.371524765-0.5)+-4.51585405
 Parameter: ZPOS <- "-24.1176451"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.1176451" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   57.153592 XMAX =   57.153592 XAVE =   57.153592
    YMIN =   -1.482051 YMAX =   -1.482051 YAVE =   -1.482051
    ZMIN =   24.293194 ZMAX =   24.293194 ZAVE =   24.293194
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.7579851"
 RDCMND substituted energy or value "?XAVE" to "57.1535921"
Evaluating: 51.7579851-57.1535921
 Parameter: XTRAN <- "-5.395607"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.03515651"
 RDCMND substituted energy or value "?YAVE" to "-1.48205118"
Evaluating: -7.03515651--1.48205118
 Parameter: YTRAN <- "-5.55310533"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.1176451"
 RDCMND substituted energy or value "?ZAVE" to "24.293194"
Evaluating: -24.1176451-24.293194
 Parameter: ZTRAN <- "-48.4108391"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.395607"
 Parameter: YTRAN -> "-5.55310533"
 Parameter: ZTRAN -> "-48.4108391"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -5.395607   -5.553105  -48.410839
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.649098783"
Evaluating: 0.649098783*360.0
 Parameter: XPHI <- "233.675562"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.428515991"
Evaluating: 0.428515991*360.0
 Parameter: YPHI <- "154.265757"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720553032"
Evaluating: 0.720553032*360.0
 Parameter: ZPHI <- "259.399092"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.7579851"
 Parameter: YPOS -> "-7.03515651"
 Parameter: ZPOS -> "-24.1176451"
 Parameter: XPHI -> "233.675562"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.592357   -0.805676
    0.000000    0.805676   -0.592357

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  126.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.7579851"
 Parameter: YPOS -> "-7.03515651"
 Parameter: ZPOS -> "-24.1176451"
 Parameter: YPHI -> "154.265757"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.900818    0.000000   -0.434198
    0.000000    1.000000    0.000000
    0.434198    0.000000   -0.900818

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  154.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.7579851"
 Parameter: YPOS -> "-7.03515651"
 Parameter: ZPOS -> "-24.1176451"
 Parameter: ZPHI -> "259.399092"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.183967   -0.982932    0.000000
    0.982932   -0.183967    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  100.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.757985 XMAX =   51.757985 XAVE =   51.757985
    YMIN =   -7.035157 YMAX =   -7.035157 YAVE =   -7.035157
    ZMIN =  -24.117645 ZMAX =  -24.117645 ZAVE =  -24.117645
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.7579851"
Evaluating: 51.7579851+3.5
 Parameter: XMAX <- "55.2579851"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.03515651"
Evaluating: -7.03515651+3.5
 Parameter: YMAX <- "-3.53515651"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.1176451"
Evaluating: -24.1176451+3.5
 Parameter: ZMAX <- "-20.6176451"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.7579851"
Evaluating: 51.7579851-3.5
 Parameter: XMIN <- "48.2579851"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.03515651"
Evaluating: -7.03515651-3.5
 Parameter: YMIN <- "-10.5351565"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.1176451"
Evaluating: -24.1176451-3.5
 Parameter: ZMIN <- "-27.6176451"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.2579851"
 Parameter: XMIN -> "48.2579851"
 Parameter: YMAX -> "-3.53515651"
 Parameter: YMIN -> "-10.5351565"
 Parameter: ZMAX -> "-20.6176451"
 Parameter: ZMIN -> "-27.6176451"
 SELRPN>      7 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64596 NEG      CLA      38       CLA     -**** PROA     TYR      1109     CE2           4.4727
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "181"
Evaluating: 181
 Parameter: J <- "181"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "181" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "181"
 Parameter: NPOS -> "143"
Evaluating: 181-143
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.941328655"
Evaluating: 125.050557*(0.941328655-0.5)
 Parameter: XPOS <- "55.1883941"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.305750054"
Evaluating: 125.050557*(0.305750054-0.5)
 Parameter: YPOS <- "-24.2910639"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.209901501"
Evaluating: 152.572525*(0.209901501-0.5)+-4.51585405
 Parameter: ZPOS <- "-48.7769145"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.7769145" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.757985 XMAX =   51.757985 XAVE =   51.757985
    YMIN =   -7.035157 YMAX =   -7.035157 YAVE =   -7.035157
    ZMIN =  -24.117645 ZMAX =  -24.117645 ZAVE =  -24.117645
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "55.1883941"
 RDCMND substituted energy or value "?XAVE" to "51.7579851"
Evaluating: 55.1883941-51.7579851
 Parameter: XTRAN <- "3.430409"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.2910639"
 RDCMND substituted energy or value "?YAVE" to "-7.03515651"
Evaluating: -24.2910639--7.03515651
 Parameter: YTRAN <- "-17.2559074"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.7769145"
 RDCMND substituted energy or value "?ZAVE" to "-24.1176451"
Evaluating: -48.7769145--24.1176451
 Parameter: ZTRAN <- "-24.6592694"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.430409"
 Parameter: YTRAN -> "-17.2559074"
 Parameter: ZTRAN -> "-24.6592694"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     3.430409  -17.255907  -24.659269
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.800549749"
Evaluating: 0.800549749*360.0
 Parameter: XPHI <- "288.19791"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.302265796"
Evaluating: 0.302265796*360.0
 Parameter: YPHI <- "108.815687"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.647050108"
Evaluating: 0.647050108*360.0
 Parameter: ZPHI <- "232.938039"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "55.1883941"
 Parameter: YPOS -> "-24.2910639"
 Parameter: ZPOS -> "-48.7769145"
 Parameter: XPHI -> "288.19791"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.312300   -0.949983
    0.000000    0.949983    0.312300

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   71.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "55.1883941"
 Parameter: YPOS -> "-24.2910639"
 Parameter: ZPOS -> "-48.7769145"
 Parameter: YPHI -> "108.815687"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.322525    0.000000   -0.946561
    0.000000    1.000000    0.000000
    0.946561    0.000000   -0.322525

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  108.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "55.1883941"
 Parameter: YPOS -> "-24.2910639"
 Parameter: ZPOS -> "-48.7769145"
 Parameter: ZPHI -> "232.938039"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.602678   -0.797984    0.000000
    0.797984   -0.602678    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  127.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   55.188394 XMAX =   55.188394 XAVE =   55.188394
    YMIN =  -24.291064 YMAX =  -24.291064 YAVE =  -24.291064
    ZMIN =  -48.776914 ZMAX =  -48.776914 ZAVE =  -48.776914
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "55.1883941"
Evaluating: 55.1883941+3.5
 Parameter: XMAX <- "58.6883941"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.2910639"
Evaluating: -24.2910639+3.5
 Parameter: YMAX <- "-20.7910639"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.7769145"
Evaluating: -48.7769145+3.5
 Parameter: ZMAX <- "-45.2769145"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "55.1883941"
Evaluating: 55.1883941-3.5
 Parameter: XMIN <- "51.6883941"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.2910639"
Evaluating: -24.2910639-3.5
 Parameter: YMIN <- "-27.7910639"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.7769145"
Evaluating: -48.7769145-3.5
 Parameter: ZMIN <- "-52.2769145"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "58.6883941"
 Parameter: XMIN -> "51.6883941"
 Parameter: YMAX -> "-20.7910639"
 Parameter: YMIN -> "-27.7910639"
 Parameter: ZMAX -> "-45.2769145"
 Parameter: ZMIN -> "-52.2769145"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "182"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "182" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "182"
Evaluating: 182
 Parameter: J <- "182"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "182" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "182"
 Parameter: NPOS -> "143"
Evaluating: 182-143
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.862802143"
Evaluating: 125.050557*(0.862802143-0.5)
 Parameter: XPOS <- "45.3686101"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.266032758"
Evaluating: 125.050557*(0.266032758-0.5)
 Parameter: YPOS <- "-29.2577339"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.287210535"
Evaluating: 152.572525*(0.287210535-0.5)+-4.51585405
 Parameter: ZPOS <- "-36.98168"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.98168" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.3686101"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.3686101-0
 Parameter: XTRAN <- "45.3686101"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.2577339"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.2577339-0
 Parameter: YTRAN <- "-29.2577339"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.98168"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.98168-0
 Parameter: ZTRAN <- "-36.98168"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.3686101"
 Parameter: YTRAN -> "-29.2577339"
 Parameter: ZTRAN -> "-36.98168"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    45.368610  -29.257734  -36.981680
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.110091163"
Evaluating: 0.110091163*360.0
 Parameter: XPHI <- "39.6328187"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491504554"
Evaluating: 0.491504554*360.0
 Parameter: YPHI <- "176.941639"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.598850478"
Evaluating: 0.598850478*360.0
 Parameter: ZPHI <- "215.586172"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.3686101"
 Parameter: YPOS -> "-29.2577339"
 Parameter: ZPOS -> "-36.98168"
 Parameter: XPHI -> "39.6328187"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.770148    0.637865
    0.000000   -0.637865    0.770148

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   39.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.3686101"
 Parameter: YPOS -> "-29.2577339"
 Parameter: ZPOS -> "-36.98168"
 Parameter: YPHI -> "176.941639"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.998576    0.000000   -0.053353
    0.000000    1.000000    0.000000
    0.053353    0.000000   -0.998576

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  176.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.3686101"
 Parameter: YPOS -> "-29.2577339"
 Parameter: ZPOS -> "-36.98168"
 Parameter: ZPHI -> "215.586172"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.813241   -0.581927    0.000000
    0.581927   -0.813241    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  144.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.368610 XMAX =   45.368610 XAVE =   45.368610
    YMIN =  -29.257734 YMAX =  -29.257734 YAVE =  -29.257734
    ZMIN =  -36.981680 ZMAX =  -36.981680 ZAVE =  -36.981680
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.3686101"
Evaluating: 45.3686101+3.5
 Parameter: XMAX <- "48.8686101"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.2577339"
Evaluating: -29.2577339+3.5
 Parameter: YMAX <- "-25.7577339"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.98168"
Evaluating: -36.98168+3.5
 Parameter: ZMAX <- "-33.48168"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.3686101"
Evaluating: 45.3686101-3.5
 Parameter: XMIN <- "41.8686101"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.2577339"
Evaluating: -29.2577339-3.5
 Parameter: YMIN <- "-32.7577339"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.98168"
Evaluating: -36.98168-3.5
 Parameter: ZMIN <- "-40.48168"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "48.8686101"
 Parameter: XMIN -> "41.8686101"
 Parameter: YMAX -> "-25.7577339"
 Parameter: YMIN -> "-32.7577339"
 Parameter: ZMAX -> "-33.48168"
 Parameter: ZMIN -> "-40.48168"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "183"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "183" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "183"
Evaluating: 183
 Parameter: J <- "183"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "183" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "183"
 Parameter: NPOS -> "143"
Evaluating: 183-143
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.576965656"
Evaluating: 125.050557*(0.576965656-0.5)
 Parameter: XPOS <- "9.62459815"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.975036401"
Evaluating: 125.050557*(0.975036401-0.5)
 Parameter: YPOS <- "59.4035665"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.485240177"
Evaluating: 152.572525*(0.485240177-0.5)+-4.51585405
 Parameter: ZPOS <- "-6.76779751"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.76779751" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.76779751" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "183"
Evaluating: 183
 Parameter: J <- "183"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "183" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "183"
 Parameter: NPOS -> "143"
Evaluating: 183-143
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.798722141E-03"
Evaluating: 125.050557*(1.798722141E-03-0.5)
 Parameter: XPOS <- "-62.3003473"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.443196603"
Evaluating: 125.050557*(0.443196603-0.5)
 Parameter: YPOS <- "-7.10329643"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.35496509"
Evaluating: 152.572525*(0.35496509-0.5)+-4.51585405
 Parameter: ZPOS <- "-26.6441965"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.6441965" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-62.3003473"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -62.3003473-0
 Parameter: XTRAN <- "-62.3003473"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.10329643"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.10329643-0
 Parameter: YTRAN <- "-7.10329643"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.6441965"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.6441965-0
 Parameter: ZTRAN <- "-26.6441965"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.3003473"
 Parameter: YTRAN -> "-7.10329643"
 Parameter: ZTRAN -> "-26.6441965"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -62.300347   -7.103296  -26.644196
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.525981319"
Evaluating: 0.525981319*360.0
 Parameter: XPHI <- "189.353275"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.202304935"
Evaluating: 0.202304935*360.0
 Parameter: YPHI <- "72.8297766"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.418783019"
Evaluating: 0.418783019*360.0
 Parameter: ZPHI <- "150.761887"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-62.3003473"
 Parameter: YPOS -> "-7.10329643"
 Parameter: ZPOS -> "-26.6441965"
 Parameter: XPHI -> "189.353275"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.986705   -0.162521
    0.000000    0.162521   -0.986705

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  170.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-62.3003473"
 Parameter: YPOS -> "-7.10329643"
 Parameter: ZPOS -> "-26.6441965"
 Parameter: YPHI -> "72.8297766"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.295212    0.000000   -0.955432
    0.000000    1.000000    0.000000
    0.955432    0.000000    0.295212

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   72.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-62.3003473"
 Parameter: YPOS -> "-7.10329643"
 Parameter: ZPOS -> "-26.6441965"
 Parameter: ZPHI -> "150.761887"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.872597    0.488440    0.000000
   -0.488440   -0.872597    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  150.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -62.300347 XMAX =  -62.300347 XAVE =  -62.300347
    YMIN =   -7.103296 YMAX =   -7.103296 YAVE =   -7.103296
    ZMIN =  -26.644196 ZMAX =  -26.644196 ZAVE =  -26.644196
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-62.3003473"
Evaluating: -62.3003473+3.5
 Parameter: XMAX <- "-58.8003473"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.10329643"
Evaluating: -7.10329643+3.5
 Parameter: YMAX <- "-3.60329643"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.6441965"
Evaluating: -26.6441965+3.5
 Parameter: ZMAX <- "-23.1441965"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-62.3003473"
Evaluating: -62.3003473-3.5
 Parameter: XMIN <- "-65.8003473"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.10329643"
Evaluating: -7.10329643-3.5
 Parameter: YMIN <- "-10.6032964"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.6441965"
Evaluating: -26.6441965-3.5
 Parameter: ZMIN <- "-30.1441965"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-58.8003473"
 Parameter: XMIN -> "-65.8003473"
 Parameter: YMAX -> "-3.60329643"
 Parameter: YMIN -> "-10.6032964"
 Parameter: ZMAX -> "-23.1441965"
 Parameter: ZMIN -> "-30.1441965"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "184"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "184" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "184"
Evaluating: 184
 Parameter: J <- "184"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "184" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "184"
 Parameter: NPOS -> "143"
Evaluating: 184-143
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.890665833"
Evaluating: 125.050557*(0.890665833-0.5)
 Parameter: XPOS <- "48.85298"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.878335009"
Evaluating: 125.050557*(0.878335009-0.5)
 Parameter: YPOS <- "47.3110036"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.362877069"
Evaluating: 152.572525*(0.362877069-0.5)+-4.51585405
 Parameter: ZPOS <- "-25.4370459"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.4370459" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "48.85298"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 48.85298-0
 Parameter: XTRAN <- "48.85298"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "47.3110036"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 47.3110036-0
 Parameter: YTRAN <- "47.3110036"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.4370459"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.4370459-0
 Parameter: ZTRAN <- "-25.4370459"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "48.85298"
 Parameter: YTRAN -> "47.3110036"
 Parameter: ZTRAN -> "-25.4370459"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    48.852980   47.311004  -25.437046
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.358896807"
Evaluating: 0.358896807*360.0
 Parameter: XPHI <- "129.202851"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.804209223"
Evaluating: 0.804209223*360.0
 Parameter: YPHI <- "289.51532"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.374531613"
Evaluating: 0.374531613*360.0
 Parameter: ZPHI <- "134.831381"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "48.85298"
 Parameter: YPOS -> "47.3110036"
 Parameter: ZPOS -> "-25.4370459"
 Parameter: XPHI -> "129.202851"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.632068    0.774913
    0.000000   -0.774913   -0.632068

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  129.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "48.85298"
 Parameter: YPOS -> "47.3110036"
 Parameter: ZPOS -> "-25.4370459"
 Parameter: YPHI -> "289.51532"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.334059    0.000000    0.942552
    0.000000    1.000000    0.000000
   -0.942552    0.000000    0.334059

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   70.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "48.85298"
 Parameter: YPOS -> "47.3110036"
 Parameter: ZPOS -> "-25.4370459"
 Parameter: ZPHI -> "134.831381"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.705023    0.709185    0.000000
   -0.709185   -0.705023    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  134.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   48.852980 XMAX =   48.852980 XAVE =   48.852980
    YMIN =   47.311004 YMAX =   47.311004 YAVE =   47.311004
    ZMIN =  -25.437046 ZMAX =  -25.437046 ZAVE =  -25.437046
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "48.85298"
Evaluating: 48.85298+3.5
 Parameter: XMAX <- "52.35298"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "47.3110036"
Evaluating: 47.3110036+3.5
 Parameter: YMAX <- "50.8110036"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.4370459"
Evaluating: -25.4370459+3.5
 Parameter: ZMAX <- "-21.9370459"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "48.85298"
Evaluating: 48.85298-3.5
 Parameter: XMIN <- "45.35298"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "47.3110036"
Evaluating: 47.3110036-3.5
 Parameter: YMIN <- "43.8110036"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.4370459"
Evaluating: -25.4370459-3.5
 Parameter: ZMIN <- "-28.9370459"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.35298"
 Parameter: XMIN -> "45.35298"
 Parameter: YMAX -> "50.8110036"
 Parameter: YMIN -> "43.8110036"
 Parameter: ZMAX -> "-21.9370459"
 Parameter: ZMIN -> "-28.9370459"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "185"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "185" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "185"
Evaluating: 185
 Parameter: J <- "185"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "185" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "185"
 Parameter: NPOS -> "143"
Evaluating: 185-143
 Parameter: J <- "42"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "4.869532229E-02"
Evaluating: 125.050557*(4.869532229E-02-0.5)
 Parameter: XPOS <- "-56.4359013"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.235732754"
Evaluating: 125.050557*(0.235732754-0.5)
 Parameter: YPOS <- "-33.0467663"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "4.239509248E-03"
Evaluating: 152.572525*(4.239509248E-03-0.5)+-4.51585405
 Parameter: ZPOS <- "-80.1552839"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-80.1552839" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-56.4359013"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -56.4359013-0
 Parameter: XTRAN <- "-56.4359013"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.0467663"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.0467663-0
 Parameter: YTRAN <- "-33.0467663"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-80.1552839"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -80.1552839-0
 Parameter: ZTRAN <- "-80.1552839"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-56.4359013"
 Parameter: YTRAN -> "-33.0467663"
 Parameter: ZTRAN -> "-80.1552839"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -56.435901  -33.046766  -80.155284
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.481329078"
Evaluating: 0.481329078*360.0
 Parameter: XPHI <- "173.278468"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.277652186"
Evaluating: 0.277652186*360.0
 Parameter: YPHI <- "99.954787"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.392815468"
Evaluating: 0.392815468*360.0
 Parameter: ZPHI <- "141.413568"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-56.4359013"
 Parameter: YPOS -> "-33.0467663"
 Parameter: ZPOS -> "-80.1552839"
 Parameter: XPHI -> "173.278468"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.993127    0.117044
    0.000000   -0.117044   -0.993127

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  173.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-56.4359013"
 Parameter: YPOS -> "-33.0467663"
 Parameter: ZPOS -> "-80.1552839"
 Parameter: YPHI -> "99.954787"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.172871    0.000000   -0.984944
    0.000000    1.000000    0.000000
    0.984944    0.000000   -0.172871

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   99.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-56.4359013"
 Parameter: YPOS -> "-33.0467663"
 Parameter: ZPOS -> "-80.1552839"
 Parameter: ZPHI -> "141.413568"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.781668    0.623695    0.000000
   -0.623695   -0.781668    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  141.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -56.435901 XMAX =  -56.435901 XAVE =  -56.435901
    YMIN =  -33.046766 YMAX =  -33.046766 YAVE =  -33.046766
    ZMIN =  -80.155284 ZMAX =  -80.155284 ZAVE =  -80.155284
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-56.4359013"
Evaluating: -56.4359013+3.5
 Parameter: XMAX <- "-52.9359013"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.0467663"
Evaluating: -33.0467663+3.5
 Parameter: YMAX <- "-29.5467663"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-80.1552839"
Evaluating: -80.1552839+3.5
 Parameter: ZMAX <- "-76.6552839"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-56.4359013"
Evaluating: -56.4359013-3.5
 Parameter: XMIN <- "-59.9359013"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.0467663"
Evaluating: -33.0467663-3.5
 Parameter: YMIN <- "-36.5467663"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-80.1552839"
Evaluating: -80.1552839-3.5
 Parameter: ZMIN <- "-83.6552839"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-52.9359013"
 Parameter: XMIN -> "-59.9359013"
 Parameter: YMAX -> "-29.5467663"
 Parameter: YMIN -> "-36.5467663"
 Parameter: ZMAX -> "-76.6552839"
 Parameter: ZMIN -> "-83.6552839"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "186"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "186" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "186"
Evaluating: 186
 Parameter: J <- "186"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "186" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "186"
 Parameter: NPOS -> "143"
Evaluating: 186-143
 Parameter: J <- "43"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.263153891"
Evaluating: 125.050557*(0.263153891-0.5)
 Parameter: XPOS <- "-29.6177379"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.282446308"
Evaluating: 125.050557*(0.282446308-0.5)
 Parameter: YPOS <- "-27.2052104"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.510454228"
Evaluating: 152.572525*(0.510454228-0.5)+-4.51585405
 Parameter: ZPOS <- "-2.92082609"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.92082609" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.92082609" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "186"
Evaluating: 186
 Parameter: J <- "186"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "186" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "186"
 Parameter: NPOS -> "143"
Evaluating: 186-143
 Parameter: J <- "43"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.839359898"
Evaluating: 125.050557*(0.839359898-0.5)
 Parameter: XPOS <- "42.4371443"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.585181777"
Evaluating: 125.050557*(0.585181777-0.5)
 Parameter: YPOS <- "10.6520287"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "8.287116536E-02"
Evaluating: 152.572525*(8.287116536E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-68.1582536"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-68.1582536" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.4371443"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 42.4371443-0
 Parameter: XTRAN <- "42.4371443"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.6520287"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.6520287-0
 Parameter: YTRAN <- "10.6520287"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-68.1582536"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -68.1582536-0
 Parameter: ZTRAN <- "-68.1582536"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.4371443"
 Parameter: YTRAN -> "10.6520287"
 Parameter: ZTRAN -> "-68.1582536"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    42.437144   10.652029  -68.158254
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.710104367"
Evaluating: 0.710104367*360.0
 Parameter: XPHI <- "255.637572"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.244288102E-03"
Evaluating: 2.244288102E-03*360.0
 Parameter: YPHI <- "0.807943717"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.869161056"
Evaluating: 0.869161056*360.0
 Parameter: ZPHI <- "312.89798"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.4371443"
 Parameter: YPOS -> "10.6520287"
 Parameter: ZPOS -> "-68.1582536"
 Parameter: XPHI -> "255.637572"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.248055   -0.968746
    0.000000    0.968746   -0.248055

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  104.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.4371443"
 Parameter: YPOS -> "10.6520287"
 Parameter: ZPOS -> "-68.1582536"
 Parameter: YPHI -> "0.807943717"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999901    0.000000   -0.014101
    0.000000    1.000000    0.000000
    0.014101    0.000000    0.999901

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    0.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.4371443"
 Parameter: YPOS -> "10.6520287"
 Parameter: ZPOS -> "-68.1582536"
 Parameter: ZPHI -> "312.89798"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.680695   -0.732567    0.000000
    0.732567    0.680695    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.437144 XMAX =   42.437144 XAVE =   42.437144
    YMIN =   10.652029 YMAX =   10.652029 YAVE =   10.652029
    ZMIN =  -68.158254 ZMAX =  -68.158254 ZAVE =  -68.158254
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.4371443"
Evaluating: 42.4371443+3.5
 Parameter: XMAX <- "45.9371443"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.6520287"
Evaluating: 10.6520287+3.5
 Parameter: YMAX <- "14.1520287"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-68.1582536"
Evaluating: -68.1582536+3.5
 Parameter: ZMAX <- "-64.6582536"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.4371443"
Evaluating: 42.4371443-3.5
 Parameter: XMIN <- "38.9371443"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.6520287"
Evaluating: 10.6520287-3.5
 Parameter: YMIN <- "7.1520287"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-68.1582536"
Evaluating: -68.1582536-3.5
 Parameter: ZMIN <- "-71.6582536"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.9371443"
 Parameter: XMIN -> "38.9371443"
 Parameter: YMAX -> "14.1520287"
 Parameter: YMIN -> "7.1520287"
 Parameter: ZMAX -> "-64.6582536"
 Parameter: ZMIN -> "-71.6582536"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "187"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "187" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "187"
Evaluating: 187
 Parameter: J <- "187"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "187" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "187"
 Parameter: NPOS -> "143"
Evaluating: 187-143
 Parameter: J <- "44"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.760982992"
Evaluating: 125.050557*(0.760982992-0.5)
 Parameter: XPOS <- "32.6360685"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.62150957"
Evaluating: 125.050557*(0.62150957-0.5)
 Parameter: YPOS <- "15.1948394"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "1.772891015E-02"
Evaluating: 152.572525*(1.772891015E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-78.097172"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-78.097172" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.6360685"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.6360685-0
 Parameter: XTRAN <- "32.6360685"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.1948394"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.1948394-0
 Parameter: YTRAN <- "15.1948394"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-78.097172"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -78.097172-0
 Parameter: ZTRAN <- "-78.097172"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.6360685"
 Parameter: YTRAN -> "15.1948394"
 Parameter: ZTRAN -> "-78.097172"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    32.636069   15.194839  -78.097172
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.567271437"
Evaluating: 0.567271437*360.0
 Parameter: XPHI <- "204.217717"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.324408088"
Evaluating: 0.324408088*360.0
 Parameter: YPHI <- "116.786912"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.467336499"
Evaluating: 0.467336499*360.0
 Parameter: ZPHI <- "168.24114"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.6360685"
 Parameter: YPOS -> "15.1948394"
 Parameter: ZPOS -> "-78.097172"
 Parameter: XPHI -> "204.217717"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.911993   -0.410205
    0.000000    0.410205   -0.911993

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  155.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.6360685"
 Parameter: YPOS -> "15.1948394"
 Parameter: ZPOS -> "-78.097172"
 Parameter: YPHI -> "116.786912"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.450674    0.000000   -0.892689
    0.000000    1.000000    0.000000
    0.892689    0.000000   -0.450674

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  116.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.6360685"
 Parameter: YPOS -> "15.1948394"
 Parameter: ZPOS -> "-78.097172"
 Parameter: ZPHI -> "168.24114"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.979014    0.203793    0.000000
   -0.203793   -0.979014    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  168.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.636069 XMAX =   32.636069 XAVE =   32.636069
    YMIN =   15.194839 YMAX =   15.194839 YAVE =   15.194839
    ZMIN =  -78.097172 ZMAX =  -78.097172 ZAVE =  -78.097172
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.6360685"
Evaluating: 32.6360685+3.5
 Parameter: XMAX <- "36.1360685"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.1948394"
Evaluating: 15.1948394+3.5
 Parameter: YMAX <- "18.6948394"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-78.097172"
Evaluating: -78.097172+3.5
 Parameter: ZMAX <- "-74.597172"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.6360685"
Evaluating: 32.6360685-3.5
 Parameter: XMIN <- "29.1360685"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.1948394"
Evaluating: 15.1948394-3.5
 Parameter: YMIN <- "11.6948394"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-78.097172"
Evaluating: -78.097172-3.5
 Parameter: ZMIN <- "-81.597172"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.1360685"
 Parameter: XMIN -> "29.1360685"
 Parameter: YMAX -> "18.6948394"
 Parameter: YMIN -> "11.6948394"
 Parameter: ZMAX -> "-74.597172"
 Parameter: ZMIN -> "-81.597172"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "188"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "188" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "188"
Evaluating: 188
 Parameter: J <- "188"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "188" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "188"
 Parameter: NPOS -> "143"
Evaluating: 188-143
 Parameter: J <- "45"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.966568154"
Evaluating: 125.050557*(0.966568154-0.5)
 Parameter: XPOS <- "58.3446075"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.388188369"
Evaluating: 125.050557*(0.388188369-0.5)
 Parameter: YPOS <- "-13.9821067"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.956603793"
Evaluating: 152.572525*(0.956603793-0.5)+-4.51585405
 Parameter: ZPOS <- "65.1493396"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "65.1493396" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "65.1493396" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "58.3446075"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 58.3446075-0
 Parameter: XTRAN <- "58.3446075"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.9821067"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.9821067-0
 Parameter: YTRAN <- "-13.9821067"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "65.1493396"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 65.1493396-0
 Parameter: ZTRAN <- "65.1493396"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "58.3446075"
 Parameter: YTRAN -> "-13.9821067"
 Parameter: ZTRAN -> "65.1493396"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    58.344608  -13.982107   65.149340
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.09097025E-02"
Evaluating: 2.09097025E-02*360.0
 Parameter: XPHI <- "7.5274929"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.305258699"
Evaluating: 0.305258699*360.0
 Parameter: YPHI <- "109.893132"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.54545255"
Evaluating: 0.54545255*360.0
 Parameter: ZPHI <- "196.362918"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "58.3446075"
 Parameter: YPOS -> "-13.9821067"
 Parameter: ZPOS -> "65.1493396"
 Parameter: XPHI -> "7.5274929"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.991382    0.131002
    0.000000   -0.131002    0.991382

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    7.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "58.3446075"
 Parameter: YPOS -> "-13.9821067"
 Parameter: ZPOS -> "65.1493396"
 Parameter: YPHI -> "109.893132"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.340267    0.000000   -0.940329
    0.000000    1.000000    0.000000
    0.940329    0.000000   -0.340267

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  109.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "58.3446075"
 Parameter: YPOS -> "-13.9821067"
 Parameter: ZPOS -> "65.1493396"
 Parameter: ZPHI -> "196.362918"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.959497   -0.281721    0.000000
    0.281721   -0.959497    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  163.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.344608 XMAX =   58.344608 XAVE =   58.344608
    YMIN =  -13.982107 YMAX =  -13.982107 YAVE =  -13.982107
    ZMIN =   65.149340 ZMAX =   65.149340 ZAVE =   65.149340
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "58.3446075"
Evaluating: 58.3446075+3.5
 Parameter: XMAX <- "61.8446075"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.9821067"
Evaluating: -13.9821067+3.5
 Parameter: YMAX <- "-10.4821067"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "65.1493396"
Evaluating: 65.1493396+3.5
 Parameter: ZMAX <- "68.6493396"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "58.3446075"
Evaluating: 58.3446075-3.5
 Parameter: XMIN <- "54.8446075"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.9821067"
Evaluating: -13.9821067-3.5
 Parameter: YMIN <- "-17.4821067"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "65.1493396"
Evaluating: 65.1493396-3.5
 Parameter: ZMIN <- "61.6493396"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "61.8446075"
 Parameter: XMIN -> "54.8446075"
 Parameter: YMAX -> "-10.4821067"
 Parameter: YMIN -> "-17.4821067"
 Parameter: ZMAX -> "68.6493396"
 Parameter: ZMIN -> "61.6493396"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "189"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "189" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "189"
Evaluating: 189
 Parameter: J <- "189"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "189" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "189"
 Parameter: NPOS -> "143"
Evaluating: 189-143
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.598587246"
Evaluating: 125.050557*(0.598587246-0.5)
 Parameter: XPOS <- "12.32839"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "2.124568724E-02"
Evaluating: 125.050557*(2.124568724E-02-0.5)
 Parameter: YPOS <- "-59.8684935"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.315832169"
Evaluating: 152.572525*(0.315832169-0.5)+-4.51585405
 Parameter: ZPOS <- "-32.614805"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.614805" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.32839"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.32839-0
 Parameter: XTRAN <- "12.32839"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-59.8684935"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -59.8684935-0
 Parameter: YTRAN <- "-59.8684935"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.614805"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.614805-0
 Parameter: ZTRAN <- "-32.614805"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.32839"
 Parameter: YTRAN -> "-59.8684935"
 Parameter: ZTRAN -> "-32.614805"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    12.328390  -59.868493  -32.614805
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678338833"
Evaluating: 0.678338833*360.0
 Parameter: XPHI <- "244.20198"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.574607936"
Evaluating: 0.574607936*360.0
 Parameter: YPHI <- "206.858857"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.878895203"
Evaluating: 0.878895203*360.0
 Parameter: ZPHI <- "316.402273"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.32839"
 Parameter: YPOS -> "-59.8684935"
 Parameter: ZPOS -> "-32.614805"
 Parameter: XPHI -> "244.20198"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.435200   -0.900334
    0.000000    0.900334   -0.435200

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.32839"
 Parameter: YPOS -> "-59.8684935"
 Parameter: ZPOS -> "-32.614805"
 Parameter: YPHI -> "206.858857"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.892122    0.000000    0.451794
    0.000000    1.000000    0.000000
   -0.451794    0.000000   -0.892122

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  153.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.32839"
 Parameter: YPOS -> "-59.8684935"
 Parameter: ZPOS -> "-32.614805"
 Parameter: ZPHI -> "316.402273"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.724199   -0.689591    0.000000
    0.689591    0.724199    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   43.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.328390 XMAX =   12.328390 XAVE =   12.328390
    YMIN =  -59.868493 YMAX =  -59.868493 YAVE =  -59.868493
    ZMIN =  -32.614805 ZMAX =  -32.614805 ZAVE =  -32.614805
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.32839"
Evaluating: 12.32839+3.5
 Parameter: XMAX <- "15.82839"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-59.8684935"
Evaluating: -59.8684935+3.5
 Parameter: YMAX <- "-56.3684935"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.614805"
Evaluating: -32.614805+3.5
 Parameter: ZMAX <- "-29.114805"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.32839"
Evaluating: 12.32839-3.5
 Parameter: XMIN <- "8.82839"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-59.8684935"
Evaluating: -59.8684935-3.5
 Parameter: YMIN <- "-63.3684935"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.614805"
Evaluating: -32.614805-3.5
 Parameter: ZMIN <- "-36.114805"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.82839"
 Parameter: XMIN -> "8.82839"
 Parameter: YMAX -> "-56.3684935"
 Parameter: YMIN -> "-63.3684935"
 Parameter: ZMAX -> "-29.114805"
 Parameter: ZMIN -> "-36.114805"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "190"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "190" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "190"
Evaluating: 190
 Parameter: J <- "190"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "190" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "190"
 Parameter: NPOS -> "143"
Evaluating: 190-143
 Parameter: J <- "47"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.727471935"
Evaluating: 125.050557*(0.727471935-0.5)
 Parameter: XPOS <- "28.4454922"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.109995419"
Evaluating: 125.050557*(0.109995419-0.5)
 Parameter: YPOS <- "-48.7702901"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.166064513"
Evaluating: 152.572525*(0.166064513-0.5)+-4.51585405
 Parameter: ZPOS <- "-55.4652345"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.4652345" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.4454922"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.4454922-0
 Parameter: XTRAN <- "28.4454922"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.7702901"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -48.7702901-0
 Parameter: YTRAN <- "-48.7702901"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.4652345"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.4652345-0
 Parameter: ZTRAN <- "-55.4652345"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.4454922"
 Parameter: YTRAN -> "-48.7702901"
 Parameter: ZTRAN -> "-55.4652345"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    28.445492  -48.770290  -55.465235
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.420313891"
Evaluating: 0.420313891*360.0
 Parameter: XPHI <- "151.313001"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.760091472"
Evaluating: 0.760091472*360.0
 Parameter: YPHI <- "273.63293"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.188134914"
Evaluating: 0.188134914*360.0
 Parameter: ZPHI <- "67.728569"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.4454922"
 Parameter: YPOS -> "-48.7702901"
 Parameter: ZPOS -> "-55.4652345"
 Parameter: XPHI -> "151.313001"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.877255    0.480024
    0.000000   -0.480024   -0.877255

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  151.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.4454922"
 Parameter: YPOS -> "-48.7702901"
 Parameter: ZPOS -> "-55.4652345"
 Parameter: YPHI -> "273.63293"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.063364    0.000000    0.997990
    0.000000    1.000000    0.000000
   -0.997990    0.000000    0.063364

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   86.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.4454922"
 Parameter: YPOS -> "-48.7702901"
 Parameter: ZPOS -> "-55.4652345"
 Parameter: ZPHI -> "67.728569"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.378995    0.925399    0.000000
   -0.925399    0.378995    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   67.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.445492 XMAX =   28.445492 XAVE =   28.445492
    YMIN =  -48.770290 YMAX =  -48.770290 YAVE =  -48.770290
    ZMIN =  -55.465235 ZMAX =  -55.465235 ZAVE =  -55.465235
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.4454922"
Evaluating: 28.4454922+3.5
 Parameter: XMAX <- "31.9454922"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.7702901"
Evaluating: -48.7702901+3.5
 Parameter: YMAX <- "-45.2702901"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.4652345"
Evaluating: -55.4652345+3.5
 Parameter: ZMAX <- "-51.9652345"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.4454922"
Evaluating: 28.4454922-3.5
 Parameter: XMIN <- "24.9454922"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.7702901"
Evaluating: -48.7702901-3.5
 Parameter: YMIN <- "-52.2702901"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.4652345"
Evaluating: -55.4652345-3.5
 Parameter: ZMIN <- "-58.9652345"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.9454922"
 Parameter: XMIN -> "24.9454922"
 Parameter: YMAX -> "-45.2702901"
 Parameter: YMIN -> "-52.2702901"
 Parameter: ZMAX -> "-51.9652345"
 Parameter: ZMIN -> "-58.9652345"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "191"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "191" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "191"
Evaluating: 191
 Parameter: J <- "191"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "191" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "191"
 Parameter: NPOS -> "143"
Evaluating: 191-143
 Parameter: J <- "48"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.150638776"
Evaluating: 125.050557*(0.150638776-0.5)
 Parameter: XPOS <- "-43.6878157"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.867261001"
Evaluating: 125.050557*(0.867261001-0.5)
 Parameter: YPOS <- "45.9261927"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.998207814"
Evaluating: 152.572525*(0.998207814-0.5)+-4.51585405
 Parameter: ZPOS <- "71.4969701"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "71.4969701" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "71.4969701" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.6878157"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.6878157-0
 Parameter: XTRAN <- "-43.6878157"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.9261927"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 45.9261927-0
 Parameter: YTRAN <- "45.9261927"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "71.4969701"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 71.4969701-0
 Parameter: ZTRAN <- "71.4969701"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.6878157"
 Parameter: YTRAN -> "45.9261927"
 Parameter: ZTRAN -> "71.4969701"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -43.687816   45.926193   71.496970
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.523751661"
Evaluating: 0.523751661*360.0
 Parameter: XPHI <- "188.550598"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.450319654"
Evaluating: 0.450319654*360.0
 Parameter: YPHI <- "162.115075"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.247340508"
Evaluating: 0.247340508*360.0
 Parameter: ZPHI <- "89.0425829"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.6878157"
 Parameter: YPOS -> "45.9261927"
 Parameter: ZPOS -> "71.4969701"
 Parameter: XPHI -> "188.550598"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.988885   -0.148683
    0.000000    0.148683   -0.988885

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  171.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.6878157"
 Parameter: YPOS -> "45.9261927"
 Parameter: ZPOS -> "71.4969701"
 Parameter: YPHI -> "162.115075"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.951675    0.000000   -0.307106
    0.000000    1.000000    0.000000
    0.307106    0.000000   -0.951675

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  162.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.6878157"
 Parameter: YPOS -> "45.9261927"
 Parameter: ZPOS -> "71.4969701"
 Parameter: ZPHI -> "89.0425829"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.016709    0.999860    0.000000
   -0.999860    0.016709    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   89.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.687816 XMAX =  -43.687816 XAVE =  -43.687816
    YMIN =   45.926193 YMAX =   45.926193 YAVE =   45.926193
    ZMIN =   71.496970 ZMAX =   71.496970 ZAVE =   71.496970
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.6878157"
Evaluating: -43.6878157+3.5
 Parameter: XMAX <- "-40.1878157"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.9261927"
Evaluating: 45.9261927+3.5
 Parameter: YMAX <- "49.4261927"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "71.4969701"
Evaluating: 71.4969701+3.5
 Parameter: ZMAX <- "74.9969701"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.6878157"
Evaluating: -43.6878157-3.5
 Parameter: XMIN <- "-47.1878157"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.9261927"
Evaluating: 45.9261927-3.5
 Parameter: YMIN <- "42.4261927"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "71.4969701"
Evaluating: 71.4969701-3.5
 Parameter: ZMIN <- "67.9969701"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.1878157"
 Parameter: XMIN -> "-47.1878157"
 Parameter: YMAX -> "49.4261927"
 Parameter: YMIN -> "42.4261927"
 Parameter: ZMAX -> "74.9969701"
 Parameter: ZMIN -> "67.9969701"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "192"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "192" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "192"
Evaluating: 192
 Parameter: J <- "192"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "192" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "192"
 Parameter: NPOS -> "143"
Evaluating: 192-143
 Parameter: J <- "49"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.576951191"
Evaluating: 125.050557*(0.576951191-0.5)
 Parameter: XPOS <- "9.6227893"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.42000519"
Evaluating: 125.050557*(0.42000519-0.5)
 Parameter: YPOS <- "-10.0033955"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.506083884"
Evaluating: 152.572525*(0.506083884-0.5)+-4.51585405
 Parameter: ZPOS <- "-3.58762051"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.58762051" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.58762051" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "192"
Evaluating: 192
 Parameter: J <- "192"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "192" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "192"
 Parameter: NPOS -> "143"
Evaluating: 192-143
 Parameter: J <- "49"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.387025597"
Evaluating: 125.050557*(0.387025597-0.5)
 Parameter: XPOS <- "-14.127512"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "3.449057515E-03"
Evaluating: 125.050557*(3.449057515E-03-0.5)
 Parameter: YPOS <- "-62.0939719"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "7.388505395E-02"
Evaluating: 152.572525*(7.388505395E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-69.5292873"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-69.5292873" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.127512"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.127512-0
 Parameter: XTRAN <- "-14.127512"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-62.0939719"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -62.0939719-0
 Parameter: YTRAN <- "-62.0939719"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-69.5292873"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -69.5292873-0
 Parameter: ZTRAN <- "-69.5292873"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.127512"
 Parameter: YTRAN -> "-62.0939719"
 Parameter: ZTRAN -> "-69.5292873"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -14.127512  -62.093972  -69.529287
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.748212857"
Evaluating: 0.748212857*360.0
 Parameter: XPHI <- "269.356629"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.451251845"
Evaluating: 0.451251845*360.0
 Parameter: YPHI <- "162.450664"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.332906423"
Evaluating: 0.332906423*360.0
 Parameter: ZPHI <- "119.846312"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.127512"
 Parameter: YPOS -> "-62.0939719"
 Parameter: ZPOS -> "-69.5292873"
 Parameter: XPHI -> "269.356629"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.011229   -0.999937
    0.000000    0.999937   -0.011229

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   90.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.127512"
 Parameter: YPOS -> "-62.0939719"
 Parameter: ZPOS -> "-69.5292873"
 Parameter: YPHI -> "162.450664"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.953458    0.000000   -0.301527
    0.000000    1.000000    0.000000
    0.301527    0.000000   -0.953458

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  162.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.127512"
 Parameter: YPOS -> "-62.0939719"
 Parameter: ZPOS -> "-69.5292873"
 Parameter: ZPHI -> "119.846312"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.497675    0.867363    0.000000
   -0.867363   -0.497675    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  119.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.127512 XMAX =  -14.127512 XAVE =  -14.127512
    YMIN =  -62.093972 YMAX =  -62.093972 YAVE =  -62.093972
    ZMIN =  -69.529287 ZMAX =  -69.529287 ZAVE =  -69.529287
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.127512"
Evaluating: -14.127512+3.5
 Parameter: XMAX <- "-10.627512"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-62.0939719"
Evaluating: -62.0939719+3.5
 Parameter: YMAX <- "-58.5939719"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-69.5292873"
Evaluating: -69.5292873+3.5
 Parameter: ZMAX <- "-66.0292873"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.127512"
Evaluating: -14.127512-3.5
 Parameter: XMIN <- "-17.627512"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-62.0939719"
Evaluating: -62.0939719-3.5
 Parameter: YMIN <- "-65.5939719"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-69.5292873"
Evaluating: -69.5292873-3.5
 Parameter: ZMIN <- "-73.0292873"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.627512"
 Parameter: XMIN -> "-17.627512"
 Parameter: YMAX -> "-58.5939719"
 Parameter: YMIN -> "-65.5939719"
 Parameter: ZMAX -> "-66.0292873"
 Parameter: ZMIN -> "-73.0292873"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "193"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "193" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "193"
Evaluating: 193
 Parameter: J <- "193"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "193" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "193"
 Parameter: NPOS -> "143"
Evaluating: 193-143
 Parameter: J <- "50"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.863904202"
Evaluating: 125.050557*(0.863904202-0.5)
 Parameter: XPOS <- "45.5064232"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.650436576"
Evaluating: 125.050557*(0.650436576-0.5)
 Parameter: YPOS <- "18.8121776"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.699670134"
Evaluating: 152.572525*(0.699670134-0.5)+-4.51585405
 Parameter: ZPOS <- "25.9483225"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.9483225" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.9483225" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.5064232"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.5064232-0
 Parameter: XTRAN <- "45.5064232"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.8121776"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 18.8121776-0
 Parameter: YTRAN <- "18.8121776"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.9483225"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.9483225-0
 Parameter: ZTRAN <- "25.9483225"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.5064232"
 Parameter: YTRAN -> "18.8121776"
 Parameter: ZTRAN -> "25.9483225"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    45.506423   18.812178   25.948322
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.814607883"
Evaluating: 0.814607883*360.0
 Parameter: XPHI <- "293.258838"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.213915985"
Evaluating: 0.213915985*360.0
 Parameter: YPHI <- "77.0097546"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.430453005"
Evaluating: 0.430453005*360.0
 Parameter: ZPHI <- "154.963082"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.5064232"
 Parameter: YPOS -> "18.8121776"
 Parameter: ZPOS -> "25.9483225"
 Parameter: XPHI -> "293.258838"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.394886   -0.918730
    0.000000    0.918730    0.394886

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   66.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.5064232"
 Parameter: YPOS -> "18.8121776"
 Parameter: ZPOS -> "25.9483225"
 Parameter: YPHI -> "77.0097546"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.224785    0.000000   -0.974408
    0.000000    1.000000    0.000000
    0.974408    0.000000    0.224785

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   77.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.5064232"
 Parameter: YPOS -> "18.8121776"
 Parameter: ZPOS -> "25.9483225"
 Parameter: ZPHI -> "154.963082"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.906035    0.423202    0.000000
   -0.423202   -0.906035    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  154.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.506423 XMAX =   45.506423 XAVE =   45.506423
    YMIN =   18.812178 YMAX =   18.812178 YAVE =   18.812178
    ZMIN =   25.948322 ZMAX =   25.948322 ZAVE =   25.948322
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.5064232"
Evaluating: 45.5064232+3.5
 Parameter: XMAX <- "49.0064232"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.8121776"
Evaluating: 18.8121776+3.5
 Parameter: YMAX <- "22.3121776"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.9483225"
Evaluating: 25.9483225+3.5
 Parameter: ZMAX <- "29.4483225"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.5064232"
Evaluating: 45.5064232-3.5
 Parameter: XMIN <- "42.0064232"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.8121776"
Evaluating: 18.8121776-3.5
 Parameter: YMIN <- "15.3121776"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.9483225"
Evaluating: 25.9483225-3.5
 Parameter: ZMIN <- "22.4483225"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.0064232"
 Parameter: XMIN -> "42.0064232"
 Parameter: YMAX -> "22.3121776"
 Parameter: YMIN -> "15.3121776"
 Parameter: ZMAX -> "29.4483225"
 Parameter: ZMIN -> "22.4483225"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "194"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "194" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "194"
Evaluating: 194
 Parameter: J <- "194"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "194" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "194"
 Parameter: NPOS -> "143"
Evaluating: 194-143
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.525251919"
Evaluating: 125.050557*(0.525251919-0.5)
 Parameter: XPOS <- "3.15776654"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.132424039"
Evaluating: 125.050557*(0.132424039-0.5)
 Parameter: YPOS <- "-45.9655787"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.910947621"
Evaluating: 152.572525*(0.910947621-0.5)+-4.51585405
 Parameter: ZPOS <- "58.1834621"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "58.1834621" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "58.1834621" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.15776654"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.15776654-0
 Parameter: XTRAN <- "3.15776654"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-45.9655787"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -45.9655787-0
 Parameter: YTRAN <- "-45.9655787"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "58.1834621"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 58.1834621-0
 Parameter: ZTRAN <- "58.1834621"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.15776654"
 Parameter: YTRAN -> "-45.9655787"
 Parameter: ZTRAN -> "58.1834621"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     3.157767  -45.965579   58.183462
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.256947051"
Evaluating: 0.256947051*360.0
 Parameter: XPHI <- "92.5009384"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.807036103"
Evaluating: 0.807036103*360.0
 Parameter: YPHI <- "290.532997"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.552745846"
Evaluating: 0.552745846*360.0
 Parameter: ZPHI <- "198.988505"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.15776654"
 Parameter: YPOS -> "-45.9655787"
 Parameter: ZPOS -> "58.1834621"
 Parameter: XPHI -> "92.5009384"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.043636    0.999048
    0.000000   -0.999048   -0.043636

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   92.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.15776654"
 Parameter: YPOS -> "-45.9655787"
 Parameter: ZPOS -> "58.1834621"
 Parameter: YPHI -> "290.532997"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.350747    0.000000    0.936470
    0.000000    1.000000    0.000000
   -0.936470    0.000000    0.350747

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   69.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.15776654"
 Parameter: YPOS -> "-45.9655787"
 Parameter: ZPOS -> "58.1834621"
 Parameter: ZPHI -> "198.988505"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.945584   -0.325378    0.000000
    0.325378   -0.945584    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  161.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.157767 XMAX =    3.157767 XAVE =    3.157767
    YMIN =  -45.965579 YMAX =  -45.965579 YAVE =  -45.965579
    ZMIN =   58.183462 ZMAX =   58.183462 ZAVE =   58.183462
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.15776654"
Evaluating: 3.15776654+3.5
 Parameter: XMAX <- "6.65776654"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-45.9655787"
Evaluating: -45.9655787+3.5
 Parameter: YMAX <- "-42.4655787"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "58.1834621"
Evaluating: 58.1834621+3.5
 Parameter: ZMAX <- "61.6834621"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.15776654"
Evaluating: 3.15776654-3.5
 Parameter: XMIN <- "-0.34223346"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-45.9655787"
Evaluating: -45.9655787-3.5
 Parameter: YMIN <- "-49.4655787"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "58.1834621"
Evaluating: 58.1834621-3.5
 Parameter: ZMIN <- "54.6834621"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.65776654"
 Parameter: XMIN -> "-0.34223346"
 Parameter: YMAX -> "-42.4655787"
 Parameter: YMIN -> "-49.4655787"
 Parameter: ZMAX -> "61.6834621"
 Parameter: ZMIN -> "54.6834621"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "195"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "195" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "195"
Evaluating: 195
 Parameter: J <- "195"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "195" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "195"
 Parameter: NPOS -> "143"
Evaluating: 195-143
 Parameter: J <- "52"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.589425571"
Evaluating: 125.050557*(0.589425571-0.5)
 Parameter: XPOS <- "11.1827175"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.186653975"
Evaluating: 125.050557*(0.186653975-0.5)
 Parameter: YPOS <- "-39.184095"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "7.316201518E-02"
Evaluating: 152.572525*(7.316201518E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-69.6396032"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-69.6396032" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.1827175"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.1827175-0
 Parameter: XTRAN <- "11.1827175"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.184095"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.184095-0
 Parameter: YTRAN <- "-39.184095"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-69.6396032"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -69.6396032-0
 Parameter: ZTRAN <- "-69.6396032"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.1827175"
 Parameter: YTRAN -> "-39.184095"
 Parameter: ZTRAN -> "-69.6396032"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    11.182718  -39.184095  -69.639603
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.784696869"
Evaluating: 0.784696869*360.0
 Parameter: XPHI <- "282.490873"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.762007546"
Evaluating: 0.762007546*360.0
 Parameter: YPHI <- "274.322717"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.82007497"
Evaluating: 0.82007497*360.0
 Parameter: ZPHI <- "295.226989"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.1827175"
 Parameter: YPOS -> "-39.184095"
 Parameter: ZPOS -> "-69.6396032"
 Parameter: XPHI -> "282.490873"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.216284   -0.976330
    0.000000    0.976330    0.216284

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   77.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.1827175"
 Parameter: YPOS -> "-39.184095"
 Parameter: ZPOS -> "-69.6396032"
 Parameter: YPHI -> "274.322717"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.075374    0.000000    0.997155
    0.000000    1.000000    0.000000
   -0.997155    0.000000    0.075374

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   85.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.1827175"
 Parameter: YPOS -> "-39.184095"
 Parameter: ZPOS -> "-69.6396032"
 Parameter: ZPHI -> "295.226989"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.426205   -0.904626    0.000000
    0.904626    0.426205    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   64.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.182718 XMAX =   11.182718 XAVE =   11.182718
    YMIN =  -39.184095 YMAX =  -39.184095 YAVE =  -39.184095
    ZMIN =  -69.639603 ZMAX =  -69.639603 ZAVE =  -69.639603
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.1827175"
Evaluating: 11.1827175+3.5
 Parameter: XMAX <- "14.6827175"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.184095"
Evaluating: -39.184095+3.5
 Parameter: YMAX <- "-35.684095"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-69.6396032"
Evaluating: -69.6396032+3.5
 Parameter: ZMAX <- "-66.1396032"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.1827175"
Evaluating: 11.1827175-3.5
 Parameter: XMIN <- "7.6827175"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.184095"
Evaluating: -39.184095-3.5
 Parameter: YMIN <- "-42.684095"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-69.6396032"
Evaluating: -69.6396032-3.5
 Parameter: ZMIN <- "-73.1396032"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.6827175"
 Parameter: XMIN -> "7.6827175"
 Parameter: YMAX -> "-35.684095"
 Parameter: YMIN -> "-42.684095"
 Parameter: ZMAX -> "-66.1396032"
 Parameter: ZMIN -> "-73.1396032"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "196"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "196" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "196"
Evaluating: 196
 Parameter: J <- "196"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "196" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "196"
 Parameter: NPOS -> "143"
Evaluating: 196-143
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.864754768"
Evaluating: 125.050557*(0.864754768-0.5)
 Parameter: XPOS <- "45.6127869"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.509123825"
Evaluating: 125.050557*(0.509123825-0.5)
 Parameter: YPOS <- "1.1409394"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.426525601"
Evaluating: 152.572525*(0.426525601-0.5)+-4.51585405
 Parameter: ZPOS <- "-15.7260286"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.7260286" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.6127869"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.6127869-0
 Parameter: XTRAN <- "45.6127869"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.1409394"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.1409394-0
 Parameter: YTRAN <- "1.1409394"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.7260286"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.7260286-0
 Parameter: ZTRAN <- "-15.7260286"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.6127869"
 Parameter: YTRAN -> "1.1409394"
 Parameter: ZTRAN -> "-15.7260286"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    45.612787    1.140939  -15.726029
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.675070566"
Evaluating: 0.675070566*360.0
 Parameter: XPHI <- "243.025404"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720879182"
Evaluating: 0.720879182*360.0
 Parameter: YPHI <- "259.516506"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.509379557"
Evaluating: 0.509379557*360.0
 Parameter: ZPHI <- "183.376641"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.6127869"
 Parameter: YPOS -> "1.1409394"
 Parameter: ZPOS -> "-15.7260286"
 Parameter: XPHI -> "243.025404"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.453595   -0.891208
    0.000000    0.891208   -0.453595

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  116.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.6127869"
 Parameter: YPOS -> "1.1409394"
 Parameter: ZPOS -> "-15.7260286"
 Parameter: YPHI -> "259.516506"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.181952    0.000000    0.983307
    0.000000    1.000000    0.000000
   -0.983307    0.000000   -0.181952

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  100.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.6127869"
 Parameter: YPOS -> "1.1409394"
 Parameter: ZPOS -> "-15.7260286"
 Parameter: ZPHI -> "183.376641"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.998264   -0.058899    0.000000
    0.058899   -0.998264    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  176.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.612787 XMAX =   45.612787 XAVE =   45.612787
    YMIN =    1.140939 YMAX =    1.140939 YAVE =    1.140939
    ZMIN =  -15.726029 ZMAX =  -15.726029 ZAVE =  -15.726029
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.6127869"
Evaluating: 45.6127869+3.5
 Parameter: XMAX <- "49.1127869"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.1409394"
Evaluating: 1.1409394+3.5
 Parameter: YMAX <- "4.6409394"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.7260286"
Evaluating: -15.7260286+3.5
 Parameter: ZMAX <- "-12.2260286"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.6127869"
Evaluating: 45.6127869-3.5
 Parameter: XMIN <- "42.1127869"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.1409394"
Evaluating: 1.1409394-3.5
 Parameter: YMIN <- "-2.3590606"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.7260286"
Evaluating: -15.7260286-3.5
 Parameter: ZMIN <- "-19.2260286"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.1127869"
 Parameter: XMIN -> "42.1127869"
 Parameter: YMAX -> "4.6409394"
 Parameter: YMIN -> "-2.3590606"
 Parameter: ZMAX -> "-12.2260286"
 Parameter: ZMIN -> "-19.2260286"
 SELRPN>     40 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     19 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64611 NEG      CLA      53       CLA     -**** PROA     VAL      1111     C             4.5656
64611 NEG      CLA      53       CLA     -**** PROA     VAL      1111     O             4.0504
64611 NEG      CLA      53       CLA     -**** PROA     VAL      1115     CB            3.5554
64611 NEG      CLA      53       CLA     -**** PROA     VAL      1115     CG1           4.0310
64611 NEG      CLA      53       CLA     -**** PROA     VAL      1115     CG2           2.7618
64611 NEG      CLA      53       CLA     -**** PROA     LEU      1167     CG            4.2145
64611 NEG      CLA      53       CLA     -**** PROA     LEU      1167     CD2           3.0743
64611 NEG      CLA      53       CLA     -**** PROA     LEU      1167     C             3.0205
64611 NEG      CLA      53       CLA     -**** PROA     LEU      1167     O             2.1685
64611 NEG      CLA      53       CLA     -**** PROA     LYS      1168     N             3.4829
64611 NEG      CLA      53       CLA     -**** PROA     LYS      1168     CA            3.3403
64611 NEG      CLA      53       CLA     -**** PROA     LYS      1168     CB            4.6233
64611 NEG      CLA      53       CLA     -**** PROA     LYS      1168     C             3.9261
64611 NEG      CLA      53       CLA     -**** PROA     ALA      1171     N             3.7755
64611 NEG      CLA      53       CLA     -**** PROA     ALA      1171     CA            3.6895
64611 NEG      CLA      53       CLA     -**** PROA     ALA      1171     CB            2.5264
64611 NEG      CLA      53       CLA     -**** PROA     ALA      1171     C             4.4551
64611 NEG      CLA      53       CLA     -**** PROA     PHE      1172     CG            4.8755
64611 NEG      CLA      53       CLA     -**** PROA     PHE      1172     CD2           4.1049
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        19
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "196"
Evaluating: 196
 Parameter: J <- "196"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "196" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "196"
 Parameter: NPOS -> "143"
Evaluating: 196-143
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.432780374"
Evaluating: 125.050557*(0.432780374-0.5)
 Parameter: XPOS <- "-8.40585167"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.596643087"
Evaluating: 125.050557*(0.596643087-0.5)
 Parameter: YPOS <- "12.0852719"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "9.196165359E-02"
Evaluating: 152.572525*(9.196165359E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-66.7712949"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-66.7712949" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.612787 XMAX =   45.612787 XAVE =   45.612787
    YMIN =    1.140939 YMAX =    1.140939 YAVE =    1.140939
    ZMIN =  -15.726029 ZMAX =  -15.726029 ZAVE =  -15.726029
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.40585167"
 RDCMND substituted energy or value "?XAVE" to "45.6127869"
Evaluating: -8.40585167-45.6127869
 Parameter: XTRAN <- "-54.0186386"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.0852719"
 RDCMND substituted energy or value "?YAVE" to "1.1409394"
Evaluating: 12.0852719-1.1409394
 Parameter: YTRAN <- "10.9443325"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-66.7712949"
 RDCMND substituted energy or value "?ZAVE" to "-15.7260286"
Evaluating: -66.7712949--15.7260286
 Parameter: ZTRAN <- "-51.0452663"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-54.0186386"
 Parameter: YTRAN -> "10.9443325"
 Parameter: ZTRAN -> "-51.0452663"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -54.018639   10.944332  -51.045266
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.345212131"
Evaluating: 0.345212131*360.0
 Parameter: XPHI <- "124.276367"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.805034389"
Evaluating: 0.805034389*360.0
 Parameter: YPHI <- "289.81238"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.320144504"
Evaluating: 0.320144504*360.0
 Parameter: ZPHI <- "115.252021"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.40585167"
 Parameter: YPOS -> "12.0852719"
 Parameter: ZPOS -> "-66.7712949"
 Parameter: XPHI -> "124.276367"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.563185    0.826331
    0.000000   -0.826331   -0.563185

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  124.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.40585167"
 Parameter: YPOS -> "12.0852719"
 Parameter: ZPOS -> "-66.7712949"
 Parameter: YPHI -> "289.81238"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.338941    0.000000    0.940808
    0.000000    1.000000    0.000000
   -0.940808    0.000000    0.338941

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   70.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.40585167"
 Parameter: YPOS -> "12.0852719"
 Parameter: ZPOS -> "-66.7712949"
 Parameter: ZPHI -> "115.252021"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.426601    0.904440    0.000000
   -0.904440   -0.426601    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  115.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.405852 XMAX =   -8.405852 XAVE =   -8.405852
    YMIN =   12.085272 YMAX =   12.085272 YAVE =   12.085272
    ZMIN =  -66.771295 ZMAX =  -66.771295 ZAVE =  -66.771295
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.40585167"
Evaluating: -8.40585167+3.5
 Parameter: XMAX <- "-4.90585167"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.0852719"
Evaluating: 12.0852719+3.5
 Parameter: YMAX <- "15.5852719"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-66.7712949"
Evaluating: -66.7712949+3.5
 Parameter: ZMAX <- "-63.2712949"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.40585167"
Evaluating: -8.40585167-3.5
 Parameter: XMIN <- "-11.9058517"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.0852719"
Evaluating: 12.0852719-3.5
 Parameter: YMIN <- "8.5852719"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-66.7712949"
Evaluating: -66.7712949-3.5
 Parameter: ZMIN <- "-70.2712949"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.90585167"
 Parameter: XMIN -> "-11.9058517"
 Parameter: YMAX -> "15.5852719"
 Parameter: YMIN -> "8.5852719"
 Parameter: ZMAX -> "-63.2712949"
 Parameter: ZMIN -> "-70.2712949"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "197"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "197" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "197"
Evaluating: 197
 Parameter: J <- "197"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "197" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "197"
 Parameter: NPOS -> "143"
Evaluating: 197-143
 Parameter: J <- "54"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.710798754"
Evaluating: 125.050557*(0.710798754-0.5)
 Parameter: XPOS <- "26.3605016"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.743609521"
Evaluating: 125.050557*(0.743609521-0.5)
 Parameter: YPOS <- "30.4635063"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.36274541"
Evaluating: 152.572525*(0.36274541-0.5)+-4.51585405
 Parameter: ZPOS <- "-25.4571334"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.4571334" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.3605016"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.3605016-0
 Parameter: XTRAN <- "26.3605016"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.4635063"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.4635063-0
 Parameter: YTRAN <- "30.4635063"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.4571334"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.4571334-0
 Parameter: ZTRAN <- "-25.4571334"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.3605016"
 Parameter: YTRAN -> "30.4635063"
 Parameter: ZTRAN -> "-25.4571334"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    26.360502   30.463506  -25.457133
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.118724664"
Evaluating: 0.118724664*360.0
 Parameter: XPHI <- "42.740879"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.110140961"
Evaluating: 0.110140961*360.0
 Parameter: YPHI <- "39.650746"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.326461928E-02"
Evaluating: 7.326461928E-02*360.0
 Parameter: ZPHI <- "26.3752629"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.3605016"
 Parameter: YPOS -> "30.4635063"
 Parameter: ZPOS -> "-25.4571334"
 Parameter: XPHI -> "42.740879"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.734431    0.678684
    0.000000   -0.678684    0.734431

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   42.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.3605016"
 Parameter: YPOS -> "30.4635063"
 Parameter: ZPOS -> "-25.4571334"
 Parameter: YPHI -> "39.650746"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.769948    0.000000   -0.638106
    0.000000    1.000000    0.000000
    0.638106    0.000000    0.769948

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   39.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.3605016"
 Parameter: YPOS -> "30.4635063"
 Parameter: ZPOS -> "-25.4571334"
 Parameter: ZPHI -> "26.3752629"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.895904    0.444248    0.000000
   -0.444248    0.895904    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   26.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.360502 XMAX =   26.360502 XAVE =   26.360502
    YMIN =   30.463506 YMAX =   30.463506 YAVE =   30.463506
    ZMIN =  -25.457133 ZMAX =  -25.457133 ZAVE =  -25.457133
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.3605016"
Evaluating: 26.3605016+3.5
 Parameter: XMAX <- "29.8605016"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.4635063"
Evaluating: 30.4635063+3.5
 Parameter: YMAX <- "33.9635063"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.4571334"
Evaluating: -25.4571334+3.5
 Parameter: ZMAX <- "-21.9571334"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.3605016"
Evaluating: 26.3605016-3.5
 Parameter: XMIN <- "22.8605016"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.4635063"
Evaluating: 30.4635063-3.5
 Parameter: YMIN <- "26.9635063"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.4571334"
Evaluating: -25.4571334-3.5
 Parameter: ZMIN <- "-28.9571334"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.8605016"
 Parameter: XMIN -> "22.8605016"
 Parameter: YMAX -> "33.9635063"
 Parameter: YMIN -> "26.9635063"
 Parameter: ZMAX -> "-21.9571334"
 Parameter: ZMIN -> "-28.9571334"
 SELRPN>      2 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "198"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "198" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "198"
Evaluating: 198
 Parameter: J <- "198"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "198" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "198"
 Parameter: NPOS -> "143"
Evaluating: 198-143
 Parameter: J <- "55"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.86661499"
Evaluating: 125.050557*(0.86661499-0.5)
 Parameter: XPOS <- "45.8454087"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.657409711"
Evaluating: 125.050557*(0.657409711-0.5)
 Parameter: YPOS <- "19.684172"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.530895671"
Evaluating: 152.572525*(0.530895671-0.5)+-4.51585405
 Parameter: ZPOS <- "0.197976486"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.197976486" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.197976486" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "198"
Evaluating: 198
 Parameter: J <- "198"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "198" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "198"
 Parameter: NPOS -> "143"
Evaluating: 198-143
 Parameter: J <- "55"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.743451091"
Evaluating: 125.050557*(0.743451091-0.5)
 Parameter: XPOS <- "30.4436945"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.175107653"
Evaluating: 125.050557*(0.175107653-0.5)
 Parameter: YPOS <- "-40.627969"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.367996653"
Evaluating: 152.572525*(0.367996653-0.5)+-4.51585405
 Parameter: ZPOS <- "-24.655938"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.655938" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.4436945"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.4436945-0
 Parameter: XTRAN <- "30.4436945"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.627969"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.627969-0
 Parameter: YTRAN <- "-40.627969"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.655938"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -24.655938-0
 Parameter: ZTRAN <- "-24.655938"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.4436945"
 Parameter: YTRAN -> "-40.627969"
 Parameter: ZTRAN -> "-24.655938"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    30.443694  -40.627969  -24.655938
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.148034177E-02"
Evaluating: 6.148034177E-02*360.0
 Parameter: XPHI <- "22.132923"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.831297154"
Evaluating: 0.831297154*360.0
 Parameter: YPHI <- "299.266975"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.911274408"
Evaluating: 0.911274408*360.0
 Parameter: ZPHI <- "328.058787"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.4436945"
 Parameter: YPOS -> "-40.627969"
 Parameter: ZPOS -> "-24.655938"
 Parameter: XPHI -> "22.132923"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.926312    0.376757
    0.000000   -0.376757    0.926312

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   22.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.4436945"
 Parameter: YPOS -> "-40.627969"
 Parameter: ZPOS -> "-24.655938"
 Parameter: YPHI -> "299.266975"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.488880    0.000000    0.872351
    0.000000    1.000000    0.000000
   -0.872351    0.000000    0.488880

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   60.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.4436945"
 Parameter: YPOS -> "-40.627969"
 Parameter: ZPOS -> "-24.655938"
 Parameter: ZPHI -> "328.058787"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.848591   -0.529049    0.000000
    0.529049    0.848591    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   31.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.443694 XMAX =   30.443694 XAVE =   30.443694
    YMIN =  -40.627969 YMAX =  -40.627969 YAVE =  -40.627969
    ZMIN =  -24.655938 ZMAX =  -24.655938 ZAVE =  -24.655938
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.4436945"
Evaluating: 30.4436945+3.5
 Parameter: XMAX <- "33.9436945"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.627969"
Evaluating: -40.627969+3.5
 Parameter: YMAX <- "-37.127969"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.655938"
Evaluating: -24.655938+3.5
 Parameter: ZMAX <- "-21.155938"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.4436945"
Evaluating: 30.4436945-3.5
 Parameter: XMIN <- "26.9436945"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.627969"
Evaluating: -40.627969-3.5
 Parameter: YMIN <- "-44.127969"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.655938"
Evaluating: -24.655938-3.5
 Parameter: ZMIN <- "-28.155938"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.9436945"
 Parameter: XMIN -> "26.9436945"
 Parameter: YMAX -> "-37.127969"
 Parameter: YMIN -> "-44.127969"
 Parameter: ZMAX -> "-21.155938"
 Parameter: ZMIN -> "-28.155938"
 SELRPN>      4 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "199"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "199" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "199"
Evaluating: 199
 Parameter: J <- "199"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "199" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "199"
 Parameter: NPOS -> "143"
Evaluating: 199-143
 Parameter: J <- "56"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.733773685E-02"
Evaluating: 125.050557*(9.733773685E-02-0.5)
 Parameter: XPOS <- "-50.3531403"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.673920424"
Evaluating: 125.050557*(0.673920424-0.5)
 Parameter: YPOS <- "21.7488459"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.706557397"
Evaluating: 152.572525*(0.706557397-0.5)+-4.51585405
 Parameter: ZPOS <- "26.9991296"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.9991296" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.9991296" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.3531403"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -50.3531403-0
 Parameter: XTRAN <- "-50.3531403"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.7488459"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.7488459-0
 Parameter: YTRAN <- "21.7488459"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.9991296"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.9991296-0
 Parameter: ZTRAN <- "26.9991296"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.3531403"
 Parameter: YTRAN -> "21.7488459"
 Parameter: ZTRAN -> "26.9991296"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -50.353140   21.748846   26.999130
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.566545938"
Evaluating: 0.566545938*360.0
 Parameter: XPHI <- "203.956538"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.231649401"
Evaluating: 0.231649401*360.0
 Parameter: YPHI <- "83.3937844"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.260039305"
Evaluating: 0.260039305*360.0
 Parameter: ZPHI <- "93.6141498"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.3531403"
 Parameter: YPOS -> "21.7488459"
 Parameter: ZPOS -> "26.9991296"
 Parameter: XPHI -> "203.956538"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.913854   -0.406044
    0.000000    0.406044   -0.913854

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  156.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.3531403"
 Parameter: YPOS -> "21.7488459"
 Parameter: ZPOS -> "26.9991296"
 Parameter: YPHI -> "83.3937844"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.115045    0.000000   -0.993360
    0.000000    1.000000    0.000000
    0.993360    0.000000    0.115045

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   83.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.3531403"
 Parameter: YPOS -> "21.7488459"
 Parameter: ZPOS -> "26.9991296"
 Parameter: ZPHI -> "93.6141498"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.063037    0.998011    0.000000
   -0.998011   -0.063037    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   93.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.353140 XMAX =  -50.353140 XAVE =  -50.353140
    YMIN =   21.748846 YMAX =   21.748846 YAVE =   21.748846
    ZMIN =   26.999130 ZMAX =   26.999130 ZAVE =   26.999130
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.3531403"
Evaluating: -50.3531403+3.5
 Parameter: XMAX <- "-46.8531403"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.7488459"
Evaluating: 21.7488459+3.5
 Parameter: YMAX <- "25.2488459"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.9991296"
Evaluating: 26.9991296+3.5
 Parameter: ZMAX <- "30.4991296"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.3531403"
Evaluating: -50.3531403-3.5
 Parameter: XMIN <- "-53.8531403"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.7488459"
Evaluating: 21.7488459-3.5
 Parameter: YMIN <- "18.2488459"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.9991296"
Evaluating: 26.9991296-3.5
 Parameter: ZMIN <- "23.4991296"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.8531403"
 Parameter: XMIN -> "-53.8531403"
 Parameter: YMAX -> "25.2488459"
 Parameter: YMIN -> "18.2488459"
 Parameter: ZMAX -> "30.4991296"
 Parameter: ZMIN -> "23.4991296"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "200"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "200" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "200"
Evaluating: 200
 Parameter: J <- "200"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "200" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "200"
 Parameter: NPOS -> "143"
Evaluating: 200-143
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.114212461"
Evaluating: 125.050557*(0.114212461-0.5)
 Parameter: XPOS <- "-48.2429466"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.632920878"
Evaluating: 125.050557*(0.632920878-0.5)
 Parameter: YPOS <- "16.6218298"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.547176205"
Evaluating: 152.572525*(0.547176205-0.5)+-4.51585405
 Parameter: ZPOS <- "2.68193867"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.68193867" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.68193867" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "200"
Evaluating: 200
 Parameter: J <- "200"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "200" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "200"
 Parameter: NPOS -> "143"
Evaluating: 200-143
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.325543732"
Evaluating: 125.050557*(0.325543732-0.5)
 Parameter: XPOS <- "-21.8158535"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "5.874566627E-03"
Evaluating: 125.050557*(5.874566627E-03-0.5)
 Parameter: YPOS <- "-61.7906607"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "8.142646631E-02"
Evaluating: 152.572525*(8.142646631E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-68.378675"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-68.378675" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.8158535"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -21.8158535-0
 Parameter: XTRAN <- "-21.8158535"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-61.7906607"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -61.7906607-0
 Parameter: YTRAN <- "-61.7906607"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-68.378675"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -68.378675-0
 Parameter: ZTRAN <- "-68.378675"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-21.8158535"
 Parameter: YTRAN -> "-61.7906607"
 Parameter: ZTRAN -> "-68.378675"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -21.815853  -61.790661  -68.378675
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720736249"
Evaluating: 0.720736249*360.0
 Parameter: XPHI <- "259.46505"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.314767143E-02"
Evaluating: 7.314767143E-02*360.0
 Parameter: YPHI <- "26.3331617"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.884900247"
Evaluating: 0.884900247*360.0
 Parameter: ZPHI <- "318.564089"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.8158535"
 Parameter: YPOS -> "-61.7906607"
 Parameter: ZPOS -> "-68.378675"
 Parameter: XPHI -> "259.46505"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.182835   -0.983144
    0.000000    0.983144   -0.182835

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.8158535"
 Parameter: YPOS -> "-61.7906607"
 Parameter: ZPOS -> "-68.378675"
 Parameter: YPHI -> "26.3331617"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.896230    0.000000   -0.443590
    0.000000    1.000000    0.000000
    0.443590    0.000000    0.896230

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   26.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.8158535"
 Parameter: YPOS -> "-61.7906607"
 Parameter: ZPOS -> "-68.378675"
 Parameter: ZPHI -> "318.564089"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.749696   -0.661782    0.000000
    0.661782    0.749696    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   41.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.815853 XMAX =  -21.815853 XAVE =  -21.815853
    YMIN =  -61.790661 YMAX =  -61.790661 YAVE =  -61.790661
    ZMIN =  -68.378675 ZMAX =  -68.378675 ZAVE =  -68.378675
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.8158535"
Evaluating: -21.8158535+3.5
 Parameter: XMAX <- "-18.3158535"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-61.7906607"
Evaluating: -61.7906607+3.5
 Parameter: YMAX <- "-58.2906607"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-68.378675"
Evaluating: -68.378675+3.5
 Parameter: ZMAX <- "-64.878675"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.8158535"
Evaluating: -21.8158535-3.5
 Parameter: XMIN <- "-25.3158535"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-61.7906607"
Evaluating: -61.7906607-3.5
 Parameter: YMIN <- "-65.2906607"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-68.378675"
Evaluating: -68.378675-3.5
 Parameter: ZMIN <- "-71.878675"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.3158535"
 Parameter: XMIN -> "-25.3158535"
 Parameter: YMAX -> "-58.2906607"
 Parameter: YMIN -> "-65.2906607"
 Parameter: ZMAX -> "-64.878675"
 Parameter: ZMIN -> "-71.878675"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "201"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "201" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "201"
Evaluating: 201
 Parameter: J <- "201"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "201" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "201"
 Parameter: NPOS -> "143"
Evaluating: 201-143
 Parameter: J <- "58"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.17450606"
Evaluating: 125.050557*(0.17450606-0.5)
 Parameter: XPOS <- "-40.7031985"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.530104681"
Evaluating: 125.050557*(0.530104681-0.5)
 Parameter: YPOS <- "3.76460713"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.397878029"
Evaluating: 152.572525*(0.397878029-0.5)+-4.51585405
 Parameter: ZPOS <- "-20.096861"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.096861" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.7031985"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -40.7031985-0
 Parameter: XTRAN <- "-40.7031985"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.76460713"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.76460713-0
 Parameter: YTRAN <- "3.76460713"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.096861"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.096861-0
 Parameter: ZTRAN <- "-20.096861"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.7031985"
 Parameter: YTRAN -> "3.76460713"
 Parameter: ZTRAN -> "-20.096861"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -40.703198    3.764607  -20.096861
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.846476055"
Evaluating: 0.846476055*360.0
 Parameter: XPHI <- "304.73138"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.34159934"
Evaluating: 0.34159934*360.0
 Parameter: YPHI <- "122.975762"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.581342326"
Evaluating: 0.581342326*360.0
 Parameter: ZPHI <- "209.283237"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.7031985"
 Parameter: YPOS -> "3.76460713"
 Parameter: ZPOS -> "-20.096861"
 Parameter: XPHI -> "304.73138"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.569730   -0.821832
    0.000000    0.821832    0.569730

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   55.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.7031985"
 Parameter: YPOS -> "3.76460713"
 Parameter: ZPOS -> "-20.096861"
 Parameter: YPHI -> "122.975762"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.544284    0.000000   -0.838901
    0.000000    1.000000    0.000000
    0.838901    0.000000   -0.544284

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  122.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.7031985"
 Parameter: YPOS -> "3.76460713"
 Parameter: ZPOS -> "-20.096861"
 Parameter: ZPHI -> "209.283237"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.872212   -0.489127    0.000000
    0.489127   -0.872212    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  150.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.703198 XMAX =  -40.703198 XAVE =  -40.703198
    YMIN =    3.764607 YMAX =    3.764607 YAVE =    3.764607
    ZMIN =  -20.096861 ZMAX =  -20.096861 ZAVE =  -20.096861
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.7031985"
Evaluating: -40.7031985+3.5
 Parameter: XMAX <- "-37.2031985"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.76460713"
Evaluating: 3.76460713+3.5
 Parameter: YMAX <- "7.26460713"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.096861"
Evaluating: -20.096861+3.5
 Parameter: ZMAX <- "-16.596861"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.7031985"
Evaluating: -40.7031985-3.5
 Parameter: XMIN <- "-44.2031985"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.76460713"
Evaluating: 3.76460713-3.5
 Parameter: YMIN <- "0.26460713"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.096861"
Evaluating: -20.096861-3.5
 Parameter: ZMIN <- "-23.596861"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.2031985"
 Parameter: XMIN -> "-44.2031985"
 Parameter: YMAX -> "7.26460713"
 Parameter: YMIN -> "0.26460713"
 Parameter: ZMAX -> "-16.596861"
 Parameter: ZMIN -> "-23.596861"
 SELRPN>     15 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      5 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64616 NEG      CLA      58       CLA     -5703 PROA     HSD      426      CE1           3.4567
64616 NEG      CLA      58       CLA     -5705 PROA     HSD      426      NE2           3.1155
64616 NEG      CLA      58       CLA     -5770 PROA     LYS      430      CE            2.9204
64616 NEG      CLA      58       CLA     -5773 PROA     LYS      430      NZ            2.9745
64616 NEG      CLA      58       CLA     -6709 PROA     LEU      486      CB            4.3799
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "201"
Evaluating: 201
 Parameter: J <- "201"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "201" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "201"
 Parameter: NPOS -> "143"
Evaluating: 201-143
 Parameter: J <- "58"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.190397715"
Evaluating: 125.050557*(0.190397715-0.5)
 Parameter: XPOS <- "-38.7159382"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.33783009"
Evaluating: 125.050557*(0.33783009-0.5)
 Parameter: YPOS <- "-20.2794376"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.405775205"
Evaluating: 152.572525*(0.405775205-0.5)+-4.51585405
 Parameter: ZPOS <- "-18.8919689"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.8919689" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.703198 XMAX =  -40.703198 XAVE =  -40.703198
    YMIN =    3.764607 YMAX =    3.764607 YAVE =    3.764607
    ZMIN =  -20.096861 ZMAX =  -20.096861 ZAVE =  -20.096861
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.7159382"
 RDCMND substituted energy or value "?XAVE" to "-40.7031985"
Evaluating: -38.7159382--40.7031985
 Parameter: XTRAN <- "1.9872603"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.2794376"
 RDCMND substituted energy or value "?YAVE" to "3.76460713"
Evaluating: -20.2794376-3.76460713
 Parameter: YTRAN <- "-24.0440447"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.8919689"
 RDCMND substituted energy or value "?ZAVE" to "-20.096861"
Evaluating: -18.8919689--20.096861
 Parameter: ZTRAN <- "1.2048921"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.9872603"
 Parameter: YTRAN -> "-24.0440447"
 Parameter: ZTRAN -> "1.2048921"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     1.987260  -24.044045    1.204892
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.591033874"
Evaluating: 0.591033874*360.0
 Parameter: XPHI <- "212.772195"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.094734363E-02"
Evaluating: 8.094734363E-02*360.0
 Parameter: YPHI <- "29.1410437"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.867067688"
Evaluating: 0.867067688*360.0
 Parameter: ZPHI <- "312.144368"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.7159382"
 Parameter: YPOS -> "-20.2794376"
 Parameter: ZPOS -> "-18.8919689"
 Parameter: XPHI -> "212.772195"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.840829   -0.541300
    0.000000    0.541300   -0.840829

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  147.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.7159382"
 Parameter: YPOS -> "-20.2794376"
 Parameter: ZPOS -> "-18.8919689"
 Parameter: YPHI -> "29.1410437"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.873424    0.000000   -0.486961
    0.000000    1.000000    0.000000
    0.486961    0.000000    0.873424

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   29.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.7159382"
 Parameter: YPOS -> "-20.2794376"
 Parameter: ZPOS -> "-18.8919689"
 Parameter: ZPHI -> "312.144368"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.671001   -0.741456    0.000000
    0.741456    0.671001    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.715938 XMAX =  -38.715938 XAVE =  -38.715938
    YMIN =  -20.279438 YMAX =  -20.279438 YAVE =  -20.279438
    ZMIN =  -18.891969 ZMAX =  -18.891969 ZAVE =  -18.891969
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.7159382"
Evaluating: -38.7159382+3.5
 Parameter: XMAX <- "-35.2159382"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.2794376"
Evaluating: -20.2794376+3.5
 Parameter: YMAX <- "-16.7794376"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.8919689"
Evaluating: -18.8919689+3.5
 Parameter: ZMAX <- "-15.3919689"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.7159382"
Evaluating: -38.7159382-3.5
 Parameter: XMIN <- "-42.2159382"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.2794376"
Evaluating: -20.2794376-3.5
 Parameter: YMIN <- "-23.7794376"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.8919689"
Evaluating: -18.8919689-3.5
 Parameter: ZMIN <- "-22.3919689"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.2159382"
 Parameter: XMIN -> "-42.2159382"
 Parameter: YMAX -> "-16.7794376"
 Parameter: YMIN -> "-23.7794376"
 Parameter: ZMAX -> "-15.3919689"
 Parameter: ZMIN -> "-22.3919689"
 SELRPN>     19 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      6 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64616 NEG      CLA      58       CLA     -**** MEMB     POPC     236      C12           3.2431
64616 NEG      CLA      58       CLA     -**** MEMB     POPC     236      C15           3.3052
64616 NEG      CLA      58       CLA     -**** MEMB     POPC     236      C11           2.3411
64616 NEG      CLA      58       CLA     -**** MEMB     POPC     236      O12           3.2283
64616 NEG      CLA      58       CLA     -**** MEMB     POPC     236      O22           3.7722
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "201"
Evaluating: 201
 Parameter: J <- "201"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "201" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "201"
 Parameter: NPOS -> "143"
Evaluating: 201-143
 Parameter: J <- "58"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.765129369"
Evaluating: 125.050557*(0.765129369-0.5)
 Parameter: XPOS <- "33.1545753"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.416629274"
Evaluating: 125.050557*(0.416629274-0.5)
 Parameter: YPOS <- "-10.4255557"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.656992251"
Evaluating: 152.572525*(0.656992251-0.5)+-4.51585405
 Parameter: ZPOS <- "19.4368501"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.4368501" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.4368501" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.715938 XMAX =  -38.715938 XAVE =  -38.715938
    YMIN =  -20.279438 YMAX =  -20.279438 YAVE =  -20.279438
    ZMIN =  -18.891969 ZMAX =  -18.891969 ZAVE =  -18.891969
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.1545753"
 RDCMND substituted energy or value "?XAVE" to "-38.7159382"
Evaluating: 33.1545753--38.7159382
 Parameter: XTRAN <- "71.8705135"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.4255557"
 RDCMND substituted energy or value "?YAVE" to "-20.2794376"
Evaluating: -10.4255557--20.2794376
 Parameter: YTRAN <- "9.8538819"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.4368501"
 RDCMND substituted energy or value "?ZAVE" to "-18.8919689"
Evaluating: 19.4368501--18.8919689
 Parameter: ZTRAN <- "38.328819"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "71.8705135"
 Parameter: YTRAN -> "9.8538819"
 Parameter: ZTRAN -> "38.328819"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    71.870514    9.853882   38.328819
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.270953673"
Evaluating: 0.270953673*360.0
 Parameter: XPHI <- "97.5433223"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.474368515"
Evaluating: 0.474368515*360.0
 Parameter: YPHI <- "170.772665"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.573074227"
Evaluating: 0.573074227*360.0
 Parameter: ZPHI <- "206.306722"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.1545753"
 Parameter: YPOS -> "-10.4255557"
 Parameter: ZPOS -> "19.4368501"
 Parameter: XPHI -> "97.5433223"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.131276    0.991346
    0.000000   -0.991346   -0.131276

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   97.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.1545753"
 Parameter: YPOS -> "-10.4255557"
 Parameter: ZPOS -> "19.4368501"
 Parameter: YPHI -> "170.772665"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.987060    0.000000   -0.160352
    0.000000    1.000000    0.000000
    0.160352    0.000000   -0.987060

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  170.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.1545753"
 Parameter: YPOS -> "-10.4255557"
 Parameter: ZPOS -> "19.4368501"
 Parameter: ZPHI -> "206.306722"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.896434   -0.443176    0.000000
    0.443176   -0.896434    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  153.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.154575 XMAX =   33.154575 XAVE =   33.154575
    YMIN =  -10.425556 YMAX =  -10.425556 YAVE =  -10.425556
    ZMIN =   19.436850 ZMAX =   19.436850 ZAVE =   19.436850
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.1545753"
Evaluating: 33.1545753+3.5
 Parameter: XMAX <- "36.6545753"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.4255557"
Evaluating: -10.4255557+3.5
 Parameter: YMAX <- "-6.9255557"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.4368501"
Evaluating: 19.4368501+3.5
 Parameter: ZMAX <- "22.9368501"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.1545753"
Evaluating: 33.1545753-3.5
 Parameter: XMIN <- "29.6545753"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.4255557"
Evaluating: -10.4255557-3.5
 Parameter: YMIN <- "-13.9255557"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.4368501"
Evaluating: 19.4368501-3.5
 Parameter: ZMIN <- "15.9368501"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.6545753"
 Parameter: XMIN -> "29.6545753"
 Parameter: YMAX -> "-6.9255557"
 Parameter: YMIN -> "-13.9255557"
 Parameter: ZMAX -> "22.9368501"
 Parameter: ZMIN -> "15.9368501"
 SELRPN>     28 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     19 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64616 NEG      CLA      58       CLA     -**** PROA     HSD      1139     CG            4.5035
64616 NEG      CLA      58       CLA     -**** PROA     HSD      1139     NE2           4.1740
64616 NEG      CLA      58       CLA     -**** PROA     HSD      1139     CD2           3.8143
64616 NEG      CLA      58       CLA     -**** PROA     HSD      1139     C             4.0095
64616 NEG      CLA      58       CLA     -**** PROA     HSD      1139     O             3.4553
64616 NEG      CLA      58       CLA     -**** PROA     TYR      1140     C             3.3471
64616 NEG      CLA      58       CLA     -**** PROA     TYR      1140     O             2.5932
64616 NEG      CLA      58       CLA     -**** PROA     ASN      1141     N             3.7565
64616 NEG      CLA      58       CLA     -**** PROA     ASN      1141     CA            3.3789
64616 NEG      CLA      58       CLA     -**** PROA     ASN      1141     C             2.6080
64616 NEG      CLA      58       CLA     -**** PROA     ASN      1141     O             3.5344
64616 NEG      CLA      58       CLA     -**** PROA     GLN      1142     N             1.3397
64616 NEG      CLA      58       CLA     -**** PROA     GLN      1142     CA            1.7503
64616 NEG      CLA      58       CLA     -**** PROA     GLN      1142     CB            1.7991
64616 NEG      CLA      58       CLA     -**** PROA     GLN      1142     CG            1.9794
64616 NEG      CLA      58       CLA     -**** PROA     GLN      1142     CD            3.3183
64616 NEG      CLA      58       CLA     -**** PROA     GLN      1142     OE1           3.7807
64616 NEG      CLA      58       CLA     -**** PROA     GLN      1142     C             3.0402
64616 NEG      CLA      58       CLA     -**** PROA     SER      1143     N             3.4223
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        19
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "201"
Evaluating: 201
 Parameter: J <- "201"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "201" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "201"
 Parameter: NPOS -> "143"
Evaluating: 201-143
 Parameter: J <- "58"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.937533827"
Evaluating: 125.050557*(0.937533827-0.5)
 Parameter: XPOS <- "54.7138488"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "5.26883772E-02"
Evaluating: 125.050557*(5.26883772E-02-0.5)
 Parameter: YPOS <- "-55.9365676"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.84617559"
Evaluating: 152.572525*(0.84617559-0.5)+-4.51585405
 Parameter: ZPOS <- "48.3010298"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.3010298" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.3010298" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.154575 XMAX =   33.154575 XAVE =   33.154575
    YMIN =  -10.425556 YMAX =  -10.425556 YAVE =  -10.425556
    ZMIN =   19.436850 ZMAX =   19.436850 ZAVE =   19.436850
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "54.7138488"
 RDCMND substituted energy or value "?XAVE" to "33.1545753"
Evaluating: 54.7138488-33.1545753
 Parameter: XTRAN <- "21.5592735"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-55.9365676"
 RDCMND substituted energy or value "?YAVE" to "-10.4255557"
Evaluating: -55.9365676--10.4255557
 Parameter: YTRAN <- "-45.5110119"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.3010298"
 RDCMND substituted energy or value "?ZAVE" to "19.4368501"
Evaluating: 48.3010298-19.4368501
 Parameter: ZTRAN <- "28.8641797"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.5592735"
 Parameter: YTRAN -> "-45.5110119"
 Parameter: ZTRAN -> "28.8641797"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    21.559273  -45.511012   28.864180
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.66093307"
Evaluating: 0.66093307*360.0
 Parameter: XPHI <- "237.935905"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.769701166"
Evaluating: 0.769701166*360.0
 Parameter: YPHI <- "277.09242"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.274022627"
Evaluating: 0.274022627*360.0
 Parameter: ZPHI <- "98.6481457"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "54.7138488"
 Parameter: YPOS -> "-55.9365676"
 Parameter: ZPOS -> "48.3010298"
 Parameter: XPHI -> "237.935905"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.530868   -0.847455
    0.000000    0.847455   -0.530868

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  122.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "54.7138488"
 Parameter: YPOS -> "-55.9365676"
 Parameter: ZPOS -> "48.3010298"
 Parameter: YPHI -> "277.09242"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.123470    0.000000    0.992348
    0.000000    1.000000    0.000000
   -0.992348    0.000000    0.123470

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   82.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "54.7138488"
 Parameter: YPOS -> "-55.9365676"
 Parameter: ZPOS -> "48.3010298"
 Parameter: ZPHI -> "98.6481457"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.150366    0.988630    0.000000
   -0.988630   -0.150366    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   98.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   54.713849 XMAX =   54.713849 XAVE =   54.713849
    YMIN =  -55.936568 YMAX =  -55.936568 YAVE =  -55.936568
    ZMIN =   48.301030 ZMAX =   48.301030 ZAVE =   48.301030
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "54.7138488"
Evaluating: 54.7138488+3.5
 Parameter: XMAX <- "58.2138488"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-55.9365676"
Evaluating: -55.9365676+3.5
 Parameter: YMAX <- "-52.4365676"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.3010298"
Evaluating: 48.3010298+3.5
 Parameter: ZMAX <- "51.8010298"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "54.7138488"
Evaluating: 54.7138488-3.5
 Parameter: XMIN <- "51.2138488"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-55.9365676"
Evaluating: -55.9365676-3.5
 Parameter: YMIN <- "-59.4365676"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.3010298"
Evaluating: 48.3010298-3.5
 Parameter: ZMIN <- "44.8010298"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "58.2138488"
 Parameter: XMIN -> "51.2138488"
 Parameter: YMAX -> "-52.4365676"
 Parameter: YMIN -> "-59.4365676"
 Parameter: ZMAX -> "51.8010298"
 Parameter: ZMIN -> "44.8010298"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "202"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "202" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "202"
Evaluating: 202
 Parameter: J <- "202"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "202" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "202"
 Parameter: NPOS -> "143"
Evaluating: 202-143
 Parameter: J <- "59"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.485563452"
Evaluating: 125.050557*(0.485563452-0.5)
 Parameter: XPOS <- "-1.80529837"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.817630262"
Evaluating: 125.050557*(0.817630262-0.5)
 Parameter: YPOS <- "39.7198412"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.45302412"
Evaluating: 152.572525*(0.45302412-0.5)+-4.51585405
 Parameter: ZPOS <- "-11.6830827"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.6830827" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.6830827" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "202"
Evaluating: 202
 Parameter: J <- "202"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "202" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "202"
 Parameter: NPOS -> "143"
Evaluating: 202-143
 Parameter: J <- "59"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.135712607"
Evaluating: 125.050557*(0.135712607-0.5)
 Parameter: XPOS <- "-45.5543414"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.192895156"
Evaluating: 125.050557*(0.192895156-0.5)
 Parameter: YPOS <- "-38.4036318"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.86995497"
Evaluating: 152.572525*(0.86995497-0.5)+-4.51585405
 Parameter: ZPOS <- "51.9291099"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "51.9291099" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "51.9291099" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.5543414"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -45.5543414-0
 Parameter: XTRAN <- "-45.5543414"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.4036318"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.4036318-0
 Parameter: YTRAN <- "-38.4036318"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "51.9291099"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 51.9291099-0
 Parameter: ZTRAN <- "51.9291099"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.5543414"
 Parameter: YTRAN -> "-38.4036318"
 Parameter: ZTRAN -> "51.9291099"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -45.554341  -38.403632   51.929110
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.223448178E-02"
Evaluating: 5.223448178E-02*360.0
 Parameter: XPHI <- "18.8044134"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.544815201"
Evaluating: 0.544815201*360.0
 Parameter: YPHI <- "196.133472"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.201891336"
Evaluating: 0.201891336*360.0
 Parameter: ZPHI <- "72.680881"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.5543414"
 Parameter: YPOS -> "-38.4036318"
 Parameter: ZPOS -> "51.9291099"
 Parameter: XPHI -> "18.8044134"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.946624    0.322339
    0.000000   -0.322339    0.946624

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   18.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.5543414"
 Parameter: YPOS -> "-38.4036318"
 Parameter: ZPOS -> "51.9291099"
 Parameter: YPHI -> "196.133472"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.960617    0.000000    0.277876
    0.000000    1.000000    0.000000
   -0.277876    0.000000   -0.960617

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  163.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.5543414"
 Parameter: YPOS -> "-38.4036318"
 Parameter: ZPOS -> "51.9291099"
 Parameter: ZPHI -> "72.680881"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.297693    0.954662    0.000000
   -0.954662    0.297693    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   72.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.554341 XMAX =  -45.554341 XAVE =  -45.554341
    YMIN =  -38.403632 YMAX =  -38.403632 YAVE =  -38.403632
    ZMIN =   51.929110 ZMAX =   51.929110 ZAVE =   51.929110
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.5543414"
Evaluating: -45.5543414+3.5
 Parameter: XMAX <- "-42.0543414"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.4036318"
Evaluating: -38.4036318+3.5
 Parameter: YMAX <- "-34.9036318"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "51.9291099"
Evaluating: 51.9291099+3.5
 Parameter: ZMAX <- "55.4291099"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.5543414"
Evaluating: -45.5543414-3.5
 Parameter: XMIN <- "-49.0543414"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.4036318"
Evaluating: -38.4036318-3.5
 Parameter: YMIN <- "-41.9036318"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "51.9291099"
Evaluating: 51.9291099-3.5
 Parameter: ZMIN <- "48.4291099"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.0543414"
 Parameter: XMIN -> "-49.0543414"
 Parameter: YMAX -> "-34.9036318"
 Parameter: YMIN -> "-41.9036318"
 Parameter: ZMAX -> "55.4291099"
 Parameter: ZMIN -> "48.4291099"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64617 NEG      CLA      59       CLA     -**** POS      SOD      96       SOD           2.8166
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "202"
Evaluating: 202
 Parameter: J <- "202"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "202" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "202"
 Parameter: NPOS -> "143"
Evaluating: 202-143
 Parameter: J <- "59"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.921932615"
Evaluating: 125.050557*(0.921932615-0.5)
 Parameter: XPOS <- "52.7629085"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.638217452"
Evaluating: 125.050557*(0.638217452-0.5)
 Parameter: YPOS <- "17.2841694"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.485339968"
Evaluating: 152.572525*(0.485339968-0.5)+-4.51585405
 Parameter: ZPOS <- "-6.75257215"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.75257215" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.75257215" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "202"
Evaluating: 202
 Parameter: J <- "202"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "202" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "202"
 Parameter: NPOS -> "143"
Evaluating: 202-143
 Parameter: J <- "59"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.757640255E-02"
Evaluating: 125.050557*(9.757640255E-02-0.5)
 Parameter: XPOS <- "-50.323295"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.310805949"
Evaluating: 125.050557*(0.310805949-0.5)
 Parameter: YPOS <- "-23.6588215"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.371845311"
Evaluating: 152.572525*(0.371845311-0.5)+-4.51585405
 Parameter: ZPOS <- "-24.0687385"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.0687385" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.554341 XMAX =  -45.554341 XAVE =  -45.554341
    YMIN =  -38.403632 YMAX =  -38.403632 YAVE =  -38.403632
    ZMIN =   51.929110 ZMAX =   51.929110 ZAVE =   51.929110
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.323295"
 RDCMND substituted energy or value "?XAVE" to "-45.5543414"
Evaluating: -50.323295--45.5543414
 Parameter: XTRAN <- "-4.7689536"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.6588215"
 RDCMND substituted energy or value "?YAVE" to "-38.4036318"
Evaluating: -23.6588215--38.4036318
 Parameter: YTRAN <- "14.7448103"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.0687385"
 RDCMND substituted energy or value "?ZAVE" to "51.9291099"
Evaluating: -24.0687385-51.9291099
 Parameter: ZTRAN <- "-75.9978484"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.7689536"
 Parameter: YTRAN -> "14.7448103"
 Parameter: ZTRAN -> "-75.9978484"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -4.768954   14.744810  -75.997848
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.539225769"
Evaluating: 0.539225769*360.0
 Parameter: XPHI <- "194.121277"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.432410196"
Evaluating: 0.432410196*360.0
 Parameter: YPHI <- "155.667671"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.548321486"
Evaluating: 0.548321486*360.0
 Parameter: ZPHI <- "197.395735"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.323295"
 Parameter: YPOS -> "-23.6588215"
 Parameter: ZPOS -> "-24.0687385"
 Parameter: XPHI -> "194.121277"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.969781   -0.243975
    0.000000    0.243975   -0.969781

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  165.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.323295"
 Parameter: YPOS -> "-23.6588215"
 Parameter: ZPOS -> "-24.0687385"
 Parameter: YPHI -> "155.667671"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.911171    0.000000   -0.412029
    0.000000    1.000000    0.000000
    0.412029    0.000000   -0.911171

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  155.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.323295"
 Parameter: YPOS -> "-23.6588215"
 Parameter: ZPOS -> "-24.0687385"
 Parameter: ZPHI -> "197.395735"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.954263   -0.298970    0.000000
    0.298970   -0.954263    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  162.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.323295 XMAX =  -50.323295 XAVE =  -50.323295
    YMIN =  -23.658822 YMAX =  -23.658822 YAVE =  -23.658822
    ZMIN =  -24.068738 ZMAX =  -24.068738 ZAVE =  -24.068738
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.323295"
Evaluating: -50.323295+3.5
 Parameter: XMAX <- "-46.823295"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.6588215"
Evaluating: -23.6588215+3.5
 Parameter: YMAX <- "-20.1588215"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.0687385"
Evaluating: -24.0687385+3.5
 Parameter: ZMAX <- "-20.5687385"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.323295"
Evaluating: -50.323295-3.5
 Parameter: XMIN <- "-53.823295"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.6588215"
Evaluating: -23.6588215-3.5
 Parameter: YMIN <- "-27.1588215"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.0687385"
Evaluating: -24.0687385-3.5
 Parameter: ZMIN <- "-27.5687385"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.823295"
 Parameter: XMIN -> "-53.823295"
 Parameter: YMAX -> "-20.1588215"
 Parameter: YMIN -> "-27.1588215"
 Parameter: ZMAX -> "-20.5687385"
 Parameter: ZMIN -> "-27.5687385"
 SELRPN>      5 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "203"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "203" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "203"
Evaluating: 203
 Parameter: J <- "203"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "203" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "203"
 Parameter: NPOS -> "143"
Evaluating: 203-143
 Parameter: J <- "60"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.645426024"
Evaluating: 125.050557*(0.645426024-0.5)
 Parameter: XPOS <- "18.1856053"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.637482816"
Evaluating: 125.050557*(0.637482816-0.5)
 Parameter: YPOS <- "17.1923027"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.461344395"
Evaluating: 152.572525*(0.461344395-0.5)+-4.51585405
 Parameter: ZPOS <- "-10.4136373"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.4136373" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.4136373" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "203"
Evaluating: 203
 Parameter: J <- "203"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "203" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "203"
 Parameter: NPOS -> "143"
Evaluating: 203-143
 Parameter: J <- "60"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.12098362"
Evaluating: 125.050557*(0.12098362-0.5)
 Parameter: XPOS <- "-47.3962094"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.729416511"
Evaluating: 125.050557*(0.729416511-0.5)
 Parameter: YPOS <- "28.6886625"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.329733443"
Evaluating: 152.572525*(0.329733443-0.5)+-4.51585405
 Parameter: ZPOS <- "-30.4938526"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.4938526" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.3962094"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -47.3962094-0
 Parameter: XTRAN <- "-47.3962094"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.6886625"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.6886625-0
 Parameter: YTRAN <- "28.6886625"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.4938526"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.4938526-0
 Parameter: ZTRAN <- "-30.4938526"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.3962094"
 Parameter: YTRAN -> "28.6886625"
 Parameter: ZTRAN -> "-30.4938526"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -47.396209   28.688662  -30.493853
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.140558194"
Evaluating: 0.140558194*360.0
 Parameter: XPHI <- "50.6009498"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.7746999"
Evaluating: 0.7746999*360.0
 Parameter: YPHI <- "278.891964"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.581845998"
Evaluating: 0.581845998*360.0
 Parameter: ZPHI <- "209.464559"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.3962094"
 Parameter: YPOS -> "28.6886625"
 Parameter: ZPOS -> "-30.4938526"
 Parameter: XPHI -> "50.6009498"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.634718    0.772744
    0.000000   -0.772744    0.634718

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   50.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.3962094"
 Parameter: YPOS -> "28.6886625"
 Parameter: ZPOS -> "-30.4938526"
 Parameter: YPHI -> "278.891964"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.154572    0.000000    0.987982
    0.000000    1.000000    0.000000
   -0.987982    0.000000    0.154572

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   81.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.3962094"
 Parameter: YPOS -> "28.6886625"
 Parameter: ZPOS -> "-30.4938526"
 Parameter: ZPHI -> "209.464559"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.870660   -0.491885    0.000000
    0.491885   -0.870660    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  150.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.396209 XMAX =  -47.396209 XAVE =  -47.396209
    YMIN =   28.688662 YMAX =   28.688662 YAVE =   28.688662
    ZMIN =  -30.493853 ZMAX =  -30.493853 ZAVE =  -30.493853
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.3962094"
Evaluating: -47.3962094+3.5
 Parameter: XMAX <- "-43.8962094"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.6886625"
Evaluating: 28.6886625+3.5
 Parameter: YMAX <- "32.1886625"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.4938526"
Evaluating: -30.4938526+3.5
 Parameter: ZMAX <- "-26.9938526"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.3962094"
Evaluating: -47.3962094-3.5
 Parameter: XMIN <- "-50.8962094"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.6886625"
Evaluating: 28.6886625-3.5
 Parameter: YMIN <- "25.1886625"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.4938526"
Evaluating: -30.4938526-3.5
 Parameter: ZMIN <- "-33.9938526"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-43.8962094"
 Parameter: XMIN -> "-50.8962094"
 Parameter: YMAX -> "32.1886625"
 Parameter: YMIN -> "25.1886625"
 Parameter: ZMAX -> "-26.9938526"
 Parameter: ZMIN -> "-33.9938526"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "204"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "204" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "204"
Evaluating: 204
 Parameter: J <- "204"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "204" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "204"
 Parameter: NPOS -> "143"
Evaluating: 204-143
 Parameter: J <- "61"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.480613014"
Evaluating: 125.050557*(0.480613014-0.5)
 Parameter: XPOS <- "-2.4243534"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.723273561"
Evaluating: 125.050557*(0.723273561-0.5)
 Parameter: YPOS <- "27.9204832"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.848179985"
Evaluating: 152.572525*(0.848179985-0.5)+-4.51585405
 Parameter: ZPOS <- "48.6068454"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.6068454" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.6068454" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.4243534"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.4243534-0
 Parameter: XTRAN <- "-2.4243534"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.9204832"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.9204832-0
 Parameter: YTRAN <- "27.9204832"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.6068454"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 48.6068454-0
 Parameter: ZTRAN <- "48.6068454"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.4243534"
 Parameter: YTRAN -> "27.9204832"
 Parameter: ZTRAN -> "48.6068454"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -2.424353   27.920483   48.606845
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.752165047"
Evaluating: 0.752165047*360.0
 Parameter: XPHI <- "270.779417"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.479042523"
Evaluating: 0.479042523*360.0
 Parameter: YPHI <- "172.455308"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.483834877"
Evaluating: 0.483834877*360.0
 Parameter: ZPHI <- "174.180556"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.4243534"
 Parameter: YPOS -> "27.9204832"
 Parameter: ZPOS -> "48.6068454"
 Parameter: XPHI -> "270.779417"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.013603   -0.999907
    0.000000    0.999907    0.013603

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   89.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.4243534"
 Parameter: YPOS -> "27.9204832"
 Parameter: ZPOS -> "48.6068454"
 Parameter: YPHI -> "172.455308"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.991343    0.000000   -0.131300
    0.000000    1.000000    0.000000
    0.131300    0.000000   -0.991343

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  172.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.4243534"
 Parameter: YPOS -> "27.9204832"
 Parameter: ZPOS -> "48.6068454"
 Parameter: ZPHI -> "174.180556"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.994846    0.101394    0.000000
   -0.101394   -0.994846    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  174.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.424353 XMAX =   -2.424353 XAVE =   -2.424353
    YMIN =   27.920483 YMAX =   27.920483 YAVE =   27.920483
    ZMIN =   48.606845 ZMAX =   48.606845 ZAVE =   48.606845
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.4243534"
Evaluating: -2.4243534+3.5
 Parameter: XMAX <- "1.0756466"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.9204832"
Evaluating: 27.9204832+3.5
 Parameter: YMAX <- "31.4204832"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.6068454"
Evaluating: 48.6068454+3.5
 Parameter: ZMAX <- "52.1068454"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.4243534"
Evaluating: -2.4243534-3.5
 Parameter: XMIN <- "-5.9243534"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.9204832"
Evaluating: 27.9204832-3.5
 Parameter: YMIN <- "24.4204832"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.6068454"
Evaluating: 48.6068454-3.5
 Parameter: ZMIN <- "45.1068454"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.0756466"
 Parameter: XMIN -> "-5.9243534"
 Parameter: YMAX -> "31.4204832"
 Parameter: YMIN -> "24.4204832"
 Parameter: ZMAX -> "52.1068454"
 Parameter: ZMIN -> "45.1068454"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "205"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "205" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "205"
Evaluating: 205
 Parameter: J <- "205"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "205" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "205"
 Parameter: NPOS -> "143"
Evaluating: 205-143
 Parameter: J <- "62"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.607788272"
Evaluating: 125.050557*(0.607788272-0.5)
 Parameter: XPOS <- "13.4789835"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.333045468"
Evaluating: 125.050557*(0.333045468-0.5)
 Parameter: YPOS <- "-20.8777572"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.346862924"
Evaluating: 152.572525*(0.346862924-0.5)+-4.51585405
 Parameter: ZPOS <- "-27.8803644"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.8803644" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.4789835"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.4789835-0
 Parameter: XTRAN <- "13.4789835"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.8777572"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.8777572-0
 Parameter: YTRAN <- "-20.8777572"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.8803644"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.8803644-0
 Parameter: ZTRAN <- "-27.8803644"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.4789835"
 Parameter: YTRAN -> "-20.8777572"
 Parameter: ZTRAN -> "-27.8803644"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    13.478984  -20.877757  -27.880364
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.239810929"
Evaluating: 0.239810929*360.0
 Parameter: XPHI <- "86.3319344"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.784875651"
Evaluating: 0.784875651*360.0
 Parameter: YPHI <- "282.555234"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.973934355"
Evaluating: 0.973934355*360.0
 Parameter: ZPHI <- "350.616368"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.4789835"
 Parameter: YPOS -> "-20.8777572"
 Parameter: ZPOS -> "-27.8803644"
 Parameter: XPHI -> "86.3319344"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.063976    0.997951
    0.000000   -0.997951    0.063976

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   86.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.4789835"
 Parameter: YPOS -> "-20.8777572"
 Parameter: ZPOS -> "-27.8803644"
 Parameter: YPHI -> "282.555234"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.217381    0.000000    0.976087
    0.000000    1.000000    0.000000
   -0.976087    0.000000    0.217381

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   77.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.4789835"
 Parameter: YPOS -> "-20.8777572"
 Parameter: ZPOS -> "-27.8803644"
 Parameter: ZPHI -> "350.616368"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.986619   -0.163044    0.000000
    0.163044    0.986619    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    9.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.478984 XMAX =   13.478984 XAVE =   13.478984
    YMIN =  -20.877757 YMAX =  -20.877757 YAVE =  -20.877757
    ZMIN =  -27.880364 ZMAX =  -27.880364 ZAVE =  -27.880364
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.4789835"
Evaluating: 13.4789835+3.5
 Parameter: XMAX <- "16.9789835"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.8777572"
Evaluating: -20.8777572+3.5
 Parameter: YMAX <- "-17.3777572"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.8803644"
Evaluating: -27.8803644+3.5
 Parameter: ZMAX <- "-24.3803644"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.4789835"
Evaluating: 13.4789835-3.5
 Parameter: XMIN <- "9.9789835"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.8777572"
Evaluating: -20.8777572-3.5
 Parameter: YMIN <- "-24.3777572"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.8803644"
Evaluating: -27.8803644-3.5
 Parameter: ZMIN <- "-31.3803644"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.9789835"
 Parameter: XMIN -> "9.9789835"
 Parameter: YMAX -> "-17.3777572"
 Parameter: YMIN -> "-24.3777572"
 Parameter: ZMAX -> "-24.3803644"
 Parameter: ZMIN -> "-31.3803644"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "206"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "206" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "206"
Evaluating: 206
 Parameter: J <- "206"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "206" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "206"
 Parameter: NPOS -> "143"
Evaluating: 206-143
 Parameter: J <- "63"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.731230885"
Evaluating: 125.050557*(0.731230885-0.5)
 Parameter: XPOS <- "28.915551"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.141399517"
Evaluating: 125.050557*(0.141399517-0.5)
 Parameter: YPOS <- "-44.8431901"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.521307309"
Evaluating: 152.572525*(0.521307309-0.5)+-4.51585405
 Parameter: ZPOS <- "-1.26494411"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.26494411" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.26494411" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "206"
Evaluating: 206
 Parameter: J <- "206"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "206" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "206"
 Parameter: NPOS -> "143"
Evaluating: 206-143
 Parameter: J <- "63"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.4714697E-02"
Evaluating: 125.050557*(1.4714697E-02-0.5)
 Parameter: XPOS <- "-60.6851974"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.719115137"
Evaluating: 125.050557*(0.719115137-0.5)
 Parameter: YPOS <- "27.4004699"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "7.142191317E-02"
Evaluating: 152.572525*(7.142191317E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-69.9050949"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-69.9050949" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-60.6851974"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -60.6851974-0
 Parameter: XTRAN <- "-60.6851974"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.4004699"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.4004699-0
 Parameter: YTRAN <- "27.4004699"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-69.9050949"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -69.9050949-0
 Parameter: ZTRAN <- "-69.9050949"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-60.6851974"
 Parameter: YTRAN -> "27.4004699"
 Parameter: ZTRAN -> "-69.9050949"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -60.685197   27.400470  -69.905095
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.696903919E-02"
Evaluating: 1.696903919E-02*360.0
 Parameter: XPHI <- "6.10885411"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.017561233E-02"
Evaluating: 1.017561233E-02*360.0
 Parameter: YPHI <- "3.66322044"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.839977324E-02"
Evaluating: 5.839977324E-02*360.0
 Parameter: ZPHI <- "21.0239184"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-60.6851974"
 Parameter: YPOS -> "27.4004699"
 Parameter: ZPOS -> "-69.9050949"
 Parameter: XPHI -> "6.10885411"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.994322    0.106418
    0.000000   -0.106418    0.994322

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    6.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-60.6851974"
 Parameter: YPOS -> "27.4004699"
 Parameter: ZPOS -> "-69.9050949"
 Parameter: YPHI -> "3.66322044"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.997957    0.000000   -0.063892
    0.000000    1.000000    0.000000
    0.063892    0.000000    0.997957

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    3.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-60.6851974"
 Parameter: YPOS -> "27.4004699"
 Parameter: ZPOS -> "-69.9050949"
 Parameter: ZPHI -> "21.0239184"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.933431    0.358758    0.000000
   -0.358758    0.933431    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   21.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -60.685197 XMAX =  -60.685197 XAVE =  -60.685197
    YMIN =   27.400470 YMAX =   27.400470 YAVE =   27.400470
    ZMIN =  -69.905095 ZMAX =  -69.905095 ZAVE =  -69.905095
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-60.6851974"
Evaluating: -60.6851974+3.5
 Parameter: XMAX <- "-57.1851974"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.4004699"
Evaluating: 27.4004699+3.5
 Parameter: YMAX <- "30.9004699"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-69.9050949"
Evaluating: -69.9050949+3.5
 Parameter: ZMAX <- "-66.4050949"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-60.6851974"
Evaluating: -60.6851974-3.5
 Parameter: XMIN <- "-64.1851974"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.4004699"
Evaluating: 27.4004699-3.5
 Parameter: YMIN <- "23.9004699"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-69.9050949"
Evaluating: -69.9050949-3.5
 Parameter: ZMIN <- "-73.4050949"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-57.1851974"
 Parameter: XMIN -> "-64.1851974"
 Parameter: YMAX -> "30.9004699"
 Parameter: YMIN -> "23.9004699"
 Parameter: ZMAX -> "-66.4050949"
 Parameter: ZMIN -> "-73.4050949"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "207"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "207" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "207"
Evaluating: 207
 Parameter: J <- "207"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "207" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "207"
 Parameter: NPOS -> "143"
Evaluating: 207-143
 Parameter: J <- "64"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.632326735"
Evaluating: 125.050557*(0.632326735-0.5)
 Parameter: XPOS <- "16.5475319"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.336997953"
Evaluating: 125.050557*(0.336997953-0.5)
 Parameter: YPOS <- "-20.3834968"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.857102514"
Evaluating: 152.572525*(0.857102514-0.5)+-4.51585405
 Parameter: ZPOS <- "49.9681782"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.9681782" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.9681782" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.5475319"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 16.5475319-0
 Parameter: XTRAN <- "16.5475319"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.3834968"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.3834968-0
 Parameter: YTRAN <- "-20.3834968"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.9681782"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.9681782-0
 Parameter: ZTRAN <- "49.9681782"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.5475319"
 Parameter: YTRAN -> "-20.3834968"
 Parameter: ZTRAN -> "49.9681782"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    16.547532  -20.383497   49.968178
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.045989038E-02"
Evaluating: 1.045989038E-02*360.0
 Parameter: XPHI <- "3.76556054"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.357878229"
Evaluating: 0.357878229*360.0
 Parameter: YPHI <- "128.836162"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.436771449"
Evaluating: 0.436771449*360.0
 Parameter: ZPHI <- "157.237722"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.5475319"
 Parameter: YPOS -> "-20.3834968"
 Parameter: ZPOS -> "49.9681782"
 Parameter: XPHI -> "3.76556054"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997841    0.065674
    0.000000   -0.065674    0.997841

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.5475319"
 Parameter: YPOS -> "-20.3834968"
 Parameter: ZPOS -> "49.9681782"
 Parameter: YPHI -> "128.836162"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.627096    0.000000   -0.778942
    0.000000    1.000000    0.000000
    0.778942    0.000000   -0.627096

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  128.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.5475319"
 Parameter: YPOS -> "-20.3834968"
 Parameter: ZPOS -> "49.9681782"
 Parameter: ZPHI -> "157.237722"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.922118    0.386909    0.000000
   -0.386909   -0.922118    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  157.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.547532 XMAX =   16.547532 XAVE =   16.547532
    YMIN =  -20.383497 YMAX =  -20.383497 YAVE =  -20.383497
    ZMIN =   49.968178 ZMAX =   49.968178 ZAVE =   49.968178
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.5475319"
Evaluating: 16.5475319+3.5
 Parameter: XMAX <- "20.0475319"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.3834968"
Evaluating: -20.3834968+3.5
 Parameter: YMAX <- "-16.8834968"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.9681782"
Evaluating: 49.9681782+3.5
 Parameter: ZMAX <- "53.4681782"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.5475319"
Evaluating: 16.5475319-3.5
 Parameter: XMIN <- "13.0475319"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.3834968"
Evaluating: -20.3834968-3.5
 Parameter: YMIN <- "-23.8834968"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.9681782"
Evaluating: 49.9681782-3.5
 Parameter: ZMIN <- "46.4681782"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.0475319"
 Parameter: XMIN -> "13.0475319"
 Parameter: YMAX -> "-16.8834968"
 Parameter: YMIN -> "-23.8834968"
 Parameter: ZMAX -> "53.4681782"
 Parameter: ZMIN -> "46.4681782"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "208"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "208" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "208"
Evaluating: 208
 Parameter: J <- "208"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "208" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "208"
 Parameter: NPOS -> "143"
Evaluating: 208-143
 Parameter: J <- "65"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.972873637"
Evaluating: 125.050557*(0.972873637-0.5)
 Parameter: XPOS <- "59.1331117"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.122544168"
Evaluating: 125.050557*(0.122544168-0.5)
 Parameter: YPOS <- "-47.201062"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.753275283"
Evaluating: 152.572525*(0.753275283-0.5)+-4.51585405
 Parameter: ZPOS <- "34.1269954"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.1269954" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.1269954" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "59.1331117"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 59.1331117-0
 Parameter: XTRAN <- "59.1331117"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.201062"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.201062-0
 Parameter: YTRAN <- "-47.201062"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.1269954"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.1269954-0
 Parameter: ZTRAN <- "34.1269954"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "59.1331117"
 Parameter: YTRAN -> "-47.201062"
 Parameter: ZTRAN -> "34.1269954"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    59.133112  -47.201062   34.126995
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.889017366"
Evaluating: 0.889017366*360.0
 Parameter: XPHI <- "320.046252"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.402103008"
Evaluating: 0.402103008*360.0
 Parameter: YPHI <- "144.757083"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.239093279"
Evaluating: 0.239093279*360.0
 Parameter: ZPHI <- "86.0735804"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "59.1331117"
 Parameter: YPOS -> "-47.201062"
 Parameter: ZPOS -> "34.1269954"
 Parameter: XPHI -> "320.046252"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.766563   -0.642169
    0.000000    0.642169    0.766563

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   39.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "59.1331117"
 Parameter: YPOS -> "-47.201062"
 Parameter: ZPOS -> "34.1269954"
 Parameter: YPHI -> "144.757083"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.816713    0.000000   -0.577044
    0.000000    1.000000    0.000000
    0.577044    0.000000   -0.816713

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  144.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "59.1331117"
 Parameter: YPOS -> "-47.201062"
 Parameter: ZPOS -> "34.1269954"
 Parameter: ZPHI -> "86.0735804"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.068475    0.997653    0.000000
   -0.997653    0.068475    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   86.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   59.133112 XMAX =   59.133112 XAVE =   59.133112
    YMIN =  -47.201062 YMAX =  -47.201062 YAVE =  -47.201062
    ZMIN =   34.126995 ZMAX =   34.126995 ZAVE =   34.126995
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "59.1331117"
Evaluating: 59.1331117+3.5
 Parameter: XMAX <- "62.6331117"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.201062"
Evaluating: -47.201062+3.5
 Parameter: YMAX <- "-43.701062"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.1269954"
Evaluating: 34.1269954+3.5
 Parameter: ZMAX <- "37.6269954"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "59.1331117"
Evaluating: 59.1331117-3.5
 Parameter: XMIN <- "55.6331117"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.201062"
Evaluating: -47.201062-3.5
 Parameter: YMIN <- "-50.701062"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.1269954"
Evaluating: 34.1269954-3.5
 Parameter: ZMIN <- "30.6269954"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "62.6331117"
 Parameter: XMIN -> "55.6331117"
 Parameter: YMAX -> "-43.701062"
 Parameter: YMIN -> "-50.701062"
 Parameter: ZMAX -> "37.6269954"
 Parameter: ZMIN -> "30.6269954"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "209"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "209" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "209"
Evaluating: 209
 Parameter: J <- "209"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "209" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "209"
 Parameter: NPOS -> "143"
Evaluating: 209-143
 Parameter: J <- "66"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.905769526"
Evaluating: 125.050557*(0.905769526-0.5)
 Parameter: XPOS <- "50.7417052"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.702791081"
Evaluating: 125.050557*(0.702791081-0.5)
 Parameter: YPOS <- "25.3591376"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.192619112"
Evaluating: 152.572525*(0.192619112-0.5)+-4.51585405
 Parameter: ZPOS <- "-51.4137323"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.4137323" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.7417052"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 50.7417052-0
 Parameter: XTRAN <- "50.7417052"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.3591376"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.3591376-0
 Parameter: YTRAN <- "25.3591376"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.4137323"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.4137323-0
 Parameter: ZTRAN <- "-51.4137323"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.7417052"
 Parameter: YTRAN -> "25.3591376"
 Parameter: ZTRAN -> "-51.4137323"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    50.741705   25.359138  -51.413732
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.460785154"
Evaluating: 0.460785154*360.0
 Parameter: XPHI <- "165.882655"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.409059851"
Evaluating: 0.409059851*360.0
 Parameter: YPHI <- "147.261546"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.834852196"
Evaluating: 0.834852196*360.0
 Parameter: ZPHI <- "300.546791"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.7417052"
 Parameter: YPOS -> "25.3591376"
 Parameter: ZPOS -> "-51.4137323"
 Parameter: XPHI -> "165.882655"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.969798    0.243909
    0.000000   -0.243909   -0.969798

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  165.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.7417052"
 Parameter: YPOS -> "25.3591376"
 Parameter: ZPOS -> "-51.4137323"
 Parameter: YPHI -> "147.261546"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.841148    0.000000   -0.540805
    0.000000    1.000000    0.000000
    0.540805    0.000000   -0.841148

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  147.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.7417052"
 Parameter: YPOS -> "25.3591376"
 Parameter: ZPOS -> "-51.4137323"
 Parameter: ZPHI -> "300.546791"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.508242   -0.861214    0.000000
    0.861214    0.508242    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   59.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.741705 XMAX =   50.741705 XAVE =   50.741705
    YMIN =   25.359138 YMAX =   25.359138 YAVE =   25.359138
    ZMIN =  -51.413732 ZMAX =  -51.413732 ZAVE =  -51.413732
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.7417052"
Evaluating: 50.7417052+3.5
 Parameter: XMAX <- "54.2417052"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.3591376"
Evaluating: 25.3591376+3.5
 Parameter: YMAX <- "28.8591376"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.4137323"
Evaluating: -51.4137323+3.5
 Parameter: ZMAX <- "-47.9137323"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.7417052"
Evaluating: 50.7417052-3.5
 Parameter: XMIN <- "47.2417052"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.3591376"
Evaluating: 25.3591376-3.5
 Parameter: YMIN <- "21.8591376"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.4137323"
Evaluating: -51.4137323-3.5
 Parameter: ZMIN <- "-54.9137323"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "54.2417052"
 Parameter: XMIN -> "47.2417052"
 Parameter: YMAX -> "28.8591376"
 Parameter: YMIN -> "21.8591376"
 Parameter: ZMAX -> "-47.9137323"
 Parameter: ZMIN -> "-54.9137323"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "210"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "210" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "210"
Evaluating: 210
 Parameter: J <- "210"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "210" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "210"
 Parameter: NPOS -> "143"
Evaluating: 210-143
 Parameter: J <- "67"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.2403281"
Evaluating: 125.050557*(0.2403281-0.5)
 Parameter: XPOS <- "-32.4721157"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.390204898"
Evaluating: 125.050557*(0.390204898-0.5)
 Parameter: YPOS <- "-13.7299387"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.860085826"
Evaluating: 152.572525*(0.860085826-0.5)+-4.51585405
 Parameter: ZPOS <- "50.4233496"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.4233496" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.4233496" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.4721157"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.4721157-0
 Parameter: XTRAN <- "-32.4721157"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.7299387"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.7299387-0
 Parameter: YTRAN <- "-13.7299387"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.4233496"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 50.4233496-0
 Parameter: ZTRAN <- "50.4233496"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.4721157"
 Parameter: YTRAN -> "-13.7299387"
 Parameter: ZTRAN -> "50.4233496"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -32.472116  -13.729939   50.423350
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.865175209"
Evaluating: 0.865175209*360.0
 Parameter: XPHI <- "311.463075"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.951760644"
Evaluating: 0.951760644*360.0
 Parameter: YPHI <- "342.633832"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.530602993"
Evaluating: 0.530602993*360.0
 Parameter: ZPHI <- "191.017077"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.4721157"
 Parameter: YPOS -> "-13.7299387"
 Parameter: ZPOS -> "50.4233496"
 Parameter: XPHI -> "311.463075"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.662137   -0.749383
    0.000000    0.749383    0.662137

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   48.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.4721157"
 Parameter: YPOS -> "-13.7299387"
 Parameter: ZPOS -> "50.4233496"
 Parameter: YPHI -> "342.633832"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.954417    0.000000    0.298477
    0.000000    1.000000    0.000000
   -0.298477    0.000000    0.954417

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   17.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.4721157"
 Parameter: YPOS -> "-13.7299387"
 Parameter: ZPOS -> "50.4233496"
 Parameter: ZPHI -> "191.017077"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.981570   -0.191102    0.000000
    0.191102   -0.981570    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  168.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.472116 XMAX =  -32.472116 XAVE =  -32.472116
    YMIN =  -13.729939 YMAX =  -13.729939 YAVE =  -13.729939
    ZMIN =   50.423350 ZMAX =   50.423350 ZAVE =   50.423350
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.4721157"
Evaluating: -32.4721157+3.5
 Parameter: XMAX <- "-28.9721157"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.7299387"
Evaluating: -13.7299387+3.5
 Parameter: YMAX <- "-10.2299387"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.4233496"
Evaluating: 50.4233496+3.5
 Parameter: ZMAX <- "53.9233496"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.4721157"
Evaluating: -32.4721157-3.5
 Parameter: XMIN <- "-35.9721157"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.7299387"
Evaluating: -13.7299387-3.5
 Parameter: YMIN <- "-17.2299387"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.4233496"
Evaluating: 50.4233496-3.5
 Parameter: ZMIN <- "46.9233496"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.9721157"
 Parameter: XMIN -> "-35.9721157"
 Parameter: YMAX -> "-10.2299387"
 Parameter: YMIN -> "-17.2299387"
 Parameter: ZMAX -> "53.9233496"
 Parameter: ZMIN -> "46.9233496"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "211"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "211" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "211"
Evaluating: 211
 Parameter: J <- "211"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "211" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "211"
 Parameter: NPOS -> "143"
Evaluating: 211-143
 Parameter: J <- "68"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.501187836"
Evaluating: 125.050557*(0.501187836-0.5)
 Parameter: XPOS <- "0.148539553"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.992520048"
Evaluating: 125.050557*(0.992520048-0.5)
 Parameter: YPOS <- "61.5899063"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.242904654"
Evaluating: 152.572525*(0.242904654-0.5)+-4.51585405
 Parameter: ZPOS <- "-43.7415402"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.7415402" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.148539553"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 0.148539553-0
 Parameter: XTRAN <- "0.148539553"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "61.5899063"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 61.5899063-0
 Parameter: YTRAN <- "61.5899063"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.7415402"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.7415402-0
 Parameter: ZTRAN <- "-43.7415402"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.148539553"
 Parameter: YTRAN -> "61.5899063"
 Parameter: ZTRAN -> "-43.7415402"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     0.148540   61.589906  -43.741540
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.156814665"
Evaluating: 0.156814665*360.0
 Parameter: XPHI <- "56.4532794"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.469170901"
Evaluating: 0.469170901*360.0
 Parameter: YPHI <- "168.901524"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.314465906E-02"
Evaluating: 8.314465906E-02*360.0
 Parameter: ZPHI <- "29.9320773"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.148539553"
 Parameter: YPOS -> "61.5899063"
 Parameter: ZPOS -> "-43.7415402"
 Parameter: XPHI -> "56.4532794"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.552617    0.833435
    0.000000   -0.833435    0.552617

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   56.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.148539553"
 Parameter: YPOS -> "61.5899063"
 Parameter: ZPOS -> "-43.7415402"
 Parameter: YPHI -> "168.901524"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.981298    0.000000   -0.192496
    0.000000    1.000000    0.000000
    0.192496    0.000000   -0.981298

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  168.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.148539553"
 Parameter: YPOS -> "61.5899063"
 Parameter: ZPOS -> "-43.7415402"
 Parameter: ZPHI -> "29.9320773"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.866618    0.498973    0.000000
   -0.498973    0.866618    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   29.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.148540 XMAX =    0.148540 XAVE =    0.148540
    YMIN =   61.589906 YMAX =   61.589906 YAVE =   61.589906
    ZMIN =  -43.741540 ZMAX =  -43.741540 ZAVE =  -43.741540
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.148539553"
Evaluating: 0.148539553+3.5
 Parameter: XMAX <- "3.64853955"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "61.5899063"
Evaluating: 61.5899063+3.5
 Parameter: YMAX <- "65.0899063"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.7415402"
Evaluating: -43.7415402+3.5
 Parameter: ZMAX <- "-40.2415402"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.148539553"
Evaluating: 0.148539553-3.5
 Parameter: XMIN <- "-3.35146045"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "61.5899063"
Evaluating: 61.5899063-3.5
 Parameter: YMIN <- "58.0899063"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.7415402"
Evaluating: -43.7415402-3.5
 Parameter: ZMIN <- "-47.2415402"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.64853955"
 Parameter: XMIN -> "-3.35146045"
 Parameter: YMAX -> "65.0899063"
 Parameter: YMIN -> "58.0899063"
 Parameter: ZMAX -> "-40.2415402"
 Parameter: ZMIN -> "-47.2415402"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "212"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "212" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "212"
Evaluating: 212
 Parameter: J <- "212"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "212" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "212"
 Parameter: NPOS -> "143"
Evaluating: 212-143
 Parameter: J <- "69"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.989245231"
Evaluating: 125.050557*(0.989245231-0.5)
 Parameter: XPOS <- "61.1803886"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.873068251"
Evaluating: 125.050557*(0.873068251-0.5)
 Parameter: YPOS <- "46.6523926"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.701043306"
Evaluating: 152.572525*(0.701043306-0.5)+-4.51585405
 Parameter: ZPOS <- "26.1578308"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.1578308" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.1578308" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "61.1803886"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 61.1803886-0
 Parameter: XTRAN <- "61.1803886"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.6523926"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 46.6523926-0
 Parameter: YTRAN <- "46.6523926"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.1578308"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.1578308-0
 Parameter: ZTRAN <- "26.1578308"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "61.1803886"
 Parameter: YTRAN -> "46.6523926"
 Parameter: ZTRAN -> "26.1578308"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    61.180389   46.652393   26.157831
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.356100044"
Evaluating: 0.356100044*360.0
 Parameter: XPHI <- "128.196016"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.904643711"
Evaluating: 0.904643711*360.0
 Parameter: YPHI <- "325.671736"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.428947052"
Evaluating: 0.428947052*360.0
 Parameter: ZPHI <- "154.420939"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "61.1803886"
 Parameter: YPOS -> "46.6523926"
 Parameter: ZPOS -> "26.1578308"
 Parameter: XPHI -> "128.196016"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.618354    0.785900
    0.000000   -0.785900   -0.618354

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  128.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "61.1803886"
 Parameter: YPOS -> "46.6523926"
 Parameter: ZPOS -> "26.1578308"
 Parameter: YPHI -> "325.671736"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.825820    0.000000    0.563933
    0.000000    1.000000    0.000000
   -0.563933    0.000000    0.825820

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   34.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "61.1803886"
 Parameter: YPOS -> "46.6523926"
 Parameter: ZPOS -> "26.1578308"
 Parameter: ZPHI -> "154.420939"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.901990    0.431756    0.000000
   -0.431756   -0.901990    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  154.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   61.180389 XMAX =   61.180389 XAVE =   61.180389
    YMIN =   46.652393 YMAX =   46.652393 YAVE =   46.652393
    ZMIN =   26.157831 ZMAX =   26.157831 ZAVE =   26.157831
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "61.1803886"
Evaluating: 61.1803886+3.5
 Parameter: XMAX <- "64.6803886"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.6523926"
Evaluating: 46.6523926+3.5
 Parameter: YMAX <- "50.1523926"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.1578308"
Evaluating: 26.1578308+3.5
 Parameter: ZMAX <- "29.6578308"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "61.1803886"
Evaluating: 61.1803886-3.5
 Parameter: XMIN <- "57.6803886"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.6523926"
Evaluating: 46.6523926-3.5
 Parameter: YMIN <- "43.1523926"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.1578308"
Evaluating: 26.1578308-3.5
 Parameter: ZMIN <- "22.6578308"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "64.6803886"
 Parameter: XMIN -> "57.6803886"
 Parameter: YMAX -> "50.1523926"
 Parameter: YMIN -> "43.1523926"
 Parameter: ZMAX -> "29.6578308"
 Parameter: ZMIN -> "22.6578308"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "213"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "213" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "213"
Evaluating: 213
 Parameter: J <- "213"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "213" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "213"
 Parameter: NPOS -> "143"
Evaluating: 213-143
 Parameter: J <- "70"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.140117184"
Evaluating: 125.050557*(0.140117184-0.5)
 Parameter: XPOS <- "-45.0035466"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.124342686"
Evaluating: 125.050557*(0.124342686-0.5)
 Parameter: YPOS <- "-46.9761564"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.903996767"
Evaluating: 152.572525*(0.903996767-0.5)+-4.51585405
 Parameter: ZPOS <- "57.1229528"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.1229528" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.1229528" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.0035466"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -45.0035466-0
 Parameter: XTRAN <- "-45.0035466"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.9761564"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.9761564-0
 Parameter: YTRAN <- "-46.9761564"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.1229528"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.1229528-0
 Parameter: ZTRAN <- "57.1229528"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.0035466"
 Parameter: YTRAN -> "-46.9761564"
 Parameter: ZTRAN -> "57.1229528"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -45.003547  -46.976156   57.122953
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.444218528"
Evaluating: 0.444218528*360.0
 Parameter: XPHI <- "159.91867"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.435947696"
Evaluating: 0.435947696*360.0
 Parameter: YPHI <- "156.941171"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.960779376"
Evaluating: 0.960779376*360.0
 Parameter: ZPHI <- "345.880575"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.0035466"
 Parameter: YPOS -> "-46.9761564"
 Parameter: ZPOS -> "57.1229528"
 Parameter: XPHI -> "159.91867"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.939206    0.343354
    0.000000   -0.343354   -0.939206

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  159.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.0035466"
 Parameter: YPOS -> "-46.9761564"
 Parameter: ZPOS -> "57.1229528"
 Parameter: YPHI -> "156.941171"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.920103    0.000000   -0.391676
    0.000000    1.000000    0.000000
    0.391676    0.000000   -0.920103

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  156.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.0035466"
 Parameter: YPOS -> "-46.9761564"
 Parameter: ZPOS -> "57.1229528"
 Parameter: ZPHI -> "345.880575"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.969789   -0.243944    0.000000
    0.243944    0.969789    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   14.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.003547 XMAX =  -45.003547 XAVE =  -45.003547
    YMIN =  -46.976156 YMAX =  -46.976156 YAVE =  -46.976156
    ZMIN =   57.122953 ZMAX =   57.122953 ZAVE =   57.122953
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.0035466"
Evaluating: -45.0035466+3.5
 Parameter: XMAX <- "-41.5035466"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.9761564"
Evaluating: -46.9761564+3.5
 Parameter: YMAX <- "-43.4761564"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.1229528"
Evaluating: 57.1229528+3.5
 Parameter: ZMAX <- "60.6229528"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.0035466"
Evaluating: -45.0035466-3.5
 Parameter: XMIN <- "-48.5035466"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.9761564"
Evaluating: -46.9761564-3.5
 Parameter: YMIN <- "-50.4761564"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.1229528"
Evaluating: 57.1229528-3.5
 Parameter: ZMIN <- "53.6229528"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.5035466"
 Parameter: XMIN -> "-48.5035466"
 Parameter: YMAX -> "-43.4761564"
 Parameter: YMIN -> "-50.4761564"
 Parameter: ZMAX -> "60.6229528"
 Parameter: ZMIN -> "53.6229528"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "214"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "214" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "214"
Evaluating: 214
 Parameter: J <- "214"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "214" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "214"
 Parameter: NPOS -> "143"
Evaluating: 214-143
 Parameter: J <- "71"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.199688115"
Evaluating: 125.050557*(0.199688115-0.5)
 Parameter: XPOS <- "-37.5541685"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.293663074"
Evaluating: 125.050557*(0.293663074-0.5)
 Parameter: YPOS <- "-25.8025475"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.169618816"
Evaluating: 152.572525*(0.169618816-0.5)+-4.51585405
 Parameter: ZPOS <- "-54.9229455"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.9229455" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.5541685"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -37.5541685-0
 Parameter: XTRAN <- "-37.5541685"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.8025475"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.8025475-0
 Parameter: YTRAN <- "-25.8025475"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.9229455"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.9229455-0
 Parameter: ZTRAN <- "-54.9229455"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.5541685"
 Parameter: YTRAN -> "-25.8025475"
 Parameter: ZTRAN -> "-54.9229455"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -37.554169  -25.802547  -54.922945
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.144961515"
Evaluating: 0.144961515*360.0
 Parameter: XPHI <- "52.1861454"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.164824687"
Evaluating: 0.164824687*360.0
 Parameter: YPHI <- "59.3368873"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.895407596"
Evaluating: 0.895407596*360.0
 Parameter: ZPHI <- "322.346735"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.5541685"
 Parameter: YPOS -> "-25.8025475"
 Parameter: ZPOS -> "-54.9229455"
 Parameter: XPHI -> "52.1861454"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.613098    0.790007
    0.000000   -0.790007    0.613098

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   52.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.5541685"
 Parameter: YPOS -> "-25.8025475"
 Parameter: ZPOS -> "-54.9229455"
 Parameter: YPHI -> "59.3368873"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.509989    0.000000   -0.860181
    0.000000    1.000000    0.000000
    0.860181    0.000000    0.509989

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   59.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.5541685"
 Parameter: YPOS -> "-25.8025475"
 Parameter: ZPOS -> "-54.9229455"
 Parameter: ZPHI -> "322.346735"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.791722   -0.610881    0.000000
    0.610881    0.791722    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   37.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.554169 XMAX =  -37.554169 XAVE =  -37.554169
    YMIN =  -25.802547 YMAX =  -25.802547 YAVE =  -25.802547
    ZMIN =  -54.922945 ZMAX =  -54.922945 ZAVE =  -54.922945
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.5541685"
Evaluating: -37.5541685+3.5
 Parameter: XMAX <- "-34.0541685"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.8025475"
Evaluating: -25.8025475+3.5
 Parameter: YMAX <- "-22.3025475"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.9229455"
Evaluating: -54.9229455+3.5
 Parameter: ZMAX <- "-51.4229455"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.5541685"
Evaluating: -37.5541685-3.5
 Parameter: XMIN <- "-41.0541685"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.8025475"
Evaluating: -25.8025475-3.5
 Parameter: YMIN <- "-29.3025475"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.9229455"
Evaluating: -54.9229455-3.5
 Parameter: ZMIN <- "-58.4229455"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.0541685"
 Parameter: XMIN -> "-41.0541685"
 Parameter: YMAX -> "-22.3025475"
 Parameter: YMIN -> "-29.3025475"
 Parameter: ZMAX -> "-51.4229455"
 Parameter: ZMIN -> "-58.4229455"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "215"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "215" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "215"
Evaluating: 215
 Parameter: J <- "215"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "215" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "215"
 Parameter: NPOS -> "143"
Evaluating: 215-143
 Parameter: J <- "72"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.894098226"
Evaluating: 125.050557*(0.894098226-0.5)
 Parameter: XPOS <- "49.2822027"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.113655181"
Evaluating: 125.050557*(0.113655181-0.5)
 Parameter: YPOS <- "-48.3126348"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.323310689"
Evaluating: 152.572525*(0.323310689-0.5)+-4.51585405
 Parameter: ZPOS <- "-31.4737884"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.4737884" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.2822027"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.2822027-0
 Parameter: XTRAN <- "49.2822027"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.3126348"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -48.3126348-0
 Parameter: YTRAN <- "-48.3126348"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.4737884"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.4737884-0
 Parameter: ZTRAN <- "-31.4737884"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.2822027"
 Parameter: YTRAN -> "-48.3126348"
 Parameter: ZTRAN -> "-31.4737884"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    49.282203  -48.312635  -31.473788
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.947790077"
Evaluating: 0.947790077*360.0
 Parameter: XPHI <- "341.204428"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.495086373"
Evaluating: 0.495086373*360.0
 Parameter: YPHI <- "178.231094"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.726489822"
Evaluating: 0.726489822*360.0
 Parameter: ZPHI <- "261.536336"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.2822027"
 Parameter: YPOS -> "-48.3126348"
 Parameter: ZPOS -> "-31.4737884"
 Parameter: XPHI -> "341.204428"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.946674   -0.322193
    0.000000    0.322193    0.946674

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   18.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.2822027"
 Parameter: YPOS -> "-48.3126348"
 Parameter: ZPOS -> "-31.4737884"
 Parameter: YPHI -> "178.231094"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.999523    0.000000   -0.030868
    0.000000    1.000000    0.000000
    0.030868    0.000000   -0.999523

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  178.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.2822027"
 Parameter: YPOS -> "-48.3126348"
 Parameter: ZPOS -> "-31.4737884"
 Parameter: ZPHI -> "261.536336"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.147182   -0.989109    0.000000
    0.989109   -0.147182    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   98.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.282203 XMAX =   49.282203 XAVE =   49.282203
    YMIN =  -48.312635 YMAX =  -48.312635 YAVE =  -48.312635
    ZMIN =  -31.473788 ZMAX =  -31.473788 ZAVE =  -31.473788
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.2822027"
Evaluating: 49.2822027+3.5
 Parameter: XMAX <- "52.7822027"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.3126348"
Evaluating: -48.3126348+3.5
 Parameter: YMAX <- "-44.8126348"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.4737884"
Evaluating: -31.4737884+3.5
 Parameter: ZMAX <- "-27.9737884"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.2822027"
Evaluating: 49.2822027-3.5
 Parameter: XMIN <- "45.7822027"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.3126348"
Evaluating: -48.3126348-3.5
 Parameter: YMIN <- "-51.8126348"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.4737884"
Evaluating: -31.4737884-3.5
 Parameter: ZMIN <- "-34.9737884"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.7822027"
 Parameter: XMIN -> "45.7822027"
 Parameter: YMAX -> "-44.8126348"
 Parameter: YMIN -> "-51.8126348"
 Parameter: ZMAX -> "-27.9737884"
 Parameter: ZMIN -> "-34.9737884"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "216"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "216" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "216"
Evaluating: 216
 Parameter: J <- "216"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "216" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "216"
 Parameter: NPOS -> "143"
Evaluating: 216-143
 Parameter: J <- "73"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.474855947"
Evaluating: 125.050557*(0.474855947-0.5)
 Parameter: XPOS <- "-3.14427783"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.17885312"
Evaluating: 125.050557*(0.17885312-0.5)
 Parameter: YPOS <- "-40.1595962"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.666990938"
Evaluating: 152.572525*(0.666990938-0.5)+-4.51585405
 Parameter: ZPOS <- "20.962375"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.962375" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.962375" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.14427783"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -3.14427783-0
 Parameter: XTRAN <- "-3.14427783"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.1595962"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.1595962-0
 Parameter: YTRAN <- "-40.1595962"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.962375"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 20.962375-0
 Parameter: ZTRAN <- "20.962375"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.14427783"
 Parameter: YTRAN -> "-40.1595962"
 Parameter: ZTRAN -> "20.962375"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -3.144278  -40.159596   20.962375
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179668418"
Evaluating: 0.179668418*360.0
 Parameter: XPHI <- "64.6806305"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.887613666"
Evaluating: 0.887613666*360.0
 Parameter: YPHI <- "319.54092"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491428578"
Evaluating: 0.491428578*360.0
 Parameter: ZPHI <- "176.914288"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.14427783"
 Parameter: YPOS -> "-40.1595962"
 Parameter: ZPOS -> "20.962375"
 Parameter: XPHI -> "64.6806305"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.427663    0.903938
    0.000000   -0.903938    0.427663

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.14427783"
 Parameter: YPOS -> "-40.1595962"
 Parameter: ZPOS -> "20.962375"
 Parameter: YPHI -> "319.54092"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.760870    0.000000    0.648905
    0.000000    1.000000    0.000000
   -0.648905    0.000000    0.760870

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   40.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.14427783"
 Parameter: YPOS -> "-40.1595962"
 Parameter: ZPOS -> "20.962375"
 Parameter: ZPHI -> "176.914288"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.998550    0.053830    0.000000
   -0.053830   -0.998550    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.144278 XMAX =   -3.144278 XAVE =   -3.144278
    YMIN =  -40.159596 YMAX =  -40.159596 YAVE =  -40.159596
    ZMIN =   20.962375 ZMAX =   20.962375 ZAVE =   20.962375
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.14427783"
Evaluating: -3.14427783+3.5
 Parameter: XMAX <- "0.35572217"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.1595962"
Evaluating: -40.1595962+3.5
 Parameter: YMAX <- "-36.6595962"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.962375"
Evaluating: 20.962375+3.5
 Parameter: ZMAX <- "24.462375"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.14427783"
Evaluating: -3.14427783-3.5
 Parameter: XMIN <- "-6.64427783"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.1595962"
Evaluating: -40.1595962-3.5
 Parameter: YMIN <- "-43.6595962"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.962375"
Evaluating: 20.962375-3.5
 Parameter: ZMIN <- "17.462375"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.35572217"
 Parameter: XMIN -> "-6.64427783"
 Parameter: YMAX -> "-36.6595962"
 Parameter: YMIN -> "-43.6595962"
 Parameter: ZMAX -> "24.462375"
 Parameter: ZMIN -> "17.462375"
 SELRPN>     14 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      6 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64631 NEG      CLA      73       CLA     -2012 PROA     GLY      156      C             4.6326
64631 NEG      CLA      73       CLA     -2013 PROA     GLY      156      O             4.1630
64631 NEG      CLA      73       CLA     -2014 PROA     ALA      157      N             4.2969
64631 NEG      CLA      73       CLA     -2016 PROA     ALA      157      CA            3.2255
64631 NEG      CLA      73       CLA     -2018 PROA     ALA      157      CB            2.6650
64631 NEG      CLA      73       CLA     -2022 PROA     ALA      157      C             4.2149
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "216"
Evaluating: 216
 Parameter: J <- "216"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "216" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "216"
 Parameter: NPOS -> "143"
Evaluating: 216-143
 Parameter: J <- "73"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.42485507"
Evaluating: 125.050557*(0.42485507-0.5)
 Parameter: XPOS <- "-9.39691535"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.775220252"
Evaluating: 125.050557*(0.775220252-0.5)
 Parameter: YPOS <- "34.4164458"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "3.558650537E-02"
Evaluating: 152.572525*(3.558650537E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-75.3725936"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-75.3725936" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.144278 XMAX =   -3.144278 XAVE =   -3.144278
    YMIN =  -40.159596 YMAX =  -40.159596 YAVE =  -40.159596
    ZMIN =   20.962375 ZMAX =   20.962375 ZAVE =   20.962375
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.39691535"
 RDCMND substituted energy or value "?XAVE" to "-3.14427783"
Evaluating: -9.39691535--3.14427783
 Parameter: XTRAN <- "-6.25263752"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.4164458"
 RDCMND substituted energy or value "?YAVE" to "-40.1595962"
Evaluating: 34.4164458--40.1595962
 Parameter: YTRAN <- "74.576042"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-75.3725936"
 RDCMND substituted energy or value "?ZAVE" to "20.962375"
Evaluating: -75.3725936-20.962375
 Parameter: ZTRAN <- "-96.3349686"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.25263752"
 Parameter: YTRAN -> "74.576042"
 Parameter: ZTRAN -> "-96.3349686"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -6.252638   74.576042  -96.334969
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.789547168"
Evaluating: 0.789547168*360.0
 Parameter: XPHI <- "284.23698"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671677194"
Evaluating: 0.671677194*360.0
 Parameter: YPHI <- "241.80379"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.769229582"
Evaluating: 0.769229582*360.0
 Parameter: ZPHI <- "276.92265"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.39691535"
 Parameter: YPOS -> "34.4164458"
 Parameter: ZPOS -> "-75.3725936"
 Parameter: XPHI -> "284.23698"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.245933   -0.969287
    0.000000    0.969287    0.245933

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   75.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.39691535"
 Parameter: YPOS -> "34.4164458"
 Parameter: ZPOS -> "-75.3725936"
 Parameter: YPHI -> "241.80379"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.472492    0.000000    0.881335
    0.000000    1.000000    0.000000
   -0.881335    0.000000   -0.472492

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  118.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.39691535"
 Parameter: YPOS -> "34.4164458"
 Parameter: ZPOS -> "-75.3725936"
 Parameter: ZPHI -> "276.92265"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.120529   -0.992710    0.000000
    0.992710    0.120529    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   83.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.396915 XMAX =   -9.396915 XAVE =   -9.396915
    YMIN =   34.416446 YMAX =   34.416446 YAVE =   34.416446
    ZMIN =  -75.372594 ZMAX =  -75.372594 ZAVE =  -75.372594
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.39691535"
Evaluating: -9.39691535+3.5
 Parameter: XMAX <- "-5.89691535"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.4164458"
Evaluating: 34.4164458+3.5
 Parameter: YMAX <- "37.9164458"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-75.3725936"
Evaluating: -75.3725936+3.5
 Parameter: ZMAX <- "-71.8725936"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.39691535"
Evaluating: -9.39691535-3.5
 Parameter: XMIN <- "-12.8969154"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.4164458"
Evaluating: 34.4164458-3.5
 Parameter: YMIN <- "30.9164458"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-75.3725936"
Evaluating: -75.3725936-3.5
 Parameter: ZMIN <- "-78.8725936"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.89691535"
 Parameter: XMIN -> "-12.8969154"
 Parameter: YMAX -> "37.9164458"
 Parameter: YMIN -> "30.9164458"
 Parameter: ZMAX -> "-71.8725936"
 Parameter: ZMIN -> "-78.8725936"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "217"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "217" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "217"
Evaluating: 217
 Parameter: J <- "217"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "217" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "217"
 Parameter: NPOS -> "143"
Evaluating: 217-143
 Parameter: J <- "74"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.766124533"
Evaluating: 125.050557*(0.766124533-0.5)
 Parameter: XPOS <- "33.2790211"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.155575012"
Evaluating: 125.050557*(0.155575012-0.5)
 Parameter: YPOS <- "-43.0705366"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.129474894"
Evaluating: 152.572525*(0.129474894-0.5)+-4.51585405
 Parameter: ZPOS <- "-61.047805"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-61.047805" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.2790211"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.2790211-0
 Parameter: XTRAN <- "33.2790211"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.0705366"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.0705366-0
 Parameter: YTRAN <- "-43.0705366"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-61.047805"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -61.047805-0
 Parameter: ZTRAN <- "-61.047805"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.2790211"
 Parameter: YTRAN -> "-43.0705366"
 Parameter: ZTRAN -> "-61.047805"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    33.279021  -43.070537  -61.047805
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919476987"
Evaluating: 0.919476987*360.0
 Parameter: XPHI <- "331.011715"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.24566902E-03"
Evaluating: 5.24566902E-03*360.0
 Parameter: YPHI <- "1.88844085"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.871103737"
Evaluating: 0.871103737*360.0
 Parameter: ZPHI <- "313.597345"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.2790211"
 Parameter: YPOS -> "-43.0705366"
 Parameter: ZPOS -> "-61.047805"
 Parameter: XPHI -> "331.011715"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.874719   -0.484631
    0.000000    0.484631    0.874719

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   28.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.2790211"
 Parameter: YPOS -> "-43.0705366"
 Parameter: ZPOS -> "-61.047805"
 Parameter: YPHI -> "1.88844085"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999457    0.000000   -0.032954
    0.000000    1.000000    0.000000
    0.032954    0.000000    0.999457

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    1.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.2790211"
 Parameter: YPOS -> "-43.0705366"
 Parameter: ZPOS -> "-61.047805"
 Parameter: ZPHI -> "313.597345"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.689586   -0.724204    0.000000
    0.724204    0.689586    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   46.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.279021 XMAX =   33.279021 XAVE =   33.279021
    YMIN =  -43.070537 YMAX =  -43.070537 YAVE =  -43.070537
    ZMIN =  -61.047805 ZMAX =  -61.047805 ZAVE =  -61.047805
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.2790211"
Evaluating: 33.2790211+3.5
 Parameter: XMAX <- "36.7790211"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.0705366"
Evaluating: -43.0705366+3.5
 Parameter: YMAX <- "-39.5705366"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-61.047805"
Evaluating: -61.047805+3.5
 Parameter: ZMAX <- "-57.547805"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.2790211"
Evaluating: 33.2790211-3.5
 Parameter: XMIN <- "29.7790211"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.0705366"
Evaluating: -43.0705366-3.5
 Parameter: YMIN <- "-46.5705366"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-61.047805"
Evaluating: -61.047805-3.5
 Parameter: ZMIN <- "-64.547805"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.7790211"
 Parameter: XMIN -> "29.7790211"
 Parameter: YMAX -> "-39.5705366"
 Parameter: YMIN -> "-46.5705366"
 Parameter: ZMAX -> "-57.547805"
 Parameter: ZMIN -> "-64.547805"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "218"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "218" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "218"
Evaluating: 218
 Parameter: J <- "218"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "218" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "218"
 Parameter: NPOS -> "143"
Evaluating: 218-143
 Parameter: J <- "75"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.296175499"
Evaluating: 125.050557*(0.296175499-0.5)
 Parameter: XPOS <- "-25.4883674"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.11392031"
Evaluating: 125.050557*(0.11392031-0.5)
 Parameter: YPOS <- "-48.2794803"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.224288321"
Evaluating: 152.572525*(0.224288321-0.5)+-4.51585405
 Parameter: ZPOS <- "-46.5818811"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-46.5818811" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.4883674"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.4883674-0
 Parameter: XTRAN <- "-25.4883674"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.2794803"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -48.2794803-0
 Parameter: YTRAN <- "-48.2794803"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-46.5818811"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -46.5818811-0
 Parameter: ZTRAN <- "-46.5818811"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.4883674"
 Parameter: YTRAN -> "-48.2794803"
 Parameter: ZTRAN -> "-46.5818811"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -25.488367  -48.279480  -46.581881
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.786236243"
Evaluating: 0.786236243*360.0
 Parameter: XPHI <- "283.045047"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.2975533"
Evaluating: 0.2975533*360.0
 Parameter: YPHI <- "107.119188"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.570935201"
Evaluating: 0.570935201*360.0
 Parameter: ZPHI <- "205.536672"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.4883674"
 Parameter: YPOS -> "-48.2794803"
 Parameter: ZPOS -> "-46.5818811"
 Parameter: XPHI -> "283.045047"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.225717   -0.974193
    0.000000    0.974193    0.225717

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   76.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.4883674"
 Parameter: YPOS -> "-48.2794803"
 Parameter: ZPOS -> "-46.5818811"
 Parameter: YPHI -> "107.119188"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.294360    0.000000   -0.955694
    0.000000    1.000000    0.000000
    0.955694    0.000000   -0.294360

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  107.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.4883674"
 Parameter: YPOS -> "-48.2794803"
 Parameter: ZPOS -> "-46.5818811"
 Parameter: ZPHI -> "205.536672"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.902310   -0.431089    0.000000
    0.431089   -0.902310    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  154.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.488367 XMAX =  -25.488367 XAVE =  -25.488367
    YMIN =  -48.279480 YMAX =  -48.279480 YAVE =  -48.279480
    ZMIN =  -46.581881 ZMAX =  -46.581881 ZAVE =  -46.581881
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.4883674"
Evaluating: -25.4883674+3.5
 Parameter: XMAX <- "-21.9883674"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.2794803"
Evaluating: -48.2794803+3.5
 Parameter: YMAX <- "-44.7794803"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-46.5818811"
Evaluating: -46.5818811+3.5
 Parameter: ZMAX <- "-43.0818811"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.4883674"
Evaluating: -25.4883674-3.5
 Parameter: XMIN <- "-28.9883674"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.2794803"
Evaluating: -48.2794803-3.5
 Parameter: YMIN <- "-51.7794803"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-46.5818811"
Evaluating: -46.5818811-3.5
 Parameter: ZMIN <- "-50.0818811"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.9883674"
 Parameter: XMIN -> "-28.9883674"
 Parameter: YMAX -> "-44.7794803"
 Parameter: YMIN -> "-51.7794803"
 Parameter: ZMAX -> "-43.0818811"
 Parameter: ZMIN -> "-50.0818811"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "219"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "219" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "219"
Evaluating: 219
 Parameter: J <- "219"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "219" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "219"
 Parameter: NPOS -> "143"
Evaluating: 219-143
 Parameter: J <- "76"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.607465558"
Evaluating: 125.050557*(0.607465558-0.5)
 Parameter: XPOS <- "13.4386279"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.950129388"
Evaluating: 125.050557*(0.950129388-0.5)
 Parameter: YPOS <- "56.2889307"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.293072746"
Evaluating: 152.572525*(0.293072746-0.5)+-4.51585405
 Parameter: ZPOS <- "-36.0872677"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.0872677" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.4386279"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.4386279-0
 Parameter: XTRAN <- "13.4386279"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "56.2889307"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 56.2889307-0
 Parameter: YTRAN <- "56.2889307"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.0872677"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.0872677-0
 Parameter: ZTRAN <- "-36.0872677"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.4386279"
 Parameter: YTRAN -> "56.2889307"
 Parameter: ZTRAN -> "-36.0872677"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    13.438628   56.288931  -36.087268
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.466543809"
Evaluating: 0.466543809*360.0
 Parameter: XPHI <- "167.955771"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.979762436E-02"
Evaluating: 5.979762436E-02*360.0
 Parameter: YPHI <- "21.5271448"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.621801769"
Evaluating: 0.621801769*360.0
 Parameter: ZPHI <- "223.848637"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.4386279"
 Parameter: YPOS -> "56.2889307"
 Parameter: ZPOS -> "-36.0872677"
 Parameter: XPHI -> "167.955771"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.977987    0.208667
    0.000000   -0.208667   -0.977987

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  167.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.4386279"
 Parameter: YPOS -> "56.2889307"
 Parameter: ZPOS -> "-36.0872677"
 Parameter: YPHI -> "21.5271448"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.930244    0.000000   -0.366942
    0.000000    1.000000    0.000000
    0.366942    0.000000    0.930244

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   21.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.4386279"
 Parameter: YPOS -> "56.2889307"
 Parameter: ZPOS -> "-36.0872677"
 Parameter: ZPHI -> "223.848637"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.721172   -0.692756    0.000000
    0.692756   -0.721172    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  136.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.438628 XMAX =   13.438628 XAVE =   13.438628
    YMIN =   56.288931 YMAX =   56.288931 YAVE =   56.288931
    ZMIN =  -36.087268 ZMAX =  -36.087268 ZAVE =  -36.087268
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.4386279"
Evaluating: 13.4386279+3.5
 Parameter: XMAX <- "16.9386279"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "56.2889307"
Evaluating: 56.2889307+3.5
 Parameter: YMAX <- "59.7889307"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.0872677"
Evaluating: -36.0872677+3.5
 Parameter: ZMAX <- "-32.5872677"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.4386279"
Evaluating: 13.4386279-3.5
 Parameter: XMIN <- "9.9386279"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "56.2889307"
Evaluating: 56.2889307-3.5
 Parameter: YMIN <- "52.7889307"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.0872677"
Evaluating: -36.0872677-3.5
 Parameter: ZMIN <- "-39.5872677"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.9386279"
 Parameter: XMIN -> "9.9386279"
 Parameter: YMAX -> "59.7889307"
 Parameter: YMIN -> "52.7889307"
 Parameter: ZMAX -> "-32.5872677"
 Parameter: ZMIN -> "-39.5872677"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "220"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "220" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "220"
Evaluating: 220
 Parameter: J <- "220"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "220" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "220"
 Parameter: NPOS -> "143"
Evaluating: 220-143
 Parameter: J <- "77"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.341605451"
Evaluating: 125.050557*(0.341605451-0.5)
 Parameter: XPOS <- "-19.8073266"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.176783519"
Evaluating: 125.050557*(0.176783519-0.5)
 Parameter: YPOS <- "-40.418401"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.568531609"
Evaluating: 152.572525*(0.568531609-0.5)+-4.51585405
 Parameter: ZPOS <- "5.94018658"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.94018658" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.94018658" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "220"
Evaluating: 220
 Parameter: J <- "220"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "220" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "220"
 Parameter: NPOS -> "143"
Evaluating: 220-143
 Parameter: J <- "77"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.468005848"
Evaluating: 125.050557*(0.468005848-0.5)
 Parameter: XPOS <- "-4.00088653"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.582945588"
Evaluating: 125.050557*(0.582945588-0.5)
 Parameter: YPOS <- "10.372392"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.520125355"
Evaluating: 152.572525*(0.520125355-0.5)+-4.51585405
 Parameter: ZPOS <- "-1.44527782"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.44527782" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.44527782" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "220"
Evaluating: 220
 Parameter: J <- "220"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "220" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "220"
 Parameter: NPOS -> "143"
Evaluating: 220-143
 Parameter: J <- "77"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.236649881"
Evaluating: 125.050557*(0.236649881-0.5)
 Parameter: XPOS <- "-32.9320791"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.37494428"
Evaluating: 125.050557*(0.37494428-0.5)
 Parameter: YPOS <- "-15.6382874"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.46516571"
Evaluating: 152.572525*(0.46516571-0.5)+-4.51585405
 Parameter: ZPOS <- "-9.83060963"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.83060963" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.83060963" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "220"
Evaluating: 220
 Parameter: J <- "220"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "220" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "220"
 Parameter: NPOS -> "143"
Evaluating: 220-143
 Parameter: J <- "77"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.435773733"
Evaluating: 125.050557*(0.435773733-0.5)
 Parameter: XPOS <- "-8.03153046"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.583922693"
Evaluating: 125.050557*(0.583922693-0.5)
 Parameter: YPOS <- "10.4945795"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.923876964"
Evaluating: 152.572525*(0.923876964-0.5)+-4.51585405
 Parameter: ZPOS <- "60.1561246"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "60.1561246" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "60.1561246" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.03153046"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.03153046-0
 Parameter: XTRAN <- "-8.03153046"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.4945795"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.4945795-0
 Parameter: YTRAN <- "10.4945795"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "60.1561246"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 60.1561246-0
 Parameter: ZTRAN <- "60.1561246"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.03153046"
 Parameter: YTRAN -> "10.4945795"
 Parameter: ZTRAN -> "60.1561246"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -8.031530   10.494580   60.156125
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.634817026"
Evaluating: 0.634817026*360.0
 Parameter: XPHI <- "228.534129"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.044921713E-02"
Evaluating: 6.044921713E-02*360.0
 Parameter: YPHI <- "21.7617182"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126907304"
Evaluating: 0.126907304*360.0
 Parameter: ZPHI <- "45.6866294"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.03153046"
 Parameter: YPOS -> "10.4945795"
 Parameter: ZPOS -> "60.1561246"
 Parameter: XPHI -> "228.534129"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.662174   -0.749350
    0.000000    0.749350   -0.662174

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  131.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.03153046"
 Parameter: YPOS -> "10.4945795"
 Parameter: ZPOS -> "60.1561246"
 Parameter: YPHI -> "21.7617182"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.928734    0.000000   -0.370747
    0.000000    1.000000    0.000000
    0.370747    0.000000    0.928734

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   21.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.03153046"
 Parameter: YPOS -> "10.4945795"
 Parameter: ZPOS -> "60.1561246"
 Parameter: ZPHI -> "45.6866294"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.698582    0.715530    0.000000
   -0.715530    0.698582    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   45.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.031530 XMAX =   -8.031530 XAVE =   -8.031530
    YMIN =   10.494580 YMAX =   10.494580 YAVE =   10.494580
    ZMIN =   60.156125 ZMAX =   60.156125 ZAVE =   60.156125
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.03153046"
Evaluating: -8.03153046+3.5
 Parameter: XMAX <- "-4.53153046"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.4945795"
Evaluating: 10.4945795+3.5
 Parameter: YMAX <- "13.9945795"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "60.1561246"
Evaluating: 60.1561246+3.5
 Parameter: ZMAX <- "63.6561246"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.03153046"
Evaluating: -8.03153046-3.5
 Parameter: XMIN <- "-11.5315305"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.4945795"
Evaluating: 10.4945795-3.5
 Parameter: YMIN <- "6.9945795"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "60.1561246"
Evaluating: 60.1561246-3.5
 Parameter: ZMIN <- "56.6561246"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.53153046"
 Parameter: XMIN -> "-11.5315305"
 Parameter: YMAX -> "13.9945795"
 Parameter: YMIN -> "6.9945795"
 Parameter: ZMAX -> "63.6561246"
 Parameter: ZMIN -> "56.6561246"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "221"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "221" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "221"
Evaluating: 221
 Parameter: J <- "221"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "221" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "221"
 Parameter: NPOS -> "143"
Evaluating: 221-143
 Parameter: J <- "78"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.640380987"
Evaluating: 125.050557*(0.640380987-0.5)
 Parameter: XPOS <- "17.5547206"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.285944462"
Evaluating: 125.050557*(0.285944462-0.5)
 Parameter: YPOS <- "-26.7677643"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.549008356"
Evaluating: 152.572525*(0.549008356-0.5)+-4.51585405
 Parameter: ZPOS <- "2.96147457"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.96147457" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.96147457" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "221"
Evaluating: 221
 Parameter: J <- "221"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "221" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "221"
 Parameter: NPOS -> "143"
Evaluating: 221-143
 Parameter: J <- "78"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.638161763"
Evaluating: 125.050557*(0.638161763-0.5)
 Parameter: XPOS <- "17.2772054"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.547591509"
Evaluating: 125.050557*(0.547591509-0.5)
 Parameter: YPOS <- "5.95134471"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "7.78153263E-02"
Evaluating: 152.572525*(7.78153263E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-68.9296357"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-68.9296357" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.2772054"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.2772054-0
 Parameter: XTRAN <- "17.2772054"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.95134471"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.95134471-0
 Parameter: YTRAN <- "5.95134471"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-68.9296357"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -68.9296357-0
 Parameter: ZTRAN <- "-68.9296357"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.2772054"
 Parameter: YTRAN -> "5.95134471"
 Parameter: ZTRAN -> "-68.9296357"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    17.277205    5.951345  -68.929636
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.978828678E-02"
Evaluating: 3.978828678E-02*360.0
 Parameter: XPHI <- "14.3237832"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.587051982"
Evaluating: 0.587051982*360.0
 Parameter: YPHI <- "211.338714"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.509092564"
Evaluating: 0.509092564*360.0
 Parameter: ZPHI <- "183.273323"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.2772054"
 Parameter: YPOS -> "5.95134471"
 Parameter: ZPOS -> "-68.9296357"
 Parameter: XPHI -> "14.3237832"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.968913    0.247401
    0.000000   -0.247401    0.968913

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   14.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.2772054"
 Parameter: YPOS -> "5.95134471"
 Parameter: ZPOS -> "-68.9296357"
 Parameter: YPHI -> "211.338714"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.854108    0.000000    0.520096
    0.000000    1.000000    0.000000
   -0.520096    0.000000   -0.854108

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  148.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.2772054"
 Parameter: YPOS -> "5.95134471"
 Parameter: ZPOS -> "-68.9296357"
 Parameter: ZPHI -> "183.273323"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.998369   -0.057099    0.000000
    0.057099   -0.998369    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  176.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.277205 XMAX =   17.277205 XAVE =   17.277205
    YMIN =    5.951345 YMAX =    5.951345 YAVE =    5.951345
    ZMIN =  -68.929636 ZMAX =  -68.929636 ZAVE =  -68.929636
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.2772054"
Evaluating: 17.2772054+3.5
 Parameter: XMAX <- "20.7772054"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.95134471"
Evaluating: 5.95134471+3.5
 Parameter: YMAX <- "9.45134471"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-68.9296357"
Evaluating: -68.9296357+3.5
 Parameter: ZMAX <- "-65.4296357"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.2772054"
Evaluating: 17.2772054-3.5
 Parameter: XMIN <- "13.7772054"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.95134471"
Evaluating: 5.95134471-3.5
 Parameter: YMIN <- "2.45134471"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-68.9296357"
Evaluating: -68.9296357-3.5
 Parameter: ZMIN <- "-72.4296357"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.7772054"
 Parameter: XMIN -> "13.7772054"
 Parameter: YMAX -> "9.45134471"
 Parameter: YMIN -> "2.45134471"
 Parameter: ZMAX -> "-65.4296357"
 Parameter: ZMIN -> "-72.4296357"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "222"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "222" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "222"
Evaluating: 222
 Parameter: J <- "222"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "222" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "222"
 Parameter: NPOS -> "143"
Evaluating: 222-143
 Parameter: J <- "79"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.55897638"
Evaluating: 125.050557*(0.55897638-0.5)
 Parameter: XPOS <- "7.37502917"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "3.757316223E-02"
Evaluating: 125.050557*(3.757316223E-02-0.5)
 Parameter: YPOS <- "-57.8267336"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.281944665"
Evaluating: 152.572525*(0.281944665-0.5)+-4.51585405
 Parameter: ZPOS <- "-37.7851071"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.7851071" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.37502917"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.37502917-0
 Parameter: XTRAN <- "7.37502917"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-57.8267336"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -57.8267336-0
 Parameter: YTRAN <- "-57.8267336"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.7851071"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.7851071-0
 Parameter: ZTRAN <- "-37.7851071"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.37502917"
 Parameter: YTRAN -> "-57.8267336"
 Parameter: ZTRAN -> "-37.7851071"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     7.375029  -57.826734  -37.785107
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.576955016"
Evaluating: 0.576955016*360.0
 Parameter: XPHI <- "207.703806"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.370835141E-02"
Evaluating: 8.370835141E-02*360.0
 Parameter: YPHI <- "30.1350065"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.694262953"
Evaluating: 0.694262953*360.0
 Parameter: ZPHI <- "249.934663"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.37502917"
 Parameter: YPOS -> "-57.8267336"
 Parameter: ZPOS -> "-37.7851071"
 Parameter: XPHI -> "207.703806"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.885363   -0.464901
    0.000000    0.464901   -0.885363

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  152.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.37502917"
 Parameter: YPOS -> "-57.8267336"
 Parameter: ZPOS -> "-37.7851071"
 Parameter: YPHI -> "30.1350065"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.864845    0.000000   -0.502039
    0.000000    1.000000    0.000000
    0.502039    0.000000    0.864845

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   30.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.37502917"
 Parameter: YPOS -> "-57.8267336"
 Parameter: ZPOS -> "-37.7851071"
 Parameter: ZPHI -> "249.934663"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.343091   -0.939302    0.000000
    0.939302   -0.343091    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  110.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.375029 XMAX =    7.375029 XAVE =    7.375029
    YMIN =  -57.826734 YMAX =  -57.826734 YAVE =  -57.826734
    ZMIN =  -37.785107 ZMAX =  -37.785107 ZAVE =  -37.785107
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.37502917"
Evaluating: 7.37502917+3.5
 Parameter: XMAX <- "10.8750292"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-57.8267336"
Evaluating: -57.8267336+3.5
 Parameter: YMAX <- "-54.3267336"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.7851071"
Evaluating: -37.7851071+3.5
 Parameter: ZMAX <- "-34.2851071"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.37502917"
Evaluating: 7.37502917-3.5
 Parameter: XMIN <- "3.87502917"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-57.8267336"
Evaluating: -57.8267336-3.5
 Parameter: YMIN <- "-61.3267336"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.7851071"
Evaluating: -37.7851071-3.5
 Parameter: ZMIN <- "-41.2851071"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.8750292"
 Parameter: XMIN -> "3.87502917"
 Parameter: YMAX -> "-54.3267336"
 Parameter: YMIN -> "-61.3267336"
 Parameter: ZMAX -> "-34.2851071"
 Parameter: ZMIN -> "-41.2851071"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "223"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "223" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "223"
Evaluating: 223
 Parameter: J <- "223"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "223" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "223"
 Parameter: NPOS -> "143"
Evaluating: 223-143
 Parameter: J <- "80"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.963897634"
Evaluating: 125.050557*(0.963897634-0.5)
 Parameter: XPOS <- "58.0106575"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.768809976"
Evaluating: 125.050557*(0.768809976-0.5)
 Parameter: YPOS <- "33.6148372"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "5.752084836E-02"
Evaluating: 152.572525*(5.752084836E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-72.0260155"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-72.0260155" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "58.0106575"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 58.0106575-0
 Parameter: XTRAN <- "58.0106575"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.6148372"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.6148372-0
 Parameter: YTRAN <- "33.6148372"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-72.0260155"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -72.0260155-0
 Parameter: ZTRAN <- "-72.0260155"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "58.0106575"
 Parameter: YTRAN -> "33.6148372"
 Parameter: ZTRAN -> "-72.0260155"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    58.010658   33.614837  -72.026015
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.449485155"
Evaluating: 0.449485155*360.0
 Parameter: XPHI <- "161.814656"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.776560805"
Evaluating: 0.776560805*360.0
 Parameter: YPHI <- "279.56189"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.31294271"
Evaluating: 0.31294271*360.0
 Parameter: ZPHI <- "112.659376"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "58.0106575"
 Parameter: YPOS -> "33.6148372"
 Parameter: ZPOS -> "-72.0260155"
 Parameter: XPHI -> "161.814656"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.950052    0.312092
    0.000000   -0.312092   -0.950052

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  161.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "58.0106575"
 Parameter: YPOS -> "33.6148372"
 Parameter: ZPOS -> "-72.0260155"
 Parameter: YPHI -> "279.56189"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.166113    0.000000    0.986107
    0.000000    1.000000    0.000000
   -0.986107    0.000000    0.166113

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   80.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "58.0106575"
 Parameter: YPOS -> "33.6148372"
 Parameter: ZPOS -> "-72.0260155"
 Parameter: ZPHI -> "112.659376"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.385252    0.922811    0.000000
   -0.922811   -0.385252    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  112.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.010658 XMAX =   58.010658 XAVE =   58.010658
    YMIN =   33.614837 YMAX =   33.614837 YAVE =   33.614837
    ZMIN =  -72.026015 ZMAX =  -72.026015 ZAVE =  -72.026015
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "58.0106575"
Evaluating: 58.0106575+3.5
 Parameter: XMAX <- "61.5106575"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.6148372"
Evaluating: 33.6148372+3.5
 Parameter: YMAX <- "37.1148372"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-72.0260155"
Evaluating: -72.0260155+3.5
 Parameter: ZMAX <- "-68.5260155"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "58.0106575"
Evaluating: 58.0106575-3.5
 Parameter: XMIN <- "54.5106575"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.6148372"
Evaluating: 33.6148372-3.5
 Parameter: YMIN <- "30.1148372"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-72.0260155"
Evaluating: -72.0260155-3.5
 Parameter: ZMIN <- "-75.5260155"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "61.5106575"
 Parameter: XMIN -> "54.5106575"
 Parameter: YMAX -> "37.1148372"
 Parameter: YMIN -> "30.1148372"
 Parameter: ZMAX -> "-68.5260155"
 Parameter: ZMIN -> "-75.5260155"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "224"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "224" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "224"
Evaluating: 224
 Parameter: J <- "224"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "224" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "224"
 Parameter: NPOS -> "143"
Evaluating: 224-143
 Parameter: J <- "81"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.65624106"
Evaluating: 125.050557*(0.65624106-0.5)
 Parameter: XPOS <- "19.5380316"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.870393719"
Evaluating: 125.050557*(0.870393719-0.5)
 Parameter: YPOS <- "46.3179409"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.289136448"
Evaluating: 152.572525*(0.289136448-0.5)+-4.51585405
 Parameter: ZPOS <- "-36.6878386"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.6878386" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.5380316"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 19.5380316-0
 Parameter: XTRAN <- "19.5380316"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.3179409"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 46.3179409-0
 Parameter: YTRAN <- "46.3179409"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.6878386"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.6878386-0
 Parameter: ZTRAN <- "-36.6878386"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.5380316"
 Parameter: YTRAN -> "46.3179409"
 Parameter: ZTRAN -> "-36.6878386"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    19.538032   46.317941  -36.687839
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.14169608"
Evaluating: 0.14169608*360.0
 Parameter: XPHI <- "51.0105888"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.655939002"
Evaluating: 0.655939002*360.0
 Parameter: YPHI <- "236.138041"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.346983222"
Evaluating: 0.346983222*360.0
 Parameter: ZPHI <- "124.91396"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.5380316"
 Parameter: YPOS -> "46.3179409"
 Parameter: ZPOS -> "-36.6878386"
 Parameter: XPHI -> "51.0105888"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.629177    0.777262
    0.000000   -0.777262    0.629177

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   51.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.5380316"
 Parameter: YPOS -> "46.3179409"
 Parameter: ZPOS -> "-36.6878386"
 Parameter: YPHI -> "236.138041"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.557194    0.000000    0.830382
    0.000000    1.000000    0.000000
   -0.830382    0.000000   -0.557194

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  123.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.5380316"
 Parameter: YPOS -> "46.3179409"
 Parameter: ZPOS -> "-36.6878386"
 Parameter: ZPHI -> "124.91396"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.572346    0.820012    0.000000
   -0.820012   -0.572346    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  124.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.538032 XMAX =   19.538032 XAVE =   19.538032
    YMIN =   46.317941 YMAX =   46.317941 YAVE =   46.317941
    ZMIN =  -36.687839 ZMAX =  -36.687839 ZAVE =  -36.687839
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.5380316"
Evaluating: 19.5380316+3.5
 Parameter: XMAX <- "23.0380316"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.3179409"
Evaluating: 46.3179409+3.5
 Parameter: YMAX <- "49.8179409"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.6878386"
Evaluating: -36.6878386+3.5
 Parameter: ZMAX <- "-33.1878386"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.5380316"
Evaluating: 19.5380316-3.5
 Parameter: XMIN <- "16.0380316"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.3179409"
Evaluating: 46.3179409-3.5
 Parameter: YMIN <- "42.8179409"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.6878386"
Evaluating: -36.6878386-3.5
 Parameter: ZMIN <- "-40.1878386"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.0380316"
 Parameter: XMIN -> "16.0380316"
 Parameter: YMAX -> "49.8179409"
 Parameter: YMIN -> "42.8179409"
 Parameter: ZMAX -> "-33.1878386"
 Parameter: ZMIN -> "-40.1878386"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "225"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "225" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "225"
Evaluating: 225
 Parameter: J <- "225"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "225" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "225"
 Parameter: NPOS -> "143"
Evaluating: 225-143
 Parameter: J <- "82"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.335104333"
Evaluating: 125.050557*(0.335104333-0.5)
 Parameter: XPOS <- "-20.620295"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.121903765"
Evaluating: 125.050557*(0.121903765-0.5)
 Parameter: YPOS <- "-47.2811448"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.945562905"
Evaluating: 152.572525*(0.945562905-0.5)+-4.51585405
 Parameter: ZPOS <- "63.4648034"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.4648034" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.4648034" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.620295"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -20.620295-0
 Parameter: XTRAN <- "-20.620295"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.2811448"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.2811448-0
 Parameter: YTRAN <- "-47.2811448"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.4648034"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 63.4648034-0
 Parameter: ZTRAN <- "63.4648034"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.620295"
 Parameter: YTRAN -> "-47.2811448"
 Parameter: ZTRAN -> "63.4648034"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -20.620295  -47.281145   63.464803
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.852700425"
Evaluating: 0.852700425*360.0
 Parameter: XPHI <- "306.972153"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.909476549"
Evaluating: 0.909476549*360.0
 Parameter: YPHI <- "327.411558"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.199780049"
Evaluating: 0.199780049*360.0
 Parameter: ZPHI <- "71.9208176"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.620295"
 Parameter: YPOS -> "-47.2811448"
 Parameter: ZPOS -> "63.4648034"
 Parameter: XPHI -> "306.972153"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.601427   -0.798928
    0.000000    0.798928    0.601427

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   53.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.620295"
 Parameter: YPOS -> "-47.2811448"
 Parameter: ZPOS -> "63.4648034"
 Parameter: YPHI -> "327.411558"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.842561    0.000000    0.538601
    0.000000    1.000000    0.000000
   -0.538601    0.000000    0.842561

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   32.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.620295"
 Parameter: YPOS -> "-47.2811448"
 Parameter: ZPOS -> "63.4648034"
 Parameter: ZPHI -> "71.9208176"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.310331    0.950629    0.000000
   -0.950629    0.310331    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   71.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.620295 XMAX =  -20.620295 XAVE =  -20.620295
    YMIN =  -47.281145 YMAX =  -47.281145 YAVE =  -47.281145
    ZMIN =   63.464803 ZMAX =   63.464803 ZAVE =   63.464803
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.620295"
Evaluating: -20.620295+3.5
 Parameter: XMAX <- "-17.120295"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.2811448"
Evaluating: -47.2811448+3.5
 Parameter: YMAX <- "-43.7811448"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.4648034"
Evaluating: 63.4648034+3.5
 Parameter: ZMAX <- "66.9648034"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.620295"
Evaluating: -20.620295-3.5
 Parameter: XMIN <- "-24.120295"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.2811448"
Evaluating: -47.2811448-3.5
 Parameter: YMIN <- "-50.7811448"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.4648034"
Evaluating: 63.4648034-3.5
 Parameter: ZMIN <- "59.9648034"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.120295"
 Parameter: XMIN -> "-24.120295"
 Parameter: YMAX -> "-43.7811448"
 Parameter: YMIN -> "-50.7811448"
 Parameter: ZMAX -> "66.9648034"
 Parameter: ZMIN -> "59.9648034"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "226"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "226" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "226"
Evaluating: 226
 Parameter: J <- "226"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "226" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "226"
 Parameter: NPOS -> "143"
Evaluating: 226-143
 Parameter: J <- "83"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.370392114"
Evaluating: 125.050557*(0.370392114-0.5)
 Parameter: XPOS <- "-16.2075383"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.260958798"
Evaluating: 125.050557*(0.260958798-0.5)
 Parameter: YPOS <- "-29.8922355"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.410686358"
Evaluating: 152.572525*(0.410686358-0.5)+-4.51585405
 Parameter: ZPOS <- "-18.1426619"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.1426619" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.2075383"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.2075383-0
 Parameter: XTRAN <- "-16.2075383"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.8922355"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.8922355-0
 Parameter: YTRAN <- "-29.8922355"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.1426619"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.1426619-0
 Parameter: ZTRAN <- "-18.1426619"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.2075383"
 Parameter: YTRAN -> "-29.8922355"
 Parameter: ZTRAN -> "-18.1426619"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -16.207538  -29.892236  -18.142662
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.223979551E-02"
Evaluating: 8.223979551E-02*360.0
 Parameter: XPHI <- "29.6063264"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.401144592"
Evaluating: 0.401144592*360.0
 Parameter: YPHI <- "144.412053"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.415077951"
Evaluating: 0.415077951*360.0
 Parameter: ZPHI <- "149.428062"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.2075383"
 Parameter: YPOS -> "-29.8922355"
 Parameter: ZPOS -> "-18.1426619"
 Parameter: XPHI -> "29.6063264"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.869440    0.494038
    0.000000   -0.494038    0.869440

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   29.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.2075383"
 Parameter: YPOS -> "-29.8922355"
 Parameter: ZPOS -> "-18.1426619"
 Parameter: YPHI -> "144.412053"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.813223    0.000000   -0.581952
    0.000000    1.000000    0.000000
    0.581952    0.000000   -0.813223

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  144.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.2075383"
 Parameter: YPOS -> "-29.8922355"
 Parameter: ZPOS -> "-18.1426619"
 Parameter: ZPHI -> "149.428062"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.860991    0.508620    0.000000
   -0.508620   -0.860991    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  149.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.207538 XMAX =  -16.207538 XAVE =  -16.207538
    YMIN =  -29.892236 YMAX =  -29.892236 YAVE =  -29.892236
    ZMIN =  -18.142662 ZMAX =  -18.142662 ZAVE =  -18.142662
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.2075383"
Evaluating: -16.2075383+3.5
 Parameter: XMAX <- "-12.7075383"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.8922355"
Evaluating: -29.8922355+3.5
 Parameter: YMAX <- "-26.3922355"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.1426619"
Evaluating: -18.1426619+3.5
 Parameter: ZMAX <- "-14.6426619"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.2075383"
Evaluating: -16.2075383-3.5
 Parameter: XMIN <- "-19.7075383"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.8922355"
Evaluating: -29.8922355-3.5
 Parameter: YMIN <- "-33.3922355"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.1426619"
Evaluating: -18.1426619-3.5
 Parameter: ZMIN <- "-21.6426619"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.7075383"
 Parameter: XMIN -> "-19.7075383"
 Parameter: YMAX -> "-26.3922355"
 Parameter: YMIN -> "-33.3922355"
 Parameter: ZMAX -> "-14.6426619"
 Parameter: ZMIN -> "-21.6426619"
 SELRPN>     24 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     13 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64641 NEG      CLA      83       CLA     -**** MEMB     POPC     192      N             3.2474
64641 NEG      CLA      83       CLA     -**** MEMB     POPC     192      C12           2.9223
64641 NEG      CLA      83       CLA     -**** MEMB     POPC     192      C14           2.4196
64641 NEG      CLA      83       CLA     -**** MEMB     POPC     192      C11           2.8524
64641 NEG      CLA      83       CLA     -**** MEMB     POPC     192      P             2.9449
64641 NEG      CLA      83       CLA     -**** MEMB     POPC     192      O13           2.9581
64641 NEG      CLA      83       CLA     -**** MEMB     POPC     192      O12           1.9023
64641 NEG      CLA      83       CLA     -**** MEMB     POPC     192      O11           3.6099
64641 NEG      CLA      83       CLA     -**** MEMB     POPC     192      C1            3.5377
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "226"
Evaluating: 226
 Parameter: J <- "226"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "226" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "226"
 Parameter: NPOS -> "143"
Evaluating: 226-143
 Parameter: J <- "83"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.892692867"
Evaluating: 125.050557*(0.892692867-0.5)
 Parameter: XPOS <- "49.1064617"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.419372099"
Evaluating: 125.050557*(0.419372099-0.5)
 Parameter: YPOS <- "-10.0825639"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.929472506"
Evaluating: 152.572525*(0.929472506-0.5)+-4.51585405
 Parameter: ZPOS <- "61.0098506"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "61.0098506" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "61.0098506" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.207538 XMAX =  -16.207538 XAVE =  -16.207538
    YMIN =  -29.892236 YMAX =  -29.892236 YAVE =  -29.892236
    ZMIN =  -18.142662 ZMAX =  -18.142662 ZAVE =  -18.142662
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.1064617"
 RDCMND substituted energy or value "?XAVE" to "-16.2075383"
Evaluating: 49.1064617--16.2075383
 Parameter: XTRAN <- "65.314"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.0825639"
 RDCMND substituted energy or value "?YAVE" to "-29.8922355"
Evaluating: -10.0825639--29.8922355
 Parameter: YTRAN <- "19.8096716"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.0098506"
 RDCMND substituted energy or value "?ZAVE" to "-18.1426619"
Evaluating: 61.0098506--18.1426619
 Parameter: ZTRAN <- "79.1525125"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "65.314"
 Parameter: YTRAN -> "19.8096716"
 Parameter: ZTRAN -> "79.1525125"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    65.314000   19.809672   79.152513
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.465495799"
Evaluating: 0.465495799*360.0
 Parameter: XPHI <- "167.578488"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.17626439"
Evaluating: 0.17626439*360.0
 Parameter: YPHI <- "63.4551804"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.503920702E-02"
Evaluating: 8.503920702E-02*360.0
 Parameter: ZPHI <- "30.6141145"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.1064617"
 Parameter: YPOS -> "-10.0825639"
 Parameter: ZPOS -> "61.0098506"
 Parameter: XPHI -> "167.578488"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.976592    0.215102
    0.000000   -0.215102   -0.976592

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  167.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.1064617"
 Parameter: YPOS -> "-10.0825639"
 Parameter: ZPOS -> "61.0098506"
 Parameter: YPHI -> "63.4551804"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.446898    0.000000   -0.894585
    0.000000    1.000000    0.000000
    0.894585    0.000000    0.446898

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   63.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.1064617"
 Parameter: YPOS -> "-10.0825639"
 Parameter: ZPOS -> "61.0098506"
 Parameter: ZPHI -> "30.6141145"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.860617    0.509253    0.000000
   -0.509253    0.860617    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   30.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.106462 XMAX =   49.106462 XAVE =   49.106462
    YMIN =  -10.082564 YMAX =  -10.082564 YAVE =  -10.082564
    ZMIN =   61.009851 ZMAX =   61.009851 ZAVE =   61.009851
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.1064617"
Evaluating: 49.1064617+3.5
 Parameter: XMAX <- "52.6064617"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.0825639"
Evaluating: -10.0825639+3.5
 Parameter: YMAX <- "-6.5825639"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.0098506"
Evaluating: 61.0098506+3.5
 Parameter: ZMAX <- "64.5098506"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.1064617"
Evaluating: 49.1064617-3.5
 Parameter: XMIN <- "45.6064617"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.0825639"
Evaluating: -10.0825639-3.5
 Parameter: YMIN <- "-13.5825639"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.0098506"
Evaluating: 61.0098506-3.5
 Parameter: ZMIN <- "57.5098506"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.6064617"
 Parameter: XMIN -> "45.6064617"
 Parameter: YMAX -> "-6.5825639"
 Parameter: YMIN -> "-13.5825639"
 Parameter: ZMAX -> "64.5098506"
 Parameter: ZMIN -> "57.5098506"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "227"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "227" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "227"
Evaluating: 227
 Parameter: J <- "227"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "227" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "227"
 Parameter: NPOS -> "143"
Evaluating: 227-143
 Parameter: J <- "84"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.417187338"
Evaluating: 125.050557*(0.417187338-0.5)
 Parameter: XPOS <- "-10.3557695"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.276129957"
Evaluating: 125.050557*(0.276129957-0.5)
 Parameter: YPOS <- "-27.9950736"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.296898026"
Evaluating: 152.572525*(0.296898026-0.5)+-4.51585405
 Parameter: ZPOS <- "-35.5036351"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.5036351" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.3557695"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.3557695-0
 Parameter: XTRAN <- "-10.3557695"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.9950736"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.9950736-0
 Parameter: YTRAN <- "-27.9950736"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.5036351"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -35.5036351-0
 Parameter: ZTRAN <- "-35.5036351"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.3557695"
 Parameter: YTRAN -> "-27.9950736"
 Parameter: ZTRAN -> "-35.5036351"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -10.355769  -27.995074  -35.503635
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.77685672"
Evaluating: 0.77685672*360.0
 Parameter: XPHI <- "279.668419"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.629945053"
Evaluating: 0.629945053*360.0
 Parameter: YPHI <- "226.780219"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.777314438"
Evaluating: 0.777314438*360.0
 Parameter: ZPHI <- "279.833198"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.3557695"
 Parameter: YPOS -> "-27.9950736"
 Parameter: ZPOS -> "-35.5036351"
 Parameter: XPHI -> "279.668419"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.167946   -0.985796
    0.000000    0.985796    0.167946

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   80.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.3557695"
 Parameter: YPOS -> "-27.9950736"
 Parameter: ZPOS -> "-35.5036351"
 Parameter: YPHI -> "226.780219"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.684799    0.000000    0.728732
    0.000000    1.000000    0.000000
   -0.728732    0.000000   -0.684799

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  133.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.3557695"
 Parameter: YPOS -> "-27.9950736"
 Parameter: ZPOS -> "-35.5036351"
 Parameter: ZPHI -> "279.833198"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.170780   -0.985309    0.000000
    0.985309    0.170780    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   80.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.355769 XMAX =  -10.355769 XAVE =  -10.355769
    YMIN =  -27.995074 YMAX =  -27.995074 YAVE =  -27.995074
    ZMIN =  -35.503635 ZMAX =  -35.503635 ZAVE =  -35.503635
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.3557695"
Evaluating: -10.3557695+3.5
 Parameter: XMAX <- "-6.8557695"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.9950736"
Evaluating: -27.9950736+3.5
 Parameter: YMAX <- "-24.4950736"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.5036351"
Evaluating: -35.5036351+3.5
 Parameter: ZMAX <- "-32.0036351"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.3557695"
Evaluating: -10.3557695-3.5
 Parameter: XMIN <- "-13.8557695"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.9950736"
Evaluating: -27.9950736-3.5
 Parameter: YMIN <- "-31.4950736"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.5036351"
Evaluating: -35.5036351-3.5
 Parameter: ZMIN <- "-39.0036351"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.8557695"
 Parameter: XMIN -> "-13.8557695"
 Parameter: YMAX -> "-24.4950736"
 Parameter: YMIN -> "-31.4950736"
 Parameter: ZMAX -> "-32.0036351"
 Parameter: ZMIN -> "-39.0036351"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "228"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "228" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "228"
Evaluating: 228
 Parameter: J <- "228"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "228" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "228"
 Parameter: NPOS -> "143"
Evaluating: 228-143
 Parameter: J <- "85"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "85"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.835991522"
Evaluating: 125.050557*(0.835991522-0.5)
 Parameter: XPOS <- "42.015927"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.541425768"
Evaluating: 125.050557*(0.541425768-0.5)
 Parameter: YPOS <- "5.18031536"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.447533812"
Evaluating: 152.572525*(0.447533812-0.5)+-4.51585405
 Parameter: ZPOS <- "-12.5207528"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.5207528" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.5207528" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "228"
Evaluating: 228
 Parameter: J <- "228"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "228" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "228"
 Parameter: NPOS -> "143"
Evaluating: 228-143
 Parameter: J <- "85"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "85"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.968456652"
Evaluating: 125.050557*(0.968456652-0.5)
 Parameter: XPOS <- "58.5807653"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.262290288"
Evaluating: 125.050557*(0.262290288-0.5)
 Parameter: YPOS <- "-29.7257319"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.720891382"
Evaluating: 152.572525*(0.720891382-0.5)+-4.51585405
 Parameter: ZPOS <- "29.1861019"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.1861019" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.1861019" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "58.5807653"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 58.5807653-0
 Parameter: XTRAN <- "58.5807653"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.7257319"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.7257319-0
 Parameter: YTRAN <- "-29.7257319"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.1861019"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.1861019-0
 Parameter: ZTRAN <- "29.1861019"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "58.5807653"
 Parameter: YTRAN -> "-29.7257319"
 Parameter: ZTRAN -> "29.1861019"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    58.580765  -29.725732   29.186102
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.641352306"
Evaluating: 0.641352306*360.0
 Parameter: XPHI <- "230.88683"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.699069123"
Evaluating: 0.699069123*360.0
 Parameter: YPHI <- "251.664884"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499582337"
Evaluating: 0.499582337*360.0
 Parameter: ZPHI <- "179.849641"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "58.5807653"
 Parameter: YPOS -> "-29.7257319"
 Parameter: ZPOS -> "29.1861019"
 Parameter: XPHI -> "230.88683"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.630854   -0.775901
    0.000000    0.775901   -0.630854

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "58.5807653"
 Parameter: YPOS -> "-29.7257319"
 Parameter: ZPOS -> "29.1861019"
 Parameter: YPHI -> "251.664884"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.314574    0.000000    0.949233
    0.000000    1.000000    0.000000
   -0.949233    0.000000   -0.314574

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  108.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "58.5807653"
 Parameter: YPOS -> "-29.7257319"
 Parameter: ZPOS -> "29.1861019"
 Parameter: ZPHI -> "179.849641"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.999997    0.002624    0.000000
   -0.002624   -0.999997    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  179.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.580765 XMAX =   58.580765 XAVE =   58.580765
    YMIN =  -29.725732 YMAX =  -29.725732 YAVE =  -29.725732
    ZMIN =   29.186102 ZMAX =   29.186102 ZAVE =   29.186102
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "58.5807653"
Evaluating: 58.5807653+3.5
 Parameter: XMAX <- "62.0807653"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.7257319"
Evaluating: -29.7257319+3.5
 Parameter: YMAX <- "-26.2257319"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.1861019"
Evaluating: 29.1861019+3.5
 Parameter: ZMAX <- "32.6861019"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "58.5807653"
Evaluating: 58.5807653-3.5
 Parameter: XMIN <- "55.0807653"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.7257319"
Evaluating: -29.7257319-3.5
 Parameter: YMIN <- "-33.2257319"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.1861019"
Evaluating: 29.1861019-3.5
 Parameter: ZMIN <- "25.6861019"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "62.0807653"
 Parameter: XMIN -> "55.0807653"
 Parameter: YMAX -> "-26.2257319"
 Parameter: YMIN -> "-33.2257319"
 Parameter: ZMAX -> "32.6861019"
 Parameter: ZMIN -> "25.6861019"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "229"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "229" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "229"
Evaluating: 229
 Parameter: J <- "229"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "229" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "229"
 Parameter: NPOS -> "143"
Evaluating: 229-143
 Parameter: J <- "86"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "86"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.4788068"
Evaluating: 125.050557*(0.4788068-0.5)
 Parameter: XPOS <- "-2.65022146"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.404410998"
Evaluating: 125.050557*(0.404410998-0.5)
 Parameter: YPOS <- "-11.9534579"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.955261452"
Evaluating: 152.572525*(0.955261452-0.5)+-4.51585405
 Parameter: ZPOS <- "64.9445352"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "64.9445352" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "64.9445352" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.65022146"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.65022146-0
 Parameter: XTRAN <- "-2.65022146"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.9534579"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.9534579-0
 Parameter: YTRAN <- "-11.9534579"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "64.9445352"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 64.9445352-0
 Parameter: ZTRAN <- "64.9445352"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.65022146"
 Parameter: YTRAN -> "-11.9534579"
 Parameter: ZTRAN -> "64.9445352"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -2.650221  -11.953458   64.944535
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.147797324"
Evaluating: 0.147797324*360.0
 Parameter: XPHI <- "53.2070366"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.469440098E-02"
Evaluating: 4.469440098E-02*360.0
 Parameter: YPHI <- "16.0899844"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.0067737E-02"
Evaluating: 9.0067737E-02*360.0
 Parameter: ZPHI <- "32.4243853"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.65022146"
 Parameter: YPOS -> "-11.9534579"
 Parameter: ZPOS -> "64.9445352"
 Parameter: XPHI -> "53.2070366"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.598925    0.800805
    0.000000   -0.800805    0.598925

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   53.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.65022146"
 Parameter: YPOS -> "-11.9534579"
 Parameter: ZPOS -> "64.9445352"
 Parameter: YPHI -> "16.0899844"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.960828    0.000000   -0.277147
    0.000000    1.000000    0.000000
    0.277147    0.000000    0.960828

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   16.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.65022146"
 Parameter: YPOS -> "-11.9534579"
 Parameter: ZPOS -> "64.9445352"
 Parameter: ZPHI -> "32.4243853"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.844100    0.536186    0.000000
   -0.536186    0.844100    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   32.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.650221 XMAX =   -2.650221 XAVE =   -2.650221
    YMIN =  -11.953458 YMAX =  -11.953458 YAVE =  -11.953458
    ZMIN =   64.944535 ZMAX =   64.944535 ZAVE =   64.944535
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.65022146"
Evaluating: -2.65022146+3.5
 Parameter: XMAX <- "0.84977854"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.9534579"
Evaluating: -11.9534579+3.5
 Parameter: YMAX <- "-8.4534579"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "64.9445352"
Evaluating: 64.9445352+3.5
 Parameter: ZMAX <- "68.4445352"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.65022146"
Evaluating: -2.65022146-3.5
 Parameter: XMIN <- "-6.15022146"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.9534579"
Evaluating: -11.9534579-3.5
 Parameter: YMIN <- "-15.4534579"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "64.9445352"
Evaluating: 64.9445352-3.5
 Parameter: ZMIN <- "61.4445352"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.84977854"
 Parameter: XMIN -> "-6.15022146"
 Parameter: YMAX -> "-8.4534579"
 Parameter: YMIN -> "-15.4534579"
 Parameter: ZMAX -> "68.4445352"
 Parameter: ZMIN -> "61.4445352"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "230"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "230" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "230"
Evaluating: 230
 Parameter: J <- "230"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "230" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "230"
 Parameter: NPOS -> "143"
Evaluating: 230-143
 Parameter: J <- "87"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.120664053"
Evaluating: 125.050557*(0.120664053-0.5)
 Parameter: XPOS <- "-47.4361715"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.833679624"
Evaluating: 125.050557*(0.833679624-0.5)
 Parameter: YPOS <- "41.7268228"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.631532562"
Evaluating: 152.572525*(0.631532562-0.5)+-4.51585405
 Parameter: ZPOS <- "15.5524011"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.5524011" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.5524011" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.4361715"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -47.4361715-0
 Parameter: XTRAN <- "-47.4361715"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.7268228"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.7268228-0
 Parameter: YTRAN <- "41.7268228"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.5524011"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.5524011-0
 Parameter: ZTRAN <- "15.5524011"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.4361715"
 Parameter: YTRAN -> "41.7268228"
 Parameter: ZTRAN -> "15.5524011"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -47.436172   41.726823   15.552401
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.946131292E-02"
Evaluating: 8.946131292E-02*360.0
 Parameter: XPHI <- "32.2060727"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.379402468"
Evaluating: 0.379402468*360.0
 Parameter: YPHI <- "136.584888"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.235800509"
Evaluating: 0.235800509*360.0
 Parameter: ZPHI <- "84.8881832"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.4361715"
 Parameter: YPOS -> "41.7268228"
 Parameter: ZPOS -> "15.5524011"
 Parameter: XPHI -> "32.2060727"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.846137    0.532966
    0.000000   -0.532966    0.846137

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   32.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.4361715"
 Parameter: YPOS -> "41.7268228"
 Parameter: ZPOS -> "15.5524011"
 Parameter: YPHI -> "136.584888"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.726393    0.000000   -0.687279
    0.000000    1.000000    0.000000
    0.687279    0.000000   -0.726393

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  136.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.4361715"
 Parameter: YPOS -> "41.7268228"
 Parameter: ZPOS -> "15.5524011"
 Parameter: ZPHI -> "84.8881832"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.089100    0.996023    0.000000
   -0.996023    0.089100    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   84.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.436172 XMAX =  -47.436172 XAVE =  -47.436172
    YMIN =   41.726823 YMAX =   41.726823 YAVE =   41.726823
    ZMIN =   15.552401 ZMAX =   15.552401 ZAVE =   15.552401
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.4361715"
Evaluating: -47.4361715+3.5
 Parameter: XMAX <- "-43.9361715"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.7268228"
Evaluating: 41.7268228+3.5
 Parameter: YMAX <- "45.2268228"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.5524011"
Evaluating: 15.5524011+3.5
 Parameter: ZMAX <- "19.0524011"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.4361715"
Evaluating: -47.4361715-3.5
 Parameter: XMIN <- "-50.9361715"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.7268228"
Evaluating: 41.7268228-3.5
 Parameter: YMIN <- "38.2268228"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.5524011"
Evaluating: 15.5524011-3.5
 Parameter: ZMIN <- "12.0524011"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-43.9361715"
 Parameter: XMIN -> "-50.9361715"
 Parameter: YMAX -> "45.2268228"
 Parameter: YMIN -> "38.2268228"
 Parameter: ZMAX -> "19.0524011"
 Parameter: ZMIN -> "12.0524011"
 SELRPN>     28 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     16 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      P             2.0805
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      O13           2.6642
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      O14           2.5299
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      O12           3.4454
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      O11           1.2093
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      C1            1.3350
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      C2            1.7707
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      O21           1.6592
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      C21           2.9821
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      O22           3.8658
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      C22           3.7367
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      C3            2.6537
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      O31           2.6063
64645 NEG      CLA      87       CLA     -**** MEMB     POPC     130      C31           3.4376
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        14
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "14"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "230"
Evaluating: 230
 Parameter: J <- "230"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "230" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "230"
 Parameter: NPOS -> "143"
Evaluating: 230-143
 Parameter: J <- "87"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.93284823"
Evaluating: 125.050557*(0.93284823-0.5)
 Parameter: XPOS <- "54.1279123"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.156197156"
Evaluating: 125.050557*(0.156197156-0.5)
 Parameter: YPOS <- "-42.9927371"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.34322813"
Evaluating: 152.572525*(0.34322813-0.5)+-4.51585405
 Parameter: ZPOS <- "-28.4349341"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.4349341" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.436172 XMAX =  -47.436172 XAVE =  -47.436172
    YMIN =   41.726823 YMAX =   41.726823 YAVE =   41.726823
    ZMIN =   15.552401 ZMAX =   15.552401 ZAVE =   15.552401
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "54.1279123"
 RDCMND substituted energy or value "?XAVE" to "-47.4361715"
Evaluating: 54.1279123--47.4361715
 Parameter: XTRAN <- "101.564084"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.9927371"
 RDCMND substituted energy or value "?YAVE" to "41.7268228"
Evaluating: -42.9927371-41.7268228
 Parameter: YTRAN <- "-84.7195599"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.4349341"
 RDCMND substituted energy or value "?ZAVE" to "15.5524011"
Evaluating: -28.4349341-15.5524011
 Parameter: ZTRAN <- "-43.9873352"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "101.564084"
 Parameter: YTRAN -> "-84.7195599"
 Parameter: ZTRAN -> "-43.9873352"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   101.564084  -84.719560  -43.987335
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.50051628E-02"
Evaluating: 7.50051628E-02*360.0
 Parameter: XPHI <- "27.0018586"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.714817956"
Evaluating: 0.714817956*360.0
 Parameter: YPHI <- "257.334464"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.849468674E-02"
Evaluating: 1.849468674E-02*360.0
 Parameter: ZPHI <- "6.65808723"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "54.1279123"
 Parameter: YPOS -> "-42.9927371"
 Parameter: ZPOS -> "-28.4349341"
 Parameter: XPHI -> "27.0018586"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.890992    0.454019
    0.000000   -0.454019    0.890992

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   27.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "54.1279123"
 Parameter: YPOS -> "-42.9927371"
 Parameter: ZPOS -> "-28.4349341"
 Parameter: YPHI -> "257.334464"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.219259    0.000000    0.975667
    0.000000    1.000000    0.000000
   -0.975667    0.000000   -0.219259

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  102.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "54.1279123"
 Parameter: YPOS -> "-42.9927371"
 Parameter: ZPOS -> "-28.4349341"
 Parameter: ZPHI -> "6.65808723"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.993256    0.115944    0.000000
   -0.115944    0.993256    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    6.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   54.127912 XMAX =   54.127912 XAVE =   54.127912
    YMIN =  -42.992737 YMAX =  -42.992737 YAVE =  -42.992737
    ZMIN =  -28.434934 ZMAX =  -28.434934 ZAVE =  -28.434934
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "54.1279123"
Evaluating: 54.1279123+3.5
 Parameter: XMAX <- "57.6279123"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.9927371"
Evaluating: -42.9927371+3.5
 Parameter: YMAX <- "-39.4927371"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.4349343"
Evaluating: -28.4349343+3.5
 Parameter: ZMAX <- "-24.9349343"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "54.1279123"
Evaluating: 54.1279123-3.5
 Parameter: XMIN <- "50.6279123"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.9927371"
Evaluating: -42.9927371-3.5
 Parameter: YMIN <- "-46.4927371"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.4349343"
Evaluating: -28.4349343-3.5
 Parameter: ZMIN <- "-31.9349343"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.6279123"
 Parameter: XMIN -> "50.6279123"
 Parameter: YMAX -> "-39.4927371"
 Parameter: YMIN -> "-46.4927371"
 Parameter: ZMAX -> "-24.9349343"
 Parameter: ZMIN -> "-31.9349343"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "231"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "231" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "231"
Evaluating: 231
 Parameter: J <- "231"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "231" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "231"
 Parameter: NPOS -> "143"
Evaluating: 231-143
 Parameter: J <- "88"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "88"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.178814555"
Evaluating: 125.050557*(0.178814555-0.5)
 Parameter: XPOS <- "-40.1644188"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.336637002"
Evaluating: 125.050557*(0.336637002-0.5)
 Parameter: YPOS <- "-20.4286339"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.820978493"
Evaluating: 152.572525*(0.820978493-0.5)+-4.51585405
 Parameter: ZPOS <- "44.4566451"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.4566451" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.4566451" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.1644188"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -40.1644188-0
 Parameter: XTRAN <- "-40.1644188"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.4286339"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.4286339-0
 Parameter: YTRAN <- "-20.4286339"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.4566451"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.4566451-0
 Parameter: ZTRAN <- "44.4566451"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.1644188"
 Parameter: YTRAN -> "-20.4286339"
 Parameter: ZTRAN -> "44.4566451"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -40.164419  -20.428634   44.456645
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.356705702"
Evaluating: 0.356705702*360.0
 Parameter: XPHI <- "128.414053"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.186654578"
Evaluating: 0.186654578*360.0
 Parameter: YPHI <- "67.1956481"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.921519103"
Evaluating: 0.921519103*360.0
 Parameter: ZPHI <- "331.746877"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.1644188"
 Parameter: YPOS -> "-20.4286339"
 Parameter: ZPOS -> "44.4566451"
 Parameter: XPHI -> "128.414053"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.621340    0.783541
    0.000000   -0.783541   -0.621340

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  128.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.1644188"
 Parameter: YPOS -> "-20.4286339"
 Parameter: ZPOS -> "44.4566451"
 Parameter: YPHI -> "67.1956481"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.387586    0.000000   -0.921834
    0.000000    1.000000    0.000000
    0.921834    0.000000    0.387586

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   67.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.1644188"
 Parameter: YPOS -> "-20.4286339"
 Parameter: ZPOS -> "44.4566451"
 Parameter: ZPHI -> "331.746877"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.880865   -0.473368    0.000000
    0.473368    0.880865    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.164419 XMAX =  -40.164419 XAVE =  -40.164419
    YMIN =  -20.428634 YMAX =  -20.428634 YAVE =  -20.428634
    ZMIN =   44.456645 ZMAX =   44.456645 ZAVE =   44.456645
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.1644188"
Evaluating: -40.1644188+3.5
 Parameter: XMAX <- "-36.6644188"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.4286339"
Evaluating: -20.4286339+3.5
 Parameter: YMAX <- "-16.9286339"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.4566451"
Evaluating: 44.4566451+3.5
 Parameter: ZMAX <- "47.9566451"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.1644188"
Evaluating: -40.1644188-3.5
 Parameter: XMIN <- "-43.6644188"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.4286339"
Evaluating: -20.4286339-3.5
 Parameter: YMIN <- "-23.9286339"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.4566451"
Evaluating: 44.4566451-3.5
 Parameter: ZMIN <- "40.9566451"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.6644188"
 Parameter: XMIN -> "-43.6644188"
 Parameter: YMAX -> "-16.9286339"
 Parameter: YMIN -> "-23.9286339"
 Parameter: ZMAX -> "47.9566451"
 Parameter: ZMIN -> "40.9566451"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "232"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "232" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "232"
Evaluating: 232
 Parameter: J <- "232"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "232" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "232"
 Parameter: NPOS -> "143"
Evaluating: 232-143
 Parameter: J <- "89"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "89"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "4.280454824E-02"
Evaluating: 125.050557*(4.280454824E-02-0.5)
 Parameter: XPOS <- "-57.1725459"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.599509311"
Evaluating: 125.050557*(0.599509311-0.5)
 Parameter: YPOS <- "12.4436948"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.834536953"
Evaluating: 152.572525*(0.834536953-0.5)+-4.51585405
 Parameter: ZPOS <- "46.5252936"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.5252936" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.5252936" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-57.1725459"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -57.1725459-0
 Parameter: XTRAN <- "-57.1725459"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.4436948"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.4436948-0
 Parameter: YTRAN <- "12.4436948"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.5252936"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.5252936-0
 Parameter: ZTRAN <- "46.5252936"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-57.1725459"
 Parameter: YTRAN -> "12.4436948"
 Parameter: ZTRAN -> "46.5252936"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -57.172546   12.443695   46.525294
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.182839108"
Evaluating: 0.182839108*360.0
 Parameter: XPHI <- "65.8220789"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.699532001"
Evaluating: 0.699532001*360.0
 Parameter: YPHI <- "251.83152"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.439850824"
Evaluating: 0.439850824*360.0
 Parameter: ZPHI <- "158.346297"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-57.1725459"
 Parameter: YPOS -> "12.4436948"
 Parameter: ZPOS -> "46.5252936"
 Parameter: XPHI -> "65.8220789"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.409572    0.912278
    0.000000   -0.912278    0.409572

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   65.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-57.1725459"
 Parameter: YPOS -> "12.4436948"
 Parameter: ZPOS -> "46.5252936"
 Parameter: YPHI -> "251.83152"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.311812    0.000000    0.950144
    0.000000    1.000000    0.000000
   -0.950144    0.000000   -0.311812

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  108.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-57.1725459"
 Parameter: YPOS -> "12.4436948"
 Parameter: ZPOS -> "46.5252936"
 Parameter: ZPHI -> "158.346297"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.929431    0.368996    0.000000
   -0.368996   -0.929431    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  158.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -57.172546 XMAX =  -57.172546 XAVE =  -57.172546
    YMIN =   12.443695 YMAX =   12.443695 YAVE =   12.443695
    ZMIN =   46.525294 ZMAX =   46.525294 ZAVE =   46.525294
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-57.1725459"
Evaluating: -57.1725459+3.5
 Parameter: XMAX <- "-53.6725459"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.4436948"
Evaluating: 12.4436948+3.5
 Parameter: YMAX <- "15.9436948"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.5252936"
Evaluating: 46.5252936+3.5
 Parameter: ZMAX <- "50.0252936"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-57.1725459"
Evaluating: -57.1725459-3.5
 Parameter: XMIN <- "-60.6725459"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.4436948"
Evaluating: 12.4436948-3.5
 Parameter: YMIN <- "8.9436948"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.5252936"
Evaluating: 46.5252936-3.5
 Parameter: ZMIN <- "43.0252936"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-53.6725459"
 Parameter: XMIN -> "-60.6725459"
 Parameter: YMAX -> "15.9436948"
 Parameter: YMIN -> "8.9436948"
 Parameter: ZMAX -> "50.0252936"
 Parameter: ZMIN -> "43.0252936"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "233"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "233" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "233"
Evaluating: 233
 Parameter: J <- "233"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "233" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "233"
 Parameter: NPOS -> "143"
Evaluating: 233-143
 Parameter: J <- "90"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "90"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.139140394"
Evaluating: 125.050557*(0.139140394-0.5)
 Parameter: XPOS <- "-45.1256947"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.200869033"
Evaluating: 125.050557*(0.200869033-0.5)
 Parameter: YPOS <- "-37.406494"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.226309842"
Evaluating: 152.572525*(0.226309842-0.5)+-4.51585405
 Parameter: ZPOS <- "-46.2734525"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-46.2734525" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.1256947"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -45.1256947-0
 Parameter: XTRAN <- "-45.1256947"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.406494"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.406494-0
 Parameter: YTRAN <- "-37.406494"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-46.2734525"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -46.2734525-0
 Parameter: ZTRAN <- "-46.2734525"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.1256947"
 Parameter: YTRAN -> "-37.406494"
 Parameter: ZTRAN -> "-46.2734525"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -45.125695  -37.406494  -46.273452
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.554709528"
Evaluating: 0.554709528*360.0
 Parameter: XPHI <- "199.69543"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.187879588"
Evaluating: 0.187879588*360.0
 Parameter: YPHI <- "67.6366517"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.274613234E-02"
Evaluating: 4.274613234E-02*360.0
 Parameter: ZPHI <- "15.3886076"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.1256947"
 Parameter: YPOS -> "-37.406494"
 Parameter: ZPOS -> "-46.2734525"
 Parameter: XPHI -> "199.69543"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.941497   -0.337020
    0.000000    0.337020   -0.941497

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  160.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.1256947"
 Parameter: YPOS -> "-37.406494"
 Parameter: ZPOS -> "-46.2734525"
 Parameter: YPHI -> "67.6366517"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.380479    0.000000   -0.924790
    0.000000    1.000000    0.000000
    0.924790    0.000000    0.380479

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   67.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.1256947"
 Parameter: YPOS -> "-37.406494"
 Parameter: ZPOS -> "-46.2734525"
 Parameter: ZPHI -> "15.3886076"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.964148    0.265364    0.000000
   -0.265364    0.964148    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   15.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.125695 XMAX =  -45.125695 XAVE =  -45.125695
    YMIN =  -37.406494 YMAX =  -37.406494 YAVE =  -37.406494
    ZMIN =  -46.273452 ZMAX =  -46.273452 ZAVE =  -46.273452
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.1256947"
Evaluating: -45.1256947+3.5
 Parameter: XMAX <- "-41.6256947"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.406494"
Evaluating: -37.406494+3.5
 Parameter: YMAX <- "-33.906494"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-46.2734525"
Evaluating: -46.2734525+3.5
 Parameter: ZMAX <- "-42.7734525"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.1256947"
Evaluating: -45.1256947-3.5
 Parameter: XMIN <- "-48.6256947"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.406494"
Evaluating: -37.406494-3.5
 Parameter: YMIN <- "-40.906494"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-46.2734525"
Evaluating: -46.2734525-3.5
 Parameter: ZMIN <- "-49.7734525"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.6256947"
 Parameter: XMIN -> "-48.6256947"
 Parameter: YMAX -> "-33.906494"
 Parameter: YMIN -> "-40.906494"
 Parameter: ZMAX -> "-42.7734525"
 Parameter: ZMIN -> "-49.7734525"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "234"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "234" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "234"
Evaluating: 234
 Parameter: J <- "234"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "234" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "234"
 Parameter: NPOS -> "143"
Evaluating: 234-143
 Parameter: J <- "91"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "91"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.201714585E-03"
Evaluating: 125.050557*(9.201714585E-03-0.5)
 Parameter: XPOS <- "-61.374599"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.5487163"
Evaluating: 125.050557*(0.5487163-0.5)
 Parameter: YPOS <- "6.09200045"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.278199363"
Evaluating: 152.572525*(0.278199363-0.5)+-4.51585405
 Parameter: ZPOS <- "-38.3565373"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.3565373" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-61.374599"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -61.374599-0
 Parameter: XTRAN <- "-61.374599"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.09200045"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 6.09200045-0
 Parameter: YTRAN <- "6.09200045"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.3565373"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.3565373-0
 Parameter: ZTRAN <- "-38.3565373"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-61.374599"
 Parameter: YTRAN -> "6.09200045"
 Parameter: ZTRAN -> "-38.3565373"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -61.374599    6.092000  -38.356537
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.956474987"
Evaluating: 0.956474987*360.0
 Parameter: XPHI <- "344.330995"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.968201541"
Evaluating: 0.968201541*360.0
 Parameter: YPHI <- "348.552555"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.116473163"
Evaluating: 0.116473163*360.0
 Parameter: ZPHI <- "41.9303387"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-61.374599"
 Parameter: YPOS -> "6.09200045"
 Parameter: ZPOS -> "-38.3565373"
 Parameter: XPHI -> "344.330995"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.962838   -0.270080
    0.000000    0.270080    0.962838

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   15.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-61.374599"
 Parameter: YPOS -> "6.09200045"
 Parameter: ZPOS -> "-38.3565373"
 Parameter: YPHI -> "348.552555"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.980107    0.000000    0.198469
    0.000000    1.000000    0.000000
   -0.198469    0.000000    0.980107

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   11.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-61.374599"
 Parameter: YPOS -> "6.09200045"
 Parameter: ZPOS -> "-38.3565373"
 Parameter: ZPHI -> "41.9303387"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.743958    0.668227    0.000000
   -0.668227    0.743958    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   41.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -61.374599 XMAX =  -61.374599 XAVE =  -61.374599
    YMIN =    6.092000 YMAX =    6.092000 YAVE =    6.092000
    ZMIN =  -38.356537 ZMAX =  -38.356537 ZAVE =  -38.356537
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-61.374599"
Evaluating: -61.374599+3.5
 Parameter: XMAX <- "-57.874599"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.09200045"
Evaluating: 6.09200045+3.5
 Parameter: YMAX <- "9.59200045"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.3565373"
Evaluating: -38.3565373+3.5
 Parameter: ZMAX <- "-34.8565373"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-61.374599"
Evaluating: -61.374599-3.5
 Parameter: XMIN <- "-64.874599"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.09200045"
Evaluating: 6.09200045-3.5
 Parameter: YMIN <- "2.59200045"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.3565373"
Evaluating: -38.3565373-3.5
 Parameter: ZMIN <- "-41.8565373"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-57.874599"
 Parameter: XMIN -> "-64.874599"
 Parameter: YMAX -> "9.59200045"
 Parameter: YMIN -> "2.59200045"
 Parameter: ZMAX -> "-34.8565373"
 Parameter: ZMIN -> "-41.8565373"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "235"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "235" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "235"
Evaluating: 235
 Parameter: J <- "235"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "235" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "235"
 Parameter: NPOS -> "143"
Evaluating: 235-143
 Parameter: J <- "92"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "92"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.461854626"
Evaluating: 125.050557*(0.461854626-0.5)
 Parameter: XPOS <- "-4.77010027"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.183549929"
Evaluating: 125.050557*(0.183549929-0.5)
 Parameter: YPOS <- "-39.5722576"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.17587827"
Evaluating: 152.572525*(0.17587827-0.5)+-4.51585405
 Parameter: ZPOS <- "-53.9679248"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.9679248" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.77010027"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.77010027-0
 Parameter: XTRAN <- "-4.77010027"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.5722576"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.5722576-0
 Parameter: YTRAN <- "-39.5722576"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.9679248"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.9679248-0
 Parameter: ZTRAN <- "-53.9679248"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.77010027"
 Parameter: YTRAN -> "-39.5722576"
 Parameter: ZTRAN -> "-53.9679248"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -4.770100  -39.572258  -53.967925
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.838838483"
Evaluating: 0.838838483*360.0
 Parameter: XPHI <- "301.981854"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950064665"
Evaluating: 0.950064665*360.0
 Parameter: YPHI <- "342.023279"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.858285781"
Evaluating: 0.858285781*360.0
 Parameter: ZPHI <- "308.982881"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.77010027"
 Parameter: YPOS -> "-39.5722576"
 Parameter: ZPOS -> "-53.9679248"
 Parameter: XPHI -> "301.981854"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.529651   -0.848216
    0.000000    0.848216    0.529651

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.77010027"
 Parameter: YPOS -> "-39.5722576"
 Parameter: ZPOS -> "-53.9679248"
 Parameter: YPHI -> "342.023279"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.951182    0.000000    0.308631
    0.000000    1.000000    0.000000
   -0.308631    0.000000    0.951182

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   17.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.77010027"
 Parameter: YPOS -> "-39.5722576"
 Parameter: ZPOS -> "-53.9679248"
 Parameter: ZPHI -> "308.982881"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.629088   -0.777334    0.000000
    0.777334    0.629088    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   51.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.770100 XMAX =   -4.770100 XAVE =   -4.770100
    YMIN =  -39.572258 YMAX =  -39.572258 YAVE =  -39.572258
    ZMIN =  -53.967925 ZMAX =  -53.967925 ZAVE =  -53.967925
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.77010027"
Evaluating: -4.77010027+3.5
 Parameter: XMAX <- "-1.27010027"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.5722576"
Evaluating: -39.5722576+3.5
 Parameter: YMAX <- "-36.0722576"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.9679248"
Evaluating: -53.9679248+3.5
 Parameter: ZMAX <- "-50.4679248"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.77010027"
Evaluating: -4.77010027-3.5
 Parameter: XMIN <- "-8.27010027"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.5722576"
Evaluating: -39.5722576-3.5
 Parameter: YMIN <- "-43.0722576"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.9679248"
Evaluating: -53.9679248-3.5
 Parameter: ZMIN <- "-57.4679248"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.27010027"
 Parameter: XMIN -> "-8.27010027"
 Parameter: YMAX -> "-36.0722576"
 Parameter: YMIN -> "-43.0722576"
 Parameter: ZMAX -> "-50.4679248"
 Parameter: ZMIN -> "-57.4679248"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "236"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "236" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "236"
Evaluating: 236
 Parameter: J <- "236"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "236" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "236"
 Parameter: NPOS -> "143"
Evaluating: 236-143
 Parameter: J <- "93"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "93"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.311842091"
Evaluating: 125.050557*(0.311842091-0.5)
 Parameter: XPOS <- "-23.5292513"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.393202359"
Evaluating: 125.050557*(0.393202359-0.5)
 Parameter: YPOS <- "-13.3551045"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.295839972"
Evaluating: 152.572525*(0.295839972-0.5)+-4.51585405
 Parameter: ZPOS <- "-35.665065"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.665065" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.5292513"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.5292513-0
 Parameter: XTRAN <- "-23.5292513"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.3551045"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.3551045-0
 Parameter: YTRAN <- "-13.3551045"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.665065"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -35.665065-0
 Parameter: ZTRAN <- "-35.665065"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.5292513"
 Parameter: YTRAN -> "-13.3551045"
 Parameter: ZTRAN -> "-35.665065"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -23.529251  -13.355104  -35.665065
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.68335472E-02"
Evaluating: 4.68335472E-02*360.0
 Parameter: XPHI <- "16.860077"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.996900999"
Evaluating: 0.996900999*360.0
 Parameter: YPHI <- "358.88436"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.676904432"
Evaluating: 0.676904432*360.0
 Parameter: ZPHI <- "243.685596"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.5292513"
 Parameter: YPOS -> "-13.3551045"
 Parameter: ZPOS -> "-35.665065"
 Parameter: XPHI -> "16.860077"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.957016    0.290035
    0.000000   -0.290035    0.957016

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   16.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.5292513"
 Parameter: YPOS -> "-13.3551045"
 Parameter: ZPOS -> "-35.665065"
 Parameter: YPHI -> "358.88436"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999810    0.000000    0.019470
    0.000000    1.000000    0.000000
   -0.019470    0.000000    0.999810

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    1.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.5292513"
 Parameter: YPOS -> "-13.3551045"
 Parameter: ZPOS -> "-35.665065"
 Parameter: ZPHI -> "243.685596"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.443297   -0.896375    0.000000
    0.896375   -0.443297    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  116.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.529251 XMAX =  -23.529251 XAVE =  -23.529251
    YMIN =  -13.355104 YMAX =  -13.355104 YAVE =  -13.355104
    ZMIN =  -35.665065 ZMAX =  -35.665065 ZAVE =  -35.665065
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.5292513"
Evaluating: -23.5292513+3.5
 Parameter: XMAX <- "-20.0292513"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.3551045"
Evaluating: -13.3551045+3.5
 Parameter: YMAX <- "-9.8551045"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.665065"
Evaluating: -35.665065+3.5
 Parameter: ZMAX <- "-32.165065"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.5292513"
Evaluating: -23.5292513-3.5
 Parameter: XMIN <- "-27.0292513"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.3551045"
Evaluating: -13.3551045-3.5
 Parameter: YMIN <- "-16.8551045"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.665065"
Evaluating: -35.665065-3.5
 Parameter: ZMIN <- "-39.165065"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.0292513"
 Parameter: XMIN -> "-27.0292513"
 Parameter: YMAX -> "-9.8551045"
 Parameter: YMIN -> "-16.8551045"
 Parameter: ZMAX -> "-32.165065"
 Parameter: ZMIN -> "-39.165065"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "237"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "237" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "237"
Evaluating: 237
 Parameter: J <- "237"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "237" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "237"
 Parameter: NPOS -> "143"
Evaluating: 237-143
 Parameter: J <- "94"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "94"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.30335704"
Evaluating: 125.050557*(0.30335704-0.5)
 Parameter: XPOS <- "-24.5903117"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.254931498"
Evaluating: 125.050557*(0.254931498-0.5)
 Parameter: YPOS <- "-30.6459527"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.895746251"
Evaluating: 152.572525*(0.895746251-0.5)+-4.51585405
 Parameter: ZPOS <- "55.8641507"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "55.8641507" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "55.8641507" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.5903117"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.5903117-0
 Parameter: XTRAN <- "-24.5903117"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.6459527"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.6459527-0
 Parameter: YTRAN <- "-30.6459527"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "55.8641507"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 55.8641507-0
 Parameter: ZTRAN <- "55.8641507"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.5903117"
 Parameter: YTRAN -> "-30.6459527"
 Parameter: ZTRAN -> "55.8641507"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -24.590312  -30.645953   55.864151
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.878556612"
Evaluating: 0.878556612*360.0
 Parameter: XPHI <- "316.28038"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.903192636"
Evaluating: 0.903192636*360.0
 Parameter: YPHI <- "325.149349"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.476635463"
Evaluating: 0.476635463*360.0
 Parameter: ZPHI <- "171.588767"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.5903117"
 Parameter: YPOS -> "-30.6459527"
 Parameter: ZPOS -> "55.8641507"
 Parameter: XPHI -> "316.28038"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.722731   -0.691130
    0.000000    0.691130    0.722731

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   43.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.5903117"
 Parameter: YPOS -> "-30.6459527"
 Parameter: ZPOS -> "55.8641507"
 Parameter: YPHI -> "325.149349"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.820644    0.000000    0.571439
    0.000000    1.000000    0.000000
   -0.571439    0.000000    0.820644

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   34.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.5903117"
 Parameter: YPOS -> "-30.6459527"
 Parameter: ZPOS -> "55.8641507"
 Parameter: ZPHI -> "171.588767"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.989244    0.146277    0.000000
   -0.146277   -0.989244    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  171.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.590312 XMAX =  -24.590312 XAVE =  -24.590312
    YMIN =  -30.645953 YMAX =  -30.645953 YAVE =  -30.645953
    ZMIN =   55.864151 ZMAX =   55.864151 ZAVE =   55.864151
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.5903117"
Evaluating: -24.5903117+3.5
 Parameter: XMAX <- "-21.0903117"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.6459527"
Evaluating: -30.6459527+3.5
 Parameter: YMAX <- "-27.1459527"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "55.8641507"
Evaluating: 55.8641507+3.5
 Parameter: ZMAX <- "59.3641507"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.5903117"
Evaluating: -24.5903117-3.5
 Parameter: XMIN <- "-28.0903117"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.6459527"
Evaluating: -30.6459527-3.5
 Parameter: YMIN <- "-34.1459527"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "55.8641507"
Evaluating: 55.8641507-3.5
 Parameter: ZMIN <- "52.3641507"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.0903117"
 Parameter: XMIN -> "-28.0903117"
 Parameter: YMAX -> "-27.1459527"
 Parameter: YMIN -> "-34.1459527"
 Parameter: ZMAX -> "59.3641507"
 Parameter: ZMIN -> "52.3641507"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "238"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "238" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "238"
Evaluating: 238
 Parameter: J <- "238"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "238" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "238"
 Parameter: NPOS -> "143"
Evaluating: 238-143
 Parameter: J <- "95"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "95"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.876351094"
Evaluating: 125.050557*(0.876351094-0.5)
 Parameter: XPOS <- "47.0629139"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.830743466"
Evaluating: 125.050557*(0.830743466-0.5)
 Parameter: YPOS <- "41.3596546"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.982914643"
Evaluating: 152.572525*(0.982914643-0.5)+-4.51585405
 Parameter: ZPOS <- "69.1636524"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.1636524" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.1636524" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "47.0629139"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 47.0629139-0
 Parameter: XTRAN <- "47.0629139"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.3596546"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.3596546-0
 Parameter: YTRAN <- "41.3596546"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.1636524"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 69.1636524-0
 Parameter: ZTRAN <- "69.1636524"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "47.0629139"
 Parameter: YTRAN -> "41.3596546"
 Parameter: ZTRAN -> "69.1636524"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    47.062914   41.359655   69.163652
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.100392566"
Evaluating: 0.100392566*360.0
 Parameter: XPHI <- "36.1413238"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.683205095"
Evaluating: 0.683205095*360.0
 Parameter: YPHI <- "245.953834"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.112631425"
Evaluating: 0.112631425*360.0
 Parameter: ZPHI <- "40.547313"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "47.0629139"
 Parameter: YPOS -> "41.3596546"
 Parameter: ZPOS -> "69.1636524"
 Parameter: XPHI -> "36.1413238"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.807565    0.589779
    0.000000   -0.589779    0.807565

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   36.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "47.0629139"
 Parameter: YPOS -> "41.3596546"
 Parameter: ZPOS -> "69.1636524"
 Parameter: YPHI -> "245.953834"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.407473    0.000000    0.913217
    0.000000    1.000000    0.000000
   -0.913217    0.000000   -0.407473

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  114.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "47.0629139"
 Parameter: YPOS -> "41.3596546"
 Parameter: ZPOS -> "69.1636524"
 Parameter: ZPHI -> "40.547313"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.759869    0.650076    0.000000
   -0.650076    0.759869    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   40.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   47.062914 XMAX =   47.062914 XAVE =   47.062914
    YMIN =   41.359655 YMAX =   41.359655 YAVE =   41.359655
    ZMIN =   69.163652 ZMAX =   69.163652 ZAVE =   69.163652
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "47.0629139"
Evaluating: 47.0629139+3.5
 Parameter: XMAX <- "50.5629139"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.3596546"
Evaluating: 41.3596546+3.5
 Parameter: YMAX <- "44.8596546"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.1636524"
Evaluating: 69.1636524+3.5
 Parameter: ZMAX <- "72.6636524"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "47.0629139"
Evaluating: 47.0629139-3.5
 Parameter: XMIN <- "43.5629139"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.3596546"
Evaluating: 41.3596546-3.5
 Parameter: YMIN <- "37.8596546"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.1636524"
Evaluating: 69.1636524-3.5
 Parameter: ZMIN <- "65.6636524"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.5629139"
 Parameter: XMIN -> "43.5629139"
 Parameter: YMAX -> "44.8596546"
 Parameter: YMIN -> "37.8596546"
 Parameter: ZMAX -> "72.6636524"
 Parameter: ZMIN -> "65.6636524"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "239"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "239" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "239"
Evaluating: 239
 Parameter: J <- "239"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "239" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "239"
 Parameter: NPOS -> "143"
Evaluating: 239-143
 Parameter: J <- "96"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "96"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.971819554"
Evaluating: 125.050557*(0.971819554-0.5)
 Parameter: XPOS <- "59.001298"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.956340792"
Evaluating: 125.050557*(0.956340792-0.5)
 Parameter: YPOS <- "57.0656702"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.516698856"
Evaluating: 152.572525*(0.516698856-0.5)+-4.51585405
 Parameter: ZPOS <- "-1.96806743"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.96806743" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.96806743" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "239"
Evaluating: 239
 Parameter: J <- "239"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "239" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "239"
 Parameter: NPOS -> "143"
Evaluating: 239-143
 Parameter: J <- "96"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "96"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.856983036"
Evaluating: 125.050557*(0.856983036-0.5)
 Parameter: XPOS <- "44.6409275"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.27056082"
Evaluating: 125.050557*(0.27056082-0.5)
 Parameter: YPOS <- "-28.6914973"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.211574581"
Evaluating: 152.572525*(0.211574581-0.5)+-4.51585405
 Parameter: ZPOS <- "-48.5216485"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.5216485" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.6409275"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 44.6409275-0
 Parameter: XTRAN <- "44.6409275"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.6914973"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.6914973-0
 Parameter: YTRAN <- "-28.6914973"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.5216485"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.5216485-0
 Parameter: ZTRAN <- "-48.5216485"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.6409275"
 Parameter: YTRAN -> "-28.6914973"
 Parameter: ZTRAN -> "-48.5216485"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    44.640927  -28.691497  -48.521648
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.731291353"
Evaluating: 0.731291353*360.0
 Parameter: XPHI <- "263.264887"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.423237822"
Evaluating: 0.423237822*360.0
 Parameter: YPHI <- "152.365616"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.611893606"
Evaluating: 0.611893606*360.0
 Parameter: ZPHI <- "220.281698"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.6409275"
 Parameter: YPOS -> "-28.6914973"
 Parameter: ZPOS -> "-48.5216485"
 Parameter: XPHI -> "263.264887"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.117279   -0.993099
    0.000000    0.993099   -0.117279

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   96.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.6409275"
 Parameter: YPOS -> "-28.6914973"
 Parameter: ZPOS -> "-48.5216485"
 Parameter: YPHI -> "152.365616"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.885925    0.000000   -0.463828
    0.000000    1.000000    0.000000
    0.463828    0.000000   -0.885925

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  152.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.6409275"
 Parameter: YPOS -> "-28.6914973"
 Parameter: ZPOS -> "-48.5216485"
 Parameter: ZPHI -> "220.281698"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.762875   -0.646546    0.000000
    0.646546   -0.762875    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  139.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.640927 XMAX =   44.640927 XAVE =   44.640927
    YMIN =  -28.691497 YMAX =  -28.691497 YAVE =  -28.691497
    ZMIN =  -48.521648 ZMAX =  -48.521648 ZAVE =  -48.521648
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.6409275"
Evaluating: 44.6409275+3.5
 Parameter: XMAX <- "48.1409275"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.6914973"
Evaluating: -28.6914973+3.5
 Parameter: YMAX <- "-25.1914973"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.5216485"
Evaluating: -48.5216485+3.5
 Parameter: ZMAX <- "-45.0216485"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.6409275"
Evaluating: 44.6409275-3.5
 Parameter: XMIN <- "41.1409275"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.6914973"
Evaluating: -28.6914973-3.5
 Parameter: YMIN <- "-32.1914973"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.5216485"
Evaluating: -48.5216485-3.5
 Parameter: ZMIN <- "-52.0216485"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "48.1409275"
 Parameter: XMIN -> "41.1409275"
 Parameter: YMAX -> "-25.1914973"
 Parameter: YMIN -> "-32.1914973"
 Parameter: ZMAX -> "-45.0216485"
 Parameter: ZMIN -> "-52.0216485"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "240"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "240" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "240"
Evaluating: 240
 Parameter: J <- "240"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "240" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "240"
 Parameter: NPOS -> "143"
Evaluating: 240-143
 Parameter: J <- "97"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "97"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.560306424"
Evaluating: 125.050557*(0.560306424-0.5)
 Parameter: XPOS <- "7.54135191"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "4.268113538E-02"
Evaluating: 125.050557*(4.268113538E-02-0.5)
 Parameter: YPOS <- "-57.1879787"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.808576358"
Evaluating: 152.572525*(0.808576358-0.5)+-4.51585405
 Parameter: ZPOS <- "42.56442"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "42.56442" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "42.56442" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.54135191"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.54135191-0
 Parameter: XTRAN <- "7.54135191"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-57.1879787"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -57.1879787-0
 Parameter: YTRAN <- "-57.1879787"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "42.56442"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 42.56442-0
 Parameter: ZTRAN <- "42.56442"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.54135191"
 Parameter: YTRAN -> "-57.1879787"
 Parameter: ZTRAN -> "42.56442"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     7.541352  -57.187979   42.564420
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.507418717"
Evaluating: 0.507418717*360.0
 Parameter: XPHI <- "182.670738"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.870894434"
Evaluating: 0.870894434*360.0
 Parameter: YPHI <- "313.521996"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.122417444"
Evaluating: 0.122417444*360.0
 Parameter: ZPHI <- "44.0702798"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.54135191"
 Parameter: YPOS -> "-57.1879787"
 Parameter: ZPOS -> "42.56442"
 Parameter: XPHI -> "182.670738"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.998914   -0.046596
    0.000000    0.046596   -0.998914

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  177.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.54135191"
 Parameter: YPOS -> "-57.1879787"
 Parameter: ZPOS -> "42.56442"
 Parameter: YPHI -> "313.521996"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.688633    0.000000    0.725110
    0.000000    1.000000    0.000000
   -0.725110    0.000000    0.688633

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   46.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.54135191"
 Parameter: YPOS -> "-57.1879787"
 Parameter: ZPOS -> "42.56442"
 Parameter: ZPHI -> "44.0702798"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.718487    0.695540    0.000000
   -0.695540    0.718487    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   44.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.541352 XMAX =    7.541352 XAVE =    7.541352
    YMIN =  -57.187979 YMAX =  -57.187979 YAVE =  -57.187979
    ZMIN =   42.564420 ZMAX =   42.564420 ZAVE =   42.564420
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.54135191"
Evaluating: 7.54135191+3.5
 Parameter: XMAX <- "11.0413519"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-57.1879787"
Evaluating: -57.1879787+3.5
 Parameter: YMAX <- "-53.6879787"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "42.56442"
Evaluating: 42.56442+3.5
 Parameter: ZMAX <- "46.06442"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.54135191"
Evaluating: 7.54135191-3.5
 Parameter: XMIN <- "4.04135191"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-57.1879787"
Evaluating: -57.1879787-3.5
 Parameter: YMIN <- "-60.6879787"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "42.56442"
Evaluating: 42.56442-3.5
 Parameter: ZMIN <- "39.06442"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.0413519"
 Parameter: XMIN -> "4.04135191"
 Parameter: YMAX -> "-53.6879787"
 Parameter: YMIN -> "-60.6879787"
 Parameter: ZMAX -> "46.06442"
 Parameter: ZMIN -> "39.06442"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "241"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "241" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "241"
Evaluating: 241
 Parameter: J <- "241"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "241" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "241"
 Parameter: NPOS -> "143"
Evaluating: 241-143
 Parameter: J <- "98"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "98"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.423726052"
Evaluating: 125.050557*(0.423726052-0.5)
 Parameter: XPOS <- "-9.53809968"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.69758274"
Evaluating: 125.050557*(0.69758274-0.5)
 Parameter: YPOS <- "24.7078317"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.250050718"
Evaluating: 152.572525*(0.250050718-0.5)+-4.51585405
 Parameter: ZPOS <- "-42.6512471"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.6512471" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.53809968"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.53809968-0
 Parameter: XTRAN <- "-9.53809968"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.7078317"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.7078317-0
 Parameter: YTRAN <- "24.7078317"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.6512471"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.6512471-0
 Parameter: ZTRAN <- "-42.6512471"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.53809968"
 Parameter: YTRAN -> "24.7078317"
 Parameter: ZTRAN -> "-42.6512471"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -9.538100   24.707832  -42.651247
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.635813299"
Evaluating: 0.635813299*360.0
 Parameter: XPHI <- "228.892788"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.402262707"
Evaluating: 0.402262707*360.0
 Parameter: YPHI <- "144.814575"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.801833717"
Evaluating: 0.801833717*360.0
 Parameter: ZPHI <- "288.660138"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.53809968"
 Parameter: YPOS -> "24.7078317"
 Parameter: ZPOS -> "-42.6512471"
 Parameter: XPHI -> "228.892788"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.657470   -0.753481
    0.000000    0.753481   -0.657470

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  131.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.53809968"
 Parameter: YPOS -> "24.7078317"
 Parameter: ZPOS -> "-42.6512471"
 Parameter: YPHI -> "144.814575"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.817292    0.000000   -0.576224
    0.000000    1.000000    0.000000
    0.576224    0.000000   -0.817292

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  144.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.53809968"
 Parameter: YPOS -> "24.7078317"
 Parameter: ZPOS -> "-42.6512471"
 Parameter: ZPHI -> "288.660138"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.319954   -0.947433    0.000000
    0.947433    0.319954    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   71.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.538100 XMAX =   -9.538100 XAVE =   -9.538100
    YMIN =   24.707832 YMAX =   24.707832 YAVE =   24.707832
    ZMIN =  -42.651247 ZMAX =  -42.651247 ZAVE =  -42.651247
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.53809968"
Evaluating: -9.53809968+3.5
 Parameter: XMAX <- "-6.03809968"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.7078317"
Evaluating: 24.7078317+3.5
 Parameter: YMAX <- "28.2078317"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.6512471"
Evaluating: -42.6512471+3.5
 Parameter: ZMAX <- "-39.1512471"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.53809968"
Evaluating: -9.53809968-3.5
 Parameter: XMIN <- "-13.0380997"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.7078317"
Evaluating: 24.7078317-3.5
 Parameter: YMIN <- "21.2078317"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.6512471"
Evaluating: -42.6512471-3.5
 Parameter: ZMIN <- "-46.1512471"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.03809968"
 Parameter: XMIN -> "-13.0380997"
 Parameter: YMAX -> "28.2078317"
 Parameter: YMIN -> "21.2078317"
 Parameter: ZMAX -> "-39.1512471"
 Parameter: ZMIN -> "-46.1512471"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "242"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "242" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "242"
Evaluating: 242
 Parameter: J <- "242"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "242" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "242"
 Parameter: NPOS -> "143"
Evaluating: 242-143
 Parameter: J <- "99"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "2.40901647E-02"
Evaluating: 125.050557*(2.40901647E-02-0.5)
 Parameter: XPOS <- "-59.51279"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.623273603"
Evaluating: 125.050557*(0.623273603-0.5)
 Parameter: YPOS <- "15.4154327"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.11387059"
Evaluating: 152.572525*(0.11387059-0.5)+-4.51585405
 Parameter: ZPOS <- "-63.4285931"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-63.4285931" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-59.51279"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -59.51279-0
 Parameter: XTRAN <- "-59.51279"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.4154327"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.4154327-0
 Parameter: YTRAN <- "15.4154327"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-63.4285931"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -63.4285931-0
 Parameter: ZTRAN <- "-63.4285931"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-59.51279"
 Parameter: YTRAN -> "15.4154327"
 Parameter: ZTRAN -> "-63.4285931"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -59.512790   15.415433  -63.428593
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.437187288"
Evaluating: 0.437187288*360.0
 Parameter: XPHI <- "157.387424"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.278747924"
Evaluating: 0.278747924*360.0
 Parameter: YPHI <- "100.349253"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.664510692"
Evaluating: 0.664510692*360.0
 Parameter: ZPHI <- "239.223849"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-59.51279"
 Parameter: YPOS -> "15.4154327"
 Parameter: ZPOS -> "-63.4285931"
 Parameter: XPHI -> "157.387424"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.923126    0.384498
    0.000000   -0.384498   -0.923126

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  157.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-59.51279"
 Parameter: YPOS -> "15.4154327"
 Parameter: ZPOS -> "-63.4285931"
 Parameter: YPHI -> "100.349253"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.179648    0.000000   -0.983731
    0.000000    1.000000    0.000000
    0.983731    0.000000   -0.179648

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  100.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-59.51279"
 Parameter: YPOS -> "15.4154327"
 Parameter: ZPOS -> "-63.4285931"
 Parameter: ZPHI -> "239.223849"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.511685   -0.859173    0.000000
    0.859173   -0.511685    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  120.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -59.512790 XMAX =  -59.512790 XAVE =  -59.512790
    YMIN =   15.415433 YMAX =   15.415433 YAVE =   15.415433
    ZMIN =  -63.428593 ZMAX =  -63.428593 ZAVE =  -63.428593
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-59.51279"
Evaluating: -59.51279+3.5
 Parameter: XMAX <- "-56.01279"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.4154327"
Evaluating: 15.4154327+3.5
 Parameter: YMAX <- "18.9154327"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-63.4285931"
Evaluating: -63.4285931+3.5
 Parameter: ZMAX <- "-59.9285931"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-59.51279"
Evaluating: -59.51279-3.5
 Parameter: XMIN <- "-63.01279"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.4154327"
Evaluating: 15.4154327-3.5
 Parameter: YMIN <- "11.9154327"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-63.4285931"
Evaluating: -63.4285931-3.5
 Parameter: ZMIN <- "-66.9285931"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-56.01279"
 Parameter: XMIN -> "-63.01279"
 Parameter: YMAX -> "18.9154327"
 Parameter: YMIN -> "11.9154327"
 Parameter: ZMAX -> "-59.9285931"
 Parameter: ZMIN -> "-66.9285931"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64657 NEG      CLA      99       CLA     -**** POS      SOD      21       SOD           2.3408
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "242"
Evaluating: 242
 Parameter: J <- "242"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "242" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "242"
 Parameter: NPOS -> "143"
Evaluating: 242-143
 Parameter: J <- "99"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.864967655"
Evaluating: 125.050557*(0.864967655-0.5)
 Parameter: XPOS <- "45.6394085"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.366244267"
Evaluating: 125.050557*(0.366244267-0.5)
 Parameter: YPOS <- "-16.7262289"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.554534006"
Evaluating: 152.572525*(0.554534006-0.5)+-4.51585405
 Parameter: ZPOS <- "3.80453694"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.80453694" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.80453694" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "242"
Evaluating: 242
 Parameter: J <- "242"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "242" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "242"
 Parameter: NPOS -> "143"
Evaluating: 242-143
 Parameter: J <- "99"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "99"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.37685777"
Evaluating: 125.050557*(0.37685777-0.5)
 Parameter: XPOS <- "-15.3990045"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.778815678"
Evaluating: 125.050557*(0.778815678-0.5)
 Parameter: YPOS <- "34.8660558"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.128245945"
Evaluating: 152.572525*(0.128245945-0.5)+-4.51585405
 Parameter: ZPOS <- "-61.2353089"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-61.2353089" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -59.512790 XMAX =  -59.512790 XAVE =  -59.512790
    YMIN =   15.415433 YMAX =   15.415433 YAVE =   15.415433
    ZMIN =  -63.428593 ZMAX =  -63.428593 ZAVE =  -63.428593
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-15.3990045"
 RDCMND substituted energy or value "?XAVE" to "-59.51279"
Evaluating: -15.3990045--59.51279
 Parameter: XTRAN <- "44.1137855"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.8660558"
 RDCMND substituted energy or value "?YAVE" to "15.4154327"
Evaluating: 34.8660558-15.4154327
 Parameter: YTRAN <- "19.4506231"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-61.2353089"
 RDCMND substituted energy or value "?ZAVE" to "-63.4285931"
Evaluating: -61.2353089--63.4285931
 Parameter: ZTRAN <- "2.1932842"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.1137855"
 Parameter: YTRAN -> "19.4506231"
 Parameter: ZTRAN -> "2.1932842"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    44.113785   19.450623    2.193284
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.154261723"
Evaluating: 0.154261723*360.0
 Parameter: XPHI <- "55.5342203"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.413645936"
Evaluating: 0.413645936*360.0
 Parameter: YPHI <- "148.912537"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.831572056"
Evaluating: 0.831572056*360.0
 Parameter: ZPHI <- "299.36594"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-15.3990045"
 Parameter: YPOS -> "34.8660558"
 Parameter: ZPOS -> "-61.2353089"
 Parameter: XPHI -> "55.5342203"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.565914    0.824464
    0.000000   -0.824464    0.565914

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   55.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-15.3990045"
 Parameter: YPOS -> "34.8660558"
 Parameter: ZPOS -> "-61.2353089"
 Parameter: YPHI -> "148.912537"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.856380    0.000000   -0.516346
    0.000000    1.000000    0.000000
    0.516346    0.000000   -0.856380

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  148.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-15.3990045"
 Parameter: YPOS -> "34.8660558"
 Parameter: ZPOS -> "-61.2353089"
 Parameter: ZPHI -> "299.36594"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.490386   -0.871505    0.000000
    0.871505    0.490386    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.399004 XMAX =  -15.399004 XAVE =  -15.399004
    YMIN =   34.866056 YMAX =   34.866056 YAVE =   34.866056
    ZMIN =  -61.235309 ZMAX =  -61.235309 ZAVE =  -61.235309
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-15.3990045"
Evaluating: -15.3990045+3.5
 Parameter: XMAX <- "-11.8990045"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.8660558"
Evaluating: 34.8660558+3.5
 Parameter: YMAX <- "38.3660558"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-61.2353089"
Evaluating: -61.2353089+3.5
 Parameter: ZMAX <- "-57.7353089"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-15.3990045"
Evaluating: -15.3990045-3.5
 Parameter: XMIN <- "-18.8990045"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.8660558"
Evaluating: 34.8660558-3.5
 Parameter: YMIN <- "31.3660558"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-61.2353089"
Evaluating: -61.2353089-3.5
 Parameter: ZMIN <- "-64.7353089"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.8990045"
 Parameter: XMIN -> "-18.8990045"
 Parameter: YMAX -> "38.3660558"
 Parameter: YMIN -> "31.3660558"
 Parameter: ZMAX -> "-57.7353089"
 Parameter: ZMIN -> "-64.7353089"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "243"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "243" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "243"
Evaluating: 243
 Parameter: J <- "243"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "243" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "243"
 Parameter: NPOS -> "143"
Evaluating: 243-143
 Parameter: J <- "100"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "100"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.866623591"
Evaluating: 125.050557*(0.866623591-0.5)
 Parameter: XPOS <- "45.8464843"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.352192764"
Evaluating: 125.050557*(0.352192764-0.5)
 Parameter: YPOS <- "-18.4833772"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.466802233"
Evaluating: 152.572525*(0.466802233-0.5)+-4.51585405
 Parameter: ZPOS <- "-9.58092119"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.58092119" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.58092119" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "243"
Evaluating: 243
 Parameter: J <- "243"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "243" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "243"
 Parameter: NPOS -> "143"
Evaluating: 243-143
 Parameter: J <- "100"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "100"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.914209465"
Evaluating: 125.050557*(0.914209465-0.5)
 Parameter: XPOS <- "51.7971243"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.124345398"
Evaluating: 125.050557*(0.124345398-0.5)
 Parameter: YPOS <- "-46.9758172"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.945256571"
Evaluating: 152.572525*(0.945256571-0.5)+-4.51585405
 Parameter: ZPOS <- "63.4180653"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.4180653" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.4180653" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.7971243"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.7971243-0
 Parameter: XTRAN <- "51.7971243"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.9758172"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.9758172-0
 Parameter: YTRAN <- "-46.9758172"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.4180653"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 63.4180653-0
 Parameter: ZTRAN <- "63.4180653"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.7971243"
 Parameter: YTRAN -> "-46.9758172"
 Parameter: ZTRAN -> "63.4180653"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    51.797124  -46.975817   63.418065
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.411170834"
Evaluating: 0.411170834*360.0
 Parameter: XPHI <- "148.0215"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.382396865"
Evaluating: 0.382396865*360.0
 Parameter: YPHI <- "137.662871"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.916661437"
Evaluating: 0.916661437*360.0
 Parameter: ZPHI <- "329.998117"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.7971243"
 Parameter: YPOS -> "-46.9758172"
 Parameter: ZPOS -> "63.4180653"
 Parameter: XPHI -> "148.0215"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.848247    0.529601
    0.000000   -0.529601   -0.848247

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  148.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.7971243"
 Parameter: YPOS -> "-46.9758172"
 Parameter: ZPOS -> "63.4180653"
 Parameter: YPHI -> "137.662871"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.739195    0.000000   -0.673492
    0.000000    1.000000    0.000000
    0.673492    0.000000   -0.739195

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  137.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.7971243"
 Parameter: YPOS -> "-46.9758172"
 Parameter: ZPOS -> "63.4180653"
 Parameter: ZPHI -> "329.998117"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.866009   -0.500028    0.000000
    0.500028    0.866009    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   30.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.797124 XMAX =   51.797124 XAVE =   51.797124
    YMIN =  -46.975817 YMAX =  -46.975817 YAVE =  -46.975817
    ZMIN =   63.418065 ZMAX =   63.418065 ZAVE =   63.418065
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.7971243"
Evaluating: 51.7971243+3.5
 Parameter: XMAX <- "55.2971243"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.9758172"
Evaluating: -46.9758172+3.5
 Parameter: YMAX <- "-43.4758172"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.4180653"
Evaluating: 63.4180653+3.5
 Parameter: ZMAX <- "66.9180653"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.7971243"
Evaluating: 51.7971243-3.5
 Parameter: XMIN <- "48.2971243"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.9758172"
Evaluating: -46.9758172-3.5
 Parameter: YMIN <- "-50.4758172"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.4180653"
Evaluating: 63.4180653-3.5
 Parameter: ZMIN <- "59.9180653"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.2971243"
 Parameter: XMIN -> "48.2971243"
 Parameter: YMAX -> "-43.4758172"
 Parameter: YMIN -> "-50.4758172"
 Parameter: ZMAX -> "66.9180653"
 Parameter: ZMIN -> "59.9180653"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "244"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "244" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "244"
Evaluating: 244
 Parameter: J <- "244"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "244" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "244"
 Parameter: NPOS -> "143"
Evaluating: 244-143
 Parameter: J <- "101"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "101"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.246043083"
Evaluating: 125.050557*(0.246043083-0.5)
 Parameter: XPOS <- "-31.7574539"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.771099953"
Evaluating: 125.050557*(0.771099953-0.5)
 Parameter: YPOS <- "33.9012001"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.799151397"
Evaluating: 152.572525*(0.799151397-0.5)+-4.51585405
 Parameter: ZPOS <- "41.1264299"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.1264299" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.1264299" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.7574539"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.7574539-0
 Parameter: XTRAN <- "-31.7574539"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.9012001"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.9012001-0
 Parameter: YTRAN <- "33.9012001"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.1264299"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.1264299-0
 Parameter: ZTRAN <- "41.1264299"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.7574539"
 Parameter: YTRAN -> "33.9012001"
 Parameter: ZTRAN -> "41.1264299"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -31.757454   33.901200   41.126430
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.323806758"
Evaluating: 0.323806758*360.0
 Parameter: XPHI <- "116.570433"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.403842531"
Evaluating: 0.403842531*360.0
 Parameter: YPHI <- "145.383311"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.597214825"
Evaluating: 0.597214825*360.0
 Parameter: ZPHI <- "214.997337"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.7574539"
 Parameter: YPOS -> "33.9012001"
 Parameter: ZPOS -> "41.1264299"
 Parameter: XPHI -> "116.570433"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.447298    0.894385
    0.000000   -0.894385   -0.447298

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  116.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.7574539"
 Parameter: YPOS -> "33.9012001"
 Parameter: ZPOS -> "41.1264299"
 Parameter: YPHI -> "145.383311"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.822971    0.000000   -0.568083
    0.000000    1.000000    0.000000
    0.568083    0.000000   -0.822971

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  145.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.7574539"
 Parameter: YPOS -> "33.9012001"
 Parameter: ZPOS -> "41.1264299"
 Parameter: ZPHI -> "214.997337"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.819179   -0.573538    0.000000
    0.573538   -0.819179    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  145.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.757454 XMAX =  -31.757454 XAVE =  -31.757454
    YMIN =   33.901200 YMAX =   33.901200 YAVE =   33.901200
    ZMIN =   41.126430 ZMAX =   41.126430 ZAVE =   41.126430
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.7574539"
Evaluating: -31.7574539+3.5
 Parameter: XMAX <- "-28.2574539"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.9012001"
Evaluating: 33.9012001+3.5
 Parameter: YMAX <- "37.4012001"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.1264299"
Evaluating: 41.1264299+3.5
 Parameter: ZMAX <- "44.6264299"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.7574539"
Evaluating: -31.7574539-3.5
 Parameter: XMIN <- "-35.2574539"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.9012001"
Evaluating: 33.9012001-3.5
 Parameter: YMIN <- "30.4012001"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.1264299"
Evaluating: 41.1264299-3.5
 Parameter: ZMIN <- "37.6264299"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.2574539"
 Parameter: XMIN -> "-35.2574539"
 Parameter: YMAX -> "37.4012001"
 Parameter: YMIN -> "30.4012001"
 Parameter: ZMAX -> "44.6264299"
 Parameter: ZMIN -> "37.6264299"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "245"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "245" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "245"
Evaluating: 245
 Parameter: J <- "245"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "245" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "245"
 Parameter: NPOS -> "143"
Evaluating: 245-143
 Parameter: J <- "102"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "102"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "5.008807647E-02"
Evaluating: 125.050557*(5.008807647E-02-0.5)
 Parameter: XPOS <- "-56.2617366"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.636302189"
Evaluating: 125.050557*(0.636302189-0.5)
 Parameter: YPOS <- "17.0446647"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.849471533"
Evaluating: 152.572525*(0.849471533-0.5)+-4.51585405
 Parameter: ZPOS <- "48.8039002"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.8039002" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.8039002" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-56.2617366"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -56.2617366-0
 Parameter: XTRAN <- "-56.2617366"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.0446647"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.0446647-0
 Parameter: YTRAN <- "17.0446647"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.8039002"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 48.8039002-0
 Parameter: ZTRAN <- "48.8039002"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-56.2617366"
 Parameter: YTRAN -> "17.0446647"
 Parameter: ZTRAN -> "48.8039002"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -56.261737   17.044665   48.803900
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.249875673"
Evaluating: 0.249875673*360.0
 Parameter: XPHI <- "89.9552423"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.579939623"
Evaluating: 0.579939623*360.0
 Parameter: YPHI <- "208.778264"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.277298234"
Evaluating: 0.277298234*360.0
 Parameter: ZPHI <- "99.8273642"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-56.2617366"
 Parameter: YPOS -> "17.0446647"
 Parameter: ZPOS -> "48.8039002"
 Parameter: XPHI -> "89.9552423"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.000781    1.000000
    0.000000   -1.000000    0.000781

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   89.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-56.2617366"
 Parameter: YPOS -> "17.0446647"
 Parameter: ZPOS -> "48.8039002"
 Parameter: YPHI -> "208.778264"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.876489    0.000000    0.481421
    0.000000    1.000000    0.000000
   -0.481421    0.000000   -0.876489

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  151.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-56.2617366"
 Parameter: YPOS -> "17.0446647"
 Parameter: ZPOS -> "48.8039002"
 Parameter: ZPHI -> "99.8273642"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.170680    0.985326    0.000000
   -0.985326   -0.170680    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   99.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -56.261737 XMAX =  -56.261737 XAVE =  -56.261737
    YMIN =   17.044665 YMAX =   17.044665 YAVE =   17.044665
    ZMIN =   48.803900 ZMAX =   48.803900 ZAVE =   48.803900
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-56.2617366"
Evaluating: -56.2617366+3.5
 Parameter: XMAX <- "-52.7617366"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.0446647"
Evaluating: 17.0446647+3.5
 Parameter: YMAX <- "20.5446647"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.8039002"
Evaluating: 48.8039002+3.5
 Parameter: ZMAX <- "52.3039002"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-56.2617366"
Evaluating: -56.2617366-3.5
 Parameter: XMIN <- "-59.7617366"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.0446647"
Evaluating: 17.0446647-3.5
 Parameter: YMIN <- "13.5446647"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.8039002"
Evaluating: 48.8039002-3.5
 Parameter: ZMIN <- "45.3039002"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-52.7617366"
 Parameter: XMIN -> "-59.7617366"
 Parameter: YMAX -> "20.5446647"
 Parameter: YMIN -> "13.5446647"
 Parameter: ZMAX -> "52.3039002"
 Parameter: ZMIN -> "45.3039002"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "246"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "246" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "246"
Evaluating: 246
 Parameter: J <- "246"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "246" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "246"
 Parameter: NPOS -> "143"
Evaluating: 246-143
 Parameter: J <- "103"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "103"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.508420075"
Evaluating: 125.050557*(0.508420075-0.5)
 Parameter: XPOS <- "1.05293507"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.641747659"
Evaluating: 125.050557*(0.641747659-0.5)
 Parameter: YPOS <- "17.7256237"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.967831176"
Evaluating: 152.572525*(0.967831176-0.5)+-4.51585405
 Parameter: ZPOS <- "66.8623297"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "66.8623297" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "66.8623297" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.05293507"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.05293507-0
 Parameter: XTRAN <- "1.05293507"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.7256237"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.7256237-0
 Parameter: YTRAN <- "17.7256237"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "66.8623297"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 66.8623297-0
 Parameter: ZTRAN <- "66.8623297"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.05293507"
 Parameter: YTRAN -> "17.7256237"
 Parameter: ZTRAN -> "66.8623297"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     1.052935   17.725624   66.862330
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.034870211E-02"
Evaluating: 1.034870211E-02*360.0
 Parameter: XPHI <- "3.72553276"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.906343022"
Evaluating: 0.906343022*360.0
 Parameter: YPHI <- "326.283488"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.137265602"
Evaluating: 0.137265602*360.0
 Parameter: ZPHI <- "49.4156167"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.05293507"
 Parameter: YPOS -> "17.7256237"
 Parameter: ZPOS -> "66.8623297"
 Parameter: XPHI -> "3.72553276"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997887    0.064977
    0.000000   -0.064977    0.997887

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.05293507"
 Parameter: YPOS -> "17.7256237"
 Parameter: ZPOS -> "66.8623297"
 Parameter: YPHI -> "326.283488"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.831794    0.000000    0.555084
    0.000000    1.000000    0.000000
   -0.555084    0.000000    0.831794

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   33.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.05293507"
 Parameter: YPOS -> "17.7256237"
 Parameter: ZPOS -> "66.8623297"
 Parameter: ZPHI -> "49.4156167"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.650567    0.759449    0.000000
   -0.759449    0.650567    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   49.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.052935 XMAX =    1.052935 XAVE =    1.052935
    YMIN =   17.725624 YMAX =   17.725624 YAVE =   17.725624
    ZMIN =   66.862330 ZMAX =   66.862330 ZAVE =   66.862330
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.05293507"
Evaluating: 1.05293507+3.5
 Parameter: XMAX <- "4.55293507"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.7256237"
Evaluating: 17.7256237+3.5
 Parameter: YMAX <- "21.2256237"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "66.8623297"
Evaluating: 66.8623297+3.5
 Parameter: ZMAX <- "70.3623297"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.05293507"
Evaluating: 1.05293507-3.5
 Parameter: XMIN <- "-2.44706493"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.7256237"
Evaluating: 17.7256237-3.5
 Parameter: YMIN <- "14.2256237"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "66.8623297"
Evaluating: 66.8623297-3.5
 Parameter: ZMIN <- "63.3623297"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.55293507"
 Parameter: XMIN -> "-2.44706493"
 Parameter: YMAX -> "21.2256237"
 Parameter: YMIN -> "14.2256237"
 Parameter: ZMAX -> "70.3623297"
 Parameter: ZMIN -> "63.3623297"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "247"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "247" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "247"
Evaluating: 247
 Parameter: J <- "247"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "247" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "247"
 Parameter: NPOS -> "143"
Evaluating: 247-143
 Parameter: J <- "104"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.435671249"
Evaluating: 125.050557*(0.435671249-0.5)
 Parameter: XPOS <- "-8.04434614"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "8.906696949E-02"
Evaluating: 125.050557*(8.906696949E-02-0.5)
 Parameter: YPOS <- "-51.3874044"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.425347983"
Evaluating: 152.572525*(0.425347983-0.5)+-4.51585405
 Parameter: ZPOS <- "-15.9057008"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.9057008" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.04434614"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.04434614-0
 Parameter: XTRAN <- "-8.04434614"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-51.3874044"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -51.3874044-0
 Parameter: YTRAN <- "-51.3874044"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.9057008"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.9057008-0
 Parameter: ZTRAN <- "-15.9057008"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.04434614"
 Parameter: YTRAN -> "-51.3874044"
 Parameter: ZTRAN -> "-15.9057008"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -8.044346  -51.387404  -15.905701
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.751756502"
Evaluating: 0.751756502*360.0
 Parameter: XPHI <- "270.632341"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.404787085"
Evaluating: 0.404787085*360.0
 Parameter: YPHI <- "145.723351"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.824690413"
Evaluating: 0.824690413*360.0
 Parameter: ZPHI <- "296.888549"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.04434614"
 Parameter: YPOS -> "-51.3874044"
 Parameter: ZPOS -> "-15.9057008"
 Parameter: XPHI -> "270.632341"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.011036   -0.999939
    0.000000    0.999939    0.011036

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   89.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.04434614"
 Parameter: YPOS -> "-51.3874044"
 Parameter: ZPOS -> "-15.9057008"
 Parameter: YPHI -> "145.723351"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.826328    0.000000   -0.563189
    0.000000    1.000000    0.000000
    0.563189    0.000000   -0.826328

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  145.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.04434614"
 Parameter: YPOS -> "-51.3874044"
 Parameter: ZPOS -> "-15.9057008"
 Parameter: ZPHI -> "296.888549"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.452256   -0.891888    0.000000
    0.891888    0.452256    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   63.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.044346 XMAX =   -8.044346 XAVE =   -8.044346
    YMIN =  -51.387404 YMAX =  -51.387404 YAVE =  -51.387404
    ZMIN =  -15.905701 ZMAX =  -15.905701 ZAVE =  -15.905701
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.04434614"
Evaluating: -8.04434614+3.5
 Parameter: XMAX <- "-4.54434614"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-51.3874044"
Evaluating: -51.3874044+3.5
 Parameter: YMAX <- "-47.8874044"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.9057008"
Evaluating: -15.9057008+3.5
 Parameter: ZMAX <- "-12.4057008"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.04434614"
Evaluating: -8.04434614-3.5
 Parameter: XMIN <- "-11.5443461"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-51.3874044"
Evaluating: -51.3874044-3.5
 Parameter: YMIN <- "-54.8874044"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.9057008"
Evaluating: -15.9057008-3.5
 Parameter: ZMIN <- "-19.4057008"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.54434614"
 Parameter: XMIN -> "-11.5443461"
 Parameter: YMAX -> "-47.8874044"
 Parameter: YMIN -> "-54.8874044"
 Parameter: ZMAX -> "-12.4057008"
 Parameter: ZMIN -> "-19.4057008"
 SELRPN>     41 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     22 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64662 NEG      CLA      104      CLA     - 191 PROA     LYS      42       C             3.7209
64662 NEG      CLA      104      CLA     - 192 PROA     LYS      42       O             2.8074
64662 NEG      CLA      104      CLA     - 193 PROA     ALA      43       N             3.9162
64662 NEG      CLA      104      CLA     - 195 PROA     ALA      43       CA            3.4805
64662 NEG      CLA      104      CLA     - 197 PROA     ALA      43       CB            4.8174
64662 NEG      CLA      104      CLA     - 201 PROA     ALA      43       C             2.5150
64662 NEG      CLA      104      CLA     - 202 PROA     ALA      43       O             2.7471
64662 NEG      CLA      104      CLA     - 203 PROA     CYS      44       N             2.4129
64662 NEG      CLA      104      CLA     - 205 PROA     CYS      44       CA            2.5621
64662 NEG      CLA      104      CLA     - 207 PROA     CYS      44       CB            3.5758
64662 NEG      CLA      104      CLA     - 210 PROA     CYS      44       SG            3.5682
64662 NEG      CLA      104      CLA     - 212 PROA     CYS      44       C             1.7861
64662 NEG      CLA      104      CLA     - 213 PROA     CYS      44       O             2.8185
64662 NEG      CLA      104      CLA     - 214 PROA     ILE      45       N             0.6353
64662 NEG      CLA      104      CLA     - 216 PROA     ILE      45       CA            1.7741
64662 NEG      CLA      104      CLA     - 218 PROA     ILE      45       CB            2.3910
64662 NEG      CLA      104      CLA     - 220 PROA     ILE      45       CG2           3.8463
64662 NEG      CLA      104      CLA     - 224 PROA     ILE      45       CG1           2.5920
64662 NEG      CLA      104      CLA     - 227 PROA     ILE      45       CD            3.3268
64662 NEG      CLA      104      CLA     - 231 PROA     ILE      45       C             2.8673
64662 NEG      CLA      104      CLA     - 233 PROA     SER      46       N             3.1275
64662 NEG      CLA      104      CLA     - 244 PROA     ILE      47       N             4.7757
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        22
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "22"
 Comparing "22" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "247"
Evaluating: 247
 Parameter: J <- "247"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "247" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "247"
 Parameter: NPOS -> "143"
Evaluating: 247-143
 Parameter: J <- "104"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.641665978"
Evaluating: 125.050557*(0.641665978-0.5)
 Parameter: XPOS <- "17.7154095"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.484489396"
Evaluating: 125.050557*(0.484489396-0.5)
 Parameter: YPOS <- "-1.93960967"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.237564945"
Evaluating: 152.572525*(0.237564945-0.5)+-4.51585405
 Parameter: ZPOS <- "-44.556233"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.556233" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.044346 XMAX =   -8.044346 XAVE =   -8.044346
    YMIN =  -51.387404 YMAX =  -51.387404 YAVE =  -51.387404
    ZMIN =  -15.905701 ZMAX =  -15.905701 ZAVE =  -15.905701
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.7154095"
 RDCMND substituted energy or value "?XAVE" to "-8.04434614"
Evaluating: 17.7154095--8.04434614
 Parameter: XTRAN <- "25.7597556"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.93960967"
 RDCMND substituted energy or value "?YAVE" to "-51.3874044"
Evaluating: -1.93960967--51.3874044
 Parameter: YTRAN <- "49.4477947"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.556233"
 RDCMND substituted energy or value "?ZAVE" to "-15.9057008"
Evaluating: -44.556233--15.9057008
 Parameter: ZTRAN <- "-28.6505322"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.7597556"
 Parameter: YTRAN -> "49.4477947"
 Parameter: ZTRAN -> "-28.6505322"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    25.759756   49.447795  -28.650532
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.65954641"
Evaluating: 0.65954641*360.0
 Parameter: XPHI <- "237.436708"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.119487017E-02"
Evaluating: 7.119487017E-02*360.0
 Parameter: YPHI <- "25.6301533"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.710507606"
Evaluating: 0.710507606*360.0
 Parameter: ZPHI <- "255.782738"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.7154095"
 Parameter: YPOS -> "-1.93960967"
 Parameter: ZPOS -> "-44.556233"
 Parameter: XPHI -> "237.436708"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.538231   -0.842797
    0.000000    0.842797   -0.538231

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  122.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.7154095"
 Parameter: YPOS -> "-1.93960967"
 Parameter: ZPOS -> "-44.556233"
 Parameter: YPHI -> "25.6301533"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.901605    0.000000   -0.432560
    0.000000    1.000000    0.000000
    0.432560    0.000000    0.901605

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   25.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.7154095"
 Parameter: YPOS -> "-1.93960967"
 Parameter: ZPOS -> "-44.556233"
 Parameter: ZPHI -> "255.782738"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.245599   -0.969371    0.000000
    0.969371   -0.245599    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  104.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.715409 XMAX =   17.715409 XAVE =   17.715409
    YMIN =   -1.939610 YMAX =   -1.939610 YAVE =   -1.939610
    ZMIN =  -44.556233 ZMAX =  -44.556233 ZAVE =  -44.556233
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.7154095"
Evaluating: 17.7154095+3.5
 Parameter: XMAX <- "21.2154095"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.9396097"
Evaluating: -1.9396097+3.5
 Parameter: YMAX <- "1.5603903"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.556233"
Evaluating: -44.556233+3.5
 Parameter: ZMAX <- "-41.056233"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.7154095"
Evaluating: 17.7154095-3.5
 Parameter: XMIN <- "14.2154095"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.9396097"
Evaluating: -1.9396097-3.5
 Parameter: YMIN <- "-5.4396097"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.556233"
Evaluating: -44.556233-3.5
 Parameter: ZMIN <- "-48.056233"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.2154095"
 Parameter: XMIN -> "14.2154095"
 Parameter: YMAX -> "1.5603903"
 Parameter: YMIN -> "-5.4396097"
 Parameter: ZMAX -> "-41.056233"
 Parameter: ZMIN -> "-48.056233"
 SELRPN>     27 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     12 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64662 NEG      CLA      104      CLA     -**** PROA     ALA      1469     O             3.5050
64662 NEG      CLA      104      CLA     -**** PROA     ARG      1472     CA            3.3095
64662 NEG      CLA      104      CLA     -**** PROA     ARG      1472     CB            3.0278
64662 NEG      CLA      104      CLA     -**** PROA     ARG      1472     CG            3.0759
64662 NEG      CLA      104      CLA     -**** PROA     ARG      1472     NH1           4.7090
64662 NEG      CLA      104      CLA     -**** PROA     ARG      1472     C             2.5201
64662 NEG      CLA      104      CLA     -**** PROA     ARG      1472     O             2.8077
64662 NEG      CLA      104      CLA     -**** PROA     THR      1473     N             2.3968
64662 NEG      CLA      104      CLA     -**** PROA     THR      1473     CA            2.7567
64662 NEG      CLA      104      CLA     -**** PROA     THR      1473     CB            3.4704
64662 NEG      CLA      104      CLA     -**** PROA     THR      1473     OG1           3.0262
64662 NEG      CLA      104      CLA     -**** PROA     THR      1473     C             4.1030
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "247"
Evaluating: 247
 Parameter: J <- "247"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "247" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "247"
 Parameter: NPOS -> "143"
Evaluating: 247-143
 Parameter: J <- "104"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.500643423"
Evaluating: 125.050557*(0.500643423-0.5)
 Parameter: XPOS <- "8.046040454E-02"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.196890916"
Evaluating: 125.050557*(0.196890916-0.5)
 Parameter: YPOS <- "-37.9039598"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.420920523"
Evaluating: 152.572525*(0.420920523-0.5)+-4.51585405
 Parameter: ZPOS <- "-16.5812095"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.5812095" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.715409 XMAX =   17.715409 XAVE =   17.715409
    YMIN =   -1.939610 YMAX =   -1.939610 YAVE =   -1.939610
    ZMIN =  -44.556233 ZMAX =  -44.556233 ZAVE =  -44.556233
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.046040454E-02"
 RDCMND substituted energy or value "?XAVE" to "17.7154095"
Evaluating: 8.046040454E-02-17.7154095
 Parameter: XTRAN <- "-17.6349491"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.9039598"
 RDCMND substituted energy or value "?YAVE" to "-1.9396097"
Evaluating: -37.9039598--1.9396097
 Parameter: YTRAN <- "-35.9643501"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.5812095"
 RDCMND substituted energy or value "?ZAVE" to "-44.556233"
Evaluating: -16.5812095--44.556233
 Parameter: ZTRAN <- "27.9750235"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.6349491"
 Parameter: YTRAN -> "-35.9643501"
 Parameter: ZTRAN -> "27.9750235"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -17.634949  -35.964350   27.975023
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.99473144"
Evaluating: 0.99473144*360.0
 Parameter: XPHI <- "358.103318"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.340137604"
Evaluating: 0.340137604*360.0
 Parameter: YPHI <- "122.449537"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.717269092"
Evaluating: 0.717269092*360.0
 Parameter: ZPHI <- "258.216873"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.046040454E-02"
 Parameter: YPOS -> "-37.9039598"
 Parameter: ZPOS -> "-16.5812095"
 Parameter: XPHI -> "358.103318"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999452   -0.033097
    0.000000    0.033097    0.999452

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    1.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.046040454E-02"
 Parameter: YPOS -> "-37.9039598"
 Parameter: ZPOS -> "-16.5812095"
 Parameter: YPHI -> "122.449537"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.536557    0.000000   -0.843864
    0.000000    1.000000    0.000000
    0.843864    0.000000   -0.536557

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  122.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.046040454E-02"
 Parameter: YPOS -> "-37.9039598"
 Parameter: ZPOS -> "-16.5812095"
 Parameter: ZPHI -> "258.216873"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.204208   -0.978928    0.000000
    0.978928   -0.204208    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  101.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.080460 XMAX =    0.080460 XAVE =    0.080460
    YMIN =  -37.903960 YMAX =  -37.903960 YAVE =  -37.903960
    ZMIN =  -16.581209 ZMAX =  -16.581209 ZAVE =  -16.581209
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.046039317E-02"
Evaluating: 8.046039317E-02+3.5
 Parameter: XMAX <- "3.58046039"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.9039598"
Evaluating: -37.9039598+3.5
 Parameter: YMAX <- "-34.4039598"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.5812095"
Evaluating: -16.5812095+3.5
 Parameter: ZMAX <- "-13.0812095"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.046039317E-02"
Evaluating: 8.046039317E-02-3.5
 Parameter: XMIN <- "-3.41953961"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.9039598"
Evaluating: -37.9039598-3.5
 Parameter: YMIN <- "-41.4039598"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.5812095"
Evaluating: -16.5812095-3.5
 Parameter: ZMIN <- "-20.0812095"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.58046039"
 Parameter: XMIN -> "-3.41953961"
 Parameter: YMAX -> "-34.4039598"
 Parameter: YMIN -> "-41.4039598"
 Parameter: ZMAX -> "-13.0812095"
 Parameter: ZMIN -> "-20.0812095"
 SELRPN>     13 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      6 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64662 NEG      CLA      104      CLA     -1250 PROA     TYR      108      OH            4.1476
64662 NEG      CLA      104      CLA     -1387 PROA     TYR      117      CG            5.4527
64662 NEG      CLA      104      CLA     -1388 PROA     TYR      117      CD1           4.4130
64662 NEG      CLA      104      CLA     -1390 PROA     TYR      117      CE1           4.0461
64662 NEG      CLA      104      CLA     -1448 PROA     SER      120      CB            4.5327
64662 NEG      CLA      104      CLA     -1451 PROA     SER      120      OG            4.4452
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "247"
Evaluating: 247
 Parameter: J <- "247"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "247" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "247"
 Parameter: NPOS -> "143"
Evaluating: 247-143
 Parameter: J <- "104"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.484679816"
Evaluating: 125.050557*(0.484679816-0.5)
 Parameter: XPOS <- "-1.91579754"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.450861385"
Evaluating: 125.050557*(0.450861385-0.5)
 Parameter: YPOS <- "-6.14481118"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.471661363"
Evaluating: 152.572525*(0.471661363-0.5)+-4.51585405
 Parameter: ZPOS <- "-8.83955145"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.83955145" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.83955145" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "247"
Evaluating: 247
 Parameter: J <- "247"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "247" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "247"
 Parameter: NPOS -> "143"
Evaluating: 247-143
 Parameter: J <- "104"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "104"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.864379808"
Evaluating: 125.050557*(0.864379808-0.5)
 Parameter: XPOS <- "45.5658979"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.158628705"
Evaluating: 125.050557*(0.158628705-0.5)
 Parameter: YPOS <- "-42.6886706"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.862723219"
Evaluating: 152.572525*(0.862723219-0.5)+-4.51585405
 Parameter: ZPOS <- "50.8257433"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.8257433" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.8257433" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.080460 XMAX =    0.080460 XAVE =    0.080460
    YMIN =  -37.903960 YMAX =  -37.903960 YAVE =  -37.903960
    ZMIN =  -16.581209 ZMAX =  -16.581209 ZAVE =  -16.581209
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.5658979"
 RDCMND substituted energy or value "?XAVE" to "8.046039317E-02"
Evaluating: 45.5658979-8.046039317E-02
 Parameter: XTRAN <- "45.4854375"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.6886706"
 RDCMND substituted energy or value "?YAVE" to "-37.9039598"
Evaluating: -42.6886706--37.9039598
 Parameter: YTRAN <- "-4.7847108"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.8257433"
 RDCMND substituted energy or value "?ZAVE" to "-16.5812095"
Evaluating: 50.8257433--16.5812095
 Parameter: ZTRAN <- "67.4069528"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.4854375"
 Parameter: YTRAN -> "-4.7847108"
 Parameter: ZTRAN -> "67.4069528"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    45.485438   -4.784711   67.406953
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.981761604"
Evaluating: 0.981761604*360.0
 Parameter: XPHI <- "353.434177"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.357873648"
Evaluating: 0.357873648*360.0
 Parameter: YPHI <- "128.834513"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.365934081"
Evaluating: 0.365934081*360.0
 Parameter: ZPHI <- "131.736269"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.5658979"
 Parameter: YPOS -> "-42.6886706"
 Parameter: ZPOS -> "50.8257433"
 Parameter: XPHI -> "353.434177"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.993441   -0.114345
    0.000000    0.114345    0.993441

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    6.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.5658979"
 Parameter: YPOS -> "-42.6886706"
 Parameter: ZPOS -> "50.8257433"
 Parameter: YPHI -> "128.834513"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.627073    0.000000   -0.778960
    0.000000    1.000000    0.000000
    0.778960    0.000000   -0.627073

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  128.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.5658979"
 Parameter: YPOS -> "-42.6886706"
 Parameter: ZPOS -> "50.8257433"
 Parameter: ZPHI -> "131.736269"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.665703    0.746217    0.000000
   -0.746217   -0.665703    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  131.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.565898 XMAX =   45.565898 XAVE =   45.565898
    YMIN =  -42.688671 YMAX =  -42.688671 YAVE =  -42.688671
    ZMIN =   50.825743 ZMAX =   50.825743 ZAVE =   50.825743
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.5658979"
Evaluating: 45.5658979+3.5
 Parameter: XMAX <- "49.0658979"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.6886706"
Evaluating: -42.6886706+3.5
 Parameter: YMAX <- "-39.1886706"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.8257433"
Evaluating: 50.8257433+3.5
 Parameter: ZMAX <- "54.3257433"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.5658979"
Evaluating: 45.5658979-3.5
 Parameter: XMIN <- "42.0658979"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.6886706"
Evaluating: -42.6886706-3.5
 Parameter: YMIN <- "-46.1886706"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.8257433"
Evaluating: 50.8257433-3.5
 Parameter: ZMIN <- "47.3257433"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.0658979"
 Parameter: XMIN -> "42.0658979"
 Parameter: YMAX -> "-39.1886706"
 Parameter: YMIN -> "-46.1886706"
 Parameter: ZMAX -> "54.3257433"
 Parameter: ZMIN -> "47.3257433"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "248"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "248" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "248"
Evaluating: 248
 Parameter: J <- "248"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "248" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "248"
 Parameter: NPOS -> "143"
Evaluating: 248-143
 Parameter: J <- "105"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "105"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.873422552"
Evaluating: 125.050557*(0.873422552-0.5)
 Parameter: XPOS <- "46.6966981"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.221678353"
Evaluating: 125.050557*(0.221678353-0.5)
 Parameter: YPOS <- "-34.804277"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.745761381"
Evaluating: 152.572525*(0.745761381-0.5)+-4.51585405
 Parameter: ZPOS <- "32.9805804"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.9805804" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.9805804" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.6966981"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.6966981-0
 Parameter: XTRAN <- "46.6966981"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.804277"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.804277-0
 Parameter: YTRAN <- "-34.804277"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.9805804"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.9805804-0
 Parameter: ZTRAN <- "32.9805804"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.6966981"
 Parameter: YTRAN -> "-34.804277"
 Parameter: ZTRAN -> "32.9805804"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    46.696698  -34.804277   32.980580
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.840021979"
Evaluating: 0.840021979*360.0
 Parameter: XPHI <- "302.407912"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.890594438"
Evaluating: 0.890594438*360.0
 Parameter: YPHI <- "320.613998"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.425200118E-03"
Evaluating: 5.425200118E-03*360.0
 Parameter: ZPHI <- "1.95307204"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.6966981"
 Parameter: YPOS -> "-34.804277"
 Parameter: ZPOS -> "32.9805804"
 Parameter: XPHI -> "302.407912"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.535943   -0.844254
    0.000000    0.844254    0.535943

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   57.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.6966981"
 Parameter: YPOS -> "-34.804277"
 Parameter: ZPOS -> "32.9805804"
 Parameter: YPHI -> "320.613998"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.772889    0.000000    0.634542
    0.000000    1.000000    0.000000
   -0.634542    0.000000    0.772889

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.6966981"
 Parameter: YPOS -> "-34.804277"
 Parameter: ZPOS -> "32.9805804"
 Parameter: ZPHI -> "1.95307204"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999419    0.034081    0.000000
   -0.034081    0.999419    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    1.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.696698 XMAX =   46.696698 XAVE =   46.696698
    YMIN =  -34.804277 YMAX =  -34.804277 YAVE =  -34.804277
    ZMIN =   32.980580 ZMAX =   32.980580 ZAVE =   32.980580
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.6966981"
Evaluating: 46.6966981+3.5
 Parameter: XMAX <- "50.1966981"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.804277"
Evaluating: -34.804277+3.5
 Parameter: YMAX <- "-31.304277"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.9805804"
Evaluating: 32.9805804+3.5
 Parameter: ZMAX <- "36.4805804"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.6966981"
Evaluating: 46.6966981-3.5
 Parameter: XMIN <- "43.1966981"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.804277"
Evaluating: -34.804277-3.5
 Parameter: YMIN <- "-38.304277"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.9805804"
Evaluating: 32.9805804-3.5
 Parameter: ZMIN <- "29.4805804"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.1966981"
 Parameter: XMIN -> "43.1966981"
 Parameter: YMAX -> "-31.304277"
 Parameter: YMIN -> "-38.304277"
 Parameter: ZMAX -> "36.4805804"
 Parameter: ZMIN -> "29.4805804"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "249"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "249" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "249"
Evaluating: 249
 Parameter: J <- "249"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "249" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "249"
 Parameter: NPOS -> "143"
Evaluating: 249-143
 Parameter: J <- "106"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "106"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.187192031E-02"
Evaluating: 125.050557*(9.187192031E-02-0.5)
 Parameter: XPOS <- "-51.0366437"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.600069547"
Evaluating: 125.050557*(0.600069547-0.5)
 Parameter: YPOS <- "12.5137526"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.109600879"
Evaluating: 152.572525*(0.109600879-0.5)+-4.51585405
 Parameter: ZPOS <- "-64.0800337"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-64.0800337" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-51.0366437"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -51.0366437-0
 Parameter: XTRAN <- "-51.0366437"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.5137526"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.5137526-0
 Parameter: YTRAN <- "12.5137526"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-64.0800337"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -64.0800337-0
 Parameter: ZTRAN <- "-64.0800337"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-51.0366437"
 Parameter: YTRAN -> "12.5137526"
 Parameter: ZTRAN -> "-64.0800337"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -51.036644   12.513753  -64.080034
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.278826811"
Evaluating: 0.278826811*360.0
 Parameter: XPHI <- "100.377652"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.756163075"
Evaluating: 0.756163075*360.0
 Parameter: YPHI <- "272.218707"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491189934"
Evaluating: 0.491189934*360.0
 Parameter: ZPHI <- "176.828376"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-51.0366437"
 Parameter: YPOS -> "12.5137526"
 Parameter: ZPOS -> "-64.0800337"
 Parameter: XPHI -> "100.377652"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.180135    0.983642
    0.000000   -0.983642   -0.180135

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  100.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-51.0366437"
 Parameter: YPOS -> "12.5137526"
 Parameter: ZPOS -> "-64.0800337"
 Parameter: YPHI -> "272.218707"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.038714    0.000000    0.999250
    0.000000    1.000000    0.000000
   -0.999250    0.000000    0.038714

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   87.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-51.0366437"
 Parameter: YPOS -> "12.5137526"
 Parameter: ZPOS -> "-64.0800337"
 Parameter: ZPHI -> "176.828376"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.998468    0.055327    0.000000
   -0.055327   -0.998468    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -51.036644 XMAX =  -51.036644 XAVE =  -51.036644
    YMIN =   12.513753 YMAX =   12.513753 YAVE =   12.513753
    ZMIN =  -64.080034 ZMAX =  -64.080034 ZAVE =  -64.080034
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-51.0366437"
Evaluating: -51.0366437+3.5
 Parameter: XMAX <- "-47.5366437"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.5137526"
Evaluating: 12.5137526+3.5
 Parameter: YMAX <- "16.0137526"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-64.0800337"
Evaluating: -64.0800337+3.5
 Parameter: ZMAX <- "-60.5800337"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-51.0366437"
Evaluating: -51.0366437-3.5
 Parameter: XMIN <- "-54.5366437"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.5137526"
Evaluating: 12.5137526-3.5
 Parameter: YMIN <- "9.0137526"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-64.0800337"
Evaluating: -64.0800337-3.5
 Parameter: ZMIN <- "-67.5800337"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-47.5366437"
 Parameter: XMIN -> "-54.5366437"
 Parameter: YMAX -> "16.0137526"
 Parameter: YMIN -> "9.0137526"
 Parameter: ZMAX -> "-60.5800337"
 Parameter: ZMIN -> "-67.5800337"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "250"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "250" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "250"
Evaluating: 250
 Parameter: J <- "250"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "250" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "250"
 Parameter: NPOS -> "143"
Evaluating: 250-143
 Parameter: J <- "107"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "107"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.247807722"
Evaluating: 125.050557*(0.247807722-0.5)
 Parameter: XPOS <- "-31.5367848"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.245154517"
Evaluating: 125.050557*(0.245154517-0.5)
 Parameter: YPOS <- "-31.8685696"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.329917153"
Evaluating: 152.572525*(0.329917153-0.5)+-4.51585405
 Parameter: ZPOS <- "-30.4658235"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.4658235" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.5367848"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.5367848-0
 Parameter: XTRAN <- "-31.5367848"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.8685696"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.8685696-0
 Parameter: YTRAN <- "-31.8685696"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.4658235"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.4658235-0
 Parameter: ZTRAN <- "-30.4658235"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.5367848"
 Parameter: YTRAN -> "-31.8685696"
 Parameter: ZTRAN -> "-30.4658235"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -31.536785  -31.868570  -30.465823
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.310918562"
Evaluating: 0.310918562*360.0
 Parameter: XPHI <- "111.930682"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.150592909"
Evaluating: 0.150592909*360.0
 Parameter: YPHI <- "54.2134472"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.2534591"
Evaluating: 0.2534591*360.0
 Parameter: ZPHI <- "91.245276"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.5367848"
 Parameter: YPOS -> "-31.8685696"
 Parameter: ZPOS -> "-30.4658235"
 Parameter: XPHI -> "111.930682"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.373485    0.927636
    0.000000   -0.927636   -0.373485

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  111.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.5367848"
 Parameter: YPOS -> "-31.8685696"
 Parameter: ZPOS -> "-30.4658235"
 Parameter: YPHI -> "54.2134472"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.584767    0.000000   -0.811201
    0.000000    1.000000    0.000000
    0.811201    0.000000    0.584767

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   54.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.5367848"
 Parameter: YPOS -> "-31.8685696"
 Parameter: ZPOS -> "-30.4658235"
 Parameter: ZPHI -> "91.245276"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.021732    0.999764    0.000000
   -0.999764   -0.021732    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   91.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.536785 XMAX =  -31.536785 XAVE =  -31.536785
    YMIN =  -31.868570 YMAX =  -31.868570 YAVE =  -31.868570
    ZMIN =  -30.465823 ZMAX =  -30.465823 ZAVE =  -30.465823
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.5367848"
Evaluating: -31.5367848+3.5
 Parameter: XMAX <- "-28.0367848"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.8685696"
Evaluating: -31.8685696+3.5
 Parameter: YMAX <- "-28.3685696"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.4658235"
Evaluating: -30.4658235+3.5
 Parameter: ZMAX <- "-26.9658235"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.5367848"
Evaluating: -31.5367848-3.5
 Parameter: XMIN <- "-35.0367848"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.8685696"
Evaluating: -31.8685696-3.5
 Parameter: YMIN <- "-35.3685696"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.4658235"
Evaluating: -30.4658235-3.5
 Parameter: ZMIN <- "-33.9658235"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.0367848"
 Parameter: XMIN -> "-35.0367848"
 Parameter: YMAX -> "-28.3685696"
 Parameter: YMIN -> "-35.3685696"
 Parameter: ZMAX -> "-26.9658235"
 Parameter: ZMIN -> "-33.9658235"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "251"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "251" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "251"
Evaluating: 251
 Parameter: J <- "251"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "251" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "251"
 Parameter: NPOS -> "143"
Evaluating: 251-143
 Parameter: J <- "108"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "108"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.253229318"
Evaluating: 125.050557*(0.253229318-0.5)
 Parameter: XPOS <- "-30.8588112"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.716296467"
Evaluating: 125.050557*(0.716296467-0.5)
 Parameter: YPOS <- "27.0479937"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "6.420781386E-02"
Evaluating: 152.572525*(6.420781386E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-71.0057683"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-71.0057683" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.8588112"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.8588112-0
 Parameter: XTRAN <- "-30.8588112"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.0479937"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.0479937-0
 Parameter: YTRAN <- "27.0479937"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-71.0057683"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -71.0057683-0
 Parameter: ZTRAN <- "-71.0057683"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.8588112"
 Parameter: YTRAN -> "27.0479937"
 Parameter: ZTRAN -> "-71.0057683"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -30.858811   27.047994  -71.005768
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.953024215"
Evaluating: 0.953024215*360.0
 Parameter: XPHI <- "343.088717"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.171702676"
Evaluating: 0.171702676*360.0
 Parameter: YPHI <- "61.8129634"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.261561777"
Evaluating: 0.261561777*360.0
 Parameter: ZPHI <- "94.1622397"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.8588112"
 Parameter: YPOS -> "27.0479937"
 Parameter: ZPOS -> "-71.0057683"
 Parameter: XPHI -> "343.088717"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.956756   -0.290891
    0.000000    0.290891    0.956756

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   16.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.8588112"
 Parameter: YPOS -> "27.0479937"
 Parameter: ZPOS -> "-71.0057683"
 Parameter: YPHI -> "61.8129634"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.472351    0.000000   -0.881410
    0.000000    1.000000    0.000000
    0.881410    0.000000    0.472351

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   61.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.8588112"
 Parameter: YPOS -> "27.0479937"
 Parameter: ZPOS -> "-71.0057683"
 Parameter: ZPHI -> "94.1622397"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.072581    0.997363    0.000000
   -0.997363   -0.072581    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   94.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.858811 XMAX =  -30.858811 XAVE =  -30.858811
    YMIN =   27.047994 YMAX =   27.047994 YAVE =   27.047994
    ZMIN =  -71.005768 ZMAX =  -71.005768 ZAVE =  -71.005768
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.8588112"
Evaluating: -30.8588112+3.5
 Parameter: XMAX <- "-27.3588112"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.0479937"
Evaluating: 27.0479937+3.5
 Parameter: YMAX <- "30.5479937"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-71.0057683"
Evaluating: -71.0057683+3.5
 Parameter: ZMAX <- "-67.5057683"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.8588112"
Evaluating: -30.8588112-3.5
 Parameter: XMIN <- "-34.3588112"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.0479937"
Evaluating: 27.0479937-3.5
 Parameter: YMIN <- "23.5479937"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-71.0057683"
Evaluating: -71.0057683-3.5
 Parameter: ZMIN <- "-74.5057683"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.3588112"
 Parameter: XMIN -> "-34.3588112"
 Parameter: YMAX -> "30.5479937"
 Parameter: YMIN -> "23.5479937"
 Parameter: ZMAX -> "-67.5057683"
 Parameter: ZMIN -> "-74.5057683"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "252"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "252" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "252"
Evaluating: 252
 Parameter: J <- "252"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "252" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "252"
 Parameter: NPOS -> "143"
Evaluating: 252-143
 Parameter: J <- "109"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "109"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "2.407575767E-02"
Evaluating: 125.050557*(2.407575767E-02-0.5)
 Parameter: XPOS <- "-59.5145916"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.874027174"
Evaluating: 125.050557*(0.874027174-0.5)
 Parameter: YPOS <- "46.7723064"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.968296405"
Evaluating: 152.572525*(0.968296405-0.5)+-4.51585405
 Parameter: ZPOS <- "66.9333109"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "66.9333109" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "66.9333109" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-59.5145916"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -59.5145916-0
 Parameter: XTRAN <- "-59.5145916"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.7723064"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 46.7723064-0
 Parameter: YTRAN <- "46.7723064"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "66.9333109"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 66.9333109-0
 Parameter: ZTRAN <- "66.9333109"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-59.5145916"
 Parameter: YTRAN -> "46.7723064"
 Parameter: ZTRAN -> "66.9333109"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -59.514592   46.772306   66.933311
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.373169658"
Evaluating: 0.373169658*360.0
 Parameter: XPHI <- "134.341077"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.227294907"
Evaluating: 0.227294907*360.0
 Parameter: YPHI <- "81.8261665"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.39238932"
Evaluating: 0.39238932*360.0
 Parameter: ZPHI <- "141.260155"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-59.5145916"
 Parameter: YPOS -> "46.7723064"
 Parameter: ZPOS -> "66.9333109"
 Parameter: XPHI -> "134.341077"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.698928    0.715192
    0.000000   -0.715192   -0.698928

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  134.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-59.5145916"
 Parameter: YPOS -> "46.7723064"
 Parameter: ZPOS -> "66.9333109"
 Parameter: YPHI -> "81.8261665"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.142177    0.000000   -0.989841
    0.000000    1.000000    0.000000
    0.989841    0.000000    0.142177

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-59.5145916"
 Parameter: YPOS -> "46.7723064"
 Parameter: ZPOS -> "66.9333109"
 Parameter: ZPHI -> "141.260155"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.779995    0.625785    0.000000
   -0.625785   -0.779995    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  141.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -59.514592 XMAX =  -59.514592 XAVE =  -59.514592
    YMIN =   46.772306 YMAX =   46.772306 YAVE =   46.772306
    ZMIN =   66.933311 ZMAX =   66.933311 ZAVE =   66.933311
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-59.5145916"
Evaluating: -59.5145916+3.5
 Parameter: XMAX <- "-56.0145916"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.7723064"
Evaluating: 46.7723064+3.5
 Parameter: YMAX <- "50.2723064"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "66.9333109"
Evaluating: 66.9333109+3.5
 Parameter: ZMAX <- "70.4333109"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-59.5145916"
Evaluating: -59.5145916-3.5
 Parameter: XMIN <- "-63.0145916"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.7723064"
Evaluating: 46.7723064-3.5
 Parameter: YMIN <- "43.2723064"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "66.9333109"
Evaluating: 66.9333109-3.5
 Parameter: ZMIN <- "63.4333109"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-56.0145916"
 Parameter: XMIN -> "-63.0145916"
 Parameter: YMAX -> "50.2723064"
 Parameter: YMIN -> "43.2723064"
 Parameter: ZMAX -> "70.4333109"
 Parameter: ZMIN -> "63.4333109"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "253"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "253" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "253"
Evaluating: 253
 Parameter: J <- "253"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "253" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "253"
 Parameter: NPOS -> "143"
Evaluating: 253-143
 Parameter: J <- "110"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "110"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.954002433"
Evaluating: 125.050557*(0.954002433-0.5)
 Parameter: XPOS <- "56.7732571"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "4.966181347E-02"
Evaluating: 125.050557*(4.966181347E-02-0.5)
 Parameter: YPOS <- "-56.3150411"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.893423863"
Evaluating: 152.572525*(0.893423863-0.5)+-4.51585405
 Parameter: ZPOS <- "55.5098181"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "55.5098181" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "55.5098181" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "56.7732571"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 56.7732571-0
 Parameter: XTRAN <- "56.7732571"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-56.3150411"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -56.3150411-0
 Parameter: YTRAN <- "-56.3150411"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "55.5098181"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 55.5098181-0
 Parameter: ZTRAN <- "55.5098181"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "56.7732571"
 Parameter: YTRAN -> "-56.3150411"
 Parameter: ZTRAN -> "55.5098181"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    56.773257  -56.315041   55.509818
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.285003763"
Evaluating: 0.285003763*360.0
 Parameter: XPHI <- "102.601355"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.167998308"
Evaluating: 0.167998308*360.0
 Parameter: YPHI <- "60.4793909"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.781773597"
Evaluating: 0.781773597*360.0
 Parameter: ZPHI <- "281.438495"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "56.7732571"
 Parameter: YPOS -> "-56.3150411"
 Parameter: ZPOS -> "55.5098181"
 Parameter: XPHI -> "102.601355"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.218166    0.975912
    0.000000   -0.975912   -0.218166

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  102.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "56.7732571"
 Parameter: YPOS -> "-56.3150411"
 Parameter: ZPOS -> "55.5098181"
 Parameter: YPHI -> "60.4793909"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.492737    0.000000   -0.870179
    0.000000    1.000000    0.000000
    0.870179    0.000000    0.492737

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   60.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "56.7732571"
 Parameter: YPOS -> "-56.3150411"
 Parameter: ZPOS -> "55.5098181"
 Parameter: ZPHI -> "281.438495"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.198316   -0.980138    0.000000
    0.980138    0.198316    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   78.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   56.773257 XMAX =   56.773257 XAVE =   56.773257
    YMIN =  -56.315041 YMAX =  -56.315041 YAVE =  -56.315041
    ZMIN =   55.509818 ZMAX =   55.509818 ZAVE =   55.509818
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "56.7732571"
Evaluating: 56.7732571+3.5
 Parameter: XMAX <- "60.2732571"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-56.3150411"
Evaluating: -56.3150411+3.5
 Parameter: YMAX <- "-52.8150411"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "55.5098181"
Evaluating: 55.5098181+3.5
 Parameter: ZMAX <- "59.0098181"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "56.7732571"
Evaluating: 56.7732571-3.5
 Parameter: XMIN <- "53.2732571"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-56.3150411"
Evaluating: -56.3150411-3.5
 Parameter: YMIN <- "-59.8150411"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "55.5098181"
Evaluating: 55.5098181-3.5
 Parameter: ZMIN <- "52.0098181"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "60.2732571"
 Parameter: XMIN -> "53.2732571"
 Parameter: YMAX -> "-52.8150411"
 Parameter: YMIN -> "-59.8150411"
 Parameter: ZMAX -> "59.0098181"
 Parameter: ZMIN -> "52.0098181"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "254"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "254" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "254"
Evaluating: 254
 Parameter: J <- "254"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "254" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "254"
 Parameter: NPOS -> "143"
Evaluating: 254-143
 Parameter: J <- "111"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "111"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.762755787"
Evaluating: 125.050557*(0.762755787-0.5)
 Parameter: XPOS <- "32.8577575"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.451481916"
Evaluating: 125.050557*(0.451481916-0.5)
 Parameter: YPOS <- "-6.06721343"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.600237677"
Evaluating: 152.572525*(0.600237677-0.5)+-4.51585405
 Parameter: ZPOS <- "10.7776614"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.7776614" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.7776614" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "254"
Evaluating: 254
 Parameter: J <- "254"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "254" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "254"
 Parameter: NPOS -> "143"
Evaluating: 254-143
 Parameter: J <- "111"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "111"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.679925139E-02"
Evaluating: 125.050557*(1.679925139E-02-0.5)
 Parameter: XPOS <- "-60.4245228"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.352431843"
Evaluating: 125.050557*(0.352431843-0.5)
 Parameter: YPOS <- "-18.4534802"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "8.184104042E-02"
Evaluating: 152.572525*(8.184104042E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-68.3154224"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-68.3154224" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-60.4245228"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -60.4245228-0
 Parameter: XTRAN <- "-60.4245228"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.4534802"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.4534802-0
 Parameter: YTRAN <- "-18.4534802"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-68.3154224"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -68.3154224-0
 Parameter: ZTRAN <- "-68.3154224"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-60.4245228"
 Parameter: YTRAN -> "-18.4534802"
 Parameter: ZTRAN -> "-68.3154224"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -60.424523  -18.453480  -68.315422
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.803336293"
Evaluating: 0.803336293*360.0
 Parameter: XPHI <- "289.201065"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.179305204E-02"
Evaluating: 3.179305204E-02*360.0
 Parameter: YPHI <- "11.4454987"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.582450887"
Evaluating: 0.582450887*360.0
 Parameter: ZPHI <- "209.682319"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-60.4245228"
 Parameter: YPOS -> "-18.4534802"
 Parameter: ZPOS -> "-68.3154224"
 Parameter: XPHI -> "289.201065"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.328884   -0.944370
    0.000000    0.944370    0.328884

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   70.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-60.4245228"
 Parameter: YPOS -> "-18.4534802"
 Parameter: ZPOS -> "-68.3154224"
 Parameter: YPHI -> "11.4454987"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.980114    0.000000   -0.198436
    0.000000    1.000000    0.000000
    0.198436    0.000000    0.980114

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   11.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-60.4245228"
 Parameter: YPOS -> "-18.4534802"
 Parameter: ZPOS -> "-68.3154224"
 Parameter: ZPHI -> "209.682319"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.868784   -0.495191    0.000000
    0.495191   -0.868784    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  150.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -60.424523 XMAX =  -60.424523 XAVE =  -60.424523
    YMIN =  -18.453480 YMAX =  -18.453480 YAVE =  -18.453480
    ZMIN =  -68.315422 ZMAX =  -68.315422 ZAVE =  -68.315422
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-60.4245228"
Evaluating: -60.4245228+3.5
 Parameter: XMAX <- "-56.9245228"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.4534802"
Evaluating: -18.4534802+3.5
 Parameter: YMAX <- "-14.9534802"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-68.3154224"
Evaluating: -68.3154224+3.5
 Parameter: ZMAX <- "-64.8154224"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-60.4245228"
Evaluating: -60.4245228-3.5
 Parameter: XMIN <- "-63.9245228"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.4534802"
Evaluating: -18.4534802-3.5
 Parameter: YMIN <- "-21.9534802"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-68.3154224"
Evaluating: -68.3154224-3.5
 Parameter: ZMIN <- "-71.8154224"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-56.9245228"
 Parameter: XMIN -> "-63.9245228"
 Parameter: YMAX -> "-14.9534802"
 Parameter: YMIN -> "-21.9534802"
 Parameter: ZMAX -> "-64.8154224"
 Parameter: ZMIN -> "-71.8154224"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "255"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "255" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "255"
Evaluating: 255
 Parameter: J <- "255"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "255" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "255"
 Parameter: NPOS -> "143"
Evaluating: 255-143
 Parameter: J <- "112"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "112"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.330658338"
Evaluating: 125.050557*(0.330658338-0.5)
 Parameter: XPOS <- "-21.1762692"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.152236374"
Evaluating: 125.050557*(0.152236374-0.5)
 Parameter: YPOS <- "-43.4880351"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.276236672"
Evaluating: 152.572525*(0.276236672-0.5)+-4.51585405
 Parameter: ZPOS <- "-38.65599"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.65599" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.1762692"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -21.1762692-0
 Parameter: XTRAN <- "-21.1762692"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.4880351"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.4880351-0
 Parameter: YTRAN <- "-43.4880351"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.65599"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.65599-0
 Parameter: ZTRAN <- "-38.65599"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-21.1762692"
 Parameter: YTRAN -> "-43.4880351"
 Parameter: ZTRAN -> "-38.65599"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -21.176269  -43.488035  -38.655990
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.405308706"
Evaluating: 0.405308706*360.0
 Parameter: XPHI <- "145.911134"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.274948501E-02"
Evaluating: 7.274948501E-02*360.0
 Parameter: YPHI <- "26.1898146"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.825429566"
Evaluating: 0.825429566*360.0
 Parameter: ZPHI <- "297.154644"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.1762692"
 Parameter: YPOS -> "-43.4880351"
 Parameter: ZPOS -> "-38.65599"
 Parameter: XPHI -> "145.911134"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.828169    0.560478
    0.000000   -0.560478   -0.828169

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  145.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.1762692"
 Parameter: YPOS -> "-43.4880351"
 Parameter: ZPOS -> "-38.65599"
 Parameter: YPHI -> "26.1898146"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.897337    0.000000   -0.441346
    0.000000    1.000000    0.000000
    0.441346    0.000000    0.897337

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   26.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.1762692"
 Parameter: YPOS -> "-43.4880351"
 Parameter: ZPOS -> "-38.65599"
 Parameter: ZPHI -> "297.154644"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.456394   -0.889778    0.000000
    0.889778    0.456394    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   62.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.176269 XMAX =  -21.176269 XAVE =  -21.176269
    YMIN =  -43.488035 YMAX =  -43.488035 YAVE =  -43.488035
    ZMIN =  -38.655990 ZMAX =  -38.655990 ZAVE =  -38.655990
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.1762692"
Evaluating: -21.1762692+3.5
 Parameter: XMAX <- "-17.6762692"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.4880351"
Evaluating: -43.4880351+3.5
 Parameter: YMAX <- "-39.9880351"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.65599"
Evaluating: -38.65599+3.5
 Parameter: ZMAX <- "-35.15599"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.1762692"
Evaluating: -21.1762692-3.5
 Parameter: XMIN <- "-24.6762692"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.4880351"
Evaluating: -43.4880351-3.5
 Parameter: YMIN <- "-46.9880351"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.65599"
Evaluating: -38.65599-3.5
 Parameter: ZMIN <- "-42.15599"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.6762692"
 Parameter: XMIN -> "-24.6762692"
 Parameter: YMAX -> "-39.9880351"
 Parameter: YMIN -> "-46.9880351"
 Parameter: ZMAX -> "-35.15599"
 Parameter: ZMIN -> "-42.15599"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "256"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "256" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "256"
Evaluating: 256
 Parameter: J <- "256"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "256" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "256"
 Parameter: NPOS -> "143"
Evaluating: 256-143
 Parameter: J <- "113"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "113"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.264754735"
Evaluating: 125.050557*(0.264754735-0.5)
 Parameter: XPOS <- "-29.4175514"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.163703137"
Evaluating: 125.050557*(0.163703137-0.5)
 Parameter: YPOS <- "-42.05411"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.220719669"
Evaluating: 152.572525*(0.220719669-0.5)+-4.51585405
 Parameter: ZPOS <- "-47.1263593"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-47.1263593" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.4175514"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.4175514-0
 Parameter: XTRAN <- "-29.4175514"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.05411"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -42.05411-0
 Parameter: YTRAN <- "-42.05411"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-47.1263593"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -47.1263593-0
 Parameter: ZTRAN <- "-47.1263593"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.4175514"
 Parameter: YTRAN -> "-42.05411"
 Parameter: ZTRAN -> "-47.1263593"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -29.417551  -42.054110  -47.126359
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.761073895"
Evaluating: 0.761073895*360.0
 Parameter: XPHI <- "273.986602"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.604165955"
Evaluating: 0.604165955*360.0
 Parameter: YPHI <- "217.499744"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.398730182"
Evaluating: 0.398730182*360.0
 Parameter: ZPHI <- "143.542866"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.4175514"
 Parameter: YPOS -> "-42.05411"
 Parameter: ZPOS -> "-47.1263593"
 Parameter: XPHI -> "273.986602"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.069523   -0.997580
    0.000000    0.997580    0.069523

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   86.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.4175514"
 Parameter: YPOS -> "-42.05411"
 Parameter: ZPOS -> "-47.1263593"
 Parameter: YPHI -> "217.499744"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.793356    0.000000    0.608758
    0.000000    1.000000    0.000000
   -0.608758    0.000000   -0.793356

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  142.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.4175514"
 Parameter: YPOS -> "-42.05411"
 Parameter: ZPOS -> "-47.1263593"
 Parameter: ZPHI -> "143.542866"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.804302    0.594221    0.000000
   -0.594221   -0.804302    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  143.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.417551 XMAX =  -29.417551 XAVE =  -29.417551
    YMIN =  -42.054110 YMAX =  -42.054110 YAVE =  -42.054110
    ZMIN =  -47.126359 ZMAX =  -47.126359 ZAVE =  -47.126359
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.4175514"
Evaluating: -29.4175514+3.5
 Parameter: XMAX <- "-25.9175514"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.05411"
Evaluating: -42.05411+3.5
 Parameter: YMAX <- "-38.55411"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-47.1263593"
Evaluating: -47.1263593+3.5
 Parameter: ZMAX <- "-43.6263593"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.4175514"
Evaluating: -29.4175514-3.5
 Parameter: XMIN <- "-32.9175514"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.05411"
Evaluating: -42.05411-3.5
 Parameter: YMIN <- "-45.55411"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-47.1263593"
Evaluating: -47.1263593-3.5
 Parameter: ZMIN <- "-50.6263593"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.9175514"
 Parameter: XMIN -> "-32.9175514"
 Parameter: YMAX -> "-38.55411"
 Parameter: YMIN -> "-45.55411"
 Parameter: ZMAX -> "-43.6263593"
 Parameter: ZMIN -> "-50.6263593"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "257"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "257" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "257"
Evaluating: 257
 Parameter: J <- "257"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "257" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "257"
 Parameter: NPOS -> "143"
Evaluating: 257-143
 Parameter: J <- "114"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "114"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.240208723"
Evaluating: 125.050557*(0.240208723-0.5)
 Parameter: XPOS <- "-32.4870439"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.673331386"
Evaluating: 125.050557*(0.673331386-0.5)
 Parameter: YPOS <- "21.6751864"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "7.671069345E-02"
Evaluating: 152.572525*(7.671069345E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-69.0981724"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-69.0981724" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.4870439"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.4870439-0
 Parameter: XTRAN <- "-32.4870439"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.6751864"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.6751864-0
 Parameter: YTRAN <- "21.6751864"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-69.0981724"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -69.0981724-0
 Parameter: ZTRAN <- "-69.0981724"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.4870439"
 Parameter: YTRAN -> "21.6751864"
 Parameter: ZTRAN -> "-69.0981724"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -32.487044   21.675186  -69.098172
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.135879008"
Evaluating: 0.135879008*360.0
 Parameter: XPHI <- "48.9164429"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.757146527"
Evaluating: 0.757146527*360.0
 Parameter: YPHI <- "272.57275"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.876379808E-02"
Evaluating: 1.876379808E-02*360.0
 Parameter: ZPHI <- "6.75496731"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.4870439"
 Parameter: YPOS -> "21.6751864"
 Parameter: ZPOS -> "-69.0981724"
 Parameter: XPHI -> "48.9164429"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.657159    0.753752
    0.000000   -0.753752    0.657159

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   48.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.4870439"
 Parameter: YPOS -> "21.6751864"
 Parameter: ZPOS -> "-69.0981724"
 Parameter: YPHI -> "272.57275"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.044888    0.000000    0.998992
    0.000000    1.000000    0.000000
   -0.998992    0.000000    0.044888

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   87.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.4870439"
 Parameter: YPOS -> "21.6751864"
 Parameter: ZPOS -> "-69.0981724"
 Parameter: ZPHI -> "6.75496731"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.993058    0.117623    0.000000
   -0.117623    0.993058    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    6.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.487044 XMAX =  -32.487044 XAVE =  -32.487044
    YMIN =   21.675186 YMAX =   21.675186 YAVE =   21.675186
    ZMIN =  -69.098172 ZMAX =  -69.098172 ZAVE =  -69.098172
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.4870439"
Evaluating: -32.4870439+3.5
 Parameter: XMAX <- "-28.9870439"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.6751864"
Evaluating: 21.6751864+3.5
 Parameter: YMAX <- "25.1751864"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-69.0981724"
Evaluating: -69.0981724+3.5
 Parameter: ZMAX <- "-65.5981724"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.4870439"
Evaluating: -32.4870439-3.5
 Parameter: XMIN <- "-35.9870439"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.6751864"
Evaluating: 21.6751864-3.5
 Parameter: YMIN <- "18.1751864"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-69.0981724"
Evaluating: -69.0981724-3.5
 Parameter: ZMIN <- "-72.5981724"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.9870439"
 Parameter: XMIN -> "-35.9870439"
 Parameter: YMAX -> "25.1751864"
 Parameter: YMIN -> "18.1751864"
 Parameter: ZMAX -> "-65.5981724"
 Parameter: ZMIN -> "-72.5981724"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "258"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "258" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "258"
Evaluating: 258
 Parameter: J <- "258"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "258" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "258"
 Parameter: NPOS -> "143"
Evaluating: 258-143
 Parameter: J <- "115"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "115"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.142927582"
Evaluating: 125.050557*(0.142927582-0.5)
 Parameter: XPOS <- "-44.6521048"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.636253705"
Evaluating: 125.050557*(0.636253705-0.5)
 Parameter: YPOS <- "17.0386017"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.765874872"
Evaluating: 152.572525*(0.765874872-0.5)+-4.51585405
 Parameter: ZPOS <- "36.0493465"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.0493465" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.0493465" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.6521048"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.6521048-0
 Parameter: XTRAN <- "-44.6521048"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.0386017"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.0386017-0
 Parameter: YTRAN <- "17.0386017"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.0493465"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.0493465-0
 Parameter: ZTRAN <- "36.0493465"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.6521048"
 Parameter: YTRAN -> "17.0386017"
 Parameter: ZTRAN -> "36.0493465"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -44.652105   17.038602   36.049346
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.427630068"
Evaluating: 0.427630068*360.0
 Parameter: XPHI <- "153.946824"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.833174872"
Evaluating: 0.833174872*360.0
 Parameter: YPHI <- "299.942954"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.547201999"
Evaluating: 0.547201999*360.0
 Parameter: ZPHI <- "196.99272"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.6521048"
 Parameter: YPOS -> "17.0386017"
 Parameter: ZPOS -> "36.0493465"
 Parameter: XPHI -> "153.946824"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.898387    0.439205
    0.000000   -0.439205   -0.898387

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  153.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.6521048"
 Parameter: YPOS -> "17.0386017"
 Parameter: ZPOS -> "36.0493465"
 Parameter: YPHI -> "299.942954"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.499138    0.000000    0.866523
    0.000000    1.000000    0.000000
   -0.866523    0.000000    0.499138

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   60.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.6521048"
 Parameter: YPOS -> "17.0386017"
 Parameter: ZPOS -> "36.0493465"
 Parameter: ZPHI -> "196.99272"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.956342   -0.292250    0.000000
    0.292250   -0.956342    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  163.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.652105 XMAX =  -44.652105 XAVE =  -44.652105
    YMIN =   17.038602 YMAX =   17.038602 YAVE =   17.038602
    ZMIN =   36.049346 ZMAX =   36.049346 ZAVE =   36.049346
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.6521048"
Evaluating: -44.6521048+3.5
 Parameter: XMAX <- "-41.1521048"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.0386017"
Evaluating: 17.0386017+3.5
 Parameter: YMAX <- "20.5386017"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.0493465"
Evaluating: 36.0493465+3.5
 Parameter: ZMAX <- "39.5493465"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.6521048"
Evaluating: -44.6521048-3.5
 Parameter: XMIN <- "-48.1521048"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.0386017"
Evaluating: 17.0386017-3.5
 Parameter: YMIN <- "13.5386017"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.0493465"
Evaluating: 36.0493465-3.5
 Parameter: ZMIN <- "32.5493465"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.1521048"
 Parameter: XMIN -> "-48.1521048"
 Parameter: YMAX -> "20.5386017"
 Parameter: YMIN -> "13.5386017"
 Parameter: ZMAX -> "39.5493465"
 Parameter: ZMIN -> "32.5493465"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "259"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "259" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "259"
Evaluating: 259
 Parameter: J <- "259"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "259" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "259"
 Parameter: NPOS -> "143"
Evaluating: 259-143
 Parameter: J <- "116"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "116"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.671133492"
Evaluating: 125.050557*(0.671133492-0.5)
 Parameter: XPOS <- "21.4003385"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.689255712"
Evaluating: 125.050557*(0.689255712-0.5)
 Parameter: YPOS <- "23.6665322"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.859277654"
Evaluating: 152.572525*(0.859277654-0.5)+-4.51585405
 Parameter: ZPOS <- "50.3000448"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.3000448" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.3000448" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.4003385"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.4003385-0
 Parameter: XTRAN <- "21.4003385"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.6665322"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.6665322-0
 Parameter: YTRAN <- "23.6665322"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.3000448"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 50.3000448-0
 Parameter: ZTRAN <- "50.3000448"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.4003385"
 Parameter: YTRAN -> "23.6665322"
 Parameter: ZTRAN -> "50.3000448"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    21.400339   23.666532   50.300045
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.121853231"
Evaluating: 0.121853231*360.0
 Parameter: XPHI <- "43.8671632"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.709567163"
Evaluating: 0.709567163*360.0
 Parameter: YPHI <- "255.444179"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.251210331"
Evaluating: 0.251210331*360.0
 Parameter: ZPHI <- "90.4357192"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.4003385"
 Parameter: YPOS -> "23.6665322"
 Parameter: ZPOS -> "50.3000448"
 Parameter: XPHI -> "43.8671632"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.720948    0.692989
    0.000000   -0.692989    0.720948

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   43.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.4003385"
 Parameter: YPOS -> "23.6665322"
 Parameter: ZPOS -> "50.3000448"
 Parameter: YPHI -> "255.444179"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.251323    0.000000    0.967903
    0.000000    1.000000    0.000000
   -0.967903    0.000000   -0.251323

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  104.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.4003385"
 Parameter: YPOS -> "23.6665322"
 Parameter: ZPOS -> "50.3000448"
 Parameter: ZPHI -> "90.4357192"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.007605    0.999971    0.000000
   -0.999971   -0.007605    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   90.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.400339 XMAX =   21.400339 XAVE =   21.400339
    YMIN =   23.666532 YMAX =   23.666532 YAVE =   23.666532
    ZMIN =   50.300045 ZMAX =   50.300045 ZAVE =   50.300045
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.4003385"
Evaluating: 21.4003385+3.5
 Parameter: XMAX <- "24.9003385"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.6665322"
Evaluating: 23.6665322+3.5
 Parameter: YMAX <- "27.1665322"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.3000448"
Evaluating: 50.3000448+3.5
 Parameter: ZMAX <- "53.8000448"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.4003385"
Evaluating: 21.4003385-3.5
 Parameter: XMIN <- "17.9003385"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.6665322"
Evaluating: 23.6665322-3.5
 Parameter: YMIN <- "20.1665322"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.3000448"
Evaluating: 50.3000448-3.5
 Parameter: ZMIN <- "46.8000448"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.9003385"
 Parameter: XMIN -> "17.9003385"
 Parameter: YMAX -> "27.1665322"
 Parameter: YMIN -> "20.1665322"
 Parameter: ZMAX -> "53.8000448"
 Parameter: ZMIN -> "46.8000448"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "260"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "260" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "260"
Evaluating: 260
 Parameter: J <- "260"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "260" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "260"
 Parameter: NPOS -> "143"
Evaluating: 260-143
 Parameter: J <- "117"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "117"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.641533931"
Evaluating: 125.050557*(0.641533931-0.5)
 Parameter: XPOS <- "17.6988969"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.133499433"
Evaluating: 125.050557*(0.133499433-0.5)
 Parameter: YPOS <- "-45.8311"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.176781537"
Evaluating: 152.572525*(0.176781537-0.5)+-4.51585405
 Parameter: ZPOS <- "-53.8301111"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.8301111" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.6988969"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.6988969-0
 Parameter: XTRAN <- "17.6988969"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-45.8311"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -45.8311-0
 Parameter: YTRAN <- "-45.8311"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.8301111"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.8301111-0
 Parameter: ZTRAN <- "-53.8301111"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.6988969"
 Parameter: YTRAN -> "-45.8311"
 Parameter: ZTRAN -> "-53.8301111"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    17.698897  -45.831100  -53.830111
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.686172747"
Evaluating: 0.686172747*360.0
 Parameter: XPHI <- "247.022189"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.758295948"
Evaluating: 0.758295948*360.0
 Parameter: YPHI <- "272.986541"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.558059423E-02"
Evaluating: 5.558059423E-02*360.0
 Parameter: ZPHI <- "20.0090139"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.6988969"
 Parameter: YPOS -> "-45.8311"
 Parameter: ZPOS -> "-53.8301111"
 Parameter: XPHI -> "247.022189"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.390375   -0.920656
    0.000000    0.920656   -0.390375

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  112.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.6988969"
 Parameter: YPOS -> "-45.8311"
 Parameter: ZPOS -> "-53.8301111"
 Parameter: YPHI -> "272.986541"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.052101    0.000000    0.998642
    0.000000    1.000000    0.000000
   -0.998642    0.000000    0.052101

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   87.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.6988969"
 Parameter: YPOS -> "-45.8311"
 Parameter: ZPOS -> "-53.8301111"
 Parameter: ZPHI -> "20.0090139"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.939639    0.342168    0.000000
   -0.342168    0.939639    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   20.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.698897 XMAX =   17.698897 XAVE =   17.698897
    YMIN =  -45.831100 YMAX =  -45.831100 YAVE =  -45.831100
    ZMIN =  -53.830111 ZMAX =  -53.830111 ZAVE =  -53.830111
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.6988969"
Evaluating: 17.6988969+3.5
 Parameter: XMAX <- "21.1988969"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-45.8311"
Evaluating: -45.8311+3.5
 Parameter: YMAX <- "-42.3311"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.8301111"
Evaluating: -53.8301111+3.5
 Parameter: ZMAX <- "-50.3301111"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.6988969"
Evaluating: 17.6988969-3.5
 Parameter: XMIN <- "14.1988969"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-45.8311"
Evaluating: -45.8311-3.5
 Parameter: YMIN <- "-49.3311"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.8301111"
Evaluating: -53.8301111-3.5
 Parameter: ZMIN <- "-57.3301111"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.1988969"
 Parameter: XMIN -> "14.1988969"
 Parameter: YMAX -> "-42.3311"
 Parameter: YMIN -> "-49.3311"
 Parameter: ZMAX -> "-50.3301111"
 Parameter: ZMIN -> "-57.3301111"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "261"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "261" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "261"
Evaluating: 261
 Parameter: J <- "261"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "261" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "261"
 Parameter: NPOS -> "143"
Evaluating: 261-143
 Parameter: J <- "118"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "118"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.248357788"
Evaluating: 125.050557*(0.248357788-0.5)
 Parameter: XPOS <- "-31.4679988"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.206142553"
Evaluating: 125.050557*(0.206142553-0.5)
 Parameter: YPOS <- "-36.7470374"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.383194526"
Evaluating: 152.572525*(0.383194526-0.5)+-4.51585405
 Parameter: ZPOS <- "-22.3371602"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.3371602" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.4679988"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.4679988-0
 Parameter: XTRAN <- "-31.4679988"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.7470374"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -36.7470374-0
 Parameter: YTRAN <- "-36.7470374"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.3371602"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.3371602-0
 Parameter: ZTRAN <- "-22.3371602"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.4679988"
 Parameter: YTRAN -> "-36.7470374"
 Parameter: ZTRAN -> "-22.3371602"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -31.467999  -36.747037  -22.337160
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.382866319"
Evaluating: 0.382866319*360.0
 Parameter: XPHI <- "137.831875"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.600858293"
Evaluating: 0.600858293*360.0
 Parameter: YPHI <- "216.308985"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.525827148"
Evaluating: 0.525827148*360.0
 Parameter: ZPHI <- "189.297773"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.4679988"
 Parameter: YPOS -> "-36.7470374"
 Parameter: ZPOS -> "-22.3371602"
 Parameter: XPHI -> "137.831875"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.741178    0.671308
    0.000000   -0.671308   -0.741178

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  137.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.4679988"
 Parameter: YPOS -> "-36.7470374"
 Parameter: ZPOS -> "-22.3371602"
 Parameter: YPHI -> "216.308985"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.805835    0.000000    0.592140
    0.000000    1.000000    0.000000
   -0.592140    0.000000   -0.805835

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  143.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.4679988"
 Parameter: YPOS -> "-36.7470374"
 Parameter: ZPOS -> "-22.3371602"
 Parameter: ZPHI -> "189.297773"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.986862   -0.161565    0.000000
    0.161565   -0.986862    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  170.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.467999 XMAX =  -31.467999 XAVE =  -31.467999
    YMIN =  -36.747037 YMAX =  -36.747037 YAVE =  -36.747037
    ZMIN =  -22.337160 ZMAX =  -22.337160 ZAVE =  -22.337160
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.4679988"
Evaluating: -31.4679988+3.5
 Parameter: XMAX <- "-27.9679988"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.7470374"
Evaluating: -36.7470374+3.5
 Parameter: YMAX <- "-33.2470374"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.3371602"
Evaluating: -22.3371602+3.5
 Parameter: ZMAX <- "-18.8371602"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.4679988"
Evaluating: -31.4679988-3.5
 Parameter: XMIN <- "-34.9679988"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.7470374"
Evaluating: -36.7470374-3.5
 Parameter: YMIN <- "-40.2470374"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.3371602"
Evaluating: -22.3371602-3.5
 Parameter: ZMIN <- "-25.8371602"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.9679988"
 Parameter: XMIN -> "-34.9679988"
 Parameter: YMAX -> "-33.2470374"
 Parameter: YMIN -> "-40.2470374"
 Parameter: ZMAX -> "-18.8371602"
 Parameter: ZMIN -> "-25.8371602"
 SELRPN>     15 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      6 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64676 NEG      CLA      118      CLA     -**** MEMB     POPC     225      N             2.9593
64676 NEG      CLA      118      CLA     -**** MEMB     POPC     225      C12           2.1622
64676 NEG      CLA      118      CLA     -**** MEMB     POPC     225      C13           3.1429
64676 NEG      CLA      118      CLA     -**** MEMB     POPC     225      C14           3.2274
64676 NEG      CLA      118      CLA     -**** MEMB     POPC     225      C11           3.2357
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "261"
Evaluating: 261
 Parameter: J <- "261"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "261" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "261"
 Parameter: NPOS -> "143"
Evaluating: 261-143
 Parameter: J <- "118"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "118"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.535891223"
Evaluating: 125.050557*(0.535891223-0.5)
 Parameter: XPOS <- "4.48821743"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.634462595"
Evaluating: 125.050557*(0.634462595-0.5)
 Parameter: YPOS <- "16.8146224"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "3.609016201E-02"
Evaluating: 152.572525*(3.609016201E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-75.2957494"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-75.2957494" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.467999 XMAX =  -31.467999 XAVE =  -31.467999
    YMIN =  -36.747037 YMAX =  -36.747037 YAVE =  -36.747037
    ZMIN =  -22.337160 ZMAX =  -22.337160 ZAVE =  -22.337160
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.48821743"
 RDCMND substituted energy or value "?XAVE" to "-31.4679988"
Evaluating: 4.48821743--31.4679988
 Parameter: XTRAN <- "35.9562162"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.8146224"
 RDCMND substituted energy or value "?YAVE" to "-36.7470374"
Evaluating: 16.8146224--36.7470374
 Parameter: YTRAN <- "53.5616598"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-75.2957494"
 RDCMND substituted energy or value "?ZAVE" to "-22.3371602"
Evaluating: -75.2957494--22.3371602
 Parameter: ZTRAN <- "-52.9585892"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.9562162"
 Parameter: YTRAN -> "53.5616598"
 Parameter: ZTRAN -> "-52.9585892"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    35.956216   53.561660  -52.958589
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.75615763"
Evaluating: 0.75615763*360.0
 Parameter: XPHI <- "272.216747"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.8545583"
Evaluating: 0.8545583*360.0
 Parameter: YPHI <- "307.640988"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.148890559"
Evaluating: 0.148890559*360.0
 Parameter: ZPHI <- "53.6006012"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.48821743"
 Parameter: YPOS -> "16.8146224"
 Parameter: ZPOS -> "-75.2957494"
 Parameter: XPHI -> "272.216747"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.038680   -0.999252
    0.000000    0.999252    0.038680

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   87.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.48821743"
 Parameter: YPOS -> "16.8146224"
 Parameter: ZPOS -> "-75.2957494"
 Parameter: YPHI -> "307.640988"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.610712    0.000000    0.791853
    0.000000    1.000000    0.000000
   -0.791853    0.000000    0.610712

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   52.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.48821743"
 Parameter: YPOS -> "16.8146224"
 Parameter: ZPOS -> "-75.2957494"
 Parameter: ZPHI -> "53.6006012"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.593410    0.804900    0.000000
   -0.804900    0.593410    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   53.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.488217 XMAX =    4.488217 XAVE =    4.488217
    YMIN =   16.814622 YMAX =   16.814622 YAVE =   16.814622
    ZMIN =  -75.295749 ZMAX =  -75.295749 ZAVE =  -75.295749
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.48821742"
Evaluating: 4.48821742+3.5
 Parameter: XMAX <- "7.98821742"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.8146224"
Evaluating: 16.8146224+3.5
 Parameter: YMAX <- "20.3146224"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-75.2957494"
Evaluating: -75.2957494+3.5
 Parameter: ZMAX <- "-71.7957494"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.48821742"
Evaluating: 4.48821742-3.5
 Parameter: XMIN <- "0.98821742"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.8146224"
Evaluating: 16.8146224-3.5
 Parameter: YMIN <- "13.3146224"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-75.2957494"
Evaluating: -75.2957494-3.5
 Parameter: ZMIN <- "-78.7957494"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.98821742"
 Parameter: XMIN -> "0.98821742"
 Parameter: YMAX -> "20.3146224"
 Parameter: YMIN -> "13.3146224"
 Parameter: ZMAX -> "-71.7957494"
 Parameter: ZMIN -> "-78.7957494"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "262"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "262" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "262"
Evaluating: 262
 Parameter: J <- "262"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "262" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "262"
 Parameter: NPOS -> "143"
Evaluating: 262-143
 Parameter: J <- "119"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "119"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.430592927"
Evaluating: 125.050557*(0.430592927-0.5)
 Parameter: XPOS <- "-8.67939314"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "6.453949995E-02"
Evaluating: 125.050557*(6.453949995E-02-0.5)
 Parameter: YPOS <- "-54.4545781"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.748105311"
Evaluating: 152.572525*(0.748105311-0.5)+-4.51585405
 Parameter: ZPOS <- "33.3381997"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.3381997" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.3381997" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.67939314"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.67939314-0
 Parameter: XTRAN <- "-8.67939314"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-54.4545781"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -54.4545781-0
 Parameter: YTRAN <- "-54.4545781"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.3381997"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.3381997-0
 Parameter: ZTRAN <- "33.3381997"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.67939314"
 Parameter: YTRAN -> "-54.4545781"
 Parameter: ZTRAN -> "33.3381997"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -8.679393  -54.454578   33.338200
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.114836715"
Evaluating: 0.114836715*360.0
 Parameter: XPHI <- "41.3412174"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.216737498"
Evaluating: 0.216737498*360.0
 Parameter: YPHI <- "78.0254993"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.412498008E-02"
Evaluating: 3.412498008E-02*360.0
 Parameter: ZPHI <- "12.2849928"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.67939314"
 Parameter: YPOS -> "-54.4545781"
 Parameter: ZPOS -> "33.3381997"
 Parameter: XPHI -> "41.3412174"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.750789    0.660542
    0.000000   -0.660542    0.750789

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   41.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.67939314"
 Parameter: YPOS -> "-54.4545781"
 Parameter: ZPOS -> "33.3381997"
 Parameter: YPHI -> "78.0254993"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.207476    0.000000   -0.978240
    0.000000    1.000000    0.000000
    0.978240    0.000000    0.207476

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   78.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.67939314"
 Parameter: YPOS -> "-54.4545781"
 Parameter: ZPOS -> "33.3381997"
 Parameter: ZPHI -> "12.2849928"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.977101    0.212774    0.000000
   -0.212774    0.977101    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   12.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.679393 XMAX =   -8.679393 XAVE =   -8.679393
    YMIN =  -54.454578 YMAX =  -54.454578 YAVE =  -54.454578
    ZMIN =   33.338200 ZMAX =   33.338200 ZAVE =   33.338200
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.67939314"
Evaluating: -8.67939314+3.5
 Parameter: XMAX <- "-5.17939314"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-54.4545781"
Evaluating: -54.4545781+3.5
 Parameter: YMAX <- "-50.9545781"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.3381997"
Evaluating: 33.3381997+3.5
 Parameter: ZMAX <- "36.8381997"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.67939314"
Evaluating: -8.67939314-3.5
 Parameter: XMIN <- "-12.1793931"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-54.4545781"
Evaluating: -54.4545781-3.5
 Parameter: YMIN <- "-57.9545781"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.3381997"
Evaluating: 33.3381997-3.5
 Parameter: ZMIN <- "29.8381997"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.17939314"
 Parameter: XMIN -> "-12.1793931"
 Parameter: YMAX -> "-50.9545781"
 Parameter: YMIN -> "-57.9545781"
 Parameter: ZMAX -> "36.8381997"
 Parameter: ZMIN -> "29.8381997"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "263"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "263" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "263"
Evaluating: 263
 Parameter: J <- "263"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "263" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "263"
 Parameter: NPOS -> "143"
Evaluating: 263-143
 Parameter: J <- "120"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "120"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.227162571"
Evaluating: 125.050557*(0.227162571-0.5)
 Parameter: XPOS <- "-34.1184725"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.301868894"
Evaluating: 125.050557*(0.301868894-0.5)
 Parameter: YPOS <- "-24.7764052"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.917290284"
Evaluating: 152.572525*(0.917290284-0.5)+-4.51585405
 Parameter: ZPOS <- "59.1511782"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "59.1511782" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "59.1511782" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.1184725"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.1184725-0
 Parameter: XTRAN <- "-34.1184725"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.7764052"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.7764052-0
 Parameter: YTRAN <- "-24.7764052"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "59.1511782"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 59.1511782-0
 Parameter: ZTRAN <- "59.1511782"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.1184725"
 Parameter: YTRAN -> "-24.7764052"
 Parameter: ZTRAN -> "59.1511782"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -34.118473  -24.776405   59.151178
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.685281777"
Evaluating: 0.685281777*360.0
 Parameter: XPHI <- "246.70144"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.281766321"
Evaluating: 0.281766321*360.0
 Parameter: YPHI <- "101.435876"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.863800303"
Evaluating: 0.863800303*360.0
 Parameter: ZPHI <- "310.968109"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.1184725"
 Parameter: YPOS -> "-24.7764052"
 Parameter: ZPOS -> "59.1511782"
 Parameter: XPHI -> "246.70144"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.395522   -0.918456
    0.000000    0.918456   -0.395522

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  113.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.1184725"
 Parameter: YPOS -> "-24.7764052"
 Parameter: ZPOS -> "59.1511782"
 Parameter: YPHI -> "101.435876"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.198271    0.000000   -0.980147
    0.000000    1.000000    0.000000
    0.980147    0.000000   -0.198271

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  101.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.1184725"
 Parameter: YPOS -> "-24.7764052"
 Parameter: ZPOS -> "59.1511782"
 Parameter: ZPHI -> "310.968109"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.655639   -0.755075    0.000000
    0.755075    0.655639    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   49.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.118473 XMAX =  -34.118473 XAVE =  -34.118473
    YMIN =  -24.776405 YMAX =  -24.776405 YAVE =  -24.776405
    ZMIN =   59.151178 ZMAX =   59.151178 ZAVE =   59.151178
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.1184725"
Evaluating: -34.1184725+3.5
 Parameter: XMAX <- "-30.6184725"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.7764052"
Evaluating: -24.7764052+3.5
 Parameter: YMAX <- "-21.2764052"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "59.1511782"
Evaluating: 59.1511782+3.5
 Parameter: ZMAX <- "62.6511782"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.1184725"
Evaluating: -34.1184725-3.5
 Parameter: XMIN <- "-37.6184725"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.7764052"
Evaluating: -24.7764052-3.5
 Parameter: YMIN <- "-28.2764052"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "59.1511782"
Evaluating: 59.1511782-3.5
 Parameter: ZMIN <- "55.6511782"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.6184725"
 Parameter: XMIN -> "-37.6184725"
 Parameter: YMAX -> "-21.2764052"
 Parameter: YMIN -> "-28.2764052"
 Parameter: ZMAX -> "62.6511782"
 Parameter: ZMIN -> "55.6511782"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "264"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "264" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "264"
Evaluating: 264
 Parameter: J <- "264"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "264" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "264"
 Parameter: NPOS -> "143"
Evaluating: 264-143
 Parameter: J <- "121"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "121"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.44917252"
Evaluating: 125.050557*(0.44917252-0.5)
 Parameter: XPOS <- "-6.35600468"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.565251354"
Evaluating: 125.050557*(0.565251354-0.5)
 Parameter: YPOS <- "8.15971816"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.678621799"
Evaluating: 152.572525*(0.678621799-0.5)+-4.51585405
 Parameter: ZPOS <- "22.7369248"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.7369248" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.7369248" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.35600468"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.35600468-0
 Parameter: XTRAN <- "-6.35600468"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.15971816"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.15971816-0
 Parameter: YTRAN <- "8.15971816"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.7369248"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.7369248-0
 Parameter: ZTRAN <- "22.7369248"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.35600468"
 Parameter: YTRAN -> "8.15971816"
 Parameter: ZTRAN -> "22.7369248"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -6.356005    8.159718   22.736925
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.703801134"
Evaluating: 0.703801134*360.0
 Parameter: XPHI <- "253.368408"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.741455326E-02"
Evaluating: 6.741455326E-02*360.0
 Parameter: YPHI <- "24.2692392"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.142659542"
Evaluating: 0.142659542*360.0
 Parameter: ZPHI <- "51.3574351"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.35600468"
 Parameter: YPOS -> "8.15971816"
 Parameter: ZPOS -> "22.7369248"
 Parameter: XPHI -> "253.368408"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.286217   -0.958165
    0.000000    0.958165   -0.286217

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  106.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.35600468"
 Parameter: YPOS -> "8.15971816"
 Parameter: ZPOS -> "22.7369248"
 Parameter: YPHI -> "24.2692392"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.911624    0.000000   -0.411025
    0.000000    1.000000    0.000000
    0.411025    0.000000    0.911624

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   24.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.35600468"
 Parameter: YPOS -> "8.15971816"
 Parameter: ZPOS -> "22.7369248"
 Parameter: ZPHI -> "51.3574351"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.624460    0.781057    0.000000
   -0.781057    0.624460    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   51.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.356005 XMAX =   -6.356005 XAVE =   -6.356005
    YMIN =    8.159718 YMAX =    8.159718 YAVE =    8.159718
    ZMIN =   22.736925 ZMAX =   22.736925 ZAVE =   22.736925
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.35600468"
Evaluating: -6.35600468+3.5
 Parameter: XMAX <- "-2.85600468"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.15971816"
Evaluating: 8.15971816+3.5
 Parameter: YMAX <- "11.6597182"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.7369248"
Evaluating: 22.7369248+3.5
 Parameter: ZMAX <- "26.2369248"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.35600468"
Evaluating: -6.35600468-3.5
 Parameter: XMIN <- "-9.85600468"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.15971816"
Evaluating: 8.15971816-3.5
 Parameter: YMIN <- "4.65971816"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.7369248"
Evaluating: 22.7369248-3.5
 Parameter: ZMIN <- "19.2369248"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.85600468"
 Parameter: XMIN -> "-9.85600468"
 Parameter: YMAX -> "11.6597182"
 Parameter: YMIN -> "4.65971816"
 Parameter: ZMAX -> "26.2369248"
 Parameter: ZMIN -> "19.2369248"
 SELRPN>     16 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      8 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64679 NEG      CLA      121      CLA     -**** PROA     ASP      994      CB            4.2431
64679 NEG      CLA      121      CLA     -**** PROA     ASP      994      CG            3.0970
64679 NEG      CLA      121      CLA     -**** PROA     ASP      994      OD1           3.5119
64679 NEG      CLA      121      CLA     -**** PROA     ASP      994      OD2           2.3035
64679 NEG      CLA      121      CLA     -**** PROA     LEU      1330     CA            4.7571
64679 NEG      CLA      121      CLA     -**** PROA     LEU      1330     CB            3.3585
64679 NEG      CLA      121      CLA     -**** PROA     LEU      1330     CG            3.4953
64679 NEG      CLA      121      CLA     -**** PROA     LEU      1330     CD1           3.8943
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "264"
Evaluating: 264
 Parameter: J <- "264"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "264" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "264"
 Parameter: NPOS -> "143"
Evaluating: 264-143
 Parameter: J <- "121"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "121"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.894331817"
Evaluating: 125.050557*(0.894331817-0.5)
 Parameter: XPOS <- "49.3114134"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.999198564"
Evaluating: 125.050557*(0.999198564-0.5)
 Parameter: YPOS <- "62.4250585"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.321026977"
Evaluating: 152.572525*(0.321026977-0.5)+-4.51585405
 Parameter: ZPOS <- "-31.8222201"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.8222201" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.356005 XMAX =   -6.356005 XAVE =   -6.356005
    YMIN =    8.159718 YMAX =    8.159718 YAVE =    8.159718
    ZMIN =   22.736925 ZMAX =   22.736925 ZAVE =   22.736925
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.3114134"
 RDCMND substituted energy or value "?XAVE" to "-6.35600468"
Evaluating: 49.3114134--6.35600468
 Parameter: XTRAN <- "55.6674181"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "62.4250585"
 RDCMND substituted energy or value "?YAVE" to "8.15971816"
Evaluating: 62.4250585-8.15971816
 Parameter: YTRAN <- "54.2653403"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.8222201"
 RDCMND substituted energy or value "?ZAVE" to "22.7369248"
Evaluating: -31.8222201-22.7369248
 Parameter: ZTRAN <- "-54.5591449"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "55.6674181"
 Parameter: YTRAN -> "54.2653403"
 Parameter: ZTRAN -> "-54.5591449"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    55.667418   54.265340  -54.559145
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.705471"
Evaluating: 0.705471*360.0
 Parameter: XPHI <- "253.96956"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.103178869"
Evaluating: 0.103178869*360.0
 Parameter: YPHI <- "37.1443928"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.4357334"
Evaluating: 0.4357334*360.0
 Parameter: ZPHI <- "156.864024"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.3114134"
 Parameter: YPOS -> "62.4250585"
 Parameter: ZPOS -> "-31.8222201"
 Parameter: XPHI -> "253.96956"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.276148   -0.961115
    0.000000    0.961115   -0.276148

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  106.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.3114134"
 Parameter: YPOS -> "62.4250585"
 Parameter: ZPOS -> "-31.8222201"
 Parameter: YPHI -> "37.1443928"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.797116    0.000000   -0.603826
    0.000000    1.000000    0.000000
    0.603826    0.000000    0.797116

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   37.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.3114134"
 Parameter: YPOS -> "62.4250585"
 Parameter: ZPOS -> "-31.8222201"
 Parameter: ZPHI -> "156.864024"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.919575    0.392915    0.000000
   -0.392915   -0.919575    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  156.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.311413 XMAX =   49.311413 XAVE =   49.311413
    YMIN =   62.425058 YMAX =   62.425058 YAVE =   62.425058
    ZMIN =  -31.822220 ZMAX =  -31.822220 ZAVE =  -31.822220
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.3114134"
Evaluating: 49.3114134+3.5
 Parameter: XMAX <- "52.8114134"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "62.4250585"
Evaluating: 62.4250585+3.5
 Parameter: YMAX <- "65.9250585"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.8222201"
Evaluating: -31.8222201+3.5
 Parameter: ZMAX <- "-28.3222201"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.3114134"
Evaluating: 49.3114134-3.5
 Parameter: XMIN <- "45.8114134"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "62.4250585"
Evaluating: 62.4250585-3.5
 Parameter: YMIN <- "58.9250585"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.8222201"
Evaluating: -31.8222201-3.5
 Parameter: ZMIN <- "-35.3222201"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.8114134"
 Parameter: XMIN -> "45.8114134"
 Parameter: YMAX -> "65.9250585"
 Parameter: YMIN -> "58.9250585"
 Parameter: ZMAX -> "-28.3222201"
 Parameter: ZMIN -> "-35.3222201"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "265"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "265" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "265"
Evaluating: 265
 Parameter: J <- "265"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "265" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "265"
 Parameter: NPOS -> "143"
Evaluating: 265-143
 Parameter: J <- "122"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "122"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.23206688"
Evaluating: 125.050557*(0.23206688-0.5)
 Parameter: XPOS <- "-33.5051859"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.217211206"
Evaluating: 125.050557*(0.217211206-0.5)
 Parameter: YPOS <- "-35.3628962"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.125190927"
Evaluating: 152.572525*(0.125190927-0.5)+-4.51585405
 Parameter: ZPOS <- "-61.7014207"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-61.7014207" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.5051859"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.5051859-0
 Parameter: XTRAN <- "-33.5051859"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.3628962"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.3628962-0
 Parameter: YTRAN <- "-35.3628962"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-61.7014207"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -61.7014207-0
 Parameter: ZTRAN <- "-61.7014207"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.5051859"
 Parameter: YTRAN -> "-35.3628962"
 Parameter: ZTRAN -> "-61.7014207"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -33.505186  -35.362896  -61.701421
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.938533196E-02"
Evaluating: 8.938533196E-02*360.0
 Parameter: XPHI <- "32.1787195"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.931305166"
Evaluating: 0.931305166*360.0
 Parameter: YPHI <- "335.26986"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.968566501"
Evaluating: 0.968566501*360.0
 Parameter: ZPHI <- "348.68394"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.5051859"
 Parameter: YPOS -> "-35.3628962"
 Parameter: ZPOS -> "-61.7014207"
 Parameter: XPHI -> "32.1787195"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.846391    0.532562
    0.000000   -0.532562    0.846391

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   32.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.5051859"
 Parameter: YPOS -> "-35.3628962"
 Parameter: ZPOS -> "-61.7014207"
 Parameter: YPHI -> "335.26986"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.908288    0.000000    0.418345
    0.000000    1.000000    0.000000
   -0.418345    0.000000    0.908288

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   24.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.5051859"
 Parameter: YPOS -> "-35.3628962"
 Parameter: ZPOS -> "-61.7014207"
 Parameter: ZPHI -> "348.68394"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.980560   -0.196221    0.000000
    0.196221    0.980560    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   11.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.505186 XMAX =  -33.505186 XAVE =  -33.505186
    YMIN =  -35.362896 YMAX =  -35.362896 YAVE =  -35.362896
    ZMIN =  -61.701421 ZMAX =  -61.701421 ZAVE =  -61.701421
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.5051859"
Evaluating: -33.5051859+3.5
 Parameter: XMAX <- "-30.0051859"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.3628962"
Evaluating: -35.3628962+3.5
 Parameter: YMAX <- "-31.8628962"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-61.7014207"
Evaluating: -61.7014207+3.5
 Parameter: ZMAX <- "-58.2014207"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.5051859"
Evaluating: -33.5051859-3.5
 Parameter: XMIN <- "-37.0051859"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.3628962"
Evaluating: -35.3628962-3.5
 Parameter: YMIN <- "-38.8628962"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-61.7014207"
Evaluating: -61.7014207-3.5
 Parameter: ZMIN <- "-65.2014207"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.0051859"
 Parameter: XMIN -> "-37.0051859"
 Parameter: YMAX -> "-31.8628962"
 Parameter: YMIN -> "-38.8628962"
 Parameter: ZMAX -> "-58.2014207"
 Parameter: ZMIN -> "-65.2014207"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "266"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "266" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "266"
Evaluating: 266
 Parameter: J <- "266"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "266" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "266"
 Parameter: NPOS -> "143"
Evaluating: 266-143
 Parameter: J <- "123"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "123"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.021375122E-02"
Evaluating: 125.050557*(1.021375122E-02-0.5)
 Parameter: XPOS <- "-61.2480432"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.692689021"
Evaluating: 125.050557*(0.692689021-0.5)
 Parameter: YPOS <- "24.0958694"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "6.212976579E-02"
Evaluating: 152.572525*(6.212976579E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-71.3228213"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-71.3228213" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-61.2480432"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -61.2480432-0
 Parameter: XTRAN <- "-61.2480432"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.0958694"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.0958694-0
 Parameter: YTRAN <- "24.0958694"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-71.3228213"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -71.3228213-0
 Parameter: ZTRAN <- "-71.3228213"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-61.2480432"
 Parameter: YTRAN -> "24.0958694"
 Parameter: ZTRAN -> "-71.3228213"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -61.248043   24.095869  -71.322821
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.641061235"
Evaluating: 0.641061235*360.0
 Parameter: XPHI <- "230.782045"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.593550869"
Evaluating: 0.593550869*360.0
 Parameter: YPHI <- "213.678313"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111686018"
Evaluating: 0.111686018*360.0
 Parameter: ZPHI <- "40.2069665"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-61.2480432"
 Parameter: YPOS -> "24.0958694"
 Parameter: ZPOS -> "-71.3228213"
 Parameter: XPHI -> "230.782045"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.632272   -0.774746
    0.000000    0.774746   -0.632272

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-61.2480432"
 Parameter: YPOS -> "24.0958694"
 Parameter: ZPOS -> "-71.3228213"
 Parameter: YPHI -> "213.678313"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.832164    0.000000    0.554529
    0.000000    1.000000    0.000000
   -0.554529    0.000000   -0.832164

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  146.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-61.2480432"
 Parameter: YPOS -> "24.0958694"
 Parameter: ZPOS -> "-71.3228213"
 Parameter: ZPHI -> "40.2069665"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.763718    0.645551    0.000000
   -0.645551    0.763718    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   40.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -61.248043 XMAX =  -61.248043 XAVE =  -61.248043
    YMIN =   24.095869 YMAX =   24.095869 YAVE =   24.095869
    ZMIN =  -71.322821 ZMAX =  -71.322821 ZAVE =  -71.322821
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-61.2480432"
Evaluating: -61.2480432+3.5
 Parameter: XMAX <- "-57.7480432"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.0958694"
Evaluating: 24.0958694+3.5
 Parameter: YMAX <- "27.5958694"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-71.3228213"
Evaluating: -71.3228213+3.5
 Parameter: ZMAX <- "-67.8228213"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-61.2480432"
Evaluating: -61.2480432-3.5
 Parameter: XMIN <- "-64.7480432"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.0958694"
Evaluating: 24.0958694-3.5
 Parameter: YMIN <- "20.5958694"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-71.3228213"
Evaluating: -71.3228213-3.5
 Parameter: ZMIN <- "-74.8228213"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-57.7480432"
 Parameter: XMIN -> "-64.7480432"
 Parameter: YMAX -> "27.5958694"
 Parameter: YMIN -> "20.5958694"
 Parameter: ZMAX -> "-67.8228213"
 Parameter: ZMIN -> "-74.8228213"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64681 NEG      CLA      123      CLA     -**** NEG      CLA      63       CLA           3.6397
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "266"
Evaluating: 266
 Parameter: J <- "266"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "266" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "266"
 Parameter: NPOS -> "143"
Evaluating: 266-143
 Parameter: J <- "123"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "123"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.313039664"
Evaluating: 125.050557*(0.313039664-0.5)
 Parameter: XPOS <- "-23.3794942"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.818394848"
Evaluating: 125.050557*(0.818394848-0.5)
 Parameter: YPOS <- "39.8154531"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.798354333"
Evaluating: 152.572525*(0.798354333-0.5)+-4.51585405
 Parameter: ZPOS <- "41.0048199"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.0048199" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.0048199" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -61.248043 XMAX =  -61.248043 XAVE =  -61.248043
    YMIN =   24.095869 YMAX =   24.095869 YAVE =   24.095869
    ZMIN =  -71.322821 ZMAX =  -71.322821 ZAVE =  -71.322821
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.3794942"
 RDCMND substituted energy or value "?XAVE" to "-61.2480432"
Evaluating: -23.3794942--61.2480432
 Parameter: XTRAN <- "37.868549"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.8154531"
 RDCMND substituted energy or value "?YAVE" to "24.0958694"
Evaluating: 39.8154531-24.0958694
 Parameter: YTRAN <- "15.7195837"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.0048199"
 RDCMND substituted energy or value "?ZAVE" to "-71.3228213"
Evaluating: 41.0048199--71.3228213
 Parameter: ZTRAN <- "112.327641"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.868549"
 Parameter: YTRAN -> "15.7195837"
 Parameter: ZTRAN -> "112.327641"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    37.868549   15.719584  112.327641
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.31956"
Evaluating: 0.31956*360.0
 Parameter: XPHI <- "115.0416"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.169305376"
Evaluating: 0.169305376*360.0
 Parameter: YPHI <- "60.9499354"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.230273591"
Evaluating: 0.230273591*360.0
 Parameter: ZPHI <- "82.8984928"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.3794942"
 Parameter: YPOS -> "39.8154531"
 Parameter: ZPOS -> "41.0048199"
 Parameter: XPHI -> "115.0416"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.423276    0.906001
    0.000000   -0.906001   -0.423276

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  115.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.3794942"
 Parameter: YPOS -> "39.8154531"
 Parameter: ZPOS -> "41.0048199"
 Parameter: YPHI -> "60.9499354"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.485574    0.000000   -0.874196
    0.000000    1.000000    0.000000
    0.874196    0.000000    0.485574

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   60.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.3794942"
 Parameter: YPOS -> "39.8154531"
 Parameter: ZPOS -> "41.0048199"
 Parameter: ZPHI -> "82.8984928"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.123628    0.992329    0.000000
   -0.992329    0.123628    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   82.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.379494 XMAX =  -23.379494 XAVE =  -23.379494
    YMIN =   39.815453 YMAX =   39.815453 YAVE =   39.815453
    ZMIN =   41.004820 ZMAX =   41.004820 ZAVE =   41.004820
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.3794944"
Evaluating: -23.3794944+3.5
 Parameter: XMAX <- "-19.8794944"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.8154532"
Evaluating: 39.8154532+3.5
 Parameter: YMAX <- "43.3154532"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.0048199"
Evaluating: 41.0048199+3.5
 Parameter: ZMAX <- "44.5048199"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.3794944"
Evaluating: -23.3794944-3.5
 Parameter: XMIN <- "-26.8794944"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.8154532"
Evaluating: 39.8154532-3.5
 Parameter: YMIN <- "36.3154532"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.0048199"
Evaluating: 41.0048199-3.5
 Parameter: ZMIN <- "37.5048199"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.8794944"
 Parameter: XMIN -> "-26.8794944"
 Parameter: YMAX -> "43.3154532"
 Parameter: YMIN -> "36.3154532"
 Parameter: ZMAX -> "44.5048199"
 Parameter: ZMIN -> "37.5048199"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "267"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "267" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "267"
Evaluating: 267
 Parameter: J <- "267"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "267" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "267"
 Parameter: NPOS -> "143"
Evaluating: 267-143
 Parameter: J <- "124"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "124"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.931233417"
Evaluating: 125.050557*(0.931233417-0.5)
 Parameter: XPOS <- "53.925979"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.897083237"
Evaluating: 125.050557*(0.897083237-0.5)
 Parameter: YPOS <- "49.65548"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.291584151"
Evaluating: 152.572525*(0.291584151-0.5)+-4.51585405
 Parameter: ZPOS <- "-36.3143864"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.3143864" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "53.925979"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 53.925979-0
 Parameter: XTRAN <- "53.925979"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "49.65548"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 49.65548-0
 Parameter: YTRAN <- "49.65548"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.3143864"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.3143864-0
 Parameter: ZTRAN <- "-36.3143864"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "53.925979"
 Parameter: YTRAN -> "49.65548"
 Parameter: ZTRAN -> "-36.3143864"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    53.925979   49.655480  -36.314386
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.794201328"
Evaluating: 0.794201328*360.0
 Parameter: XPHI <- "285.912478"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.631671895"
Evaluating: 0.631671895*360.0
 Parameter: YPHI <- "227.401882"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.999599075"
Evaluating: 0.999599075*360.0
 Parameter: ZPHI <- "359.855667"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "53.925979"
 Parameter: YPOS -> "49.65548"
 Parameter: ZPOS -> "-36.3143864"
 Parameter: XPHI -> "285.912478"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.274169   -0.961682
    0.000000    0.961682    0.274169

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   74.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "53.925979"
 Parameter: YPOS -> "49.65548"
 Parameter: ZPOS -> "-36.3143864"
 Parameter: YPHI -> "227.401882"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.676852    0.000000    0.736119
    0.000000    1.000000    0.000000
   -0.736119    0.000000   -0.676852

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  132.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "53.925979"
 Parameter: YPOS -> "49.65548"
 Parameter: ZPOS -> "-36.3143864"
 Parameter: ZPHI -> "359.855667"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999997   -0.002519    0.000000
    0.002519    0.999997    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    0.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   53.925979 XMAX =   53.925979 XAVE =   53.925979
    YMIN =   49.655480 YMAX =   49.655480 YAVE =   49.655480
    ZMIN =  -36.314386 ZMAX =  -36.314386 ZAVE =  -36.314386
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "53.925979"
Evaluating: 53.925979+3.5
 Parameter: XMAX <- "57.425979"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "49.65548"
Evaluating: 49.65548+3.5
 Parameter: YMAX <- "53.15548"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.3143864"
Evaluating: -36.3143864+3.5
 Parameter: ZMAX <- "-32.8143864"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "53.925979"
Evaluating: 53.925979-3.5
 Parameter: XMIN <- "50.425979"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "49.65548"
Evaluating: 49.65548-3.5
 Parameter: YMIN <- "46.15548"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.3143864"
Evaluating: -36.3143864-3.5
 Parameter: ZMIN <- "-39.8143864"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.425979"
 Parameter: XMIN -> "50.425979"
 Parameter: YMAX -> "53.15548"
 Parameter: YMIN -> "46.15548"
 Parameter: ZMAX -> "-32.8143864"
 Parameter: ZMIN -> "-39.8143864"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "268"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "268" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "268"
Evaluating: 268
 Parameter: J <- "268"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "268" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "268"
 Parameter: NPOS -> "143"
Evaluating: 268-143
 Parameter: J <- "125"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "125"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.313849721"
Evaluating: 125.050557*(0.313849721-0.5)
 Parameter: XPOS <- "-23.2781961"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.728689473"
Evaluating: 125.050557*(0.728689473-0.5)
 Parameter: YPOS <- "28.597746"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.455926376"
Evaluating: 152.572525*(0.455926376-0.5)+-4.51585405
 Parameter: ZPOS <- "-11.2402781"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.2402781" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.2402781" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "268"
Evaluating: 268
 Parameter: J <- "268"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "268" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "268"
 Parameter: NPOS -> "143"
Evaluating: 268-143
 Parameter: J <- "125"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "125"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.903152003"
Evaluating: 125.050557*(0.903152003-0.5)
 Parameter: XPOS <- "50.4143825"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.77355942"
Evaluating: 125.050557*(0.77355942-0.5)
 Parameter: YPOS <- "34.2087578"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "6.345897762E-02"
Evaluating: 152.572525*(6.345897762E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-71.1200201"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-71.1200201" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "50.4143825"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 50.4143825-0
 Parameter: XTRAN <- "50.4143825"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.2087578"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.2087578-0
 Parameter: YTRAN <- "34.2087578"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-71.1200201"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -71.1200201-0
 Parameter: ZTRAN <- "-71.1200201"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.4143825"
 Parameter: YTRAN -> "34.2087578"
 Parameter: ZTRAN -> "-71.1200201"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    50.414383   34.208758  -71.120020
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.777423583"
Evaluating: 0.777423583*360.0
 Parameter: XPHI <- "279.87249"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.341700138"
Evaluating: 0.341700138*360.0
 Parameter: YPHI <- "123.01205"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335010002"
Evaluating: 0.335010002*360.0
 Parameter: ZPHI <- "120.603601"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "50.4143825"
 Parameter: YPOS -> "34.2087578"
 Parameter: ZPOS -> "-71.1200201"
 Parameter: XPHI -> "279.87249"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.171456   -0.985192
    0.000000    0.985192    0.171456

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   80.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "50.4143825"
 Parameter: YPOS -> "34.2087578"
 Parameter: ZPOS -> "-71.1200201"
 Parameter: YPHI -> "123.01205"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.544815    0.000000   -0.838556
    0.000000    1.000000    0.000000
    0.838556    0.000000   -0.544815

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  123.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "50.4143825"
 Parameter: YPOS -> "34.2087578"
 Parameter: ZPOS -> "-71.1200201"
 Parameter: ZPHI -> "120.603601"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.509096    0.860710    0.000000
   -0.860710   -0.509096    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  120.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.414383 XMAX =   50.414383 XAVE =   50.414383
    YMIN =   34.208758 YMAX =   34.208758 YAVE =   34.208758
    ZMIN =  -71.120020 ZMAX =  -71.120020 ZAVE =  -71.120020
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "50.4143825"
Evaluating: 50.4143825+3.5
 Parameter: XMAX <- "53.9143825"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.2087578"
Evaluating: 34.2087578+3.5
 Parameter: YMAX <- "37.7087578"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-71.1200201"
Evaluating: -71.1200201+3.5
 Parameter: ZMAX <- "-67.6200201"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "50.4143825"
Evaluating: 50.4143825-3.5
 Parameter: XMIN <- "46.9143825"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.2087578"
Evaluating: 34.2087578-3.5
 Parameter: YMIN <- "30.7087578"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-71.1200201"
Evaluating: -71.1200201-3.5
 Parameter: ZMIN <- "-74.6200201"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.9143825"
 Parameter: XMIN -> "46.9143825"
 Parameter: YMAX -> "37.7087578"
 Parameter: YMIN -> "30.7087578"
 Parameter: ZMAX -> "-67.6200201"
 Parameter: ZMIN -> "-74.6200201"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64683 NEG      CLA      125      CLA     -**** POS      SOD      72       SOD           1.2285
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "268"
Evaluating: 268
 Parameter: J <- "268"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "268" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "268"
 Parameter: NPOS -> "143"
Evaluating: 268-143
 Parameter: J <- "125"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "125"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.537151651"
Evaluating: 125.050557*(0.537151651-0.5)
 Parameter: XPOS <- "4.64583465"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.485132265"
Evaluating: 125.050557*(0.485132265-0.5)
 Parameter: YPOS <- "-1.85921854"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.572375516"
Evaluating: 152.572525*(0.572375516-0.5)+-4.51585405
 Parameter: ZPOS <- "6.52666117"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.52666117" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.52666117" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "268"
Evaluating: 268
 Parameter: J <- "268"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "268" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "268"
 Parameter: NPOS -> "143"
Evaluating: 268-143
 Parameter: J <- "125"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "125"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "3.347129449E-02"
Evaluating: 125.050557*(3.347129449E-02-0.5)
 Parameter: XPOS <- "-58.3396745"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.305282906"
Evaluating: 125.050557*(0.305282906-0.5)
 Parameter: YPOS <- "-24.3494811"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.814812374"
Evaluating: 152.572525*(0.814812374-0.5)+-4.51585405
 Parameter: ZPOS <- "43.5158648"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.5158648" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.5158648" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   50.414383 XMAX =   50.414383 XAVE =   50.414383
    YMIN =   34.208758 YMAX =   34.208758 YAVE =   34.208758
    ZMIN =  -71.120020 ZMAX =  -71.120020 ZAVE =  -71.120020
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-58.3396745"
 RDCMND substituted energy or value "?XAVE" to "50.4143825"
Evaluating: -58.3396745-50.4143825
 Parameter: XTRAN <- "-108.754057"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.3494811"
 RDCMND substituted energy or value "?YAVE" to "34.2087578"
Evaluating: -24.3494811-34.2087578
 Parameter: YTRAN <- "-58.5582389"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.5158648"
 RDCMND substituted energy or value "?ZAVE" to "-71.1200201"
Evaluating: 43.5158648--71.1200201
 Parameter: ZTRAN <- "114.635885"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-108.754057"
 Parameter: YTRAN -> "-58.5582389"
 Parameter: ZTRAN -> "114.635885"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR  -108.754057  -58.558239  114.635885
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.371561193"
Evaluating: 0.371561193*360.0
 Parameter: XPHI <- "133.762029"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.2808435E-02"
Evaluating: 3.2808435E-02*360.0
 Parameter: YPHI <- "11.8110366"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.643528462"
Evaluating: 0.643528462*360.0
 Parameter: ZPHI <- "231.670246"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-58.3396745"
 Parameter: YPOS -> "-24.3494811"
 Parameter: ZPOS -> "43.5158648"
 Parameter: XPHI -> "133.762029"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.691665    0.722219
    0.000000   -0.722219   -0.691665

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  133.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-58.3396745"
 Parameter: YPOS -> "-24.3494811"
 Parameter: ZPOS -> "43.5158648"
 Parameter: YPHI -> "11.8110366"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.978828    0.000000   -0.204685
    0.000000    1.000000    0.000000
    0.204685    0.000000    0.978828

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   11.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-58.3396745"
 Parameter: YPOS -> "-24.3494811"
 Parameter: ZPOS -> "43.5158648"
 Parameter: ZPHI -> "231.670246"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.620186   -0.784454    0.000000
    0.784454   -0.620186    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -58.339675 XMAX =  -58.339675 XAVE =  -58.339675
    YMIN =  -24.349481 YMAX =  -24.349481 YAVE =  -24.349481
    ZMIN =   43.515865 ZMAX =   43.515865 ZAVE =   43.515865
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-58.3396746"
Evaluating: -58.3396746+3.5
 Parameter: XMAX <- "-54.8396746"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.3494811"
Evaluating: -24.3494811+3.5
 Parameter: YMAX <- "-20.8494811"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.5158647"
Evaluating: 43.5158647+3.5
 Parameter: ZMAX <- "47.0158647"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-58.3396746"
Evaluating: -58.3396746-3.5
 Parameter: XMIN <- "-61.8396746"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.3494811"
Evaluating: -24.3494811-3.5
 Parameter: YMIN <- "-27.8494811"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.5158647"
Evaluating: 43.5158647-3.5
 Parameter: ZMIN <- "40.0158647"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-54.8396746"
 Parameter: XMIN -> "-61.8396746"
 Parameter: YMAX -> "-20.8494811"
 Parameter: YMIN -> "-27.8494811"
 Parameter: ZMAX -> "47.0158647"
 Parameter: ZMIN -> "40.0158647"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "269"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "269" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "269"
Evaluating: 269
 Parameter: J <- "269"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "269" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "269"
 Parameter: NPOS -> "143"
Evaluating: 269-143
 Parameter: J <- "126"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "126"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.69030137"
Evaluating: 125.050557*(0.69030137-0.5)
 Parameter: XPOS <- "23.7972923"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.104523743"
Evaluating: 125.050557*(0.104523743-0.5)
 Parameter: YPOS <- "-49.4545262"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.52414867"
Evaluating: 152.572525*(0.52414867-0.5)+-4.51585405
 Parameter: ZPOS <- "-0.831430493"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.831430493" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.831430493" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "269"
Evaluating: 269
 Parameter: J <- "269"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "269" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "269"
 Parameter: NPOS -> "143"
Evaluating: 269-143
 Parameter: J <- "126"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "126"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.78996555E-02"
Evaluating: 125.050557*(9.78996555E-02-0.5)
 Parameter: XPOS <- "-50.282872"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.504248838"
Evaluating: 125.050557*(0.504248838-0.5)
 Parameter: YPOS <- "0.531319559"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.133647568"
Evaluating: 152.572525*(0.133647568-0.5)+-4.51585405
 Parameter: ZPOS <- "-60.4111696"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-60.4111696" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.282872"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -50.282872-0
 Parameter: XTRAN <- "-50.282872"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.531319559"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 0.531319559-0
 Parameter: YTRAN <- "0.531319559"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-60.4111696"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -60.4111696-0
 Parameter: ZTRAN <- "-60.4111696"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.282872"
 Parameter: YTRAN -> "0.531319559"
 Parameter: ZTRAN -> "-60.4111696"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -50.282872    0.531320  -60.411170
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.567876714"
Evaluating: 0.567876714*360.0
 Parameter: XPHI <- "204.435617"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919275935"
Evaluating: 0.919275935*360.0
 Parameter: YPHI <- "330.939337"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.504411563"
Evaluating: 0.504411563*360.0
 Parameter: ZPHI <- "181.588163"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.282872"
 Parameter: YPOS -> "0.531319559"
 Parameter: ZPOS -> "-60.4111696"
 Parameter: XPHI -> "204.435617"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.910427   -0.413670
    0.000000    0.413670   -0.910427

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  155.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.282872"
 Parameter: YPOS -> "0.531319559"
 Parameter: ZPOS -> "-60.4111696"
 Parameter: YPHI -> "330.939337"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.874106    0.000000    0.485735
    0.000000    1.000000    0.000000
   -0.485735    0.000000    0.874106

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   29.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.282872"
 Parameter: YPOS -> "0.531319559"
 Parameter: ZPOS -> "-60.4111696"
 Parameter: ZPHI -> "181.588163"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.999616   -0.027715    0.000000
    0.027715   -0.999616    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  178.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.282872 XMAX =  -50.282872 XAVE =  -50.282872
    YMIN =    0.531320 YMAX =    0.531320 YAVE =    0.531320
    ZMIN =  -60.411170 ZMAX =  -60.411170 ZAVE =  -60.411170
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.282872"
Evaluating: -50.282872+3.5
 Parameter: XMAX <- "-46.782872"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.531319559"
Evaluating: 0.531319559+3.5
 Parameter: YMAX <- "4.03131956"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-60.4111696"
Evaluating: -60.4111696+3.5
 Parameter: ZMAX <- "-56.9111696"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.282872"
Evaluating: -50.282872-3.5
 Parameter: XMIN <- "-53.782872"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.531319559"
Evaluating: 0.531319559-3.5
 Parameter: YMIN <- "-2.96868044"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-60.4111696"
Evaluating: -60.4111696-3.5
 Parameter: ZMIN <- "-63.9111696"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.782872"
 Parameter: XMIN -> "-53.782872"
 Parameter: YMAX -> "4.03131956"
 Parameter: YMIN -> "-2.96868044"
 Parameter: ZMAX -> "-56.9111696"
 Parameter: ZMIN -> "-63.9111696"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "270"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "270" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "270"
Evaluating: 270
 Parameter: J <- "270"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "270" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "270"
 Parameter: NPOS -> "143"
Evaluating: 270-143
 Parameter: J <- "127"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "127"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.991144491"
Evaluating: 125.050557*(0.991144491-0.5)
 Parameter: XPOS <- "61.4178922"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.927047115"
Evaluating: 125.050557*(0.927047115-0.5)
 Parameter: YPOS <- "53.4024796"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.836873944"
Evaluating: 152.572525*(0.836873944-0.5)+-4.51585405
 Parameter: ZPOS <- "46.8818542"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.8818542" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.8818542" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "61.4178922"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 61.4178922-0
 Parameter: XTRAN <- "61.4178922"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "53.4024796"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 53.4024796-0
 Parameter: YTRAN <- "53.4024796"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.8818542"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.8818542-0
 Parameter: ZTRAN <- "46.8818542"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "61.4178922"
 Parameter: YTRAN -> "53.4024796"
 Parameter: ZTRAN -> "46.8818542"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    61.417892   53.402480   46.881854
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.64413057E-02"
Evaluating: 8.64413057E-02*360.0
 Parameter: XPHI <- "31.1188701"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.639631363"
Evaluating: 0.639631363*360.0
 Parameter: YPHI <- "230.267291"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.759006725"
Evaluating: 0.759006725*360.0
 Parameter: ZPHI <- "273.242421"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "61.4178922"
 Parameter: YPOS -> "53.4024796"
 Parameter: ZPOS -> "46.8818542"
 Parameter: XPHI -> "31.1188701"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.856097    0.516815
    0.000000   -0.516815    0.856097

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   31.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "61.4178922"
 Parameter: YPOS -> "53.4024796"
 Parameter: ZPOS -> "46.8818542"
 Parameter: YPHI -> "230.267291"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.639207    0.000000    0.769035
    0.000000    1.000000    0.000000
   -0.769035    0.000000   -0.639207

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  129.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "61.4178922"
 Parameter: YPOS -> "53.4024796"
 Parameter: ZPOS -> "46.8818542"
 Parameter: ZPHI -> "273.242421"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.056561   -0.998399    0.000000
    0.998399    0.056561    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   86.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   61.417892 XMAX =   61.417892 XAVE =   61.417892
    YMIN =   53.402480 YMAX =   53.402480 YAVE =   53.402480
    ZMIN =   46.881854 ZMAX =   46.881854 ZAVE =   46.881854
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "61.4178922"
Evaluating: 61.4178922+3.5
 Parameter: XMAX <- "64.9178922"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "53.4024796"
Evaluating: 53.4024796+3.5
 Parameter: YMAX <- "56.9024796"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.8818542"
Evaluating: 46.8818542+3.5
 Parameter: ZMAX <- "50.3818542"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "61.4178922"
Evaluating: 61.4178922-3.5
 Parameter: XMIN <- "57.9178922"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "53.4024796"
Evaluating: 53.4024796-3.5
 Parameter: YMIN <- "49.9024796"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.8818542"
Evaluating: 46.8818542-3.5
 Parameter: ZMIN <- "43.3818542"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "64.9178922"
 Parameter: XMIN -> "57.9178922"
 Parameter: YMAX -> "56.9024796"
 Parameter: YMIN -> "49.9024796"
 Parameter: ZMAX -> "50.3818542"
 Parameter: ZMIN -> "43.3818542"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "271"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "271" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "271"
Evaluating: 271
 Parameter: J <- "271"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "271" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "271"
 Parameter: NPOS -> "143"
Evaluating: 271-143
 Parameter: J <- "128"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "128"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.855535583"
Evaluating: 125.050557*(0.855535583-0.5)
 Parameter: XPOS <- "44.4599227"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "6.643808116E-02"
Evaluating: 125.050557*(6.643808116E-02-0.5)
 Parameter: YPOS <- "-54.2171594"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.711467265"
Evaluating: 152.572525*(0.711467265-0.5)+-4.51585405
 Parameter: ZPOS <- "27.7482405"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.7482405" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.7482405" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.4599227"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 44.4599227-0
 Parameter: XTRAN <- "44.4599227"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-54.2171594"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -54.2171594-0
 Parameter: YTRAN <- "-54.2171594"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.7482405"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.7482405-0
 Parameter: ZTRAN <- "27.7482405"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.4599227"
 Parameter: YTRAN -> "-54.2171594"
 Parameter: ZTRAN -> "27.7482405"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    44.459923  -54.217159   27.748241
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.190236524"
Evaluating: 0.190236524*360.0
 Parameter: XPHI <- "68.4851486"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.545448466"
Evaluating: 0.545448466*360.0
 Parameter: YPHI <- "196.361448"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126113685"
Evaluating: 0.126113685*360.0
 Parameter: ZPHI <- "45.4009266"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.4599227"
 Parameter: YPOS -> "-54.2171594"
 Parameter: ZPOS -> "27.7482405"
 Parameter: XPHI -> "68.4851486"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.366742    0.930323
    0.000000   -0.930323    0.366742

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   68.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.4599227"
 Parameter: YPOS -> "-54.2171594"
 Parameter: ZPOS -> "27.7482405"
 Parameter: YPHI -> "196.361448"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.959504    0.000000    0.281696
    0.000000    1.000000    0.000000
   -0.281696    0.000000   -0.959504

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  163.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.4599227"
 Parameter: YPOS -> "-54.2171594"
 Parameter: ZPOS -> "27.7482405"
 Parameter: ZPHI -> "45.4009266"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.702142    0.712037    0.000000
   -0.712037    0.702142    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   45.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.459923 XMAX =   44.459923 XAVE =   44.459923
    YMIN =  -54.217159 YMAX =  -54.217159 YAVE =  -54.217159
    ZMIN =   27.748241 ZMAX =   27.748241 ZAVE =   27.748241
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.4599227"
Evaluating: 44.4599227+3.5
 Parameter: XMAX <- "47.9599227"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-54.2171594"
Evaluating: -54.2171594+3.5
 Parameter: YMAX <- "-50.7171594"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.7482405"
Evaluating: 27.7482405+3.5
 Parameter: ZMAX <- "31.2482405"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.4599227"
Evaluating: 44.4599227-3.5
 Parameter: XMIN <- "40.9599227"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-54.2171594"
Evaluating: -54.2171594-3.5
 Parameter: YMIN <- "-57.7171594"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.7482405"
Evaluating: 27.7482405-3.5
 Parameter: ZMIN <- "24.2482405"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.9599227"
 Parameter: XMIN -> "40.9599227"
 Parameter: YMAX -> "-50.7171594"
 Parameter: YMIN -> "-57.7171594"
 Parameter: ZMAX -> "31.2482405"
 Parameter: ZMIN -> "24.2482405"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "272"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "272" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "272"
Evaluating: 272
 Parameter: J <- "272"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "272" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "272"
 Parameter: NPOS -> "143"
Evaluating: 272-143
 Parameter: J <- "129"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "129"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.884895956"
Evaluating: 125.050557*(0.884895956-0.5)
 Parameter: XPOS <- "48.1314537"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.226806699"
Evaluating: 125.050557*(0.226806699-0.5)
 Parameter: YPOS <- "-34.1629745"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.149926778"
Evaluating: 152.572525*(0.149926778-0.5)+-4.51585405
 Parameter: ZPOS <- "-57.9274095"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.9274095" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "48.1314537"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 48.1314537-0
 Parameter: XTRAN <- "48.1314537"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.1629745"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.1629745-0
 Parameter: YTRAN <- "-34.1629745"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.9274095"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -57.9274095-0
 Parameter: ZTRAN <- "-57.9274095"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "48.1314537"
 Parameter: YTRAN -> "-34.1629745"
 Parameter: ZTRAN -> "-57.9274095"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    48.131454  -34.162974  -57.927410
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.48961527"
Evaluating: 0.48961527*360.0
 Parameter: XPHI <- "176.261497"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.247408589"
Evaluating: 0.247408589*360.0
 Parameter: YPHI <- "89.067092"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.83228596"
Evaluating: 0.83228596*360.0
 Parameter: ZPHI <- "299.622946"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "48.1314537"
 Parameter: YPOS -> "-34.1629745"
 Parameter: ZPOS -> "-57.9274095"
 Parameter: XPHI -> "176.261497"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.997872    0.065203
    0.000000   -0.065203   -0.997872

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  176.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "48.1314537"
 Parameter: YPOS -> "-34.1629745"
 Parameter: ZPOS -> "-57.9274095"
 Parameter: YPHI -> "89.067092"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.016282    0.000000   -0.999867
    0.000000    1.000000    0.000000
    0.999867    0.000000    0.016282

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   89.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "48.1314537"
 Parameter: YPOS -> "-34.1629745"
 Parameter: ZPOS -> "-57.9274095"
 Parameter: ZPHI -> "299.622946"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.494290   -0.869297    0.000000
    0.869297    0.494290    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   48.131454 XMAX =   48.131454 XAVE =   48.131454
    YMIN =  -34.162974 YMAX =  -34.162974 YAVE =  -34.162974
    ZMIN =  -57.927410 ZMAX =  -57.927410 ZAVE =  -57.927410
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "48.1314537"
Evaluating: 48.1314537+3.5
 Parameter: XMAX <- "51.6314537"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.1629745"
Evaluating: -34.1629745+3.5
 Parameter: YMAX <- "-30.6629745"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.9274095"
Evaluating: -57.9274095+3.5
 Parameter: ZMAX <- "-54.4274095"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "48.1314537"
Evaluating: 48.1314537-3.5
 Parameter: XMIN <- "44.6314537"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.1629745"
Evaluating: -34.1629745-3.5
 Parameter: YMIN <- "-37.6629745"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.9274095"
Evaluating: -57.9274095-3.5
 Parameter: ZMIN <- "-61.4274095"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "51.6314537"
 Parameter: XMIN -> "44.6314537"
 Parameter: YMAX -> "-30.6629745"
 Parameter: YMIN -> "-37.6629745"
 Parameter: ZMAX -> "-54.4274095"
 Parameter: ZMIN -> "-61.4274095"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "273"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "273" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "273"
Evaluating: 273
 Parameter: J <- "273"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "273" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "273"
 Parameter: NPOS -> "143"
Evaluating: 273-143
 Parameter: J <- "130"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "130"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.486450222"
Evaluating: 125.050557*(0.486450222-0.5)
 Parameter: XPOS <- "-1.69440729"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.399379315"
Evaluating: 125.050557*(0.399379315-0.5)
 Parameter: YPOS <- "-12.5826727"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.210103487"
Evaluating: 152.572525*(0.210103487-0.5)+-4.51585405
 Parameter: ZPOS <- "-48.746097"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.746097" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.69440729"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -1.69440729-0
 Parameter: XTRAN <- "-1.69440729"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.5826727"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.5826727-0
 Parameter: YTRAN <- "-12.5826727"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.746097"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.746097-0
 Parameter: ZTRAN <- "-48.746097"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-1.69440729"
 Parameter: YTRAN -> "-12.5826727"
 Parameter: ZTRAN -> "-48.746097"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -1.694407  -12.582673  -48.746097
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.209031682"
Evaluating: 0.209031682*360.0
 Parameter: XPHI <- "75.2514055"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.783283759"
Evaluating: 0.783283759*360.0
 Parameter: YPHI <- "281.982153"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.95732778"
Evaluating: 0.95732778*360.0
 Parameter: ZPHI <- "344.638001"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.69440729"
 Parameter: YPOS -> "-12.5826727"
 Parameter: ZPOS -> "-48.746097"
 Parameter: XPHI -> "75.2514055"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.254578    0.967052
    0.000000   -0.967052    0.254578

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   75.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.69440729"
 Parameter: YPOS -> "-12.5826727"
 Parameter: ZPOS -> "-48.746097"
 Parameter: YPHI -> "281.982153"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.207607    0.000000    0.978212
    0.000000    1.000000    0.000000
   -0.978212    0.000000    0.207607

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   78.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.69440729"
 Parameter: YPOS -> "-12.5826727"
 Parameter: ZPOS -> "-48.746097"
 Parameter: ZPHI -> "344.638001"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.964271   -0.264917    0.000000
    0.264917    0.964271    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   15.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.694407 XMAX =   -1.694407 XAVE =   -1.694407
    YMIN =  -12.582673 YMAX =  -12.582673 YAVE =  -12.582673
    ZMIN =  -48.746097 ZMAX =  -48.746097 ZAVE =  -48.746097
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.69440729"
Evaluating: -1.69440729+3.5
 Parameter: XMAX <- "1.80559271"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.5826727"
Evaluating: -12.5826727+3.5
 Parameter: YMAX <- "-9.0826727"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.746097"
Evaluating: -48.746097+3.5
 Parameter: ZMAX <- "-45.246097"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.69440729"
Evaluating: -1.69440729-3.5
 Parameter: XMIN <- "-5.19440729"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.5826727"
Evaluating: -12.5826727-3.5
 Parameter: YMIN <- "-16.0826727"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.746097"
Evaluating: -48.746097-3.5
 Parameter: ZMIN <- "-52.246097"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.80559271"
 Parameter: XMIN -> "-5.19440729"
 Parameter: YMAX -> "-9.0826727"
 Parameter: YMIN -> "-16.0826727"
 Parameter: ZMAX -> "-45.246097"
 Parameter: ZMIN -> "-52.246097"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "274"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "274" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "274"
Evaluating: 274
 Parameter: J <- "274"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "274" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "274"
 Parameter: NPOS -> "143"
Evaluating: 274-143
 Parameter: J <- "131"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "131"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.746904205"
Evaluating: 125.050557*(0.746904205-0.5)
 Parameter: XPOS <- "30.8755084"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.292101383"
Evaluating: 125.050557*(0.292101383-0.5)
 Parameter: YPOS <- "-25.9978379"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "4.674206447E-02"
Evaluating: 152.572525*(4.674206447E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-73.6705618"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-73.6705618" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.8755084"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.8755084-0
 Parameter: XTRAN <- "30.8755084"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.9978379"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.9978379-0
 Parameter: YTRAN <- "-25.9978379"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-73.6705618"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -73.6705618-0
 Parameter: ZTRAN <- "-73.6705618"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.8755084"
 Parameter: YTRAN -> "-25.9978379"
 Parameter: ZTRAN -> "-73.6705618"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    30.875508  -25.997838  -73.670562
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.229417488"
Evaluating: 0.229417488*360.0
 Parameter: XPHI <- "82.5902957"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.790775821"
Evaluating: 0.790775821*360.0
 Parameter: YPHI <- "284.679296"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.615641429"
Evaluating: 0.615641429*360.0
 Parameter: ZPHI <- "221.630914"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.8755084"
 Parameter: YPOS -> "-25.9978379"
 Parameter: ZPOS -> "-73.6705618"
 Parameter: XPHI -> "82.5902957"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.128964    0.991649
    0.000000   -0.991649    0.128964

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   82.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.8755084"
 Parameter: YPOS -> "-25.9978379"
 Parameter: ZPOS -> "-73.6705618"
 Parameter: YPHI -> "284.679296"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.253408    0.000000    0.967359
    0.000000    1.000000    0.000000
   -0.967359    0.000000    0.253408

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   75.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.8755084"
 Parameter: YPOS -> "-25.9978379"
 Parameter: ZPOS -> "-73.6705618"
 Parameter: ZPHI -> "221.630914"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.747440   -0.664330    0.000000
    0.664330   -0.747440    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  138.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.875508 XMAX =   30.875508 XAVE =   30.875508
    YMIN =  -25.997838 YMAX =  -25.997838 YAVE =  -25.997838
    ZMIN =  -73.670562 ZMAX =  -73.670562 ZAVE =  -73.670562
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.8755084"
Evaluating: 30.8755084+3.5
 Parameter: XMAX <- "34.3755084"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.9978379"
Evaluating: -25.9978379+3.5
 Parameter: YMAX <- "-22.4978379"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-73.6705618"
Evaluating: -73.6705618+3.5
 Parameter: ZMAX <- "-70.1705618"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.8755084"
Evaluating: 30.8755084-3.5
 Parameter: XMIN <- "27.3755084"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.9978379"
Evaluating: -25.9978379-3.5
 Parameter: YMIN <- "-29.4978379"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-73.6705618"
Evaluating: -73.6705618-3.5
 Parameter: ZMIN <- "-77.1705618"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.3755084"
 Parameter: XMIN -> "27.3755084"
 Parameter: YMAX -> "-22.4978379"
 Parameter: YMIN -> "-29.4978379"
 Parameter: ZMAX -> "-70.1705618"
 Parameter: ZMIN -> "-77.1705618"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "275"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "275" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "275"
Evaluating: 275
 Parameter: J <- "275"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "275" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "275"
 Parameter: NPOS -> "143"
Evaluating: 275-143
 Parameter: J <- "132"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "132"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.186290492"
Evaluating: 125.050557*(0.186290492-0.5)
 Parameter: XPOS <- "-39.2295487"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.422526482"
Evaluating: 125.050557*(0.422526482-0.5)
 Parameter: YPOS <- "-9.68810658"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.339142823"
Evaluating: 152.572525*(0.339142823-0.5)+-4.51585405
 Parameter: ZPOS <- "-29.0582397"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.0582397" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.2295487"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.2295487-0
 Parameter: XTRAN <- "-39.2295487"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.68810658"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.68810658-0
 Parameter: YTRAN <- "-9.68810658"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.0582397"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.0582397-0
 Parameter: ZTRAN <- "-29.0582397"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.2295487"
 Parameter: YTRAN -> "-9.68810658"
 Parameter: ZTRAN -> "-29.0582397"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -39.229549   -9.688107  -29.058240
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.368897258"
Evaluating: 0.368897258*360.0
 Parameter: XPHI <- "132.803013"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.106246705E-02"
Evaluating: 6.106246705E-02*360.0
 Parameter: YPHI <- "21.9824881"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.308114014"
Evaluating: 0.308114014*360.0
 Parameter: ZPHI <- "110.921045"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.2295487"
 Parameter: YPOS -> "-9.68810658"
 Parameter: ZPOS -> "-29.0582397"
 Parameter: XPHI -> "132.803013"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.679480    0.733694
    0.000000   -0.733694   -0.679480

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.2295487"
 Parameter: YPOS -> "-9.68810658"
 Parameter: ZPOS -> "-29.0582397"
 Parameter: YPHI -> "21.9824881"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.927298    0.000000   -0.374323
    0.000000    1.000000    0.000000
    0.374323    0.000000    0.927298

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   21.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.2295487"
 Parameter: YPOS -> "-9.68810658"
 Parameter: ZPOS -> "-29.0582397"
 Parameter: ZPHI -> "110.921045"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.357081    0.934073    0.000000
   -0.934073   -0.357081    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  110.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.229549 XMAX =  -39.229549 XAVE =  -39.229549
    YMIN =   -9.688107 YMAX =   -9.688107 YAVE =   -9.688107
    ZMIN =  -29.058240 ZMAX =  -29.058240 ZAVE =  -29.058240
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.2295487"
Evaluating: -39.2295487+3.5
 Parameter: XMAX <- "-35.7295487"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.68810658"
Evaluating: -9.68810658+3.5
 Parameter: YMAX <- "-6.18810658"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.0582397"
Evaluating: -29.0582397+3.5
 Parameter: ZMAX <- "-25.5582397"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.2295487"
Evaluating: -39.2295487-3.5
 Parameter: XMIN <- "-42.7295487"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.68810658"
Evaluating: -9.68810658-3.5
 Parameter: YMIN <- "-13.1881066"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.0582397"
Evaluating: -29.0582397-3.5
 Parameter: ZMIN <- "-32.5582397"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.7295487"
 Parameter: XMIN -> "-42.7295487"
 Parameter: YMAX -> "-6.18810658"
 Parameter: YMIN -> "-13.1881066"
 Parameter: ZMAX -> "-25.5582397"
 Parameter: ZMIN -> "-32.5582397"
 SELRPN>     17 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      7 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64690 NEG      CLA      132      CLA     -5378 PROA     MET      367      N             4.7994
64690 NEG      CLA      132      CLA     -5380 PROA     MET      367      CA            4.4361
64690 NEG      CLA      132      CLA     -5388 PROA     MET      367      SD            3.3562
64690 NEG      CLA      132      CLA     -5389 PROA     MET      367      CE            3.3411
64690 NEG      CLA      132      CLA     -5434 PROA     ILE      370      CB            3.4880
64690 NEG      CLA      132      CLA     -5440 PROA     ILE      370      CG1           2.5677
64690 NEG      CLA      132      CLA     -5443 PROA     ILE      370      CD            2.4670
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "275"
Evaluating: 275
 Parameter: J <- "275"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "275" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "275"
 Parameter: NPOS -> "143"
Evaluating: 275-143
 Parameter: J <- "132"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "132"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.114133688"
Evaluating: 125.050557*(0.114133688-0.5)
 Parameter: XPOS <- "-48.2527972"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.337288586"
Evaluating: 125.050557*(0.337288586-0.5)
 Parameter: YPOS <- "-20.347153"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.19811588"
Evaluating: 152.572525*(0.19811588-0.5)+-4.51585405
 Parameter: ZPOS <- "-50.5750765"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.5750765" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.229549 XMAX =  -39.229549 XAVE =  -39.229549
    YMIN =   -9.688107 YMAX =   -9.688107 YAVE =   -9.688107
    ZMIN =  -29.058240 ZMAX =  -29.058240 ZAVE =  -29.058240
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-48.2527972"
 RDCMND substituted energy or value "?XAVE" to "-39.2295487"
Evaluating: -48.2527972--39.2295487
 Parameter: XTRAN <- "-9.0232485"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.347153"
 RDCMND substituted energy or value "?YAVE" to "-9.68810658"
Evaluating: -20.347153--9.68810658
 Parameter: YTRAN <- "-10.6590464"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.5750765"
 RDCMND substituted energy or value "?ZAVE" to "-29.0582397"
Evaluating: -50.5750765--29.0582397
 Parameter: ZTRAN <- "-21.5168368"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.0232485"
 Parameter: YTRAN -> "-10.6590464"
 Parameter: ZTRAN -> "-21.5168368"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -9.023248  -10.659046  -21.516837
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.624851358"
Evaluating: 0.624851358*360.0
 Parameter: XPHI <- "224.946489"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.612816301"
Evaluating: 0.612816301*360.0
 Parameter: YPHI <- "220.613868"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.941259138"
Evaluating: 0.941259138*360.0
 Parameter: ZPHI <- "338.85329"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-48.2527972"
 Parameter: YPOS -> "-20.347153"
 Parameter: ZPOS -> "-50.5750765"
 Parameter: XPHI -> "224.946489"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.707767   -0.706446
    0.000000    0.706446   -0.707767

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  135.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-48.2527972"
 Parameter: YPOS -> "-20.347153"
 Parameter: ZPOS -> "-50.5750765"
 Parameter: YPHI -> "220.613868"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.759114    0.000000    0.650958
    0.000000    1.000000    0.000000
   -0.650958    0.000000   -0.759114

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  139.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-48.2527972"
 Parameter: YPOS -> "-20.347153"
 Parameter: ZPOS -> "-50.5750765"
 Parameter: ZPHI -> "338.85329"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.932660   -0.360757    0.000000
    0.360757    0.932660    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   21.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -48.252797 XMAX =  -48.252797 XAVE =  -48.252797
    YMIN =  -20.347153 YMAX =  -20.347153 YAVE =  -20.347153
    ZMIN =  -50.575077 ZMAX =  -50.575077 ZAVE =  -50.575077
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-48.2527972"
Evaluating: -48.2527972+3.5
 Parameter: XMAX <- "-44.7527972"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.347153"
Evaluating: -20.347153+3.5
 Parameter: YMAX <- "-16.847153"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.5750765"
Evaluating: -50.5750765+3.5
 Parameter: ZMAX <- "-47.0750765"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-48.2527972"
Evaluating: -48.2527972-3.5
 Parameter: XMIN <- "-51.7527972"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.347153"
Evaluating: -20.347153-3.5
 Parameter: YMIN <- "-23.847153"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.5750765"
Evaluating: -50.5750765-3.5
 Parameter: ZMIN <- "-54.0750765"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.7527972"
 Parameter: XMIN -> "-51.7527972"
 Parameter: YMAX -> "-16.847153"
 Parameter: YMIN -> "-23.847153"
 Parameter: ZMAX -> "-47.0750765"
 Parameter: ZMIN -> "-54.0750765"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "276"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "276" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "276"
Evaluating: 276
 Parameter: J <- "276"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "276" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "276"
 Parameter: NPOS -> "143"
Evaluating: 276-143
 Parameter: J <- "133"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "133"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.925596568"
Evaluating: 125.050557*(0.925596568-0.5)
 Parameter: XPOS <- "53.2210879"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.334003836"
Evaluating: 125.050557*(0.334003836-0.5)
 Parameter: YPOS <- "-20.7579128"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.844441281"
Evaluating: 152.572525*(0.844441281-0.5)+-4.51585405
 Parameter: ZPOS <- "48.0364219"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.0364219" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.0364219" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "53.2210879"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 53.2210879-0
 Parameter: XTRAN <- "53.2210879"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.7579128"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.7579128-0
 Parameter: YTRAN <- "-20.7579128"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.0364219"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 48.0364219-0
 Parameter: ZTRAN <- "48.0364219"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "53.2210879"
 Parameter: YTRAN -> "-20.7579128"
 Parameter: ZTRAN -> "48.0364219"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    53.221088  -20.757913   48.036422
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.668325466"
Evaluating: 0.668325466*360.0
 Parameter: XPHI <- "240.597168"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.982809358E-02"
Evaluating: 1.982809358E-02*360.0
 Parameter: YPHI <- "7.13811369"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.457541449"
Evaluating: 0.457541449*360.0
 Parameter: ZPHI <- "164.714922"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "53.2210879"
 Parameter: YPOS -> "-20.7579128"
 Parameter: ZPOS -> "48.0364219"
 Parameter: XPHI -> "240.597168"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.490947   -0.871190
    0.000000    0.871190   -0.490947

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  119.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "53.2210879"
 Parameter: YPOS -> "-20.7579128"
 Parameter: ZPOS -> "48.0364219"
 Parameter: YPHI -> "7.13811369"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.992249    0.000000   -0.124262
    0.000000    1.000000    0.000000
    0.124262    0.000000    0.992249

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    7.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "53.2210879"
 Parameter: YPOS -> "-20.7579128"
 Parameter: ZPOS -> "48.0364219"
 Parameter: ZPHI -> "164.714922"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.964626    0.263622    0.000000
   -0.263622   -0.964626    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  164.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   53.221088 XMAX =   53.221088 XAVE =   53.221088
    YMIN =  -20.757913 YMAX =  -20.757913 YAVE =  -20.757913
    ZMIN =   48.036422 ZMAX =   48.036422 ZAVE =   48.036422
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "53.2210879"
Evaluating: 53.2210879+3.5
 Parameter: XMAX <- "56.7210879"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.7579128"
Evaluating: -20.7579128+3.5
 Parameter: YMAX <- "-17.2579128"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.0364219"
Evaluating: 48.0364219+3.5
 Parameter: ZMAX <- "51.5364219"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "53.2210879"
Evaluating: 53.2210879-3.5
 Parameter: XMIN <- "49.7210879"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.7579128"
Evaluating: -20.7579128-3.5
 Parameter: YMIN <- "-24.2579128"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.0364219"
Evaluating: 48.0364219-3.5
 Parameter: ZMIN <- "44.5364219"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "56.7210879"
 Parameter: XMIN -> "49.7210879"
 Parameter: YMAX -> "-17.2579128"
 Parameter: YMIN -> "-24.2579128"
 Parameter: ZMAX -> "51.5364219"
 Parameter: ZMIN -> "44.5364219"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "277"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "277" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "277"
Evaluating: 277
 Parameter: J <- "277"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "277" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "277"
 Parameter: NPOS -> "143"
Evaluating: 277-143
 Parameter: J <- "134"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "134"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.953520601"
Evaluating: 125.050557*(0.953520601-0.5)
 Parameter: XPOS <- "56.7130038"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.644126627"
Evaluating: 125.050557*(0.644126627-0.5)
 Parameter: YPOS <- "18.023115"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.705891202"
Evaluating: 152.572525*(0.705891202-0.5)+-4.51585405
 Parameter: ZPOS <- "26.8974865"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.8974865" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.8974865" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "56.7130038"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 56.7130038-0
 Parameter: XTRAN <- "56.7130038"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.023115"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 18.023115-0
 Parameter: YTRAN <- "18.023115"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.8974865"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.8974865-0
 Parameter: ZTRAN <- "26.8974865"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "56.7130038"
 Parameter: YTRAN -> "18.023115"
 Parameter: ZTRAN -> "26.8974865"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    56.713004   18.023115   26.897486
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.264882572"
Evaluating: 0.264882572*360.0
 Parameter: XPHI <- "95.3577259"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.766812082"
Evaluating: 0.766812082*360.0
 Parameter: YPHI <- "276.05235"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.205741654E-02"
Evaluating: 6.205741654E-02*360.0
 Parameter: ZPHI <- "22.34067"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "56.7130038"
 Parameter: YPOS -> "18.023115"
 Parameter: ZPOS -> "26.8974865"
 Parameter: XPHI -> "95.3577259"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.093374    0.995631
    0.000000   -0.995631   -0.093374

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   95.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "56.7130038"
 Parameter: YPOS -> "18.023115"
 Parameter: ZPOS -> "26.8974865"
 Parameter: YPHI -> "276.05235"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.105437    0.000000    0.994426
    0.000000    1.000000    0.000000
   -0.994426    0.000000    0.105437

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   83.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "56.7130038"
 Parameter: YPOS -> "18.023115"
 Parameter: ZPOS -> "26.8974865"
 Parameter: ZPHI -> "22.34067"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.924940    0.380113    0.000000
   -0.380113    0.924940    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   22.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   56.713004 XMAX =   56.713004 XAVE =   56.713004
    YMIN =   18.023115 YMAX =   18.023115 YAVE =   18.023115
    ZMIN =   26.897486 ZMAX =   26.897486 ZAVE =   26.897486
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "56.7130038"
Evaluating: 56.7130038+3.5
 Parameter: XMAX <- "60.2130038"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.023115"
Evaluating: 18.023115+3.5
 Parameter: YMAX <- "21.523115"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.8974865"
Evaluating: 26.8974865+3.5
 Parameter: ZMAX <- "30.3974865"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "56.7130038"
Evaluating: 56.7130038-3.5
 Parameter: XMIN <- "53.2130038"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.023115"
Evaluating: 18.023115-3.5
 Parameter: YMIN <- "14.523115"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.8974865"
Evaluating: 26.8974865-3.5
 Parameter: ZMIN <- "23.3974865"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "60.2130038"
 Parameter: XMIN -> "53.2130038"
 Parameter: YMAX -> "21.523115"
 Parameter: YMIN -> "14.523115"
 Parameter: ZMAX -> "30.3974865"
 Parameter: ZMIN -> "23.3974865"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "278"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "278" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "278"
Evaluating: 278
 Parameter: J <- "278"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "278" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "278"
 Parameter: NPOS -> "143"
Evaluating: 278-143
 Parameter: J <- "135"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "135"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.748916029"
Evaluating: 125.050557*(0.748916029-0.5)
 Parameter: XPOS <- "31.1270881"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.519187446"
Evaluating: 125.050557*(0.519187446-0.5)
 Parameter: YPOS <- "2.39940081"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "6.727986677E-02"
Evaluating: 152.572525*(6.727986677E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-70.5370574"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-70.5370574" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.1270881"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.1270881-0
 Parameter: XTRAN <- "31.1270881"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.39940081"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.39940081-0
 Parameter: YTRAN <- "2.39940081"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-70.5370574"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -70.5370574-0
 Parameter: ZTRAN <- "-70.5370574"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.1270881"
 Parameter: YTRAN -> "2.39940081"
 Parameter: ZTRAN -> "-70.5370574"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    31.127088    2.399401  -70.537057
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.316329164"
Evaluating: 0.316329164*360.0
 Parameter: XPHI <- "113.878499"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.797864931"
Evaluating: 0.797864931*360.0
 Parameter: YPHI <- "287.231375"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.346782856"
Evaluating: 0.346782856*360.0
 Parameter: ZPHI <- "124.841828"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.1270881"
 Parameter: YPOS -> "2.39940081"
 Parameter: ZPOS -> "-70.5370574"
 Parameter: XPHI -> "113.878499"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.404798    0.914406
    0.000000   -0.914406   -0.404798

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  113.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.1270881"
 Parameter: YPOS -> "2.39940081"
 Parameter: ZPOS -> "-70.5370574"
 Parameter: YPHI -> "287.231375"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.296231    0.000000    0.955116
    0.000000    1.000000    0.000000
   -0.955116    0.000000    0.296231

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   72.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.1270881"
 Parameter: YPOS -> "2.39940081"
 Parameter: ZPOS -> "-70.5370574"
 Parameter: ZPHI -> "124.841828"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.571313    0.820732    0.000000
   -0.820732   -0.571313    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  124.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.127088 XMAX =   31.127088 XAVE =   31.127088
    YMIN =    2.399401 YMAX =    2.399401 YAVE =    2.399401
    ZMIN =  -70.537057 ZMAX =  -70.537057 ZAVE =  -70.537057
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.1270881"
Evaluating: 31.1270881+3.5
 Parameter: XMAX <- "34.6270881"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.39940081"
Evaluating: 2.39940081+3.5
 Parameter: YMAX <- "5.89940081"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-70.5370574"
Evaluating: -70.5370574+3.5
 Parameter: ZMAX <- "-67.0370574"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.1270881"
Evaluating: 31.1270881-3.5
 Parameter: XMIN <- "27.6270881"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.39940081"
Evaluating: 2.39940081-3.5
 Parameter: YMIN <- "-1.10059919"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-70.5370574"
Evaluating: -70.5370574-3.5
 Parameter: ZMIN <- "-74.0370574"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.6270881"
 Parameter: XMIN -> "27.6270881"
 Parameter: YMAX -> "5.89940081"
 Parameter: YMIN -> "-1.10059919"
 Parameter: ZMAX -> "-67.0370574"
 Parameter: ZMIN -> "-74.0370574"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "279"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "279" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "279"
Evaluating: 279
 Parameter: J <- "279"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "279" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "279"
 Parameter: NPOS -> "143"
Evaluating: 279-143
 Parameter: J <- "136"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.439228187"
Evaluating: 125.050557*(0.439228187-0.5)
 Parameter: XPOS <- "-7.59954907"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.423999608"
Evaluating: 125.050557*(0.423999608-0.5)
 Parameter: YPOS <- "-9.50389135"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.782431215"
Evaluating: 152.572525*(0.782431215-0.5)+-4.51585405
 Parameter: ZPOS <- "38.5753896"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.5753896" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.5753896" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.59954907"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.59954907-0
 Parameter: XTRAN <- "-7.59954907"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.50389135"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.50389135-0
 Parameter: YTRAN <- "-9.50389135"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.5753896"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.5753896-0
 Parameter: ZTRAN <- "38.5753896"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.59954907"
 Parameter: YTRAN -> "-9.50389135"
 Parameter: ZTRAN -> "38.5753896"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -7.599549   -9.503891   38.575390
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.290143232E-02"
Evaluating: 5.290143232E-02*360.0
 Parameter: XPHI <- "19.0445156"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.465641919E-02"
Evaluating: 5.465641919E-02*360.0
 Parameter: YPHI <- "19.6763109"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.642998201"
Evaluating: 0.642998201*360.0
 Parameter: ZPHI <- "231.479352"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.59954907"
 Parameter: YPOS -> "-9.50389135"
 Parameter: ZPOS -> "38.5753896"
 Parameter: XPHI -> "19.0445156"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.945265    0.326303
    0.000000   -0.326303    0.945265

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   19.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.59954907"
 Parameter: YPOS -> "-9.50389135"
 Parameter: ZPOS -> "38.5753896"
 Parameter: YPHI -> "19.6763109"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.941610    0.000000   -0.336706
    0.000000    1.000000    0.000000
    0.336706    0.000000    0.941610

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   19.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.59954907"
 Parameter: YPOS -> "-9.50389135"
 Parameter: ZPOS -> "38.5753896"
 Parameter: ZPHI -> "231.479352"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.622797   -0.782384    0.000000
    0.782384   -0.622797    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.599549 XMAX =   -7.599549 XAVE =   -7.599549
    YMIN =   -9.503891 YMAX =   -9.503891 YAVE =   -9.503891
    ZMIN =   38.575390 ZMAX =   38.575390 ZAVE =   38.575390
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.59954907"
Evaluating: -7.59954907+3.5
 Parameter: XMAX <- "-4.09954907"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.50389135"
Evaluating: -9.50389135+3.5
 Parameter: YMAX <- "-6.00389135"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.5753896"
Evaluating: 38.5753896+3.5
 Parameter: ZMAX <- "42.0753896"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.59954907"
Evaluating: -7.59954907-3.5
 Parameter: XMIN <- "-11.0995491"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.50389135"
Evaluating: -9.50389135-3.5
 Parameter: YMIN <- "-13.0038913"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.5753896"
Evaluating: 38.5753896-3.5
 Parameter: ZMIN <- "35.0753896"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.09954907"
 Parameter: XMIN -> "-11.0995491"
 Parameter: YMAX -> "-6.00389135"
 Parameter: YMIN -> "-13.0038913"
 Parameter: ZMAX -> "42.0753896"
 Parameter: ZMIN -> "35.0753896"
 SELRPN>      2 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64694 NEG      CLA      136      CLA     -**** PROA     TYR      975      CD2           4.4170
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "279"
Evaluating: 279
 Parameter: J <- "279"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "279" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "279"
 Parameter: NPOS -> "143"
Evaluating: 279-143
 Parameter: J <- "136"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.824655018"
Evaluating: 125.050557*(0.824655018-0.5)
 Parameter: XPOS <- "40.5982908"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.326002405"
Evaluating: 125.050557*(0.326002405-0.5)
 Parameter: YPOS <- "-21.7584962"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.589480642"
Evaluating: 152.572525*(0.589480642-0.5)+-4.51585405
 Parameter: ZPOS <- "9.13643344"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.13643344" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.13643344" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "279"
Evaluating: 279
 Parameter: J <- "279"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "279" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "279"
 Parameter: NPOS -> "143"
Evaluating: 279-143
 Parameter: J <- "136"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.544182783"
Evaluating: 125.050557*(0.544182783-0.5)
 Parameter: XPOS <- "5.52508162"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.720405934"
Evaluating: 125.050557*(0.720405934-0.5)
 Parameter: YPOS <- "27.5618848"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.61792023"
Evaluating: 152.572525*(0.61792023-0.5)+-4.51585405
 Parameter: ZPOS <- "13.4755332"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.4755332" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.4755332" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "279"
Evaluating: 279
 Parameter: J <- "279"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "279" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "279"
 Parameter: NPOS -> "143"
Evaluating: 279-143
 Parameter: J <- "136"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "136"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.903989341E-02"
Evaluating: 125.050557*(1.903989341E-02-0.5)
 Parameter: XPOS <- "-60.1443292"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.11436112"
Evaluating: 125.050557*(0.11436112-0.5)
 Parameter: YPOS <- "-48.2243567"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.173922617"
Evaluating: 152.572525*(0.173922617-0.5)+-4.51585405
 Parameter: ZPOS <- "-54.2663037"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.2663037" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.599549 XMAX =   -7.599549 XAVE =   -7.599549
    YMIN =   -9.503891 YMAX =   -9.503891 YAVE =   -9.503891
    ZMIN =   38.575390 ZMAX =   38.575390 ZAVE =   38.575390
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-60.1443292"
 RDCMND substituted energy or value "?XAVE" to "-7.59954907"
Evaluating: -60.1443292--7.59954907
 Parameter: XTRAN <- "-52.5447801"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.2243567"
 RDCMND substituted energy or value "?YAVE" to "-9.50389135"
Evaluating: -48.2243567--9.50389135
 Parameter: YTRAN <- "-38.7204653"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.2663037"
 RDCMND substituted energy or value "?ZAVE" to "38.5753896"
Evaluating: -54.2663037-38.5753896
 Parameter: ZTRAN <- "-92.8416933"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.5447801"
 Parameter: YTRAN -> "-38.7204653"
 Parameter: ZTRAN -> "-92.8416933"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -52.544780  -38.720465  -92.841693
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.610023434"
Evaluating: 0.610023434*360.0
 Parameter: XPHI <- "219.608436"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.879051046"
Evaluating: 0.879051046*360.0
 Parameter: YPHI <- "316.458377"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.503773931"
Evaluating: 0.503773931*360.0
 Parameter: ZPHI <- "181.358615"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-60.1443292"
 Parameter: YPOS -> "-48.2243567"
 Parameter: ZPOS -> "-54.2663037"
 Parameter: XPHI -> "219.608436"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.770419   -0.637537
    0.000000    0.637537   -0.770419

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  140.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-60.1443292"
 Parameter: YPOS -> "-48.2243567"
 Parameter: ZPOS -> "-54.2663037"
 Parameter: YPHI -> "316.458377"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.724874    0.000000    0.688881
    0.000000    1.000000    0.000000
   -0.688881    0.000000    0.724874

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   43.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-60.1443292"
 Parameter: YPOS -> "-48.2243567"
 Parameter: ZPOS -> "-54.2663037"
 Parameter: ZPHI -> "181.358615"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.999719   -0.023710    0.000000
    0.023710   -0.999719    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  178.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -60.144329 XMAX =  -60.144329 XAVE =  -60.144329
    YMIN =  -48.224357 YMAX =  -48.224357 YAVE =  -48.224357
    ZMIN =  -54.266304 ZMAX =  -54.266304 ZAVE =  -54.266304
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-60.1443292"
Evaluating: -60.1443292+3.5
 Parameter: XMAX <- "-56.6443292"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.2243567"
Evaluating: -48.2243567+3.5
 Parameter: YMAX <- "-44.7243567"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.2663037"
Evaluating: -54.2663037+3.5
 Parameter: ZMAX <- "-50.7663037"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-60.1443292"
Evaluating: -60.1443292-3.5
 Parameter: XMIN <- "-63.6443292"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.2243567"
Evaluating: -48.2243567-3.5
 Parameter: YMIN <- "-51.7243567"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.2663037"
Evaluating: -54.2663037-3.5
 Parameter: ZMIN <- "-57.7663037"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-56.6443292"
 Parameter: XMIN -> "-63.6443292"
 Parameter: YMAX -> "-44.7243567"
 Parameter: YMIN -> "-51.7243567"
 Parameter: ZMAX -> "-50.7663037"
 Parameter: ZMIN -> "-57.7663037"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "280"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "280" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "280"
Evaluating: 280
 Parameter: J <- "280"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "280" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "280"
 Parameter: NPOS -> "143"
Evaluating: 280-143
 Parameter: J <- "137"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "137"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.675740089"
Evaluating: 125.050557*(0.675740089-0.5)
 Parameter: XPOS <- "21.976396"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.899643083"
Evaluating: 125.050557*(0.899643083-0.5)
 Parameter: YPOS <- "49.9755901"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.273527937"
Evaluating: 152.572525*(0.273527937-0.5)+-4.51585405
 Parameter: ZPOS <- "-39.0692685"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.0692685" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.976396"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.976396-0
 Parameter: XTRAN <- "21.976396"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "49.9755901"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 49.9755901-0
 Parameter: YTRAN <- "49.9755901"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.0692685"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.0692685-0
 Parameter: ZTRAN <- "-39.0692685"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.976396"
 Parameter: YTRAN -> "49.9755901"
 Parameter: ZTRAN -> "-39.0692685"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    21.976396   49.975590  -39.069268
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.639701126"
Evaluating: 0.639701126*360.0
 Parameter: XPHI <- "230.292405"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.936195697"
Evaluating: 0.936195697*360.0
 Parameter: YPHI <- "337.030451"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.260504904"
Evaluating: 0.260504904*360.0
 Parameter: ZPHI <- "93.7817654"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.976396"
 Parameter: YPOS -> "49.9755901"
 Parameter: ZPOS -> "-39.0692685"
 Parameter: XPHI -> "230.292405"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.638870   -0.769315
    0.000000    0.769315   -0.638870

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.976396"
 Parameter: YPOS -> "49.9755901"
 Parameter: ZPOS -> "-39.0692685"
 Parameter: YPHI -> "337.030451"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.920712    0.000000    0.390242
    0.000000    1.000000    0.000000
   -0.390242    0.000000    0.920712

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   22.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.976396"
 Parameter: YPOS -> "49.9755901"
 Parameter: ZPOS -> "-39.0692685"
 Parameter: ZPHI -> "93.7817654"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.065956    0.997823    0.000000
   -0.997823   -0.065956    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   93.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.976396 XMAX =   21.976396 XAVE =   21.976396
    YMIN =   49.975590 YMAX =   49.975590 YAVE =   49.975590
    ZMIN =  -39.069268 ZMAX =  -39.069268 ZAVE =  -39.069268
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.976396"
Evaluating: 21.976396+3.5
 Parameter: XMAX <- "25.476396"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "49.9755901"
Evaluating: 49.9755901+3.5
 Parameter: YMAX <- "53.4755901"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.0692685"
Evaluating: -39.0692685+3.5
 Parameter: ZMAX <- "-35.5692685"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.976396"
Evaluating: 21.976396-3.5
 Parameter: XMIN <- "18.476396"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "49.9755901"
Evaluating: 49.9755901-3.5
 Parameter: YMIN <- "46.4755901"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.0692685"
Evaluating: -39.0692685-3.5
 Parameter: ZMIN <- "-42.5692685"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.476396"
 Parameter: XMIN -> "18.476396"
 Parameter: YMAX -> "53.4755901"
 Parameter: YMIN -> "46.4755901"
 Parameter: ZMAX -> "-35.5692685"
 Parameter: ZMIN -> "-42.5692685"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "281"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "281" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "281"
Evaluating: 281
 Parameter: J <- "281"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "281" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "281"
 Parameter: NPOS -> "143"
Evaluating: 281-143
 Parameter: J <- "138"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "138"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.79779527"
Evaluating: 125.050557*(0.79779527-0.5)
 Parameter: XPOS <- "37.2394644"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.125817866"
Evaluating: 125.050557*(0.125817866-0.5)
 Parameter: YPOS <- "-46.7916843"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.310737149"
Evaluating: 152.572525*(0.310737149-0.5)+-4.51585405
 Parameter: ZPOS <- "-33.3921651"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.3921651" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.2394644"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 37.2394644-0
 Parameter: XTRAN <- "37.2394644"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.7916843"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.7916843-0
 Parameter: YTRAN <- "-46.7916843"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.3921651"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.3921651-0
 Parameter: ZTRAN <- "-33.3921651"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.2394644"
 Parameter: YTRAN -> "-46.7916843"
 Parameter: ZTRAN -> "-33.3921651"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    37.239464  -46.791684  -33.392165
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.228352958E-02"
Evaluating: 7.228352958E-02*360.0
 Parameter: XPHI <- "26.0220706"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.750354044"
Evaluating: 0.750354044*360.0
 Parameter: YPHI <- "270.127456"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.95134873"
Evaluating: 0.95134873*360.0
 Parameter: ZPHI <- "342.485543"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.2394644"
 Parameter: YPOS -> "-46.7916843"
 Parameter: ZPOS -> "-33.3921651"
 Parameter: XPHI -> "26.0220706"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.898625    0.438717
    0.000000   -0.438717    0.898625

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   26.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.2394644"
 Parameter: YPOS -> "-46.7916843"
 Parameter: ZPOS -> "-33.3921651"
 Parameter: YPHI -> "270.127456"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.002225    0.000000    0.999998
    0.000000    1.000000    0.000000
   -0.999998    0.000000    0.002225

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   89.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.2394644"
 Parameter: YPOS -> "-46.7916843"
 Parameter: ZPOS -> "-33.3921651"
 Parameter: ZPHI -> "342.485543"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.953641   -0.300946    0.000000
    0.300946    0.953641    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   17.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.239464 XMAX =   37.239464 XAVE =   37.239464
    YMIN =  -46.791684 YMAX =  -46.791684 YAVE =  -46.791684
    ZMIN =  -33.392165 ZMAX =  -33.392165 ZAVE =  -33.392165
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.2394644"
Evaluating: 37.2394644+3.5
 Parameter: XMAX <- "40.7394644"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.7916843"
Evaluating: -46.7916843+3.5
 Parameter: YMAX <- "-43.2916843"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.3921651"
Evaluating: -33.3921651+3.5
 Parameter: ZMAX <- "-29.8921651"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.2394644"
Evaluating: 37.2394644-3.5
 Parameter: XMIN <- "33.7394644"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.7916843"
Evaluating: -46.7916843-3.5
 Parameter: YMIN <- "-50.2916843"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.3921651"
Evaluating: -33.3921651-3.5
 Parameter: ZMIN <- "-36.8921651"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.7394644"
 Parameter: XMIN -> "33.7394644"
 Parameter: YMAX -> "-43.2916843"
 Parameter: YMIN -> "-50.2916843"
 Parameter: ZMAX -> "-29.8921651"
 Parameter: ZMIN -> "-36.8921651"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "282"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "282" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "282"
Evaluating: 282
 Parameter: J <- "282"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "282" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "282"
 Parameter: NPOS -> "143"
Evaluating: 282-143
 Parameter: J <- "139"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "139"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.709178163"
Evaluating: 125.050557*(0.709178163-0.5)
 Parameter: XPOS <- "26.1578458"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.487971822"
Evaluating: 125.050557*(0.487971822-0.5)
 Parameter: YPOS <- "-1.50413036"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "5.570309356E-02"
Evaluating: 152.572525*(5.570309356E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-72.3033549"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-72.3033549" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.1578458"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.1578458-0
 Parameter: XTRAN <- "26.1578458"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.50413036"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.50413036-0
 Parameter: YTRAN <- "-1.50413036"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-72.3033549"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -72.3033549-0
 Parameter: ZTRAN <- "-72.3033549"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.1578458"
 Parameter: YTRAN -> "-1.50413036"
 Parameter: ZTRAN -> "-72.3033549"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    26.157846   -1.504130  -72.303355
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.564770575"
Evaluating: 0.564770575*360.0
 Parameter: XPHI <- "203.317407"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.566187758"
Evaluating: 0.566187758*360.0
 Parameter: YPHI <- "203.827593"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.953022971"
Evaluating: 0.953022971*360.0
 Parameter: ZPHI <- "343.08827"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.1578458"
 Parameter: YPOS -> "-1.50413036"
 Parameter: ZPOS -> "-72.3033549"
 Parameter: XPHI -> "203.317407"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.918326   -0.395825
    0.000000    0.395825   -0.918326

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  156.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.1578458"
 Parameter: YPOS -> "-1.50413036"
 Parameter: ZPOS -> "-72.3033549"
 Parameter: YPHI -> "203.827593"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.914765    0.000000    0.403986
    0.000000    1.000000    0.000000
   -0.403986    0.000000   -0.914765

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  156.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.1578458"
 Parameter: YPOS -> "-1.50413036"
 Parameter: ZPOS -> "-72.3033549"
 Parameter: ZPHI -> "343.08827"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.956754   -0.290898    0.000000
    0.290898    0.956754    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   16.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.157846 XMAX =   26.157846 XAVE =   26.157846
    YMIN =   -1.504130 YMAX =   -1.504130 YAVE =   -1.504130
    ZMIN =  -72.303355 ZMAX =  -72.303355 ZAVE =  -72.303355
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.1578458"
Evaluating: 26.1578458+3.5
 Parameter: XMAX <- "29.6578458"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.50413036"
Evaluating: -1.50413036+3.5
 Parameter: YMAX <- "1.99586964"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-72.3033549"
Evaluating: -72.3033549+3.5
 Parameter: ZMAX <- "-68.8033549"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.1578458"
Evaluating: 26.1578458-3.5
 Parameter: XMIN <- "22.6578458"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.50413036"
Evaluating: -1.50413036-3.5
 Parameter: YMIN <- "-5.00413036"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-72.3033549"
Evaluating: -72.3033549-3.5
 Parameter: ZMIN <- "-75.8033549"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.6578458"
 Parameter: XMIN -> "22.6578458"
 Parameter: YMAX -> "1.99586964"
 Parameter: YMIN -> "-5.00413036"
 Parameter: ZMAX -> "-68.8033549"
 Parameter: ZMIN -> "-75.8033549"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "283"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "283" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "283"
Evaluating: 283
 Parameter: J <- "283"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "283" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "283"
 Parameter: NPOS -> "143"
Evaluating: 283-143
 Parameter: J <- "140"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "140"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.359162746"
Evaluating: 125.050557*(0.359162746-0.5)
 Parameter: XPOS <- "-17.6117771"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.234857195"
Evaluating: 125.050557*(0.234857195-0.5)
 Parameter: YPOS <- "-33.1562554"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.254819456"
Evaluating: 152.572525*(0.254819456-0.5)+-4.51585405
 Parameter: ZPOS <- "-41.9236687"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.9236687" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.6117771"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.6117771-0
 Parameter: XTRAN <- "-17.6117771"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.1562554"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.1562554-0
 Parameter: YTRAN <- "-33.1562554"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.9236687"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.9236687-0
 Parameter: ZTRAN <- "-41.9236687"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.6117771"
 Parameter: YTRAN -> "-33.1562554"
 Parameter: ZTRAN -> "-41.9236687"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -17.611777  -33.156255  -41.923669
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.983485822"
Evaluating: 0.983485822*360.0
 Parameter: XPHI <- "354.054896"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.660364058"
Evaluating: 0.660364058*360.0
 Parameter: YPHI <- "237.731061"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.290031429"
Evaluating: 0.290031429*360.0
 Parameter: ZPHI <- "104.411314"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.6117771"
 Parameter: YPOS -> "-33.1562554"
 Parameter: ZPOS -> "-41.9236687"
 Parameter: XPHI -> "354.054896"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.994622   -0.103576
    0.000000    0.103576    0.994622

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    5.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.6117771"
 Parameter: YPOS -> "-33.1562554"
 Parameter: ZPOS -> "-41.9236687"
 Parameter: YPHI -> "237.731061"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.533894    0.000000    0.845551
    0.000000    1.000000    0.000000
   -0.845551    0.000000   -0.533894

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  122.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.6117771"
 Parameter: YPOS -> "-33.1562554"
 Parameter: ZPOS -> "-41.9236687"
 Parameter: ZPHI -> "104.411314"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.248881    0.968534    0.000000
   -0.968534   -0.248881    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  104.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.611777 XMAX =  -17.611777 XAVE =  -17.611777
    YMIN =  -33.156255 YMAX =  -33.156255 YAVE =  -33.156255
    ZMIN =  -41.923669 ZMAX =  -41.923669 ZAVE =  -41.923669
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.6117771"
Evaluating: -17.6117771+3.5
 Parameter: XMAX <- "-14.1117771"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.1562554"
Evaluating: -33.1562554+3.5
 Parameter: YMAX <- "-29.6562554"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.9236687"
Evaluating: -41.9236687+3.5
 Parameter: ZMAX <- "-38.4236687"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.6117771"
Evaluating: -17.6117771-3.5
 Parameter: XMIN <- "-21.1117771"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.1562554"
Evaluating: -33.1562554-3.5
 Parameter: YMIN <- "-36.6562554"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.9236687"
Evaluating: -41.9236687-3.5
 Parameter: ZMIN <- "-45.4236687"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.1117771"
 Parameter: XMIN -> "-21.1117771"
 Parameter: YMAX -> "-29.6562554"
 Parameter: YMIN -> "-36.6562554"
 Parameter: ZMAX -> "-38.4236687"
 Parameter: ZMIN -> "-45.4236687"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "284"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "284" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "284"
Evaluating: 284
 Parameter: J <- "284"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "284" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "284"
 Parameter: NPOS -> "143"
Evaluating: 284-143
 Parameter: J <- "141"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "141"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.637993562"
Evaluating: 125.050557*(0.637993562-0.5)
 Parameter: XPOS <- "17.2561718"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.795430594"
Evaluating: 125.050557*(0.795430594-0.5)
 Parameter: YPOS <- "36.9437603"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.116965577"
Evaluating: 152.572525*(0.116965577-0.5)+-4.51585405
 Parameter: ZPOS <- "-62.9563831"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-62.9563831" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.2561718"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.2561718-0
 Parameter: XTRAN <- "17.2561718"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.9437603"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 36.9437603-0
 Parameter: YTRAN <- "36.9437603"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-62.9563831"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -62.9563831-0
 Parameter: ZTRAN <- "-62.9563831"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.2561718"
 Parameter: YTRAN -> "36.9437603"
 Parameter: ZTRAN -> "-62.9563831"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    17.256172   36.943760  -62.956383
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.777318366"
Evaluating: 0.777318366*360.0
 Parameter: XPHI <- "279.834612"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.147982768"
Evaluating: 0.147982768*360.0
 Parameter: YPHI <- "53.2737965"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487209142"
Evaluating: 0.487209142*360.0
 Parameter: ZPHI <- "175.395291"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.2561718"
 Parameter: YPOS -> "36.9437603"
 Parameter: ZPOS -> "-62.9563831"
 Parameter: XPHI -> "279.834612"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.170805   -0.985305
    0.000000    0.985305    0.170805

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   80.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.2561718"
 Parameter: YPOS -> "36.9437603"
 Parameter: ZPOS -> "-62.9563831"
 Parameter: YPHI -> "53.2737965"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.597992    0.000000   -0.801502
    0.000000    1.000000    0.000000
    0.801502    0.000000    0.597992

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   53.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.2561718"
 Parameter: YPOS -> "36.9437603"
 Parameter: ZPOS -> "-62.9563831"
 Parameter: ZPHI -> "175.395291"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.996772    0.080281    0.000000
   -0.080281   -0.996772    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  175.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.256172 XMAX =   17.256172 XAVE =   17.256172
    YMIN =   36.943760 YMAX =   36.943760 YAVE =   36.943760
    ZMIN =  -62.956383 ZMAX =  -62.956383 ZAVE =  -62.956383
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.2561718"
Evaluating: 17.2561718+3.5
 Parameter: XMAX <- "20.7561718"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.9437603"
Evaluating: 36.9437603+3.5
 Parameter: YMAX <- "40.4437603"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-62.9563831"
Evaluating: -62.9563831+3.5
 Parameter: ZMAX <- "-59.4563831"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.2561718"
Evaluating: 17.2561718-3.5
 Parameter: XMIN <- "13.7561718"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.9437603"
Evaluating: 36.9437603-3.5
 Parameter: YMIN <- "33.4437603"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-62.9563831"
Evaluating: -62.9563831-3.5
 Parameter: ZMIN <- "-66.4563831"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.7561718"
 Parameter: XMIN -> "13.7561718"
 Parameter: YMAX -> "40.4437603"
 Parameter: YMIN -> "33.4437603"
 Parameter: ZMAX -> "-59.4563831"
 Parameter: ZMIN -> "-66.4563831"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "285"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "285" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "285"
Evaluating: 285
 Parameter: J <- "285"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "285" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "285"
 Parameter: NPOS -> "143"
Evaluating: 285-143
 Parameter: J <- "142"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "142"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.838117167"
Evaluating: 125.050557*(0.838117167-0.5)
 Parameter: XPOS <- "42.2817401"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.611408256"
Evaluating: 125.050557*(0.611408256-0.5)
 Parameter: YPOS <- "13.9316645"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.35338548"
Evaluating: 152.572525*(0.35338548-0.5)+-4.51585405
 Parameter: ZPOS <- "-26.8852016"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.8852016" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.2817401"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 42.2817401-0
 Parameter: XTRAN <- "42.2817401"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.9316645"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.9316645-0
 Parameter: YTRAN <- "13.9316645"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.8852016"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.8852016-0
 Parameter: ZTRAN <- "-26.8852016"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.2817401"
 Parameter: YTRAN -> "13.9316645"
 Parameter: ZTRAN -> "-26.8852016"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    42.281740   13.931665  -26.885202
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.128457499"
Evaluating: 0.128457499*360.0
 Parameter: XPHI <- "46.2446996"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.424382681"
Evaluating: 0.424382681*360.0
 Parameter: YPHI <- "152.777765"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.566356516E-02"
Evaluating: 9.566356516E-02*360.0
 Parameter: ZPHI <- "34.4388835"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.2817401"
 Parameter: YPOS -> "13.9316645"
 Parameter: ZPOS -> "-26.8852016"
 Parameter: XPHI -> "46.2446996"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.691580    0.722300
    0.000000   -0.722300    0.691580

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   46.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.2817401"
 Parameter: YPOS -> "13.9316645"
 Parameter: ZPOS -> "-26.8852016"
 Parameter: YPHI -> "152.777765"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.889239    0.000000   -0.457443
    0.000000    1.000000    0.000000
    0.457443    0.000000   -0.889239

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  152.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.2817401"
 Parameter: YPOS -> "13.9316645"
 Parameter: ZPOS -> "-26.8852016"
 Parameter: ZPHI -> "34.4388835"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.824730    0.565527    0.000000
   -0.565527    0.824730    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   34.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.281740 XMAX =   42.281740 XAVE =   42.281740
    YMIN =   13.931665 YMAX =   13.931665 YAVE =   13.931665
    ZMIN =  -26.885202 ZMAX =  -26.885202 ZAVE =  -26.885202
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.2817401"
Evaluating: 42.2817401+3.5
 Parameter: XMAX <- "45.7817401"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.9316645"
Evaluating: 13.9316645+3.5
 Parameter: YMAX <- "17.4316645"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.8852016"
Evaluating: -26.8852016+3.5
 Parameter: ZMAX <- "-23.3852016"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.2817401"
Evaluating: 42.2817401-3.5
 Parameter: XMIN <- "38.7817401"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.9316645"
Evaluating: 13.9316645-3.5
 Parameter: YMIN <- "10.4316645"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.8852016"
Evaluating: -26.8852016-3.5
 Parameter: ZMIN <- "-30.3852016"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.7817401"
 Parameter: XMIN -> "38.7817401"
 Parameter: YMAX -> "17.4316645"
 Parameter: YMIN -> "10.4316645"
 Parameter: ZMAX -> "-23.3852016"
 Parameter: ZMIN -> "-30.3852016"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "286"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "286" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "286"
Evaluating: 286
 Parameter: J <- "286"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "286" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "286"
 Parameter: NPOS -> "143"
Evaluating: 286-143
 Parameter: J <- "143"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "143"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.310119944"
Evaluating: 125.050557*(0.310119944-0.5)
 Parameter: XPOS <- "-23.7446068"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.390720664"
Evaluating: 125.050557*(0.390720664-0.5)
 Parameter: YPOS <- "-13.6654418"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.970858613"
Evaluating: 152.572525*(0.970858613-0.5)+-4.51585405
 Parameter: ZPOS <- "67.3242335"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "67.3242335" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "67.3242335" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.7446068"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.7446068-0
 Parameter: XTRAN <- "-23.7446068"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.6654418"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.6654418-0
 Parameter: YTRAN <- "-13.6654418"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "67.3242335"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 67.3242335-0
 Parameter: ZTRAN <- "67.3242335"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.7446068"
 Parameter: YTRAN -> "-13.6654418"
 Parameter: ZTRAN -> "67.3242335"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -23.744607  -13.665442   67.324234
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.557084944"
Evaluating: 0.557084944*360.0
 Parameter: XPHI <- "200.55058"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.402444519"
Evaluating: 0.402444519*360.0
 Parameter: YPHI <- "144.880027"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.605732933E-02"
Evaluating: 4.605732933E-02*360.0
 Parameter: ZPHI <- "16.5806386"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.7446068"
 Parameter: YPOS -> "-13.6654418"
 Parameter: ZPOS -> "67.3242335"
 Parameter: XPHI -> "200.55058"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.936363   -0.351034
    0.000000    0.351034   -0.936363

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  159.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.7446068"
 Parameter: YPOS -> "-13.6654418"
 Parameter: ZPOS -> "67.3242335"
 Parameter: YPHI -> "144.880027"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.817949    0.000000   -0.575290
    0.000000    1.000000    0.000000
    0.575290    0.000000   -0.817949

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  144.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.7446068"
 Parameter: YPOS -> "-13.6654418"
 Parameter: ZPOS -> "67.3242335"
 Parameter: ZPHI -> "16.5806386"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.958419    0.285365    0.000000
   -0.285365    0.958419    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   16.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.744607 XMAX =  -23.744607 XAVE =  -23.744607
    YMIN =  -13.665442 YMAX =  -13.665442 YAVE =  -13.665442
    ZMIN =   67.324234 ZMAX =   67.324234 ZAVE =   67.324234
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.7446068"
Evaluating: -23.7446068+3.5
 Parameter: XMAX <- "-20.2446068"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.6654418"
Evaluating: -13.6654418+3.5
 Parameter: YMAX <- "-10.1654418"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "67.3242335"
Evaluating: 67.3242335+3.5
 Parameter: ZMAX <- "70.8242335"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.7446068"
Evaluating: -23.7446068-3.5
 Parameter: XMIN <- "-27.2446068"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.6654418"
Evaluating: -13.6654418-3.5
 Parameter: YMIN <- "-17.1654418"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "67.3242335"
Evaluating: 67.3242335-3.5
 Parameter: ZMIN <- "63.8242335"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.2446068"
 Parameter: XMIN -> "-27.2446068"
 Parameter: YMAX -> "-10.1654418"
 Parameter: YMIN -> "-17.1654418"
 Parameter: ZMAX -> "70.8242335"
 Parameter: ZMIN -> "63.8242335"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "287"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "287" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "287"
Evaluating: 287
 Parameter: J <- "287"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "287" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "287"
 Parameter: NPOS -> "143"
Evaluating: 287-143
 Parameter: J <- "144"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "144"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.258285701"
Evaluating: 125.050557*(0.258285701-0.5)
 Parameter: XPOS <- "-30.2265077"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.136679011"
Evaluating: 125.050557*(0.136679011-0.5)
 Parameter: YPOS <- "-45.433492"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "6.076935604E-02"
Evaluating: 152.572525*(6.076935604E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-71.5303825"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-71.5303825" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.2265077"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.2265077-0
 Parameter: XTRAN <- "-30.2265077"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-45.433492"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -45.433492-0
 Parameter: YTRAN <- "-45.433492"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-71.5303825"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -71.5303825-0
 Parameter: ZTRAN <- "-71.5303825"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.2265077"
 Parameter: YTRAN -> "-45.433492"
 Parameter: ZTRAN -> "-71.5303825"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -30.226508  -45.433492  -71.530383
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.570726087"
Evaluating: 0.570726087*360.0
 Parameter: XPHI <- "205.461391"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.99595272"
Evaluating: 0.99595272*360.0
 Parameter: YPHI <- "358.542979"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.461715744"
Evaluating: 0.461715744*360.0
 Parameter: ZPHI <- "166.217668"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.2265077"
 Parameter: YPOS -> "-45.433492"
 Parameter: ZPOS -> "-71.5303825"
 Parameter: XPHI -> "205.461391"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.902875   -0.429903
    0.000000    0.429903   -0.902875

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  154.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.2265077"
 Parameter: YPOS -> "-45.433492"
 Parameter: ZPOS -> "-71.5303825"
 Parameter: YPHI -> "358.542979"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.999677    0.000000    0.025427
    0.000000    1.000000    0.000000
   -0.025427    0.000000    0.999677

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    1.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.2265077"
 Parameter: YPOS -> "-45.433492"
 Parameter: ZPOS -> "-71.5303825"
 Parameter: ZPHI -> "166.217668"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.971208    0.238234    0.000000
   -0.238234   -0.971208    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  166.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.226508 XMAX =  -30.226508 XAVE =  -30.226508
    YMIN =  -45.433492 YMAX =  -45.433492 YAVE =  -45.433492
    ZMIN =  -71.530383 ZMAX =  -71.530383 ZAVE =  -71.530383
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.2265077"
Evaluating: -30.2265077+3.5
 Parameter: XMAX <- "-26.7265077"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-45.433492"
Evaluating: -45.433492+3.5
 Parameter: YMAX <- "-41.933492"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-71.5303825"
Evaluating: -71.5303825+3.5
 Parameter: ZMAX <- "-68.0303825"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.2265077"
Evaluating: -30.2265077-3.5
 Parameter: XMIN <- "-33.7265077"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-45.433492"
Evaluating: -45.433492-3.5
 Parameter: YMIN <- "-48.933492"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-71.5303825"
Evaluating: -71.5303825-3.5
 Parameter: ZMIN <- "-75.0303825"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.7265077"
 Parameter: XMIN -> "-33.7265077"
 Parameter: YMAX -> "-41.933492"
 Parameter: YMIN -> "-48.933492"
 Parameter: ZMAX -> "-68.0303825"
 Parameter: ZMIN -> "-75.0303825"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      1 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64702 NEG      CLA      144      CLA     -**** POS      SOD      92       SOD           3.1577
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "287"
Evaluating: 287
 Parameter: J <- "287"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "287" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "287"
 Parameter: NPOS -> "143"
Evaluating: 287-143
 Parameter: J <- "144"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "144"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.947125238"
Evaluating: 125.050557*(0.947125238-0.5)
 Parameter: XPOS <- "55.9132601"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.251929628"
Evaluating: 125.050557*(0.251929628-0.5)
 Parameter: YPOS <- "-31.0213382"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "9.399729683E-02"
Evaluating: 152.572525*(9.399729683E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-66.4607116"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-66.4607116" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.226508 XMAX =  -30.226508 XAVE =  -30.226508
    YMIN =  -45.433492 YMAX =  -45.433492 YAVE =  -45.433492
    ZMIN =  -71.530383 ZMAX =  -71.530383 ZAVE =  -71.530383
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "55.9132601"
 RDCMND substituted energy or value "?XAVE" to "-30.2265077"
Evaluating: 55.9132601--30.2265077
 Parameter: XTRAN <- "86.1397678"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.0213382"
 RDCMND substituted energy or value "?YAVE" to "-45.433492"
Evaluating: -31.0213382--45.433492
 Parameter: YTRAN <- "14.4121538"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-66.4607116"
 RDCMND substituted energy or value "?ZAVE" to "-71.5303825"
Evaluating: -66.4607116--71.5303825
 Parameter: ZTRAN <- "5.0696709"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "86.1397678"
 Parameter: YTRAN -> "14.4121538"
 Parameter: ZTRAN -> "5.0696709"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    86.139768   14.412154    5.069671
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.687014393"
Evaluating: 0.687014393*360.0
 Parameter: XPHI <- "247.325181"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.53462247"
Evaluating: 0.53462247*360.0
 Parameter: YPHI <- "192.464089"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.202159453"
Evaluating: 0.202159453*360.0
 Parameter: ZPHI <- "72.7774031"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "55.9132601"
 Parameter: YPOS -> "-31.0213382"
 Parameter: ZPOS -> "-66.4607116"
 Parameter: XPHI -> "247.325181"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.385501   -0.922708
    0.000000    0.922708   -0.385501

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  112.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "55.9132601"
 Parameter: YPOS -> "-31.0213382"
 Parameter: ZPOS -> "-66.4607116"
 Parameter: YPHI -> "192.464089"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.976431    0.000000    0.215828
    0.000000    1.000000    0.000000
   -0.215828    0.000000   -0.976431

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  167.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "55.9132601"
 Parameter: YPOS -> "-31.0213382"
 Parameter: ZPOS -> "-66.4607116"
 Parameter: ZPHI -> "72.7774031"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.296085    0.955162    0.000000
   -0.955162    0.296085    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   72.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   55.913260 XMAX =   55.913260 XAVE =   55.913260
    YMIN =  -31.021338 YMAX =  -31.021338 YAVE =  -31.021338
    ZMIN =  -66.460712 ZMAX =  -66.460712 ZAVE =  -66.460712
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "55.9132601"
Evaluating: 55.9132601+3.5
 Parameter: XMAX <- "59.4132601"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.0213382"
Evaluating: -31.0213382+3.5
 Parameter: YMAX <- "-27.5213382"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-66.4607116"
Evaluating: -66.4607116+3.5
 Parameter: ZMAX <- "-62.9607116"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "55.9132601"
Evaluating: 55.9132601-3.5
 Parameter: XMIN <- "52.4132601"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.0213382"
Evaluating: -31.0213382-3.5
 Parameter: YMIN <- "-34.5213382"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-66.4607116"
Evaluating: -66.4607116-3.5
 Parameter: ZMIN <- "-69.9607116"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "59.4132601"
 Parameter: XMIN -> "52.4132601"
 Parameter: YMAX -> "-27.5213382"
 Parameter: YMIN -> "-34.5213382"
 Parameter: ZMAX -> "-62.9607116"
 Parameter: ZMIN -> "-69.9607116"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "288"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "288" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "288"
Evaluating: 288
 Parameter: J <- "288"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "288" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "288"
 Parameter: NPOS -> "143"
Evaluating: 288-143
 Parameter: J <- "145"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "145"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.260702797"
Evaluating: 125.050557*(0.260702797-0.5)
 Parameter: XPOS <- "-29.9242485"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.71377525"
Evaluating: 125.050557*(0.71377525-0.5)
 Parameter: YPOS <- "26.7327141"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.497195862"
Evaluating: 152.572525*(0.497195862-0.5)+-4.51585405
 Parameter: ZPOS <- "-4.94368847"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.94368847" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.94368847" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "288"
Evaluating: 288
 Parameter: J <- "288"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "288" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "288"
 Parameter: NPOS -> "143"
Evaluating: 288-143
 Parameter: J <- "145"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "145"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "8.607448646E-02"
Evaluating: 125.050557*(8.607448646E-02-0.5)
 Parameter: XPOS <- "-51.761616"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "1.195018568E-03"
Evaluating: 125.050557*(1.195018568E-03-0.5)
 Parameter: YPOS <- "-62.3758408"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.574018308"
Evaluating: 152.572525*(0.574018308-0.5)+-4.51585405
 Parameter: ZPOS <- "6.7773061"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.7773061" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.7773061" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "288"
Evaluating: 288
 Parameter: J <- "288"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "288" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "288"
 Parameter: NPOS -> "143"
Evaluating: 288-143
 Parameter: J <- "145"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "145"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.939990638"
Evaluating: 125.050557*(0.939990638-0.5)
 Parameter: XPOS <- "55.0210744"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.844257531"
Evaluating: 125.050557*(0.844257531-0.5)
 Parameter: YPOS <- "43.049596"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.297912314"
Evaluating: 152.572525*(0.297912314-0.5)+-4.51585405
 Parameter: ZPOS <- "-35.3488826"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.3488826" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "55.0210744"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 55.0210744-0
 Parameter: XTRAN <- "55.0210744"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "43.049596"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 43.049596-0
 Parameter: YTRAN <- "43.049596"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.3488826"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -35.3488826-0
 Parameter: ZTRAN <- "-35.3488826"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "55.0210744"
 Parameter: YTRAN -> "43.049596"
 Parameter: ZTRAN -> "-35.3488826"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    55.021074   43.049596  -35.348883
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.401950444"
Evaluating: 0.401950444*360.0
 Parameter: XPHI <- "144.70216"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.481527575"
Evaluating: 0.481527575*360.0
 Parameter: YPHI <- "173.349927"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.240306008"
Evaluating: 0.240306008*360.0
 Parameter: ZPHI <- "86.5101629"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "55.0210744"
 Parameter: YPOS -> "43.049596"
 Parameter: ZPOS -> "-35.3488826"
 Parameter: XPHI -> "144.70216"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.816159    0.577827
    0.000000   -0.577827   -0.816159

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  144.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "55.0210744"
 Parameter: YPOS -> "43.049596"
 Parameter: ZPOS -> "-35.3488826"
 Parameter: YPHI -> "173.349927"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.993272    0.000000   -0.115805
    0.000000    1.000000    0.000000
    0.115805    0.000000   -0.993272

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  173.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "55.0210744"
 Parameter: YPOS -> "43.049596"
 Parameter: ZPOS -> "-35.3488826"
 Parameter: ZPHI -> "86.5101629"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.060871    0.998146    0.000000
   -0.998146    0.060871    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   86.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   55.021074 XMAX =   55.021074 XAVE =   55.021074
    YMIN =   43.049596 YMAX =   43.049596 YAVE =   43.049596
    ZMIN =  -35.348883 ZMAX =  -35.348883 ZAVE =  -35.348883
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "55.0210744"
Evaluating: 55.0210744+3.5
 Parameter: XMAX <- "58.5210744"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "43.049596"
Evaluating: 43.049596+3.5
 Parameter: YMAX <- "46.549596"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.3488826"
Evaluating: -35.3488826+3.5
 Parameter: ZMAX <- "-31.8488826"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "55.0210744"
Evaluating: 55.0210744-3.5
 Parameter: XMIN <- "51.5210744"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "43.049596"
Evaluating: 43.049596-3.5
 Parameter: YMIN <- "39.549596"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.3488826"
Evaluating: -35.3488826-3.5
 Parameter: ZMIN <- "-38.8488826"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "58.5210744"
 Parameter: XMIN -> "51.5210744"
 Parameter: YMAX -> "46.549596"
 Parameter: YMIN -> "39.549596"
 Parameter: ZMAX -> "-31.8488826"
 Parameter: ZMIN -> "-38.8488826"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "289"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "289" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "289"
Evaluating: 289
 Parameter: J <- "289"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "289" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "289"
 Parameter: NPOS -> "143"
Evaluating: 289-143
 Parameter: J <- "146"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "146"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.186056556"
Evaluating: 125.050557*(0.186056556-0.5)
 Parameter: XPOS <- "-39.2588025"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.806239313"
Evaluating: 125.050557*(0.806239313-0.5)
 Parameter: YPOS <- "38.2953967"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.458040771"
Evaluating: 152.572525*(0.458040771-0.5)+-4.51585405
 Parameter: ZPOS <- "-10.9176796"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.9176796" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.9176796" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "289"
Evaluating: 289
 Parameter: J <- "289"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "289" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "289"
 Parameter: NPOS -> "143"
Evaluating: 289-143
 Parameter: J <- "146"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "146"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.815202123"
Evaluating: 125.050557*(0.815202123-0.5)
 Parameter: XPOS <- "39.416201"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "3.174323506E-03"
Evaluating: 125.050557*(3.174323506E-03-0.5)
 Parameter: YPOS <- "-62.1283276"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "3.321057571E-02"
Evaluating: 152.572525*(3.321057571E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-75.7350952"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-75.7350952" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.416201"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.416201-0
 Parameter: XTRAN <- "39.416201"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-62.1283276"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -62.1283276-0
 Parameter: YTRAN <- "-62.1283276"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-75.7350952"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -75.7350952-0
 Parameter: ZTRAN <- "-75.7350952"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.416201"
 Parameter: YTRAN -> "-62.1283276"
 Parameter: ZTRAN -> "-75.7350952"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    39.416201  -62.128328  -75.735095
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.518812938"
Evaluating: 0.518812938*360.0
 Parameter: XPHI <- "186.772658"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.519375853E-02"
Evaluating: 2.519375853E-02*360.0
 Parameter: YPHI <- "9.06975307"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.876242844"
Evaluating: 0.876242844*360.0
 Parameter: ZPHI <- "315.447424"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.416201"
 Parameter: YPOS -> "-62.1283276"
 Parameter: ZPOS -> "-75.7350952"
 Parameter: XPHI -> "186.772658"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.993022   -0.117930
    0.000000    0.117930   -0.993022

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  173.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.416201"
 Parameter: YPOS -> "-62.1283276"
 Parameter: ZPOS -> "-75.7350952"
 Parameter: YPHI -> "9.06975307"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.987497    0.000000   -0.157637
    0.000000    1.000000    0.000000
    0.157637    0.000000    0.987497

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    9.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.416201"
 Parameter: YPOS -> "-62.1283276"
 Parameter: ZPOS -> "-75.7350952"
 Parameter: ZPHI -> "315.447424"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.712607   -0.701563    0.000000
    0.701563    0.712607    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   44.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.416201 XMAX =   39.416201 XAVE =   39.416201
    YMIN =  -62.128328 YMAX =  -62.128328 YAVE =  -62.128328
    ZMIN =  -75.735095 ZMAX =  -75.735095 ZAVE =  -75.735095
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.416201"
Evaluating: 39.416201+3.5
 Parameter: XMAX <- "42.916201"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-62.1283276"
Evaluating: -62.1283276+3.5
 Parameter: YMAX <- "-58.6283276"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-75.7350952"
Evaluating: -75.7350952+3.5
 Parameter: ZMAX <- "-72.2350952"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.416201"
Evaluating: 39.416201-3.5
 Parameter: XMIN <- "35.916201"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-62.1283276"
Evaluating: -62.1283276-3.5
 Parameter: YMIN <- "-65.6283276"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-75.7350952"
Evaluating: -75.7350952-3.5
 Parameter: ZMIN <- "-79.2350952"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.916201"
 Parameter: XMIN -> "35.916201"
 Parameter: YMAX -> "-58.6283276"
 Parameter: YMIN -> "-65.6283276"
 Parameter: ZMAX -> "-72.2350952"
 Parameter: ZMIN -> "-79.2350952"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "290"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "290" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "290"
Evaluating: 290
 Parameter: J <- "290"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "290" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "290"
 Parameter: NPOS -> "143"
Evaluating: 290-143
 Parameter: J <- "147"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "147"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.174137934"
Evaluating: 125.050557*(0.174137934-0.5)
 Parameter: XPOS <- "-40.7492329"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.316052745"
Evaluating: 125.050557*(0.316052745-0.5)
 Parameter: YPOS <- "-23.0027067"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "7.719878685E-02"
Evaluating: 152.572525*(7.719878685E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-69.0237027"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-69.0237027" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.7492329"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -40.7492329-0
 Parameter: XTRAN <- "-40.7492329"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.0027067"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -23.0027067-0
 Parameter: YTRAN <- "-23.0027067"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-69.0237027"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -69.0237027-0
 Parameter: ZTRAN <- "-69.0237027"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.7492329"
 Parameter: YTRAN -> "-23.0027067"
 Parameter: ZTRAN -> "-69.0237027"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -40.749233  -23.002707  -69.023703
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.027245692E-02"
Evaluating: 1.027245692E-02*360.0
 Parameter: XPHI <- "3.69808449"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.652244137"
Evaluating: 0.652244137*360.0
 Parameter: YPHI <- "234.807889"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.693799079"
Evaluating: 0.693799079*360.0
 Parameter: ZPHI <- "249.767668"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.7492329"
 Parameter: YPOS -> "-23.0027067"
 Parameter: ZPOS -> "-69.0237027"
 Parameter: XPHI -> "3.69808449"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997918    0.064499
    0.000000   -0.064499    0.997918

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.7492329"
 Parameter: YPOS -> "-23.0027067"
 Parameter: ZPOS -> "-69.0237027"
 Parameter: YPHI -> "234.807889"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.576320    0.000000    0.817224
    0.000000    1.000000    0.000000
   -0.817224    0.000000   -0.576320

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  125.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.7492329"
 Parameter: YPOS -> "-23.0027067"
 Parameter: ZPOS -> "-69.0237027"
 Parameter: ZPHI -> "249.767668"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.345828   -0.938298    0.000000
    0.938298   -0.345828    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  110.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.749233 XMAX =  -40.749233 XAVE =  -40.749233
    YMIN =  -23.002707 YMAX =  -23.002707 YAVE =  -23.002707
    ZMIN =  -69.023703 ZMAX =  -69.023703 ZAVE =  -69.023703
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.7492329"
Evaluating: -40.7492329+3.5
 Parameter: XMAX <- "-37.2492329"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.0027067"
Evaluating: -23.0027067+3.5
 Parameter: YMAX <- "-19.5027067"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-69.0237027"
Evaluating: -69.0237027+3.5
 Parameter: ZMAX <- "-65.5237027"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.7492329"
Evaluating: -40.7492329-3.5
 Parameter: XMIN <- "-44.2492329"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.0027067"
Evaluating: -23.0027067-3.5
 Parameter: YMIN <- "-26.5027067"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-69.0237027"
Evaluating: -69.0237027-3.5
 Parameter: ZMIN <- "-72.5237027"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.2492329"
 Parameter: XMIN -> "-44.2492329"
 Parameter: YMAX -> "-19.5027067"
 Parameter: YMIN -> "-26.5027067"
 Parameter: ZMAX -> "-65.5237027"
 Parameter: ZMIN -> "-72.5237027"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "291"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "291" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "291"
Evaluating: 291
 Parameter: J <- "291"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "291" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "291"
 Parameter: NPOS -> "143"
Evaluating: 291-143
 Parameter: J <- "148"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "148"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.275967912"
Evaluating: 125.050557*(0.275967912-0.5)
 Parameter: XPOS <- "-28.0153374"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.373489282"
Evaluating: 125.050557*(0.373489282-0.5)
 Parameter: YPOS <- "-15.8202358"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.71212619"
Evaluating: 152.572525*(0.71212619-0.5)+-4.51585405
 Parameter: ZPOS <- "27.8487744"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.8487744" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.8487744" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.0153374"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.0153374-0
 Parameter: XTRAN <- "-28.0153374"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.8202358"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.8202358-0
 Parameter: YTRAN <- "-15.8202358"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.8487744"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.8487744-0
 Parameter: ZTRAN <- "27.8487744"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.0153374"
 Parameter: YTRAN -> "-15.8202358"
 Parameter: ZTRAN -> "27.8487744"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -28.015337  -15.820236   27.848774
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.338179969"
Evaluating: 0.338179969*360.0
 Parameter: XPHI <- "121.744789"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.226256174"
Evaluating: 0.226256174*360.0
 Parameter: YPHI <- "81.4522226"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.186155717"
Evaluating: 0.186155717*360.0
 Parameter: ZPHI <- "67.0160581"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.0153374"
 Parameter: YPOS -> "-15.8202358"
 Parameter: ZPOS -> "27.8487744"
 Parameter: XPHI -> "121.744789"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.526137    0.850400
    0.000000   -0.850400   -0.526137

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  121.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.0153374"
 Parameter: YPOS -> "-15.8202358"
 Parameter: ZPOS -> "27.8487744"
 Parameter: YPHI -> "81.4522226"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.148634    0.000000   -0.988892
    0.000000    1.000000    0.000000
    0.988892    0.000000    0.148634

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.0153374"
 Parameter: YPOS -> "-15.8202358"
 Parameter: ZPOS -> "27.8487744"
 Parameter: ZPHI -> "67.0160581"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.390473    0.920614    0.000000
   -0.920614    0.390473    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   67.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.015337 XMAX =  -28.015337 XAVE =  -28.015337
    YMIN =  -15.820236 YMAX =  -15.820236 YAVE =  -15.820236
    ZMIN =   27.848774 ZMAX =   27.848774 ZAVE =   27.848774
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.0153374"
Evaluating: -28.0153374+3.5
 Parameter: XMAX <- "-24.5153374"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.8202358"
Evaluating: -15.8202358+3.5
 Parameter: YMAX <- "-12.3202358"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.8487744"
Evaluating: 27.8487744+3.5
 Parameter: ZMAX <- "31.3487744"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.0153374"
Evaluating: -28.0153374-3.5
 Parameter: XMIN <- "-31.5153374"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.8202358"
Evaluating: -15.8202358-3.5
 Parameter: YMIN <- "-19.3202358"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.8487744"
Evaluating: 27.8487744-3.5
 Parameter: ZMIN <- "24.3487744"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.5153374"
 Parameter: XMIN -> "-31.5153374"
 Parameter: YMAX -> "-12.3202358"
 Parameter: YMIN -> "-19.3202358"
 Parameter: ZMAX -> "31.3487744"
 Parameter: ZMIN -> "24.3487744"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "292"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "292" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "292"
Evaluating: 292
 Parameter: J <- "292"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "292" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "292"
 Parameter: NPOS -> "143"
Evaluating: 292-143
 Parameter: J <- "149"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "149"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.629311744"
Evaluating: 125.050557*(0.629311744-0.5)
 Parameter: XPOS <- "16.1705056"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.250254816"
Evaluating: 125.050557*(0.250254816-0.5)
 Parameter: YPOS <- "-31.2307744"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.468948575"
Evaluating: 152.572525*(0.468948575-0.5)+-4.51585405
 Parameter: ZPOS <- "-9.25344837"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.25344837" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.25344837" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "292"
Evaluating: 292
 Parameter: J <- "292"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "292" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "292"
 Parameter: NPOS -> "143"
Evaluating: 292-143
 Parameter: J <- "149"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "149"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.586752827"
Evaluating: 125.050557*(0.586752827-0.5)
 Parameter: XPOS <- "10.8484893"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.944218591"
Evaluating: 125.050557*(0.944218591-0.5)
 Parameter: YPOS <- "55.5497822"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.374088131"
Evaluating: 152.572525*(0.374088131-0.5)+-4.51585405
 Parameter: ZPOS <- "-23.7265458"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.7265458" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.8484893"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.8484893-0
 Parameter: XTRAN <- "10.8484893"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "55.5497822"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 55.5497822-0
 Parameter: YTRAN <- "55.5497822"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.7265458"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.7265458-0
 Parameter: ZTRAN <- "-23.7265458"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.8484893"
 Parameter: YTRAN -> "55.5497822"
 Parameter: ZTRAN -> "-23.7265458"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    10.848489   55.549782  -23.726546
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.783550657"
Evaluating: 0.783550657*360.0
 Parameter: XPHI <- "282.078237"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.261762169"
Evaluating: 0.261762169*360.0
 Parameter: YPHI <- "94.2343808"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.1026221E-02"
Evaluating: 9.1026221E-02*360.0
 Parameter: ZPHI <- "32.7694396"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.8484893"
 Parameter: YPOS -> "55.5497822"
 Parameter: ZPOS -> "-23.7265458"
 Parameter: XPHI -> "282.078237"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.209247   -0.977863
    0.000000    0.977863    0.209247

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   77.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.8484893"
 Parameter: YPOS -> "55.5497822"
 Parameter: ZPOS -> "-23.7265458"
 Parameter: YPHI -> "94.2343808"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.073837    0.000000   -0.997270
    0.000000    1.000000    0.000000
    0.997270    0.000000   -0.073837

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   94.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.8484893"
 Parameter: YPOS -> "55.5497822"
 Parameter: ZPOS -> "-23.7265458"
 Parameter: ZPHI -> "32.7694396"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.840855    0.541260    0.000000
   -0.541260    0.840855    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   32.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.848489 XMAX =   10.848489 XAVE =   10.848489
    YMIN =   55.549782 YMAX =   55.549782 YAVE =   55.549782
    ZMIN =  -23.726546 ZMAX =  -23.726546 ZAVE =  -23.726546
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.8484893"
Evaluating: 10.8484893+3.5
 Parameter: XMAX <- "14.3484893"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "55.5497822"
Evaluating: 55.5497822+3.5
 Parameter: YMAX <- "59.0497822"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.7265458"
Evaluating: -23.7265458+3.5
 Parameter: ZMAX <- "-20.2265458"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.8484893"
Evaluating: 10.8484893-3.5
 Parameter: XMIN <- "7.3484893"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "55.5497822"
Evaluating: 55.5497822-3.5
 Parameter: YMIN <- "52.0497822"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.7265458"
Evaluating: -23.7265458-3.5
 Parameter: ZMIN <- "-27.2265458"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.3484893"
 Parameter: XMIN -> "7.3484893"
 Parameter: YMAX -> "59.0497822"
 Parameter: YMIN -> "52.0497822"
 Parameter: ZMAX -> "-20.2265458"
 Parameter: ZMIN -> "-27.2265458"
 SELRPN>      4 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      4 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64707 NEG      CLA      149      CLA     -**** MEMB     POPC     229      P             3.4411
64707 NEG      CLA      149      CLA     -**** MEMB     POPC     229      O13           2.5958
64707 NEG      CLA      149      CLA     -**** MEMB     POPC     229      O11           3.4006
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "292"
Evaluating: 292
 Parameter: J <- "292"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "292" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "292"
 Parameter: NPOS -> "143"
Evaluating: 292-143
 Parameter: J <- "149"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "149"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.59262102E-02"
Evaluating: 125.050557*(9.59262102E-02-0.5)
 Parameter: XPOS <- "-50.5296525"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.74058567"
Evaluating: 125.050557*(0.74058567-0.5)
 Parameter: YPOS <- "30.085372"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.806888898"
Evaluating: 152.572525*(0.806888898-0.5)+-4.51585405
 Parameter: ZPOS <- "42.30696"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "42.30696" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "42.30696" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.848489 XMAX =   10.848489 XAVE =   10.848489
    YMIN =   55.549782 YMAX =   55.549782 YAVE =   55.549782
    ZMIN =  -23.726546 ZMAX =  -23.726546 ZAVE =  -23.726546
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-50.5296525"
 RDCMND substituted energy or value "?XAVE" to "10.8484893"
Evaluating: -50.5296525-10.8484893
 Parameter: XTRAN <- "-61.3781418"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.085372"
 RDCMND substituted energy or value "?YAVE" to "55.5497822"
Evaluating: 30.085372-55.5497822
 Parameter: YTRAN <- "-25.4644102"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "42.30696"
 RDCMND substituted energy or value "?ZAVE" to "-23.7265458"
Evaluating: 42.30696--23.7265458
 Parameter: ZTRAN <- "66.0335058"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-61.3781418"
 Parameter: YTRAN -> "-25.4644102"
 Parameter: ZTRAN -> "66.0335058"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -61.378142  -25.464410   66.033506
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.120515686"
Evaluating: 0.120515686*360.0
 Parameter: XPHI <- "43.385647"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.714410262"
Evaluating: 0.714410262*360.0
 Parameter: YPHI <- "257.187694"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.78725331"
Evaluating: 0.78725331*360.0
 Parameter: ZPHI <- "283.411192"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-50.5296525"
 Parameter: YPOS -> "30.085372"
 Parameter: ZPOS -> "42.30696"
 Parameter: XPHI -> "43.385647"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.726747    0.686905
    0.000000   -0.686905    0.726747

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   43.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-50.5296525"
 Parameter: YPOS -> "30.085372"
 Parameter: ZPOS -> "42.30696"
 Parameter: YPHI -> "257.187694"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.221758    0.000000    0.975102
    0.000000    1.000000    0.000000
   -0.975102    0.000000   -0.221758

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  102.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-50.5296525"
 Parameter: YPOS -> "30.085372"
 Parameter: ZPOS -> "42.30696"
 Parameter: ZPHI -> "283.411192"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.231938   -0.972731    0.000000
    0.972731    0.231938    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   76.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -50.529653 XMAX =  -50.529653 XAVE =  -50.529653
    YMIN =   30.085372 YMAX =   30.085372 YAVE =   30.085372
    ZMIN =   42.306960 ZMAX =   42.306960 ZAVE =   42.306960
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-50.5296525"
Evaluating: -50.5296525+3.5
 Parameter: XMAX <- "-47.0296525"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.085372"
Evaluating: 30.085372+3.5
 Parameter: YMAX <- "33.585372"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "42.30696"
Evaluating: 42.30696+3.5
 Parameter: ZMAX <- "45.80696"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-50.5296525"
Evaluating: -50.5296525-3.5
 Parameter: XMIN <- "-54.0296525"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.085372"
Evaluating: 30.085372-3.5
 Parameter: YMIN <- "26.585372"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "42.30696"
Evaluating: 42.30696-3.5
 Parameter: ZMIN <- "38.80696"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-47.0296525"
 Parameter: XMIN -> "-54.0296525"
 Parameter: YMAX -> "33.585372"
 Parameter: YMIN -> "26.585372"
 Parameter: ZMAX -> "45.80696"
 Parameter: ZMIN -> "38.80696"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "293"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "293" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "293"
Evaluating: 293
 Parameter: J <- "293"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "293" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "293"
 Parameter: NPOS -> "143"
Evaluating: 293-143
 Parameter: J <- "150"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "150"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "3.209563926E-02"
Evaluating: 125.050557*(3.209563926E-02-0.5)
 Parameter: XPOS <- "-58.5117009"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.263273629"
Evaluating: 125.050557*(0.263273629-0.5)
 Parameter: YPOS <- "-29.6027646"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.323475691"
Evaluating: 152.572525*(0.323475691-0.5)+-4.51585405
 Parameter: ZPOS <- "-31.4486136"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.4486136" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-58.5117009"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -58.5117009-0
 Parameter: XTRAN <- "-58.5117009"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.6027646"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.6027646-0
 Parameter: YTRAN <- "-29.6027646"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.4486136"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.4486136-0
 Parameter: ZTRAN <- "-31.4486136"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.5117009"
 Parameter: YTRAN -> "-29.6027646"
 Parameter: ZTRAN -> "-31.4486136"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -58.511701  -29.602765  -31.448614
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.317029334"
Evaluating: 0.317029334*360.0
 Parameter: XPHI <- "114.13056"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.6466016"
Evaluating: 0.6466016*360.0
 Parameter: YPHI <- "232.776576"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.664765852"
Evaluating: 0.664765852*360.0
 Parameter: ZPHI <- "239.315707"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-58.5117009"
 Parameter: YPOS -> "-29.6027646"
 Parameter: ZPOS -> "-31.4486136"
 Parameter: XPHI -> "114.13056"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.408817    0.912616
    0.000000   -0.912616   -0.408817

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-58.5117009"
 Parameter: YPOS -> "-29.6027646"
 Parameter: ZPOS -> "-31.4486136"
 Parameter: YPHI -> "232.776576"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.604925    0.000000    0.796283
    0.000000    1.000000    0.000000
   -0.796283    0.000000   -0.604925

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  127.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-58.5117009"
 Parameter: YPOS -> "-29.6027646"
 Parameter: ZPOS -> "-31.4486136"
 Parameter: ZPHI -> "239.315707"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.510307   -0.859992    0.000000
    0.859992   -0.510307    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  120.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -58.511701 XMAX =  -58.511701 XAVE =  -58.511701
    YMIN =  -29.602765 YMAX =  -29.602765 YAVE =  -29.602765
    ZMIN =  -31.448614 ZMAX =  -31.448614 ZAVE =  -31.448614
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-58.5117009"
Evaluating: -58.5117009+3.5
 Parameter: XMAX <- "-55.0117009"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.6027646"
Evaluating: -29.6027646+3.5
 Parameter: YMAX <- "-26.1027646"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.4486136"
Evaluating: -31.4486136+3.5
 Parameter: ZMAX <- "-27.9486136"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-58.5117009"
Evaluating: -58.5117009-3.5
 Parameter: XMIN <- "-62.0117009"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.6027646"
Evaluating: -29.6027646-3.5
 Parameter: YMIN <- "-33.1027646"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.4486136"
Evaluating: -31.4486136-3.5
 Parameter: ZMIN <- "-34.9486136"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-55.0117009"
 Parameter: XMIN -> "-62.0117009"
 Parameter: YMAX -> "-26.1027646"
 Parameter: YMIN -> "-33.1027646"
 Parameter: ZMAX -> "-27.9486136"
 Parameter: ZMIN -> "-34.9486136"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "294"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "294" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "294"
Evaluating: 294
 Parameter: J <- "294"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "294" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "294"
 Parameter: NPOS -> "143"
Evaluating: 294-143
 Parameter: J <- "151"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "151"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.44933046"
Evaluating: 125.050557*(0.44933046-0.5)
 Parameter: XPOS <- "-6.3362542"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.343088713"
Evaluating: 125.050557*(0.343088713-0.5)
 Parameter: YPOS <- "-19.6218438"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.241402835"
Evaluating: 152.572525*(0.241402835-0.5)+-4.51585405
 Parameter: ZPOS <- "-43.9706765"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.9706765" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.3362542"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.3362542-0
 Parameter: XTRAN <- "-6.3362542"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.6218438"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -19.6218438-0
 Parameter: YTRAN <- "-19.6218438"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.9706765"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.9706765-0
 Parameter: ZTRAN <- "-43.9706765"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.3362542"
 Parameter: YTRAN -> "-19.6218438"
 Parameter: ZTRAN -> "-43.9706765"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -6.336254  -19.621844  -43.970677
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.622079371"
Evaluating: 0.622079371*360.0
 Parameter: XPHI <- "223.948574"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.448573752"
Evaluating: 0.448573752*360.0
 Parameter: YPHI <- "161.486551"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.691545768"
Evaluating: 0.691545768*360.0
 Parameter: ZPHI <- "248.956476"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.3362542"
 Parameter: YPOS -> "-19.6218438"
 Parameter: ZPOS -> "-43.9706765"
 Parameter: XPHI -> "223.948574"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.719963   -0.694012
    0.000000    0.694012   -0.719963

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  136.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.3362542"
 Parameter: YPOS -> "-19.6218438"
 Parameter: ZPOS -> "-43.9706765"
 Parameter: YPHI -> "161.486551"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.948249    0.000000   -0.317527
    0.000000    1.000000    0.000000
    0.317527    0.000000   -0.948249

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  161.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.3362542"
 Parameter: YPOS -> "-19.6218438"
 Parameter: ZPOS -> "-43.9706765"
 Parameter: ZPHI -> "248.956476"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.359077   -0.933308    0.000000
    0.933308   -0.359077    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  111.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.336254 XMAX =   -6.336254 XAVE =   -6.336254
    YMIN =  -19.621844 YMAX =  -19.621844 YAVE =  -19.621844
    ZMIN =  -43.970677 ZMAX =  -43.970677 ZAVE =  -43.970677
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.3362542"
Evaluating: -6.3362542+3.5
 Parameter: XMAX <- "-2.8362542"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.6218438"
Evaluating: -19.6218438+3.5
 Parameter: YMAX <- "-16.1218438"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.9706765"
Evaluating: -43.9706765+3.5
 Parameter: ZMAX <- "-40.4706765"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.3362542"
Evaluating: -6.3362542-3.5
 Parameter: XMIN <- "-9.8362542"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.6218438"
Evaluating: -19.6218438-3.5
 Parameter: YMIN <- "-23.1218438"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.9706765"
Evaluating: -43.9706765-3.5
 Parameter: ZMIN <- "-47.4706765"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.8362542"
 Parameter: XMIN -> "-9.8362542"
 Parameter: YMAX -> "-16.1218438"
 Parameter: YMIN -> "-23.1218438"
 Parameter: ZMAX -> "-40.4706765"
 Parameter: ZMIN -> "-47.4706765"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "295"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "295" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "295"
Evaluating: 295
 Parameter: J <- "295"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "295" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "295"
 Parameter: NPOS -> "143"
Evaluating: 295-143
 Parameter: J <- "152"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "152"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.787022175"
Evaluating: 125.050557*(0.787022175-0.5)
 Parameter: XPOS <- "35.8922829"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "9.261348016E-03"
Evaluating: 125.050557*(9.261348016E-03-0.5)
 Parameter: YPOS <- "-61.3671418"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.219937008"
Evaluating: 152.572525*(0.219937008-0.5)+-4.51585405
 Parameter: ZPOS <- "-47.2457719"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-47.2457719" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.8922829"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 35.8922829-0
 Parameter: XTRAN <- "35.8922829"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-61.3671418"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -61.3671418-0
 Parameter: YTRAN <- "-61.3671418"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-47.2457719"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -47.2457719-0
 Parameter: ZTRAN <- "-47.2457719"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.8922829"
 Parameter: YTRAN -> "-61.3671418"
 Parameter: ZTRAN -> "-47.2457719"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    35.892283  -61.367142  -47.245772
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.620212978"
Evaluating: 0.620212978*360.0
 Parameter: XPHI <- "223.276672"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.977702289"
Evaluating: 0.977702289*360.0
 Parameter: YPHI <- "351.972824"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.468744949"
Evaluating: 0.468744949*360.0
 Parameter: ZPHI <- "168.748182"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.8922829"
 Parameter: YPOS -> "-61.3671418"
 Parameter: ZPOS -> "-47.2457719"
 Parameter: XPHI -> "223.276672"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.728052   -0.685522
    0.000000    0.685522   -0.728052

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  136.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.8922829"
 Parameter: YPOS -> "-61.3671418"
 Parameter: ZPOS -> "-47.2457719"
 Parameter: YPHI -> "351.972824"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.990202    0.000000    0.139643
    0.000000    1.000000    0.000000
   -0.139643    0.000000    0.990202

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    8.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.8922829"
 Parameter: YPOS -> "-61.3671418"
 Parameter: ZPOS -> "-47.2457719"
 Parameter: ZPHI -> "168.748182"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.980779    0.195121    0.000000
   -0.195121   -0.980779    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  168.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.892283 XMAX =   35.892283 XAVE =   35.892283
    YMIN =  -61.367142 YMAX =  -61.367142 YAVE =  -61.367142
    ZMIN =  -47.245772 ZMAX =  -47.245772 ZAVE =  -47.245772
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.8922829"
Evaluating: 35.8922829+3.5
 Parameter: XMAX <- "39.3922829"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-61.3671418"
Evaluating: -61.3671418+3.5
 Parameter: YMAX <- "-57.8671418"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-47.2457719"
Evaluating: -47.2457719+3.5
 Parameter: ZMAX <- "-43.7457719"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.8922829"
Evaluating: 35.8922829-3.5
 Parameter: XMIN <- "32.3922829"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-61.3671418"
Evaluating: -61.3671418-3.5
 Parameter: YMIN <- "-64.8671418"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-47.2457719"
Evaluating: -47.2457719-3.5
 Parameter: ZMIN <- "-50.7457719"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.3922829"
 Parameter: XMIN -> "32.3922829"
 Parameter: YMAX -> "-57.8671418"
 Parameter: YMIN -> "-64.8671418"
 Parameter: ZMAX -> "-43.7457719"
 Parameter: ZMIN -> "-50.7457719"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "296"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "296" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "296"
Evaluating: 296
 Parameter: J <- "296"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "296" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "296"
 Parameter: NPOS -> "143"
Evaluating: 296-143
 Parameter: J <- "153"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "153"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.467793663"
Evaluating: 125.050557*(0.467793663-0.5)
 Parameter: XPOS <- "-4.02742038"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.226463846"
Evaluating: 125.050557*(0.226463846-0.5)
 Parameter: YPOS <- "-34.2058484"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "7.734894378E-02"
Evaluating: 152.572525*(7.734894378E-02-0.5)+-4.51585405
 Parameter: ZPOS <- "-69.0007929"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-69.0007929" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.02742038"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.02742038-0
 Parameter: XTRAN <- "-4.02742038"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.2058484"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.2058484-0
 Parameter: YTRAN <- "-34.2058484"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-69.0007929"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -69.0007929-0
 Parameter: ZTRAN <- "-69.0007929"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.02742038"
 Parameter: YTRAN -> "-34.2058484"
 Parameter: ZTRAN -> "-69.0007929"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -4.027420  -34.205848  -69.000793
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.814185471"
Evaluating: 0.814185471*360.0
 Parameter: XPHI <- "293.10677"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.177924652E-02"
Evaluating: 5.177924652E-02*360.0
 Parameter: YPHI <- "18.6405287"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.320319604"
Evaluating: 0.320319604*360.0
 Parameter: ZPHI <- "115.315057"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.02742038"
 Parameter: YPOS -> "-34.2058484"
 Parameter: ZPOS -> "-69.0007929"
 Parameter: XPHI -> "293.10677"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.392446   -0.919775
    0.000000    0.919775    0.392446

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   66.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.02742038"
 Parameter: YPOS -> "-34.2058484"
 Parameter: ZPOS -> "-69.0007929"
 Parameter: YPHI -> "18.6405287"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.947543    0.000000   -0.319630
    0.000000    1.000000    0.000000
    0.319630    0.000000    0.947543

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   18.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.02742038"
 Parameter: YPOS -> "-34.2058484"
 Parameter: ZPOS -> "-69.0007929"
 Parameter: ZPHI -> "115.315057"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.427595    0.903970    0.000000
   -0.903970   -0.427595    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  115.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.027420 XMAX =   -4.027420 XAVE =   -4.027420
    YMIN =  -34.205848 YMAX =  -34.205848 YAVE =  -34.205848
    ZMIN =  -69.000793 ZMAX =  -69.000793 ZAVE =  -69.000793
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.02742038"
Evaluating: -4.02742038+3.5
 Parameter: XMAX <- "-0.52742038"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.2058484"
Evaluating: -34.2058484+3.5
 Parameter: YMAX <- "-30.7058484"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-69.0007929"
Evaluating: -69.0007929+3.5
 Parameter: ZMAX <- "-65.5007929"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.02742038"
Evaluating: -4.02742038-3.5
 Parameter: XMIN <- "-7.52742038"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.2058484"
Evaluating: -34.2058484-3.5
 Parameter: YMIN <- "-37.7058484"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-69.0007929"
Evaluating: -69.0007929-3.5
 Parameter: ZMIN <- "-72.5007929"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.52742038"
 Parameter: XMIN -> "-7.52742038"
 Parameter: YMAX -> "-30.7058484"
 Parameter: YMIN -> "-37.7058484"
 Parameter: ZMAX -> "-65.5007929"
 Parameter: ZMIN -> "-72.5007929"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "297"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "297" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "297"
Evaluating: 297
 Parameter: J <- "297"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "297" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "297"
 Parameter: NPOS -> "143"
Evaluating: 297-143
 Parameter: J <- "154"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "154"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.214212712"
Evaluating: 125.050557*(0.214212712-0.5)
 Parameter: XPOS <- "-35.7378595"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.691341533"
Evaluating: 125.050557*(0.691341533-0.5)
 Parameter: YPOS <- "23.9273653"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.68031086"
Evaluating: 152.572525*(0.68031086-0.5)+-4.51585405
 Parameter: ZPOS <- "22.9946291"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.9946291" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.9946291" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.7378595"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -35.7378595-0
 Parameter: XTRAN <- "-35.7378595"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.9273653"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.9273653-0
 Parameter: YTRAN <- "23.9273653"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.9946291"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.9946291-0
 Parameter: ZTRAN <- "22.9946291"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.7378595"
 Parameter: YTRAN -> "23.9273653"
 Parameter: ZTRAN -> "22.9946291"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -35.737859   23.927365   22.994629
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.90520971"
Evaluating: 0.90520971*360.0
 Parameter: XPHI <- "325.875496"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.956330562"
Evaluating: 0.956330562*360.0
 Parameter: YPHI <- "344.279002"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.369889367E-02"
Evaluating: 8.369889367E-02*360.0
 Parameter: ZPHI <- "30.1316017"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.7378595"
 Parameter: YPOS -> "23.9273653"
 Parameter: ZPOS -> "22.9946291"
 Parameter: XPHI -> "325.875496"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.827820   -0.560993
    0.000000    0.560993    0.827820

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   34.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.7378595"
 Parameter: YPOS -> "23.9273653"
 Parameter: ZPOS -> "22.9946291"
 Parameter: YPHI -> "344.279002"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.962593    0.000000    0.270953
    0.000000    1.000000    0.000000
   -0.270953    0.000000    0.962593

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   15.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.7378595"
 Parameter: YPOS -> "23.9273653"
 Parameter: ZPOS -> "22.9946291"
 Parameter: ZPHI -> "30.1316017"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.864875    0.501988    0.000000
   -0.501988    0.864875    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   30.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.737859 XMAX =  -35.737859 XAVE =  -35.737859
    YMIN =   23.927365 YMAX =   23.927365 YAVE =   23.927365
    ZMIN =   22.994629 ZMAX =   22.994629 ZAVE =   22.994629
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.7378595"
Evaluating: -35.7378595+3.5
 Parameter: XMAX <- "-32.2378595"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.9273653"
Evaluating: 23.9273653+3.5
 Parameter: YMAX <- "27.4273653"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.9946291"
Evaluating: 22.9946291+3.5
 Parameter: ZMAX <- "26.4946291"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.7378595"
Evaluating: -35.7378595-3.5
 Parameter: XMIN <- "-39.2378595"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.9273653"
Evaluating: 23.9273653-3.5
 Parameter: YMIN <- "20.4273653"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.9946291"
Evaluating: 22.9946291-3.5
 Parameter: ZMIN <- "19.4946291"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.2378595"
 Parameter: XMIN -> "-39.2378595"
 Parameter: YMAX -> "27.4273653"
 Parameter: YMIN -> "20.4273653"
 Parameter: ZMAX -> "26.4946291"
 Parameter: ZMIN -> "19.4946291"
 SELRPN>      5 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      4 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64712 NEG      CLA      154      CLA     -**** MEMB     POPC     79       O14           3.4901
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "297"
Evaluating: 297
 Parameter: J <- "297"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "297" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "297"
 Parameter: NPOS -> "143"
Evaluating: 297-143
 Parameter: J <- "154"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "154"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.340814131"
Evaluating: 125.050557*(0.340814131-0.5)
 Parameter: XPOS <- "-19.9062816"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.313744218"
Evaluating: 125.050557*(0.313744218-0.5)
 Parameter: YPOS <- "-23.2913893"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.843313859"
Evaluating: 152.572525*(0.843313859-0.5)+-4.51585405
 Parameter: ZPOS <- "47.8644083"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.8644083" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.8644083" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.737859 XMAX =  -35.737859 XAVE =  -35.737859
    YMIN =   23.927365 YMAX =   23.927365 YAVE =   23.927365
    ZMIN =   22.994629 ZMAX =   22.994629 ZAVE =   22.994629
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.9062816"
 RDCMND substituted energy or value "?XAVE" to "-35.7378595"
Evaluating: -19.9062816--35.7378595
 Parameter: XTRAN <- "15.8315779"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.2913893"
 RDCMND substituted energy or value "?YAVE" to "23.9273653"
Evaluating: -23.2913893-23.9273653
 Parameter: YTRAN <- "-47.2187546"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.8644083"
 RDCMND substituted energy or value "?ZAVE" to "22.9946291"
Evaluating: 47.8644083-22.9946291
 Parameter: ZTRAN <- "24.8697792"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.8315779"
 Parameter: YTRAN -> "-47.2187546"
 Parameter: ZTRAN -> "24.8697792"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    15.831578  -47.218755   24.869779
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.912593887"
Evaluating: 0.912593887*360.0
 Parameter: XPHI <- "328.533799"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.293799928"
Evaluating: 0.293799928*360.0
 Parameter: YPHI <- "105.767974"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.660309228E-02"
Evaluating: 2.660309228E-02*360.0
 Parameter: ZPHI <- "9.57711322"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.9062816"
 Parameter: YPOS -> "-23.2913893"
 Parameter: ZPOS -> "47.8644083"
 Parameter: XPHI -> "328.533799"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.852948   -0.521995
    0.000000    0.521995    0.852948

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   31.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.9062816"
 Parameter: YPOS -> "-23.2913893"
 Parameter: ZPOS -> "47.8644083"
 Parameter: YPHI -> "105.767974"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.271742    0.000000   -0.962370
    0.000000    1.000000    0.000000
    0.962370    0.000000   -0.271742

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  105.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.9062816"
 Parameter: YPOS -> "-23.2913893"
 Parameter: ZPOS -> "47.8644083"
 Parameter: ZPHI -> "9.57711322"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.986063    0.166375    0.000000
   -0.166375    0.986063    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    9.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.906282 XMAX =  -19.906282 XAVE =  -19.906282
    YMIN =  -23.291389 YMAX =  -23.291389 YAVE =  -23.291389
    ZMIN =   47.864408 ZMAX =   47.864408 ZAVE =   47.864408
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.9062816"
Evaluating: -19.9062816+3.5
 Parameter: XMAX <- "-16.4062816"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.2913893"
Evaluating: -23.2913893+3.5
 Parameter: YMAX <- "-19.7913893"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.8644083"
Evaluating: 47.8644083+3.5
 Parameter: ZMAX <- "51.3644083"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.9062816"
Evaluating: -19.9062816-3.5
 Parameter: XMIN <- "-23.4062816"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.2913893"
Evaluating: -23.2913893-3.5
 Parameter: YMIN <- "-26.7913893"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.8644083"
Evaluating: 47.8644083-3.5
 Parameter: ZMIN <- "44.3644083"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-16.4062816"
 Parameter: XMIN -> "-23.4062816"
 Parameter: YMAX -> "-19.7913893"
 Parameter: YMIN -> "-26.7913893"
 Parameter: ZMAX -> "51.3644083"
 Parameter: ZMIN -> "44.3644083"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "298"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "298" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "298"
Evaluating: 298
 Parameter: J <- "298"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "298" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "298"
 Parameter: NPOS -> "143"
Evaluating: 298-143
 Parameter: J <- "155"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "155"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.932640925"
Evaluating: 125.050557*(0.932640925-0.5)
 Parameter: XPOS <- "54.1019887"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.346336588"
Evaluating: 125.050557*(0.346336588-0.5)
 Parameter: YPOS <- "-19.2156953"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.491167572"
Evaluating: 152.572525*(0.491167572-0.5)+-4.51585405
 Parameter: ZPOS <- "-5.86343989"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.86343989" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.86343989" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "298"
Evaluating: 298
 Parameter: J <- "298"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "298" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "298"
 Parameter: NPOS -> "143"
Evaluating: 298-143
 Parameter: J <- "155"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "155"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.763846421"
Evaluating: 125.050557*(0.763846421-0.5)
 Parameter: XPOS <- "32.9941419"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.170853827"
Evaluating: 125.050557*(0.170853827-0.5)
 Parameter: YPOS <- "-41.1599123"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.91504008"
Evaluating: 152.572525*(0.91504008-0.5)+-4.51585405
 Parameter: ZPOS <- "58.8078589"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "58.8078589" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "58.8078589" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.9941419"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.9941419-0
 Parameter: XTRAN <- "32.9941419"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.1599123"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -41.1599123-0
 Parameter: YTRAN <- "-41.1599123"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "58.8078589"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 58.8078589-0
 Parameter: ZTRAN <- "58.8078589"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.9941419"
 Parameter: YTRAN -> "-41.1599123"
 Parameter: ZTRAN -> "58.8078589"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    32.994142  -41.159912   58.807859
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882676172"
Evaluating: 0.882676172*360.0
 Parameter: XPHI <- "317.763422"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.243990027E-02"
Evaluating: 6.243990027E-02*360.0
 Parameter: YPHI <- "22.4783641"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.568605758E-02"
Evaluating: 7.568605758E-02*360.0
 Parameter: ZPHI <- "27.2469807"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.9941419"
 Parameter: YPOS -> "-41.1599123"
 Parameter: ZPOS -> "58.8078589"
 Parameter: XPHI -> "317.763422"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.740376   -0.672193
    0.000000    0.672193    0.740376

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   42.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.9941419"
 Parameter: YPOS -> "-41.1599123"
 Parameter: ZPOS -> "58.8078589"
 Parameter: YPHI -> "22.4783641"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.924024    0.000000   -0.382335
    0.000000    1.000000    0.000000
    0.382335    0.000000    0.924024

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   22.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.9941419"
 Parameter: YPOS -> "-41.1599123"
 Parameter: ZPOS -> "58.8078589"
 Parameter: ZPHI -> "27.2469807"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.889041    0.457827    0.000000
   -0.457827    0.889041    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   27.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.994142 XMAX =   32.994142 XAVE =   32.994142
    YMIN =  -41.159912 YMAX =  -41.159912 YAVE =  -41.159912
    ZMIN =   58.807859 ZMAX =   58.807859 ZAVE =   58.807859
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.9941419"
Evaluating: 32.9941419+3.5
 Parameter: XMAX <- "36.4941419"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.1599123"
Evaluating: -41.1599123+3.5
 Parameter: YMAX <- "-37.6599123"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "58.8078589"
Evaluating: 58.8078589+3.5
 Parameter: ZMAX <- "62.3078589"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.9941419"
Evaluating: 32.9941419-3.5
 Parameter: XMIN <- "29.4941419"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.1599123"
Evaluating: -41.1599123-3.5
 Parameter: YMIN <- "-44.6599123"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "58.8078589"
Evaluating: 58.8078589-3.5
 Parameter: ZMIN <- "55.3078589"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.4941419"
 Parameter: XMIN -> "29.4941419"
 Parameter: YMAX -> "-37.6599123"
 Parameter: YMIN -> "-44.6599123"
 Parameter: ZMAX -> "62.3078589"
 Parameter: ZMIN -> "55.3078589"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "299"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "299" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "299"
Evaluating: 299
 Parameter: J <- "299"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "299" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "299"
 Parameter: NPOS -> "143"
Evaluating: 299-143
 Parameter: J <- "156"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "156"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.630400163"
Evaluating: 125.050557*(0.630400163-0.5)
 Parameter: XPOS <- "16.306613"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.919286582"
Evaluating: 125.050557*(0.919286582-0.5)
 Parameter: YPOS <- "52.4320206"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.897396534"
Evaluating: 152.572525*(0.897396534-0.5)+-4.51585405
 Parameter: ZPOS <- "56.1159386"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.1159386" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.1159386" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.306613"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 16.306613-0
 Parameter: XTRAN <- "16.306613"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "52.4320206"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 52.4320206-0
 Parameter: YTRAN <- "52.4320206"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.1159386"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 56.1159386-0
 Parameter: ZTRAN <- "56.1159386"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.306613"
 Parameter: YTRAN -> "52.4320206"
 Parameter: ZTRAN -> "56.1159386"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    16.306613   52.432021   56.115939
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.658003719"
Evaluating: 0.658003719*360.0
 Parameter: XPHI <- "236.881339"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.845439746"
Evaluating: 0.845439746*360.0
 Parameter: YPHI <- "304.358309"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.979532601"
Evaluating: 0.979532601*360.0
 Parameter: ZPHI <- "352.631736"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.306613"
 Parameter: YPOS -> "52.4320206"
 Parameter: ZPOS -> "56.1159386"
 Parameter: XPHI -> "236.881339"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.546375   -0.837541
    0.000000    0.837541   -0.546375

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  123.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.306613"
 Parameter: YPOS -> "52.4320206"
 Parameter: ZPOS -> "56.1159386"
 Parameter: YPHI -> "304.358309"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.564366    0.000000    0.825524
    0.000000    1.000000    0.000000
   -0.825524    0.000000    0.564366

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   55.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.306613"
 Parameter: YPOS -> "52.4320206"
 Parameter: ZPOS -> "56.1159386"
 Parameter: ZPHI -> "352.631736"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.991742   -0.128246    0.000000
    0.128246    0.991742    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    7.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.306613 XMAX =   16.306613 XAVE =   16.306613
    YMIN =   52.432021 YMAX =   52.432021 YAVE =   52.432021
    ZMIN =   56.115939 ZMAX =   56.115939 ZAVE =   56.115939
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.306613"
Evaluating: 16.306613+3.5
 Parameter: XMAX <- "19.806613"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "52.4320206"
Evaluating: 52.4320206+3.5
 Parameter: YMAX <- "55.9320206"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.1159386"
Evaluating: 56.1159386+3.5
 Parameter: ZMAX <- "59.6159386"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.306613"
Evaluating: 16.306613-3.5
 Parameter: XMIN <- "12.806613"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "52.4320206"
Evaluating: 52.4320206-3.5
 Parameter: YMIN <- "48.9320206"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.1159386"
Evaluating: 56.1159386-3.5
 Parameter: ZMIN <- "52.6159386"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.806613"
 Parameter: XMIN -> "12.806613"
 Parameter: YMAX -> "55.9320206"
 Parameter: YMIN -> "48.9320206"
 Parameter: ZMAX -> "59.6159386"
 Parameter: ZMIN -> "52.6159386"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "300"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "300" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "300"
Evaluating: 300
 Parameter: J <- "300"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "300" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "300"
 Parameter: NPOS -> "143"
Evaluating: 300-143
 Parameter: J <- "157"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "157"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.511087481"
Evaluating: 125.050557*(0.511087481-0.5)
 Parameter: XPOS <- "1.38649567"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.581944742"
Evaluating: 125.050557*(0.581944742-0.5)
 Parameter: YPOS <- "10.2472356"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.670464872"
Evaluating: 152.572525*(0.670464872-0.5)+-4.51585405
 Parameter: ZPOS <- "21.4924019"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.4924019" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.4924019" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.38649567"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.38649567-0
 Parameter: XTRAN <- "1.38649567"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.2472356"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.2472356-0
 Parameter: YTRAN <- "10.2472356"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.4924019"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.4924019-0
 Parameter: ZTRAN <- "21.4924019"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.38649567"
 Parameter: YTRAN -> "10.2472356"
 Parameter: ZTRAN -> "21.4924019"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR     1.386496   10.247236   21.492402
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.242179126"
Evaluating: 0.242179126*360.0
 Parameter: XPHI <- "87.1844854"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.289361884"
Evaluating: 0.289361884*360.0
 Parameter: YPHI <- "104.170278"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.17377499"
Evaluating: 0.17377499*360.0
 Parameter: ZPHI <- "62.5589964"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.38649567"
 Parameter: YPOS -> "10.2472356"
 Parameter: ZPOS -> "21.4924019"
 Parameter: XPHI -> "87.1844854"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.049120    0.998793
    0.000000   -0.998793    0.049120

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   87.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.38649567"
 Parameter: YPOS -> "10.2472356"
 Parameter: ZPOS -> "21.4924019"
 Parameter: YPHI -> "104.170278"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.244804    0.000000   -0.969572
    0.000000    1.000000    0.000000
    0.969572    0.000000   -0.244804

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  104.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.38649567"
 Parameter: YPOS -> "10.2472356"
 Parameter: ZPOS -> "21.4924019"
 Parameter: ZPHI -> "62.5589964"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.460835    0.887486    0.000000
   -0.887486    0.460835    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   62.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.386496 XMAX =    1.386496 XAVE =    1.386496
    YMIN =   10.247236 YMAX =   10.247236 YAVE =   10.247236
    ZMIN =   21.492402 ZMAX =   21.492402 ZAVE =   21.492402
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.38649567"
Evaluating: 1.38649567+3.5
 Parameter: XMAX <- "4.88649567"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.2472356"
Evaluating: 10.2472356+3.5
 Parameter: YMAX <- "13.7472356"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.4924019"
Evaluating: 21.4924019+3.5
 Parameter: ZMAX <- "24.9924019"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.38649567"
Evaluating: 1.38649567-3.5
 Parameter: XMIN <- "-2.11350433"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.2472356"
Evaluating: 10.2472356-3.5
 Parameter: YMIN <- "6.7472356"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.4924019"
Evaluating: 21.4924019-3.5
 Parameter: ZMIN <- "17.9924019"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.88649567"
 Parameter: XMIN -> "-2.11350433"
 Parameter: YMAX -> "13.7472356"
 Parameter: YMIN -> "6.7472356"
 Parameter: ZMAX -> "24.9924019"
 Parameter: ZMIN -> "17.9924019"
 SELRPN>     28 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     14 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64715 NEG      CLA      157      CLA     -**** PROA     THR      1298     C             2.7318
64715 NEG      CLA      157      CLA     -**** PROA     THR      1298     O             3.4859
64715 NEG      CLA      157      CLA     -**** PROA     GLN      1299     N             1.3957
64715 NEG      CLA      157      CLA     -**** PROA     GLN      1299     CA            1.0980
64715 NEG      CLA      157      CLA     -**** PROA     GLN      1299     CB            1.1718
64715 NEG      CLA      157      CLA     -**** PROA     GLN      1299     CG            2.1182
64715 NEG      CLA      157      CLA     -**** PROA     GLN      1299     CD            3.1128
64715 NEG      CLA      157      CLA     -**** PROA     GLN      1299     OE1           3.4732
64715 NEG      CLA      157      CLA     -**** PROA     GLN      1299     C             2.2378
64715 NEG      CLA      157      CLA     -**** PROA     GLN      1299     O             3.1847
64715 NEG      CLA      157      CLA     -**** PROA     ILE      1300     N             2.8102
64715 NEG      CLA      157      CLA     -**** PROA     ILE      1300     CA            4.2154
64715 NEG      CLA      157      CLA     -**** PROA     GLU      1327     CB            5.6175
64715 NEG      CLA      157      CLA     -**** PROA     ALA      1331     CB            3.4770
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        14
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "14"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "300"
Evaluating: 300
 Parameter: J <- "300"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "300" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "300"
 Parameter: NPOS -> "143"
Evaluating: 300-143
 Parameter: J <- "157"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "157"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.824738131"
Evaluating: 125.050557*(0.824738131-0.5)
 Parameter: XPOS <- "40.6086842"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.90930501"
Evaluating: 125.050557*(0.90930501-0.5)
 Parameter: YPOS <- "51.1838195"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.644485005"
Evaluating: 152.572525*(0.644485005-0.5)+-4.51585405
 Parameter: ZPOS <- "17.528588"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.528588" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.528588" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.386496 XMAX =    1.386496 XAVE =    1.386496
    YMIN =   10.247236 YMAX =   10.247236 YAVE =   10.247236
    ZMIN =   21.492402 ZMAX =   21.492402 ZAVE =   21.492402
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.6086842"
 RDCMND substituted energy or value "?XAVE" to "1.38649567"
Evaluating: 40.6086842-1.38649567
 Parameter: XTRAN <- "39.2221885"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "51.1838195"
 RDCMND substituted energy or value "?YAVE" to "10.2472356"
Evaluating: 51.1838195-10.2472356
 Parameter: YTRAN <- "40.9365839"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.528588"
 RDCMND substituted energy or value "?ZAVE" to "21.4924019"
Evaluating: 17.528588-21.4924019
 Parameter: ZTRAN <- "-3.9638139"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.2221885"
 Parameter: YTRAN -> "40.9365839"
 Parameter: ZTRAN -> "-3.9638139"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    39.222189   40.936584   -3.963814
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.787469713E-02"
Evaluating: 8.787469713E-02*360.0
 Parameter: XPHI <- "31.634891"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.649596541"
Evaluating: 0.649596541*360.0
 Parameter: YPHI <- "233.854755"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.157606481"
Evaluating: 0.157606481*360.0
 Parameter: ZPHI <- "56.7383332"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.6086842"
 Parameter: YPOS -> "51.1838195"
 Parameter: ZPOS -> "17.528588"
 Parameter: XPHI -> "31.634891"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.851408    0.524504
    0.000000   -0.524504    0.851408

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   31.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.6086842"
 Parameter: YPOS -> "51.1838195"
 Parameter: ZPOS -> "17.528588"
 Parameter: YPHI -> "233.854755"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.589834    0.000000    0.807524
    0.000000    1.000000    0.000000
   -0.807524    0.000000   -0.589834

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  126.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.6086842"
 Parameter: YPOS -> "51.1838195"
 Parameter: ZPOS -> "17.528588"
 Parameter: ZPHI -> "56.7383332"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.548464    0.836174    0.000000
   -0.836174    0.548464    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   56.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.608684 XMAX =   40.608684 XAVE =   40.608684
    YMIN =   51.183819 YMAX =   51.183819 YAVE =   51.183819
    ZMIN =   17.528588 ZMAX =   17.528588 ZAVE =   17.528588
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.6086842"
Evaluating: 40.6086842+3.5
 Parameter: XMAX <- "44.1086842"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "51.1838195"
Evaluating: 51.1838195+3.5
 Parameter: YMAX <- "54.6838195"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.528588"
Evaluating: 17.528588+3.5
 Parameter: ZMAX <- "21.028588"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.6086842"
Evaluating: 40.6086842-3.5
 Parameter: XMIN <- "37.1086842"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "51.1838195"
Evaluating: 51.1838195-3.5
 Parameter: YMIN <- "47.6838195"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.528588"
Evaluating: 17.528588-3.5
 Parameter: ZMIN <- "14.028588"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.1086842"
 Parameter: XMIN -> "37.1086842"
 Parameter: YMAX -> "54.6838195"
 Parameter: YMIN -> "47.6838195"
 Parameter: ZMAX -> "21.028588"
 Parameter: ZMIN -> "14.028588"
 SELRPN>     25 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>     12 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64715 NEG      CLA      157      CLA     -**** MEMB     POPC     117      C12           3.0164
64715 NEG      CLA      157      CLA     -**** MEMB     POPC     117      C11           1.6403
64715 NEG      CLA      157      CLA     -**** MEMB     POPC     117      P             3.2963
64715 NEG      CLA      157      CLA     -**** MEMB     POPC     117      O13           3.5414
64715 NEG      CLA      157      CLA     -**** MEMB     POPC     117      O12           2.4598
64715 NEG      CLA      157      CLA     -**** MEMB     POPC     117      O11           3.1797
64715 NEG      CLA      157      CLA     -**** MEMB     POPC     117      O31           3.4400
64715 NEG      CLA      157      CLA     -**** MEMB     POPC     117      C32           3.4899
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "300"
Evaluating: 300
 Parameter: J <- "300"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "300" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "300"
 Parameter: NPOS -> "143"
Evaluating: 300-143
 Parameter: J <- "157"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "157"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.728552347"
Evaluating: 125.050557*(0.728552347-0.5)
 Parameter: XPOS <- "28.5805983"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.186363696"
Evaluating: 125.050557*(0.186363696-0.5)
 Parameter: YPOS <- "-39.2203945"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.419221557"
Evaluating: 152.572525*(0.419221557-0.5)+-4.51585405
 Parameter: ZPOS <- "-16.8404251"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.8404251" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.608684 XMAX =   40.608684 XAVE =   40.608684
    YMIN =   51.183819 YMAX =   51.183819 YAVE =   51.183819
    ZMIN =   17.528588 ZMAX =   17.528588 ZAVE =   17.528588
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.5805983"
 RDCMND substituted energy or value "?XAVE" to "40.6086842"
Evaluating: 28.5805983-40.6086842
 Parameter: XTRAN <- "-12.0280859"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.2203945"
 RDCMND substituted energy or value "?YAVE" to "51.1838195"
Evaluating: -39.2203945-51.1838195
 Parameter: YTRAN <- "-90.404214"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.8404251"
 RDCMND substituted energy or value "?ZAVE" to "17.528588"
Evaluating: -16.8404251-17.528588
 Parameter: ZTRAN <- "-34.3690131"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.0280859"
 Parameter: YTRAN -> "-90.404214"
 Parameter: ZTRAN -> "-34.3690131"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR   -12.028086  -90.404214  -34.369013
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.949059997E-02"
Evaluating: 7.949059997E-02*360.0
 Parameter: XPHI <- "28.616616"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.513028965"
Evaluating: 0.513028965*360.0
 Parameter: YPHI <- "184.690427"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.247528806"
Evaluating: 0.247528806*360.0
 Parameter: ZPHI <- "89.1103702"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.5805983"
 Parameter: YPOS -> "-39.2203945"
 Parameter: ZPOS -> "-16.8404251"
 Parameter: XPHI -> "28.616616"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.877844    0.478946
    0.000000   -0.478946    0.877844

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   28.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.5805983"
 Parameter: YPOS -> "-39.2203945"
 Parameter: ZPOS -> "-16.8404251"
 Parameter: YPHI -> "184.690427"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.996651    0.000000    0.081772
    0.000000    1.000000    0.000000
   -0.081772    0.000000   -0.996651

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  175.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.5805983"
 Parameter: YPOS -> "-39.2203945"
 Parameter: ZPOS -> "-16.8404251"
 Parameter: ZPHI -> "89.1103702"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.015526    0.999879    0.000000
   -0.999879    0.015526    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   89.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.580598 XMAX =   28.580598 XAVE =   28.580598
    YMIN =  -39.220394 YMAX =  -39.220394 YAVE =  -39.220394
    ZMIN =  -16.840425 ZMAX =  -16.840425 ZAVE =  -16.840425
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.5805983"
Evaluating: 28.5805983+3.5
 Parameter: XMAX <- "32.0805983"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.2203945"
Evaluating: -39.2203945+3.5
 Parameter: YMAX <- "-35.7203945"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.8404251"
Evaluating: -16.8404251+3.5
 Parameter: ZMAX <- "-13.3404251"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.5805983"
Evaluating: 28.5805983-3.5
 Parameter: XMIN <- "25.0805983"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.2203945"
Evaluating: -39.2203945-3.5
 Parameter: YMIN <- "-42.7203945"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.8404251"
Evaluating: -16.8404251-3.5
 Parameter: ZMIN <- "-20.3404251"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.0805983"
 Parameter: XMIN -> "25.0805983"
 Parameter: YMAX -> "-35.7203945"
 Parameter: YMIN -> "-42.7203945"
 Parameter: ZMAX -> "-13.3404251"
 Parameter: ZMIN -> "-20.3404251"
 SELRPN>      9 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      4 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
64715 NEG      CLA      157      CLA     -**** MEMB     POPC     250      O13           3.6457
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "300"
Evaluating: 300
 Parameter: J <- "300"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "300" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "300"
 Parameter: NPOS -> "143"
Evaluating: 300-143
 Parameter: J <- "157"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "157"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.70095278"
Evaluating: 125.050557*(0.70095278-0.5)
 Parameter: XPOS <- "25.1292571"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.109595084"
Evaluating: 125.050557*(0.109595084-0.5)
 Parameter: YPOS <- "-48.8203522"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.88454935"
Evaluating: 152.572525*(0.88454935-0.5)+-4.51585405
 Parameter: ZPOS <- "54.1558113"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.1558113" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.1558113" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.580598 XMAX =   28.580598 XAVE =   28.580598
    YMIN =  -39.220394 YMAX =  -39.220394 YAVE =  -39.220394
    ZMIN =  -16.840425 ZMAX =  -16.840425 ZAVE =  -16.840425
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.1292571"
 RDCMND substituted energy or value "?XAVE" to "28.5805983"
Evaluating: 25.1292571-28.5805983
 Parameter: XTRAN <- "-3.4513412"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.8203522"
 RDCMND substituted energy or value "?YAVE" to "-39.2203945"
Evaluating: -48.8203522--39.2203945
 Parameter: YTRAN <- "-9.5999577"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.1558113"
 RDCMND substituted energy or value "?ZAVE" to "-16.8404251"
Evaluating: 54.1558113--16.8404251
 Parameter: ZTRAN <- "70.9962364"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.4513412"
 Parameter: YTRAN -> "-9.5999577"
 Parameter: ZTRAN -> "70.9962364"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -3.451341   -9.599958   70.996236
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.331810139"
Evaluating: 0.331810139*360.0
 Parameter: XPHI <- "119.45165"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.489942097"
Evaluating: 0.489942097*360.0
 Parameter: YPHI <- "176.379155"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.853036891"
Evaluating: 0.853036891*360.0
 Parameter: ZPHI <- "307.093281"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.1292571"
 Parameter: YPOS -> "-48.8203522"
 Parameter: ZPOS -> "54.1558113"
 Parameter: XPHI -> "119.45165"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.491689    0.870771
    0.000000   -0.870771   -0.491689

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  119.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.1292571"
 Parameter: YPOS -> "-48.8203522"
 Parameter: ZPOS -> "54.1558113"
 Parameter: YPHI -> "176.379155"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.998004    0.000000   -0.063154
    0.000000    1.000000    0.000000
    0.063154    0.000000   -0.998004

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  176.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.1292571"
 Parameter: YPOS -> "-48.8203522"
 Parameter: ZPOS -> "54.1558113"
 Parameter: ZPHI -> "307.093281"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.603114   -0.797655    0.000000
    0.797655    0.603114    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   52.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.129257 XMAX =   25.129257 XAVE =   25.129257
    YMIN =  -48.820352 YMAX =  -48.820352 YAVE =  -48.820352
    ZMIN =   54.155811 ZMAX =   54.155811 ZAVE =   54.155811
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.1292571"
Evaluating: 25.1292571+3.5
 Parameter: XMAX <- "28.6292571"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.8203522"
Evaluating: -48.8203522+3.5
 Parameter: YMAX <- "-45.3203522"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.1558113"
Evaluating: 54.1558113+3.5
 Parameter: ZMAX <- "57.6558113"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.1292571"
Evaluating: 25.1292571-3.5
 Parameter: XMIN <- "21.6292571"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.8203522"
Evaluating: -48.8203522-3.5
 Parameter: YMIN <- "-52.3203522"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.1558113"
Evaluating: 54.1558113-3.5
 Parameter: ZMIN <- "50.6558113"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.6292571"
 Parameter: XMIN -> "21.6292571"
 Parameter: YMAX -> "-45.3203522"
 Parameter: YMIN -> "-52.3203522"
 Parameter: ZMAX -> "57.6558113"
 Parameter: ZMIN -> "50.6558113"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "301"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "301" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "301"
Evaluating: 301
 Parameter: J <- "301"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "301" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "301"
 Parameter: NPOS -> "143"
Evaluating: 301-143
 Parameter: J <- "158"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "158"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.467365846"
Evaluating: 125.050557*(0.467365846-0.5)
 Parameter: XPOS <- "-4.08091913"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.655651859"
Evaluating: 125.050557*(0.655651859-0.5)
 Parameter: YPOS <- "19.4643517"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.246689679"
Evaluating: 152.572525*(0.246689679-0.5)+-4.51585405
 Parameter: ZPOS <- "-43.1640493"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.1640493" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.08091913"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.08091913-0
 Parameter: XTRAN <- "-4.08091913"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.4643517"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.4643517-0
 Parameter: YTRAN <- "19.4643517"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.1640493"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.1640493-0
 Parameter: ZTRAN <- "-43.1640493"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.08091913"
 Parameter: YTRAN -> "19.4643517"
 Parameter: ZTRAN -> "-43.1640493"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    -4.080919   19.464352  -43.164049
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.633023544"
Evaluating: 0.633023544*360.0
 Parameter: XPHI <- "227.888476"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.920939481"
Evaluating: 0.920939481*360.0
 Parameter: YPHI <- "331.538213"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.751536818"
Evaluating: 0.751536818*360.0
 Parameter: ZPHI <- "270.553254"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.08091913"
 Parameter: YPOS -> "19.4643517"
 Parameter: ZPOS -> "-43.1640493"
 Parameter: XPHI -> "227.888476"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.670576   -0.741841
    0.000000    0.741841   -0.670576

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  132.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.08091913"
 Parameter: YPOS -> "19.4643517"
 Parameter: ZPOS -> "-43.1640493"
 Parameter: YPHI -> "331.538213"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.879135    0.000000    0.476573
    0.000000    1.000000    0.000000
   -0.476573    0.000000    0.879135

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   28.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.08091913"
 Parameter: YPOS -> "19.4643517"
 Parameter: ZPOS -> "-43.1640493"
 Parameter: ZPHI -> "270.553254"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    0.009656   -0.999953    0.000000
    0.999953    0.009656    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   89.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.080919 XMAX =   -4.080919 XAVE =   -4.080919
    YMIN =   19.464352 YMAX =   19.464352 YAVE =   19.464352
    ZMIN =  -43.164049 ZMAX =  -43.164049 ZAVE =  -43.164049
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.08091913"
Evaluating: -4.08091913+3.5
 Parameter: XMAX <- "-0.58091913"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.4643517"
Evaluating: 19.4643517+3.5
 Parameter: YMAX <- "22.9643517"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.1640493"
Evaluating: -43.1640493+3.5
 Parameter: ZMAX <- "-39.6640493"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.08091913"
Evaluating: -4.08091913-3.5
 Parameter: XMIN <- "-7.58091913"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.4643517"
Evaluating: 19.4643517-3.5
 Parameter: YMIN <- "15.9643517"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.1640493"
Evaluating: -43.1640493-3.5
 Parameter: ZMIN <- "-46.6640493"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.58091913"
 Parameter: XMIN -> "-7.58091913"
 Parameter: YMAX -> "22.9643517"
 Parameter: YMIN -> "15.9643517"
 Parameter: ZMAX -> "-39.6640493"
 Parameter: ZMIN -> "-46.6640493"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "302"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "302" and "302".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "302"
Evaluating: 302
 Parameter: J <- "302"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "143"
 Comparing "302" and "143".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "302"
 Parameter: NPOS -> "143"
Evaluating: 302-143
 Parameter: J <- "159"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "159"
 SELRPN>      1 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.991580814"
Evaluating: 125.050557*(0.991580814-0.5)
 Parameter: XPOS <- "61.4724546"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "125.050557"
 RDCMND substituted energy or value "?RANDOM" to "0.677968197"
Evaluating: 125.050557*(0.677968197-0.5)
 Parameter: YPOS <- "22.2550222"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "152.572525"
 Parameter: ZCEN -> "-4.51585405"
 RDCMND substituted energy or value "?RANDOM" to "0.349280849"
Evaluating: 152.572525*(0.349280849-0.5)+-4.51585405
 Parameter: ZPOS <- "-27.5114555"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.5114555" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "61.4724546"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 61.4724546-0
 Parameter: XTRAN <- "61.4724546"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.2550222"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 22.2550222-0
 Parameter: YTRAN <- "22.2550222"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.5114555"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.5114555-0
 Parameter: ZTRAN <- "-27.5114555"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "61.4724546"
 Parameter: YTRAN -> "22.2550222"
 Parameter: ZTRAN -> "-27.5114555"
 SELRPN>      1 atoms have been selected out of  64717
 TRANSLATION VECTOR    61.472455   22.255022  -27.511456
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.779345585"
Evaluating: 0.779345585*360.0
 Parameter: XPHI <- "280.564411"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.614448374"
Evaluating: 0.614448374*360.0
 Parameter: YPHI <- "221.201415"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.452747924"
Evaluating: 0.452747924*360.0
 Parameter: ZPHI <- "162.989253"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "61.4724546"
 Parameter: YPOS -> "22.2550222"
 Parameter: ZPOS -> "-27.5114555"
 Parameter: XPHI -> "280.564411"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.183341   -0.983049
    0.000000    0.983049    0.183341

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   79.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "61.4724546"
 Parameter: YPOS -> "22.2550222"
 Parameter: ZPOS -> "-27.5114555"
 Parameter: YPHI -> "221.201415"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.752399    0.000000    0.658708
    0.000000    1.000000    0.000000
   -0.658708    0.000000   -0.752399

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  138.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "61.4724546"
 Parameter: YPOS -> "22.2550222"
 Parameter: ZPOS -> "-27.5114555"
 Parameter: ZPHI -> "162.989253"
 SELRPN>      1 atoms have been selected out of  64717
 ROTATION MATRIX
   -0.956250    0.292551    0.000000
   -0.292551   -0.956250    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  162.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  64717
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   61.472455 XMAX =   61.472455 XAVE =   61.472455
    YMIN =   22.255022 YMAX =   22.255022 YAVE =   22.255022
    ZMIN =  -27.511456 ZMAX =  -27.511456 ZAVE =  -27.511456
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "61.4724546"
Evaluating: 61.4724546+3.5
 Parameter: XMAX <- "64.9724546"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.2550222"
Evaluating: 22.2550222+3.5
 Parameter: YMAX <- "25.7550222"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.5114555"
Evaluating: -27.5114555+3.5
 Parameter: ZMAX <- "-24.0114555"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "61.4724546"
Evaluating: 61.4724546-3.5
 Parameter: XMIN <- "57.9724546"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.2550222"
Evaluating: 22.2550222-3.5
 Parameter: YMIN <- "18.7550222"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.5114555"
Evaluating: -27.5114555-3.5
 Parameter: ZMIN <- "-31.0114555"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "64.9724546"
 Parameter: XMIN -> "57.9724546"
 Parameter: YMAX -> "25.7550222"
 Parameter: YMIN -> "18.7550222"
 Parameter: ZMAX -> "-24.0114555"
 Parameter: ZMIN -> "-31.0114555"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>  21669 atoms have been selected out of  64717
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21669"
 Comparing "21669" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  82234
 SELRPN>      0 atoms have been selected out of  82234

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "303"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "302"
 Comparing "303" and "302".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @pos end
 Parameter: POS -> "SOD"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "143"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @neg end
 Parameter: NEG -> "CLA"
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "159"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>    143 atoms have been selected out of  64717
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "64416"
 Parameter: POSAT <- "64416"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>    159 atoms have been selected out of  64717
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "64559"
 Parameter: NEGAT <- "64559"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "64559" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            if posat .gt. @negat then
 Parameter: NEGAT -> "64559"
 Comparing "64416" and "64559".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        label skipreorder
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of  64717
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>    143 atoms have been selected out of  64717
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "143"
 Parameter: NPOSATOMS <- "143"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>    159 atoms have been selected out of  64717
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "159"
 Parameter: NNEGATOMS <- "159"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>    143 atoms have been selected out of  64717
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>    143 atoms have been selected out of  64717
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "143"
 Parameter: NIONATOMS <- "143"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "143" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "159" and "0".
 IF test evaluated as true.  Performing command
 SEGMENTS "IONS    " AND "NEG     " HAVE BEEN JOINED.
 THE RESIDUE IDENTIFIERS HAVE BEEN RENUMBERED
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        4   Number of residues   =     1957
         Number of atoms         =    64717   Number of groups     =    17831
         Number of bonds         =    64356   Number of angles     =   121292
         Number of dihedrals     =   171543   Number of impropers  =     4149
         Number of cross-terms   =     1332   Number of autogens   =        0
         Number of HB acceptors  =     1875   Number of HB donors  =     2261
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4.3_ion_protmemb.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 11. 2023. JOB
 TITLE> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 TITLE> *  DATE:    10/11/23      5:22:19      CREATED BY USER: APACHE
 TITLE> *

 ** WARNING ** Coordinates were overwritten for 64415 atoms.
 *** LEVEL  2 WARNING *** BOMLEV IS    0
  
 CHARMM>     
  
 CHARMM>    write coor pdb name step4.3_ion.pdb
 VOPEN> Attempting to open::step4.3_ion.pdb::
 RDTITL>  
 RDTITL> No title read.
  Write CHARMM-pdb format
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: 0
 Parameter: CGTOTINIT <- "0"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: INT(0)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "0"
Evaluating: ABS(0-0)
 Parameter: CGDIFF <- "0"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    delete atom sele .not. ( segid IONS ) end
 SELRPN>  64415 atoms have been selected out of  64717

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:       1655 residues deleted.

 Message from MAPIC:          3 segments deleted.
 DELTIC:     64356 bonds deleted
 DELTIC:    121292 angles deleted
 DELTIC:    171543 dihedrals deleted
 DELTIC:      4149 improper dihedrals deleted
 DELTIC:      1332 crossterm maps deleted
 DELTIC:      2261 donors deleted
 DELTIC:      1875 acceptors deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      302
         Number of atoms         =      302   Number of groups     =      302
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =  -16.00000
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step4.3_ion.psf
 VOPEN> Attempting to open::step4.3_ion.psf::
 RDTITL> WRITE COOR CARD NAME STEP4.3_ION.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step4.3_ion.crd
 VOPEN> Attempting to open::step4.3_ion.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    write title card name step4.3_ion.str
 VOPEN> Attempting to open::step4.3_ion.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 143
 RDTITL> * SET NNEGTOT = 159
 RDTITL> * SET NIONTOT = 302
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   10 with status "KEEP"
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                     56.35 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    MOST SEVERE WARNING WAS AT LEVEL  1

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:    56.35  SECONDS 
                         CPU TIME:    28.47  SECONDS 
